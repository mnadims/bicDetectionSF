<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<unit xmlns="http://www.srcML.org/srcML/src" revision="1.0.0" language="Java" filename="E:/01Courses@USASK/CMPT898-HumanDrivenSoftwareEngineeringForScientificResearch/ProjectProgress/data_files/final_dataset/gen_patch_codes/filtered/oozie/ca01c283.java"><expr_stmt><expr><name>From</name> <name>ca01c28362ede63bac17e32af42809b1c90c5ce9</name> <name>Mon</name> <name>Sep</name> <literal type="number">17</literal> <literal type="number">00</literal><operator>:</operator><literal type="number">00</literal><operator>:</operator><literal type="number">00</literal> <literal type="number">2001</literal>
<name>From</name><operator>:</operator> <name>Robert</name> <name><name>Kanter</name> <argument_list type="generic">&lt;<argument><name>rkanter</name><annotation>@<name><name>cloudera</name><operator>.</operator><name>com</name></name></annotation></argument>&gt;</argument_list></name>
<name>Date</name><operator>:</operator> <name>Sat</name></expr><operator>,</operator> <expr><literal type="number">12</literal> <name>Nov</name> <literal type="number">2016</literal> <literal type="number">21</literal><operator>:</operator><literal type="number">41</literal><operator>:</operator><literal type="number">17</literal> <operator>+</operator><literal type="number">0100</literal>
<name>Subject</name><operator>:</operator> <index>[<expr><name>PATCH</name></expr>]</index> <name>OOZIE</name><operator>-</operator><literal type="number">2666</literal> <name>Support</name> <name>embedding</name> <name>Jetty</name> <name>into</name> <call><name>Oozie</name> <argument_list>(<argument><expr><name>asasvari</name> <name>via</name>
 <name>rkanter</name></expr></argument>)</argument_list></call>

<operator>--</operator>
 <name>bin</name><operator>/</operator><name><name>mkdistro</name><operator>.</operator><name>sh</name></name>                               <operator>|</operator>   <literal type="number">2</literal> <operator>+</operator><operator>-</operator>
 <name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>conf</name><operator>/</operator><name>oozie</name><operator>-</operator><name><name>env</name><operator>.</operator><name>sh</name></name>               <operator>|</operator>   <literal type="number">6</literal> <operator>+</operator><operator>-</operator>
 <operator>...</operator><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>util</name><operator>/</operator><name><name>ConfigUtils</name><operator>.</operator><name>java</name></name>    <operator>|</operator>  <literal type="number">12</literal> <operator>+</operator><operator>-</operator>
 <operator>...</operator><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>util</name><operator>/</operator><name><name>Instrumentation</name><operator>.</operator><name>java</name></name>    <operator>|</operator>   <literal type="number">8</literal> <operator>+</operator><operator>-</operator>
 <name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>resources</name><operator>/</operator><name>oozie</name><operator>-</operator>default<operator>.</operator><name>xml</name>     <operator>|</operator>  <literal type="number">93</literal> <operator>++</operator><operator>++</operator><operator>+</operator><operator>-</operator>
 <name>distro</name><operator>/</operator><name><name>pom</name><operator>.</operator><name>xml</name></name>                                <operator>|</operator>  <literal type="number">99</literal> <operator>++</operator><operator>+</operator><operator>--</operator><operator>-</operator>
 <name>distro</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>bin</name><operator>/</operator><name>oozie</name><operator>-</operator><name>jetty</name><operator>-</operator><name><name>server</name><operator>.</operator><name>sh</name></name>     <operator>|</operator> <literal type="number">226</literal> <operator>++</operator><operator>++</operator><operator>++</operator><operator>++</operator><operator>++</operator><operator>++</operator><operator>++</operator>
 <name>distro</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>bin</name><operator>/</operator><name>oozie</name><operator>-</operator><name><name>setup</name><operator>.</operator><name>sh</name></name>            <operator>|</operator> <literal type="number">285</literal> <operator>++</operator><operator>++</operator><operator>++</operator><operator>++</operator><operator>++</operator><operator>+</operator><operator>--</operator><operator>--</operator><operator>--</operator><operator>-</operator>
 <name>distro</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>bin</name><operator>/</operator><name>oozie</name><operator>-</operator><name><name>sys</name><operator>.</operator><name>sh</name></name>              <operator>|</operator>  <literal type="number">36</literal> <operator>++</operator><operator>-</operator>
 <name>distro</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>bin</name><operator>/</operator><name>oozie</name><operator>-</operator><name>tomcat</name><operator>-</operator><name><name>server</name><operator>.</operator><name>sh</name></name>    <operator>|</operator>  <literal type="number">89</literal> <operator>++</operator><operator>++</operator><operator>++</operator>
 <name>distro</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>bin</name><operator>/</operator><name><name>oozied</name><operator>.</operator><name>sh</name></name>                 <operator>|</operator>  <literal type="number">98</literal> <operator>++</operator><operator>--</operator><operator>--</operator>
 <name><name>pom</name><operator>.</operator><name>xml</name></name>                                       <operator>|</operator>  <literal type="number">72</literal> <operator>++</operator><operator>++</operator><operator>-</operator>
 <name>release</name><operator>-</operator><name><name>log</name><operator>.</operator><name>txt</name></name>                               <operator>|</operator>   <literal type="number">1</literal> <operator>+</operator>
 <name>server</name><operator>/</operator><name><name>pom</name><operator>.</operator><name>xml</name></name>                                <operator>|</operator> <literal type="number">257</literal> <operator>++</operator><operator>++</operator><operator>++</operator><operator>++</operator><operator>++</operator><operator>++</operator><operator>++</operator><operator>++</operator>
 <name>server</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>assemblies</name><operator>/</operator><name><name>empty</name><operator>.</operator><name>xml</name></name>          <operator>|</operator>  <literal type="number">21</literal> <operator>++</operator>
 <operator>...</operator><operator>/</operator><name>oozie</name><operator>/</operator><name>server</name><operator>/</operator><name><name>EmbeddedOozieServer</name><operator>.</operator><name>java</name></name>     <operator>|</operator> <literal type="number">206</literal> <operator>++</operator><operator>++</operator><operator>++</operator><operator>++</operator><operator>++</operator><operator>++</operator><operator>+</operator>
 <operator>...</operator><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>server</name><operator>/</operator><name><name>FilterMapper</name><operator>.</operator><name>java</name></name> <operator>|</operator>  <literal type="number">61</literal> <operator>++</operator><operator>++</operator>
 <operator>...</operator><operator>/</operator><name>server</name><operator>/</operator><name><name>HttpConfigurationWrapper</name><operator>.</operator><name>java</name></name>      <operator>|</operator>  <literal type="number">63</literal> <operator>++</operator><operator>++</operator>
 <operator>...</operator><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>server</name><operator>/</operator><name><name>JspHandler</name><operator>.</operator><name>java</name></name>   <operator>|</operator> <literal type="number">161</literal> <operator>++</operator><operator>++</operator><operator>++</operator><operator>++</operator><operator>++</operator>
 <operator>...</operator><operator>/</operator><name>server</name><operator>/</operator><name><name>SSLServerConnectorFactory</name><operator>.</operator><name>java</name></name>     <operator>|</operator> <literal type="number">136</literal> <operator>++</operator><operator>++</operator><operator>++</operator><operator>++</operator><operator>+</operator>
 <operator>...</operator><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>server</name><operator>/</operator><name><name>ServletMapper</name><operator>.</operator><name>java</name></name>    <operator>|</operator>  <literal type="number">95</literal> <operator>++</operator><operator>++</operator><operator>++</operator>
 <operator>...</operator><operator>/</operator><name>oozie</name><operator>/</operator><name>server</name><operator>/</operator><name><name>WebRootResourceLocator</name><operator>.</operator><name>java</name></name>  <operator>|</operator>  <literal type="number">39</literal> <operator>++</operator><operator>+</operator>
 <operator>...</operator><operator>/</operator><name><name>ConstraintSecurityHandlerProvider</name><operator>.</operator><name>java</name></name>    <operator>|</operator>  <literal type="number">47</literal> <operator>++</operator><operator>+</operator>
 <operator>...</operator><operator>/</operator><name>server</name><operator>/</operator><name>guice</name><operator>/</operator><name><name>JettyServerProvider</name><operator>.</operator><name>java</name></name>     <operator>|</operator>  <literal type="number">48</literal> <operator>++</operator><operator>+</operator>
 <operator>...</operator><operator>/</operator><name>server</name><operator>/</operator><name>guice</name><operator>/</operator><name><name>JspHandlerProvider</name><operator>.</operator><name>java</name></name>      <operator>|</operator>  <literal type="number">47</literal> <operator>++</operator><operator>+</operator>
 <operator>...</operator><operator>/</operator><name>oozie</name><operator>/</operator><name>server</name><operator>/</operator><name>guice</name><operator>/</operator><name><name>OozieGuiceModule</name><operator>.</operator><name>java</name></name>  <operator>|</operator>  <literal type="number">45</literal> <operator>++</operator><operator>+</operator>
 <operator>...</operator><operator>/</operator><name>server</name><operator>/</operator><name>guice</name><operator>/</operator><name><name>RewriteHandlerProvider</name><operator>.</operator><name>java</name></name>  <operator>|</operator>  <literal type="number">44</literal> <operator>++</operator><operator>+</operator>
 <operator>...</operator><operator>/</operator><name>oozie</name><operator>/</operator><name>server</name><operator>/</operator><name>guice</name><operator>/</operator><name><name>ServicesProvider</name><operator>.</operator><name>java</name></name>  <operator>|</operator>  <literal type="number">39</literal> <operator>++</operator><operator>+</operator>
 <operator>...</operator><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>resources</name><operator>/</operator><name>checkstyle</name><operator>-</operator><name><name>header</name><operator>.</operator><name>txt</name></name>  <operator>|</operator>  <literal type="number">17</literal> <operator>++</operator>
 <name>server</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>resources</name><operator>/</operator><name><name>checkstyle</name><operator>.</operator><name>xml</name></name>      <operator>|</operator>  <literal type="number">41</literal> <operator>++</operator><operator>+</operator>
 <operator>...</operator><operator>/</operator><name>oozie</name><operator>/</operator><name>server</name><operator>/</operator><name><name>TestEmbeddedOozieServer</name><operator>.</operator><name>java</name></name> <operator>|</operator> <literal type="number">119</literal> <operator>++</operator><operator>++</operator><operator>++</operator><operator>++</operator>
 <operator>...</operator><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>server</name><operator>/</operator><name><name>TestJspHandler</name><operator>.</operator><name>java</name></name>   <operator>|</operator>  <literal type="number">94</literal> <operator>++</operator><operator>++</operator><operator>++</operator>
 <operator>...</operator><operator>/</operator><name>server</name><operator>/</operator><name><name>TestSSLServerConnectorFactory</name><operator>.</operator><name>java</name></name> <operator>|</operator> <literal type="number">137</literal> <operator>++</operator><operator>++</operator><operator>++</operator><operator>++</operator><operator>+</operator>
 <name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>assemblies</name><operator>/</operator><name>distro</name><operator>-</operator><name><name>jetty</name><operator>.</operator><name>xml</name></name>          <operator>|</operator> <literal type="number">155</literal> <operator>++</operator><operator>++</operator><operator>++</operator><operator>++</operator><operator>++</operator>
 <operator>...</operator><operator>/</operator><block>{<expr><name><name>distro</name><operator>.</operator><name>xml</name></name> <operator>=</operator><operator>&gt;</operator> <name>distro</name><operator>-</operator><name><name>tomcat</name><operator>.</operator><name>xml</name></name></expr>}</block>         <operator>|</operator>   <literal type="number">8</literal> <operator>+</operator><operator>-</operator>
 <name>webapp</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>webapp</name><operator>/</operator><literal type="number">403.html</literal>               <operator>|</operator>  <literal type="number">31</literal> <operator>++</operator>
 <name>webapp</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>webapp</name><operator>/</operator><literal type="number">404.html</literal>               <operator>|</operator>  <literal type="number">31</literal> <operator>++</operator>
 <literal type="number">37</literal> <name>files</name> <name>changed</name></expr><operator>,</operator> <expr><literal type="number">2712</literal> <call><name>insertions</name><argument_list>(<argument><expr><operator>+</operator></expr></argument>)</argument_list></call></expr><operator>,</operator> <expr><literal type="number">257</literal> <call><name>deletions</name><argument_list>(<argument><expr><operator>-</operator></expr></argument>)</argument_list></call>
 <name>create</name> <name>mode</name> <literal type="number">100644</literal> <name>distro</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>bin</name><operator>/</operator><name>oozie</name><operator>-</operator><name>jetty</name><operator>-</operator><name><name>server</name><operator>.</operator><name>sh</name></name>
 <name>create</name> <name>mode</name> <literal type="number">100644</literal> <name>distro</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>bin</name><operator>/</operator><name>oozie</name><operator>-</operator><name>tomcat</name><operator>-</operator><name><name>server</name><operator>.</operator><name>sh</name></name>
 <name>create</name> <name>mode</name> <literal type="number">100644</literal> <name>server</name><operator>/</operator><name><name>pom</name><operator>.</operator><name>xml</name></name>
 <name>create</name> <name>mode</name> <literal type="number">100644</literal> <name>server</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>assemblies</name><operator>/</operator><name><name>empty</name><operator>.</operator><name>xml</name></name>
 <name>create</name> <name>mode</name> <literal type="number">100644</literal> <name>server</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>server</name><operator>/</operator><name><name>EmbeddedOozieServer</name><operator>.</operator><name>java</name></name>
 <name>create</name> <name>mode</name> <literal type="number">100644</literal> <name>server</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>server</name><operator>/</operator><name><name>FilterMapper</name><operator>.</operator><name>java</name></name>
 <name>create</name> <name>mode</name> <literal type="number">100644</literal> <name>server</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>server</name><operator>/</operator><name><name>HttpConfigurationWrapper</name><operator>.</operator><name>java</name></name>
 <name>create</name> <name>mode</name> <literal type="number">100644</literal> <name>server</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>server</name><operator>/</operator><name><name>JspHandler</name><operator>.</operator><name>java</name></name>
 <name>create</name> <name>mode</name> <literal type="number">100644</literal> <name>server</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>server</name><operator>/</operator><name><name>SSLServerConnectorFactory</name><operator>.</operator><name>java</name></name>
 <name>create</name> <name>mode</name> <literal type="number">100644</literal> <name>server</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>server</name><operator>/</operator><name><name>ServletMapper</name><operator>.</operator><name>java</name></name>
 <name>create</name> <name>mode</name> <literal type="number">100644</literal> <name>server</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>server</name><operator>/</operator><name><name>WebRootResourceLocator</name><operator>.</operator><name>java</name></name>
 <name>create</name> <name>mode</name> <literal type="number">100644</literal> <name>server</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>server</name><operator>/</operator><name>guice</name><operator>/</operator><name><name>ConstraintSecurityHandlerProvider</name><operator>.</operator><name>java</name></name>
 <name>create</name> <name>mode</name> <literal type="number">100644</literal> <name>server</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>server</name><operator>/</operator><name>guice</name><operator>/</operator><name><name>JettyServerProvider</name><operator>.</operator><name>java</name></name>
 <name>create</name> <name>mode</name> <literal type="number">100644</literal> <name>server</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>server</name><operator>/</operator><name>guice</name><operator>/</operator><name><name>JspHandlerProvider</name><operator>.</operator><name>java</name></name>
 <name>create</name> <name>mode</name> <literal type="number">100644</literal> <name>server</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>server</name><operator>/</operator><name>guice</name><operator>/</operator><name><name>OozieGuiceModule</name><operator>.</operator><name>java</name></name>
 <name>create</name> <name>mode</name> <literal type="number">100644</literal> <name>server</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>server</name><operator>/</operator><name>guice</name><operator>/</operator><name><name>RewriteHandlerProvider</name><operator>.</operator><name>java</name></name>
 <name>create</name> <name>mode</name> <literal type="number">100644</literal> <name>server</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>server</name><operator>/</operator><name>guice</name><operator>/</operator><name><name>ServicesProvider</name><operator>.</operator><name>java</name></name>
 <name>create</name> <name>mode</name> <literal type="number">100644</literal> <name>server</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>resources</name><operator>/</operator><name>checkstyle</name><operator>-</operator><name><name>header</name><operator>.</operator><name>txt</name></name>
 <name>create</name> <name>mode</name> <literal type="number">100644</literal> <name>server</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>resources</name><operator>/</operator><name><name>checkstyle</name><operator>.</operator><name>xml</name></name>
 <name>create</name> <name>mode</name> <literal type="number">100644</literal> <name>server</name><operator>/</operator><name>src</name><operator>/</operator><name>test</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>server</name><operator>/</operator><name><name>TestEmbeddedOozieServer</name><operator>.</operator><name>java</name></name>
 <name>create</name> <name>mode</name> <literal type="number">100644</literal> <name>server</name><operator>/</operator><name>src</name><operator>/</operator><name>test</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>server</name><operator>/</operator><name><name>TestJspHandler</name><operator>.</operator><name>java</name></name>
 <name>create</name> <name>mode</name> <literal type="number">100644</literal> <name>server</name><operator>/</operator><name>src</name><operator>/</operator><name>test</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>server</name><operator>/</operator><name><name>TestSSLServerConnectorFactory</name><operator>.</operator><name>java</name></name>
 <name>create</name> <name>mode</name> <literal type="number">100644</literal> <name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>assemblies</name><operator>/</operator><name>distro</name><operator>-</operator><name><name>jetty</name><operator>.</operator><name>xml</name></name>
 <name>rename</name> <name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>assemblies</name><operator>/</operator><block>{<expr><name><name>distro</name><operator>.</operator><name>xml</name></name> <operator>=</operator><operator>&gt;</operator> <name>distro</name><operator>-</operator><name><name>tomcat</name><operator>.</operator><name>xml</name></name></expr>}</block> <operator>(</operator><literal type="number">98</literal><operator>%</operator><operator>)</operator>
 <name>create</name> <name>mode</name> <literal type="number">100644</literal> <name>webapp</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>webapp</name><operator>/</operator><literal type="number">403.html</literal>
 <name>create</name> <name>mode</name> <literal type="number">100644</literal> <name>webapp</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>webapp</name><operator>/</operator><literal type="number">404.html</literal>

<name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>bin</name><operator>/</operator><name><name>mkdistro</name><operator>.</operator><name>sh</name></name> <name>b</name><operator>/</operator><name>bin</name><operator>/</operator><name><name>mkdistro</name><operator>.</operator><name>sh</name></name>
<name>index</name> <literal type="number">1ccd495bd</literal><operator>..</operator><name>e0cff3615</name> <literal type="number">100755</literal>
<operator>--</operator> <name>a</name><operator>/</operator><name>bin</name><operator>/</operator><name><name>mkdistro</name><operator>.</operator><name>sh</name></name>
<operator>++</operator> <name>b</name><operator>/</operator><name>bin</name><operator>/</operator><name><name>mkdistro</name><operator>.</operator><name>sh</name></name>
@@ <operator>-</operator><literal type="number">70</literal></expr><operator>,</operator><expr><literal type="number">7</literal> <operator>+</operator><literal type="number">70</literal></expr><operator>,</operator><expr><literal type="number">7</literal> @@ <name>MVN_OPTS</name><operator>=</operator><literal type="string">"-Dbuild.time=${DATETIME} -Dvc.revision=${VC_REV} -Dvc.url=${VC_URL} -D
 export DATETIME2=`date -u "</literal><operator>+</operator><operator>%</operator><name>Y</name><operator>%</operator><name>m</name><operator>%</operator><name>d</name><operator>-</operator><operator>%</operator><name>H</name><operator>%</operator><name>M</name><operator>%</operator><name>SGMT</name><literal type="string">"`
 mvn clean package assembly:single ${MVN_OPTS} "</literal><name>$</name>@<literal type="string">"
 
if [ "</literal><name>$</name><operator>?</operator><literal type="string">" != "</literal><literal type="number">0</literal><literal type="string">" ]; then
if [ "</literal><name>$</name><operator>?</operator><literal type="string">" -ne "</literal><literal type="number">0</literal><literal type="string">" ]; then
   echo
   echo "</literal><name>ERROR</name></expr><operator>,</operator> <expr><name>Oozie</name> <name>distro</name> <name>creation</name> <name>failed</name><literal type="string">"
   echo
diff --git a/core/src/main/conf/oozie-env.sh b/core/src/main/conf/oozie-env.sh
index 390c955c0..bc8c60180 100644
-- a/core/src/main/conf/oozie-env.sh
++ b/core/src/main/conf/oozie-env.sh
@@ -22,7 +22,9 @@
 # Settings for the Embedded Tomcat that runs Oozie
 # Java System properties for Oozie should be specified in this variable
 #
export CATALINA_OPTS="</literal><name>$CATALINA_OPTS</name> <operator>-</operator><name>Xmx1024m</name><literal type="string">"
if [ "</literal><name>$</name><block>{<expr><name>OOZIE_USE_TOMCAT</name></expr>}</block><literal type="string">" = "</literal><literal type="number">1</literal><literal type="string">" ]; then
  export CATALINA_OPTS="</literal><name>$CATALINA_OPTS</name> <operator>-</operator><name>Xmx1024m</name><literal type="string">"
fi
 
 # Oozie configuration file to load from Oozie configuration directory
 #
@@ -66,4 +68,4 @@ export CATALINA_OPTS="</literal><name>$CATALINA_OPTS</name> <operator>-</operator><name>Xmx1024m</name><literal type="string">"
 
 # The Oozie Instance ID
 #
# export OOZIE_INSTANCE_ID="</literal><name>$</name><block>{<expr><name>OOZIE_HTTP_HOSTNAME</name></expr>}</block><literal type="string">"
\ No newline at end of file
# export OOZIE_INSTANCE_ID="</literal><name>$</name><block>{<expr><name>OOZIE_HTTP_HOSTNAME</name></expr>}</block><literal type="string">"
diff --git a/core/src/main/java/org/apache/oozie/util/ConfigUtils.java b/core/src/main/java/org/apache/oozie/util/ConfigUtils.java
index a56c5a295..792723fd7 100644
-- a/core/src/main/java/org/apache/oozie/util/ConfigUtils.java
++ b/core/src/main/java/org/apache/oozie/util/ConfigUtils.java
@@ -28,6 +28,10 @@ import org.apache.oozie.servlet.ServicesLoader;
  */
 public class ConfigUtils {
     private final static XLog LOG = XLog.getLog(ConfigUtils.class);
    public static final String OOZIE_HTTPS_ENABLED = "</literal><name><name>oozie</name><operator>.</operator><name>https</name><operator>.</operator><name>enabled</name></name><literal type="string">";
    public static final String OOZIE_HTTP_HOSTNAME = "</literal><name><name>oozie</name><operator>.</operator><name>http</name><operator>.</operator><name>hostname</name></name><literal type="string">";
    public static final String OOZIE_HTTPS_PORT = "</literal><name><name>oozie</name><operator>.</operator><name>https</name><operator>.</operator><name>port</name></name><literal type="string">";
    public static final String OOZIE_HTTP_PORT = "</literal><name><name>oozie</name><operator>.</operator><name>http</name><operator>.</operator><name>port</name></name><literal type="string">";
 
     public static boolean BOOLEAN_DEFAULT = false;
     public static String STRING_DEFAULT = ""</literal></expr>;</expr_stmt>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">92</literal></expr><operator>,</operator><expr><literal type="number">13</literal> <operator>+</operator><literal type="number">96</literal></expr><operator>,</operator><expr><literal type="number">13</literal> @@ <specifier>public</specifier> <name>class</name> <name>ConfigUtils</name> <block>{
         <if_stmt><else>else <block>{<block_content>
             <expr_stmt><expr><call><name><name>sb</name><operator>.</operator><name>append</name></name><argument_list>(<argument><expr><literal type="string">"http://"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
         <expr_stmt/></block_content></block></else></if_stmt>}</block>
        <call><name><name>sb</name><operator>.</operator><name>append</name></name><argument_list>(<argument><expr><call><name><name>ConfigurationService</name><operator>.</operator><name>get</name></name><argument_list>(<argument><expr><literal type="string">"oozie.http.hostname"</literal></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>sb</name><operator>.</operator><name>append</name></name><argument_list>(<argument><expr><call><name><name>ConfigurationService</name><operator>.</operator><name>get</name></name><argument_list>(<argument><expr><name>OOZIE_HTTP_HOSTNAME</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
         <expr_stmt><expr><call><name><name>sb</name><operator>.</operator><name>append</name></name><argument_list>(<argument><expr><literal type="string">":"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
         <if_stmt><if>if <condition>(<expr><name>secure</name></expr>)</condition> <block>{<block_content>
            <expr_stmt><expr><call><name><name>sb</name><operator>.</operator><name>append</name></name><argument_list>(<argument><expr><call><name><name>ConfigurationService</name><operator>.</operator><name>get</name></name><argument_list>(<argument><expr><literal type="string">"oozie.https.port"</literal></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name><name>sb</name><operator>.</operator><name>append</name></name><argument_list>(<argument><expr><call><name><name>ConfigurationService</name><operator>.</operator><name>get</name></name><argument_list>(<argument><expr><name>OOZIE_HTTPS_PORT</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
         </block_content>}</block></if>
         <else>else <block>{<block_content>
            <expr_stmt><expr><call><name><name>sb</name><operator>.</operator><name>append</name></name><argument_list>(<argument><expr><call><name><name>ConfigurationService</name><operator>.</operator><name>get</name></name><argument_list>(<argument><expr><literal type="string">"oozie.http.port"</literal></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name><name>sb</name><operator>.</operator><name>append</name></name><argument_list>(<argument><expr><call><name><name>ConfigurationService</name><operator>.</operator><name>get</name></name><argument_list>(<argument><expr><name>OOZIE_HTTP_PORT</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
         </block_content>}</block></else></if_stmt>
         <expr_stmt><expr><call><name><name>sb</name><operator>.</operator><name>append</name></name><argument_list>(<argument><expr><literal type="string">"/oozie"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
         <return>return <expr><call><name><name>sb</name><operator>.</operator><name>toString</name></name><argument_list>()</argument_list></call></expr>;</return>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">110</literal></expr><operator>,</operator><expr><literal type="number">7</literal> <operator>+</operator><literal type="number">114</literal></expr><operator>,</operator><expr><literal type="number">7</literal> @@ <specifier>public</specifier> <name>class</name> <name>ConfigUtils</name> <block>{
      <expr><operator>*</operator> @</expr><return>return <expr><name>the</name> <name>HTTP</name> <name>or</name> <name>HTTPS</name> <name>URL</name></expr></return> <for>for this Oozie server
      */
     public static String getOozieEffectiveUrl<control>(<init><expr/></init>)</control> <block>{<block_content>
        <return>return <expr><call><name>getOozieURL</name><argument_list>(<argument><expr><call><name><name>ServicesLoader</name><operator>.</operator><name>isSSLEnabled</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</return>
        <return>return <expr><call><name>getOozieURL</name><argument_list>(<argument><expr><call><name><name>ServicesLoader</name><operator>.</operator><name>isSSLEnabled</name></name><argument_list>()</argument_list></call> <operator>||</operator> <call><name><name>ConfigurationService</name><operator>.</operator><name>getBoolean</name></name><argument_list>(<argument><expr><name>OOZIE_HTTPS_ENABLED</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</return>
     </block_content>}</block></for>
 
     <specifier>public</specifier> <specifier>static</specifier> <name>boolean</name> <call><name>isBackwardSupportForCoordStatus</name><argument_list>()</argument_list></call> <block>{
<expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>util</name><operator>/</operator><name><name>Instrumentation</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>util</name><operator>/</operator><name><name>Instrumentation</name><operator>.</operator><name>java</name></name>
<name>index</name> <literal type="number">99d64acec</literal><operator>..</operator><literal type="number">55e00d4df</literal> <literal type="number">100644</literal>
<operator>--</operator> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>util</name><operator>/</operator><name><name>Instrumentation</name><operator>.</operator><name>java</name></name>
<operator>++</operator> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>util</name><operator>/</operator><name><name>Instrumentation</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">784</literal></expr>,<expr><literal type="number">9</literal> <operator>+</operator><literal type="number">784</literal></expr>,<expr><literal type="number">11</literal> @@ <specifier>public</specifier> <name>class</name> <name>Instrumentation</name> <block>{
             <if_stmt><if>if <condition>(<expr><call><name><name>map</name><operator>.</operator><name>containsKey</name></name><argument_list>(<argument><expr><name>name</name></expr></argument>)</argument_list></call></expr>)</condition> <block>{<block_content>
                 <throw>throw <expr><operator>new</operator> <call><name>RuntimeException</name><argument_list>(<argument><expr><call><name><name>XLog</name><operator>.</operator><name>format</name></name><argument_list>(<argument><expr><literal type="string">"Sampler group=[{0}] name=[{1}] already defined"</literal></expr></argument>, <argument><expr><name>group</name></expr></argument>, <argument><expr><name>name</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</throw>
             <expr_stmt/></block_content></block></if></if_stmt>}</block>
            <name>Sampler</name> <name>sampler</name> <operator>=</operator> <operator>new</operator> <call><name>Sampler</name><argument_list>(<argument><expr><name>period</name></expr></argument>, <argument><expr><name>interval</name></expr></argument>, <argument><expr><name>variable</name></expr></argument>)</argument_list></call></expr>;
            <expr><call><name><name>map</name><operator>.</operator><name>put</name></name><argument_list>(<argument><expr><name>name</name></expr></argument>, <argument><expr><name>sampler</name></expr></argument>)</argument_list></call></expr>;
            <expr><call><name><name>scheduler</name><operator>.</operator><name>scheduleAtFixedRate</name></name><argument_list>(<argument><expr><name>sampler</name></expr></argument>, <argument><expr><literal type="number">0</literal></expr></argument>, <argument><expr><call><name><name>sampler</name><operator>.</operator><name>getSamplingInterval</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><name><name>TimeUnit</name><operator>.</operator><name>SECONDS</name></name></expr></argument>)</argument_list></call></expr>;
            <if_stmt><else>else <block>{<block_content>
                <decl_stmt><decl><type><name>Sampler</name></type> <name>sampler</name> <init>= <expr><operator>new</operator> <call><name>Sampler</name><argument_list>(<argument><expr><name>period</name></expr></argument>, <argument><expr><name>interval</name></expr></argument>, <argument><expr><name>variable</name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
                <expr_stmt><expr><call><name><name>map</name><operator>.</operator><name>put</name></name><argument_list>(<argument><expr><name>name</name></expr></argument>, <argument><expr><name>sampler</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                <expr_stmt><expr><call><name><name>scheduler</name><operator>.</operator><name>scheduleAtFixedRate</name></name><argument_list>(<argument><expr><name>sampler</name></expr></argument>, <argument><expr><literal type="number">0</literal></expr></argument>, <argument><expr><call><name><name>sampler</name><operator>.</operator><name>getSamplingInterval</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><name><name>TimeUnit</name><operator>.</operator><name>SECONDS</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt/></block_content></block></else></if_stmt>}</block></block></expr></expr_stmt>
         }
         finally <block>{<block_content>
             <expr_stmt><expr><call><name><name>samplerLock</name><operator>.</operator><name>unlock</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
<expr_stmt><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>resources</name><operator>/</operator><name>oozie</name><operator>-</operator>default<operator>.</operator><name>xml</name> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>resources</name><operator>/</operator><name>oozie</name><operator>-</operator>default<operator>.</operator><name>xml</name>
<name>index</name> <name>e71ebe3b7</name><operator>..</operator><literal type="number">856564338</literal> <literal type="number">100644</literal>
<operator>--</operator> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>resources</name><operator>/</operator><name>oozie</name><operator>-</operator>default<operator>.</operator><name>xml</name>
<operator>++</operator> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>resources</name><operator>/</operator><name>oozie</name><operator>-</operator>default<operator>.</operator><name>xml</name>
@@ <operator>-</operator><literal type="number">2488</literal></expr><operator>,</operator><expr><literal type="number">9</literal> <operator>+</operator><literal type="number">2488</literal></expr><operator>,</operator><expr><literal type="number">10</literal> @@ <name>will</name> <name>be</name> <name>the</name> <name>requeue</name> <name>interval</name></expr></expr_stmt> <for>for the actions which are waiting for a long time w
 
     &lt;property&gt;
         &lt;name&gt;oozie.http.hostname&lt;/name&gt;
        &lt;value&gt;localhost&lt;/value&gt;
        &lt;value&gt;0.0.0.0&lt;/value&gt;
         &lt;description&gt;
            Oozie server host name.
            Oozie server host name. The network interface Oozie server binds to as an IP address or a hostname.
            Most users won't need to change this setting from the default value.
         &lt;/description&gt;
     &lt;/property&gt;
 
@@ -2502,6 +2503,22 @@ will be the requeue interval for the actions which are waiting for a long time w
         &lt;/description&gt;
     &lt;/property&gt;
 
    &lt;property&gt;
        &lt;name&gt;oozie.http.request.header.size&lt;/name&gt;
        &lt;value&gt;65536&lt;/value&gt;
        &lt;description&gt;
            Oozie HTTP request header size.
        &lt;/description&gt;
    &lt;/property&gt;

    &lt;property&gt;
        &lt;name&gt;oozie.http.response.header.size&lt;/name&gt;
        &lt;value&gt;65536&lt;/value&gt;
        &lt;description&gt;
            Oozie HTTP response header size.
        &lt;/description&gt;
    &lt;/property&gt;

     &lt;property&gt;
         &lt;name&gt;oozie.https.port&lt;/name&gt;
         &lt;value&gt;11443&lt;/value&gt;
@@ -2510,6 +2527,70 @@ will be the requeue interval for the actions which are waiting for a long time w
         &lt;/description&gt;
     &lt;/property&gt;
 
    &lt;property&gt;
        &lt;name&gt;oozie.https.enabled&lt;/name&gt;
        &lt;value&gt;false&lt;/value&gt;
        &lt;description&gt;
            Controls whether SSL encryption is enabled.
        &lt;/description&gt;
    &lt;/property&gt;

    &lt;property&gt;
        &lt;name&gt;oozie.https.truststore.file&lt;/name&gt;
        &lt;value&gt;custom.truststore&lt;/value&gt;
        &lt;description&gt;
            Path to a TrustStore file.
        &lt;/description&gt;
    &lt;/property&gt;

    &lt;property&gt;
        &lt;name&gt;oozie.https.truststore.pass&lt;/name&gt;
        &lt;value&gt;cloudera&lt;/value&gt;
        &lt;description&gt;
            Password to the TrustStore.
        &lt;/description&gt;
    &lt;/property&gt;

    &lt;property&gt;
        &lt;name&gt;oozie.https.keystore.file&lt;/name&gt;
        &lt;value&gt;&lt;/value&gt;
        &lt;description&gt;
            Path to a KeyStore file.
        &lt;/description&gt;
    &lt;/property&gt;

    &lt;property&gt;
        &lt;name&gt;oozie.https.keystore.pass&lt;/name&gt;
        &lt;value&gt;&lt;/value&gt;
        &lt;description&gt;
            Password to the KeyStore.
        &lt;/description&gt;
    &lt;/property&gt;

    &lt;property&gt;
        &lt;name&gt;oozie.https.include.protocols&lt;/name&gt;
        &lt;value&gt;TLSv1,SSLv2Hello,TLSv1.1,TLSv1.2&lt;/value&gt;
        &lt;description&gt;
            Enabled TLS protocols.
        &lt;/description&gt;
    &lt;/property&gt;

    &lt;property&gt;
        &lt;name&gt;oozie.https.exclude.cipher.suites&lt;/name&gt;
        &lt;value&gt;TLS_ECDHE_RSA_WITH_RC4_128_SHA,SSL_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA,SSL_RSA_WITH_DES_CBC_SHA,SSL_DHE_RSA_WITH_DES_CBC_SHA,SSL_RSA_EXPORT_WITH_RC4_40_MD5,SSL_RSA_EXPORT_WITH_DES40_CBC_SHA,SSL_RSA_WITH_RC4_128_MD5&lt;/value&gt;
        &lt;description&gt;
            List of weak Cipher suites to exclude.
        &lt;/description&gt;
    &lt;/property&gt;

    &lt;property&gt;
        &lt;name&gt;oozie.jsp.tmp.dir&lt;/name&gt;
        &lt;value&gt;/tmp&lt;/value&gt;
        &lt;description&gt;
            Temporary directory for compiling JSP pages.
        &lt;/description&gt;
    &lt;/property&gt;

     &lt;property&gt;
         &lt;name&gt;oozie.instance.id&lt;/name&gt;
         &lt;value&gt;${oozie.http.hostname}&lt;/value&gt;
@@ -2519,6 +2600,14 @@ will be the requeue interval for the actions which are waiting for a long time w
         &lt;/description&gt;
     &lt;/property&gt;
 
    &lt;property&gt;
        &lt;name&gt;oozie.server.threadpool.max.threads&lt;/name&gt;
        &lt;value&gt;150&lt;/value&gt;
        &lt;description&gt;
             Controls the threadpool size for the Oozie Server (both Jetty and Tomcat)
        &lt;/description&gt;
    &lt;/property&gt;

     &lt;!-- Sharelib Configuration --&gt;
     &lt;property&gt;
         &lt;name&gt;oozie.service.ShareLibService.mapping.file&lt;/name&gt;
diff --git a/distro/pom.xml b/distro/pom.xml
index def006922..ce5319f4d 100644
-- a/distro/pom.xml
++ b/distro/pom.xml
@@ -31,6 +31,10 @@
     &lt;name&gt;Apache Oozie Distro&lt;/name&gt;
     &lt;packaging&gt;jar&lt;/packaging&gt;
 
    &lt;properties&gt;
        &lt;distro.descriptor&gt;../src/main/assemblies/distro-jetty.xml&lt;/distro.descriptor&gt;
    &lt;/properties&gt;

     &lt;dependencies&gt;
         &lt;dependency&gt;
             &lt;groupId&gt;org.apache.oozie&lt;/groupId&gt;
@@ -54,7 +58,6 @@
             &lt;scope&gt;compile&lt;/scope&gt;
         &lt;/dependency&gt;
     &lt;/dependencies&gt;

     &lt;build&gt;
         &lt;plugins&gt;
             &lt;plugin&gt;
@@ -74,49 +77,11 @@
                 &lt;configuration&gt;
                     &lt;finalName&gt;oozie-${project.version}&lt;/finalName&gt;
                     &lt;descriptors&gt;
                        &lt;descriptor&gt;../src/main/assemblies/distro.xml&lt;/descriptor&gt;
                        &lt;descriptor&gt;${distro.descriptor}&lt;/descriptor&gt;
                     &lt;/descriptors&gt;
                 &lt;/configuration&gt;
             &lt;/plugin&gt;
            &lt;!-- Downloading Tomcat TAR.GZ, using downloads/ dir to avoid downloading over an over --&gt;
            &lt;plugin&gt;
                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
                &lt;artifactId&gt;maven-antrun-plugin&lt;/artifactId&gt;
                &lt;executions&gt;
                    &lt;execution&gt;
                        &lt;configuration&gt;
                            &lt;target&gt;
                                &lt;mkdir dir="downloads"/&gt;
                                &lt;get src="http://archive.apache.org/dist/tomcat/tomcat-6/v${tomcat.version}/bin/apache-tomcat-${tomcat.version}.tar.gz"
                                     dest="downloads/tomcat-${tomcat.version}.tar.gz" verbose="true" skipexisting="true"/&gt;
                                &lt;delete dir="target/tomcat"/&gt;
                                &lt;mkdir dir="target/tomcat"/&gt;
                                &lt;gunzip src="downloads/tomcat-${tomcat.version}.tar.gz"
                                        dest="target/tomcat/tomcat-${tomcat.version}.tar"/&gt;
                                &lt;untar src="target/tomcat/tomcat-${tomcat.version}.tar" dest="target/tomcat"/&gt;
                                &lt;move file="target/tomcat/apache-tomcat-${tomcat.version}" tofile="target/tomcat/oozie-server"/&gt;
                                &lt;delete dir="target/tomcat/oozie-server/webapps"/&gt;
                                &lt;mkdir dir="target/tomcat/oozie-server/webapps"/&gt;
                                &lt;delete file="target/tomcat/oozie-server/conf/server.xml"/&gt;
                                &lt;copy file="src/main/tomcat/server.xml" toDir="target/tomcat/oozie-server/conf"/&gt;
                                &lt;copy file="src/main/tomcat/logging.properties"
                                      toDir="target/tomcat/oozie-server/conf"/&gt;
                                &lt;mkdir dir="target/tomcat/oozie-server/conf/ssl"/&gt;
                                &lt;copy file="src/main/tomcat/server.xml" toDir="target/tomcat/oozie-server/conf/ssl"/&gt;
                                &lt;copy file="src/main/tomcat/ssl-server.xml" toDir="target/tomcat/oozie-server/conf/ssl"/&gt;
                                &lt;copy file="src/main/tomcat/ssl-web.xml" toDir="target/tomcat/oozie-server/conf/ssl"/&gt;
                                &lt;copy todir="target/tomcat/oozie-server/webapps/ROOT"&gt;
                                    &lt;fileset dir="src/main/tomcat/ROOT"/&gt;
                                &lt;/copy&gt;
                            &lt;/target&gt;
                        &lt;/configuration&gt;
                        &lt;goals&gt;
                            &lt;goal&gt;run&lt;/goal&gt;
                        &lt;/goals&gt;
                        &lt;phase&gt;package&lt;/phase&gt;
                    &lt;/execution&gt;
                &lt;/executions&gt;
            &lt;/plugin&gt;

             &lt;plugin&gt;
                 &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
                 &lt;artifactId&gt;maven-deploy-plugin&lt;/artifactId&gt;
@@ -143,6 +108,56 @@
                 &lt;/dependency&gt;
              &lt;/dependencies&gt;
         &lt;/profile&gt;

        &lt;profile&gt;
            &lt;id&gt;tomcat&lt;/id&gt;
            &lt;properties&gt;
                &lt;distro.descriptor&gt;../src/main/assemblies/distro-tomcat.xml&lt;/distro.descriptor&gt;
            &lt;/properties&gt;
            &lt;build&gt;
                &lt;plugins&gt;
                    &lt;!-- Downloading Tomcat TAR.GZ, using downloads/ dir to avoid downloading over an over --&gt;
                    &lt;plugin&gt;
                        &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
                        &lt;artifactId&gt;maven-antrun-plugin&lt;/artifactId&gt;
                        &lt;version&gt;1.6&lt;/version&gt;
                        &lt;executions&gt;
                            &lt;execution&gt;
                                &lt;configuration&gt;
                                    &lt;target&gt;
                                        &lt;mkdir dir="downloads"/&gt;
                                        &lt;get src="http://archive.apache.org/dist/tomcat/tomcat-6/v${tomcat.version}/bin/apache-tomcat-${tomcat.version}.tar.gz"
                                             dest="downloads/tomcat-${tomcat.version}.tar.gz" verbose="true" skipexisting="true"/&gt;
                                        &lt;delete dir="target/tomcat"/&gt;
                                        &lt;mkdir dir="target/tomcat"/&gt;
                                        &lt;gunzip src="downloads/tomcat-${tomcat.version}.tar.gz"
                                                dest="target/tomcat/tomcat-${tomcat.version}.tar"/&gt;
                                        &lt;untar src="target/tomcat/tomcat-${tomcat.version}.tar" dest="target/tomcat"/&gt;
                                        &lt;move file="target/tomcat/apache-tomcat-${tomcat.version}" tofile="target/tomcat/oozie-server"/&gt;
                                        &lt;delete dir="target/tomcat/oozie-server/webapps"/&gt;
                                        &lt;mkdir dir="target/tomcat/oozie-server/webapps"/&gt;
                                        &lt;delete file="target/tomcat/oozie-server/conf/server.xml"/&gt;
                                        &lt;copy file="src/main/tomcat/server.xml" toDir="target/tomcat/oozie-server/conf"/&gt;
                                        &lt;copy file="src/main/tomcat/logging.properties"
                                              toDir="target/tomcat/oozie-server/conf"/&gt;
                                        &lt;mkdir dir="target/tomcat/oozie-server/conf/ssl"/&gt;
                                        &lt;copy file="src/main/tomcat/server.xml" toDir="target/tomcat/oozie-server/conf/ssl"/&gt;
                                        &lt;copy file="src/main/tomcat/ssl-server.xml" toDir="target/tomcat/oozie-server/conf/ssl"/&gt;
                                        &lt;copy file="src/main/tomcat/ssl-web.xml" toDir="target/tomcat/oozie-server/conf/ssl"/&gt;
                                        &lt;copy todir="target/tomcat/oozie-server/webapps/ROOT"&gt;
                                            &lt;fileset dir="src/main/tomcat/ROOT"/&gt;
                                        &lt;/copy&gt;
                                    &lt;/target&gt;
                                &lt;/configuration&gt;
                                &lt;goals&gt;
                                    &lt;goal&gt;run&lt;/goal&gt;
                                &lt;/goals&gt;
                                &lt;phase&gt;package&lt;/phase&gt;
                            &lt;/execution&gt;
                        &lt;/executions&gt;
                    &lt;/plugin&gt;
                &lt;/plugins&gt;
            &lt;/build&gt;
        &lt;/profile&gt;
     &lt;/profiles&gt;
 &lt;/project&gt;

diff --git a/distro/src/main/bin/oozie-jetty-server.sh b/distro/src/main/bin/oozie-jetty-server.sh
new file mode 100644
index 000000000..8acfc2ec2
-- /dev/null
++ b/distro/src/main/bin/oozie-jetty-server.sh
@@ -0,0 +1,226 @@
#!/bin/bash
#
# Licensed to the Apache Software Foundation (ASF) under one
# or more contributor license agreements.  See the NOTICE file
# distributed with this work for additional information
# regarding copyright ownership.  The ASF licenses this file
# to you under the Apache License, Version 2.0 (the
# "License"); you may not use this file except in compliance
# with the License.  You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.


# Set Jetty related environment variables
setup_jetty_log_and_pid() {
  if [ "${JETTY_OUT}" = "" ]; then
    export JETTY_OUT=${OOZIE_LOG}/jetty.out
    print "Setting JETTY_OUT:        ${JETTY_OUT}"
  else
    print "Using   JETTY_OUT:        ${JETTY_OUT}"
  fi

  if [ "${JETTY_PID_FILE}" = "" ]; then
    export JETTY_PID_FILE=${JETTY_DIR}/oozie.pid
    print "Setting JETTY_PID_FILE:        ${JETTY_PID_FILE}"
  else
    print "Using   JETTY_PID_FILE:        ${JETTY_PID_FILE}"
  fi
}

setup_java_opts() {
  if [ -z "${JAVA_HOME}" -a -z "${JRE_HOME}" ]; then
    if ${darwin}; then
      if [ -x '/usr/libexec/java_home' ] ; then
        export JAVA_HOME=`/usr/libexec/java_home`
      elif [ -d "/System/Library/Frameworks/JavaVM.framework/Versions/CurrentJDK/Home" ]; then
        export JAVA_HOME="/System/Library/Frameworks/JavaVM.framework/Versions/CurrentJDK/Home"
      fi
    else
      JAVA_PATH=`which java 2&gt;/dev/null`
      if [ "x${JAVA_PATH}" != "x" ]; then
        JAVA_PATH=`dirname ${JAVA_PATH} 2&gt;/dev/null`
      fi
      if [ "x${JRE_HOME}" = "x" ]; then
        if [ -x /usr/bin/java ]; then
          JRE_HOME=/usr
        fi
      fi
    fi
    if [ -z "${JAVA_HOME}" -a -z "${JRE_HOME}" ]; then
      echo "Neither the JAVA_HOME nor the JRE_HOME environment variable is defined"
      echo "At least one of these environment variable is needed to run this program"
      exit 1
    fi
  fi
  if [ -z "${JRE_HOME}" ]; then
    JRE_HOME="${JAVA_HOME}"
  fi

  JAVA_BIN="${JRE_HOME}"/bin/java
  echo "Using Java executable from ${JRE_HOME}"
}

setup_jetty_opts() {
  echo "Using   JETTY_OPTS:       ${JETTY_OPTS}"
  jetty_opts="-Doozie.home.dir=${OOZIE_HOME}";
  jetty_opts="${jetty_opts} -Doozie.config.dir=${OOZIE_CONFIG}";
  jetty_opts="${jetty_opts} -Doozie.log.dir=${OOZIE_LOG}";
  jetty_opts="${jetty_opts} -Doozie.data.dir=${OOZIE_DATA}";
  jetty_opts="${jetty_opts} -Doozie.config.file=${OOZIE_CONFIG_FILE}";
  jetty_opts="${jetty_opts} -Doozie.log4j.file=${OOZIE_LOG4J_FILE}";
  jetty_opts="${jetty_opts} -Doozie.log4j.reload=${OOZIE_LOG4J_RELOAD}";
  # add required native libraries such as compression codecs
  jetty_opts="${jetty_opts} -Djava.library.path=${JAVA_LIBRARY_PATH}";

  jetty_opts="${jetty_opts} -cp ${JETTY_DIR}/*:${JETTY_DIR}/dependency/*:${BASEDIR}/lib/*:${BASEDIR}/libtools/*:${JETTY_DIR}"
  echo "Adding to JETTY_OPTS:     ${jetty_opts}"

  export JETTY_OPTS="${JETTY_OPTS} ${jetty_opts}"
}

start_jetty() {
  if [ ! -z "${JETTY_PID_FILE}" ]; then
    if [ -f "${JETTY_PID_FILE}" ]; then
      if [ -s "${JETTY_PID_FILE}" ]; then
        echo "Existing PID file found during start."
        if [ -r "${JETTY_PID_FILE}" ]; then
          PID=$(cat "${JETTY_PID_FILE}")
          ps -p "$PID" &gt;/dev/null 2&gt;&amp;1
          if [ $? -eq 0 ] ; then
            echo "Oozie server appears to still be running with PID $PID. Start aborted."
            echo "If the following process is not a Jetty process, remove the PID file and try again:"
            ps -f -p "$PID"
            exit 1
          else
            echo "Removing/clearing stale PID file."
            rm -f "${JETTY_PID_FILE}" &gt;/dev/null 2&gt;&amp;1
            if [ $? != 0 ]; then
              if [ -w "${JETTY_PID_FILE}" ]; then
                cat /dev/null &gt; "${JETTY_PID_FILE}"
              else
                echo "Unable to remove or clear stale PID file. Start aborted."
                exit 1
              fi
            fi
          fi
        else
          echo "Unable to read PID file. Start aborted."
          exit 1
        fi
      else
        rm -f "$JETTY_PID_FILE" &gt;/dev/null 2&gt;&amp;1
        if [ $? != 0 ]; then
          if [ ! -w "$JETTY_PID_FILE" ]; then
            echo "Unable to remove or write to empty PID file. Start aborted."
            exit 1
          fi
        fi
      fi
    fi
  fi

  ${JAVA_BIN} ${JETTY_OPTS} org.apache.oozie.server.EmbeddedOozieServer &gt;&gt; "${JETTY_OUT}" 2&gt;&amp;1 &amp;
  PID=$!
  if [ ${PID} ]; then
    echo -n "Oozie server started"
  fi

  if [ ! -z "${JETTY_PID_FILE}" ]; then
    echo -n $! &gt; "${JETTY_PID_FILE}"
    echo -n " - PID: ${PID}."
  fi
  echo
}

run_jetty() {
  ${JAVA_BIN} ${JETTY_OPTS} org.apache.oozie.server.EmbeddedOozieServer
}

#TODO allow users to force kill jetty. Add --force
stop_jetty() {
  if [ ! -z "${JETTY_PID_FILE}" ]; then
    if [ -f "${JETTY_PID_FILE}" ]; then
      if [ -s "${JETTY_PID_FILE}" ]; then
        kill -0 "$(cat "${JETTY_PID_FILE}")" &gt;/dev/null 2&gt;&amp;1
        if [ $? -gt 0 ]; then
          echo "PID file found but no matching process was found. Stop aborted."
          exit 1
        fi
      else
        echo "PID file is empty and has been ignored."
      fi
    else
      echo "\$JETTY_PID_FILE was set but the specified file does not exist. Is Oozie server running? Stop aborted."
      exit 1
    fi
  fi

  kill "$(cat "${JETTY_PID_FILE}")"

  RETRY_COUNT=5

  if [ ! -z "${JETTY_PID_FILE}" ]; then
    if [ -f "${JETTY_PID_FILE}" ]; then
      while [ $RETRY_COUNT -ge 0 ]; do
        kill -0 "$(cat ${JETTY_PID_FILE})" &gt;/dev/null 2&gt;&amp;1
        if [ $? -gt 0 ]; then
          rm -f "${JETTY_PID_FILE}" &gt;/dev/null 2&gt;&amp;1
          if [ $? != 0 ]; then
            if [ -w "${JETTY_PID_FILE}" ]; then
              cat /dev/null &gt; "${JETTY_PID_FILE}"
            else
              echo "Oozie server stopped but the PID file could not be removed or cleared."
            fi
          fi
          break
        fi
        if [ ${RETRY_COUNT} -gt 0 ]; then
          sleep 1
        fi
        if [ ${RETRY_COUNT} -eq 0 ]; then
          echo "Oozie server did not stop in time. PID file was not removed."
        fi
        RETRY_COUNT=$((RETRY_COUNT - 1))
      done
    fi
  fi
}

symlink_lib() {
  test -e ${BASEDIR}/lib || ln -s ${JETTY_DIR}/webapp/WEB-INF/lib ${BASEDIR}/lib
}

jetty_main() {
  source ${BASEDIR}/bin/oozie-sys.sh
  JETTY_DIR=${BASEDIR}/embedded-oozie-server

  setup_jetty_log_and_pid
  setup_java_opts
  setup_jetty_opts

  actionCmd=$1
  case $actionCmd in
    (run)
       ${BASEDIR}/bin/oozie-setup.sh
       symlink_lib
       setup_ooziedb
       run_jetty
      ;;
    (start)
       ${BASEDIR}/bin/oozie-setup.sh
       symlink_lib
       setup_ooziedb
       start_jetty
      ;;
    (stop)
      stop_jetty
      ;;
  esac
}
diff --git a/distro/src/main/bin/oozie-setup.sh b/distro/src/main/bin/oozie-setup.sh
index 79b049bcc..9d6a2d0c9 100644
-- a/distro/src/main/bin/oozie-setup.sh
++ b/distro/src/main/bin/oozie-setup.sh
@@ -74,9 +74,7 @@ function checkExec() {
   then
     echo
     echo "Failed: $1"
    echo
    cleanUp
    exit -1;
    cleanup_and_exit
   fi
 }
 
@@ -85,9 +83,7 @@ function checkFileExists() {
   if [ ! -e ${1} ]; then
     echo
     echo "File/Dir does no exist: ${1}"
    echo
    cleanUp
    exit -1
    cleanup_and_exit
   fi
 }
 
@@ -96,9 +92,7 @@ function checkFileDoesNotExist() {
   if [ -e ${1} ]; then
     echo
     echo "File/Dir already exists: ${1}"
    echo
    cleanUp
    exit -1
    cleanup_and_exit
   fi
 }
 
@@ -119,6 +113,10 @@ done
 BASEDIR=`dirname ${PRG}`
 BASEDIR=`cd ${BASEDIR}/..;pwd`
 
JETTY_DIR=${BASEDIR}/embedded-oozie-server
JETTY_WEBAPP_DIR=${JETTY_DIR}/webapp
JETTY_LIB_DIR=${JETTY_WEBAPP_DIR}/WEB-INF/lib/

 source ${BASEDIR}/bin/oozie-sys.sh -silent
 
 addExtjs=""
@@ -145,10 +143,16 @@ do
     #Create lib directory from war if lib doesn't exist
     if [ ! -d "${BASEDIR}/lib" ]<empty_stmt>;</empty_stmt></for> <decl_stmt><decl><type><name>then</name>
       <name>mkdir</name></type> <name>$</name><block>{<block_content><expr><name>BASEDIR</name></expr></block_content>}</block></decl></decl_stmt><expr_stmt><expr><operator>/</operator><name>lib</name>
      <name>unzip</name> <name>$</name><block>{<expr><name>BASEDIR</name></expr>}</block><operator>/</operator><name><name>oozie</name><operator>.</operator><name>war</name></name> <name>WEB</name><operator>-</operator><name>INF</name><operator>/</operator><name>lib</name></expr></expr_stmt><comment type="block">/*.jar -d ${BASEDIR}/lib &gt; /dev/null
      mv ${BASEDIR}/lib/WEB-INF/lib/*.jar ${BASEDIR}/lib/
      rmdir ${BASEDIR}/lib/WEB-INF/lib
      rmdir ${BASEDIR}/lib/WEB-INF

      if [ "${OOZIE_USE_TOMCAT}" = "1" ]; then
        unzip ${BASEDIR}/oozie.war WEB-INF/lib/*.jar -d ${BASEDIR}/lib &gt; /dev/null
        mv ${BASEDIR}/lib/WEB-INF/lib/*.jar ${BASEDIR}/lib/
        rmdir ${BASEDIR}/lib/WEB-INF/lib
        rmdir ${BASEDIR}/lib/WEB-INF
      else
        cp ${JETTY_LIB_DIR}/*  ${BASEDIR}/lib
      fi

     fi
 
     OOZIECPPATH=""
@@ -187,7 +191,7 @@ do
   shift
 done
 
if [ -e "${CATALINA_PID}" ]; then
if [ -e "${CATALINA_PID}" -a "${OOZIE_USE_TOMCAT}" = "1" ]; then
   echo
   echo "ERROR: Stop Oozie first"
   echo
@@ -196,19 +200,25 @@ fi
 
 echo
 
if [ "${prepareWar}" == "" ]; then
  echo "no arguments given"
  printUsage
  exit -1
else
  if [ -e "${outputWar}" ]; then
      chmod -f u+w ${outputWar}
      rm -rf ${outputWar}
  fi
  rm -rf ${outputWarExpanded}
 
  # Adding extension JARs
log_ready_to_start() {
  echo

  echo "INFO: Oozie is ready to be started"

  echo
}

check_extjs() {
  if [ "${addExtjs}" = "true" ]; then
    checkFileExists ${extjsHome}
  else
    echo "INFO: Oozie webconsole disabled, ExtJS library not specified"
  fi
}
 
# Check if it is necessary to add extension JARs and ExtJS
check_adding_extensions() {
   libext=${OOZIE_HOME}/libext
   if [ "${additionalDir}" != "" ]; then
     libext=${additionalDir}
@@ -227,114 +237,167 @@ else
       addExtjs=true
     fi
   fi
}
 
  prepare

  checkFileExists ${inputWar}
  checkFileDoesNotExist ${outputWar}
cleanup_and_exit() {
  echo
  cleanUp
  exit -1
}
 
  if [ "${addExtjs}" = "true" ]; then
    checkFileExists ${extjsHome}
  else
    echo "INFO: Oozie webconsole disabled, ExtJS library not specified"
prepare_jetty() {
  check_adding_extensions
  check_extjs

  if [ "${addExtjs}" = "true" -a ! -e ${JETTY_WEBAPP_DIR}/ext-2.2 ]; then
     unzip ${extjsHome} -d ${JETTY_WEBAPP_DIR}
    checkExec "Extracting ExtJS to ${JETTY_WEBAPP_DIR}/"
  elif [ "${addExtjs}" = "true" -a -e ${JETTY_WEBAPP_DIR}/ext-2.2 ]; then
     # TODO
    echo "${JETTY_WEBAPP_DIR}/ext-2.2 already exists"
    cleanup_and_exit
   fi
 
   if [ "${addJars}" = "true" ]; then
      for jarPath in ${jarsPath//:/$'\n'}
      do
        checkFileExists ${jarPath}
      done
    for jarPath in ${jarsPath//:/$'\n'}
    do
      found=`ls ${JETTY_LIB_DIR}/${jarPath} 2&gt; /dev/null | wc -l`
      checkExec "looking for JAR ${jarPath} in ${JETTY_LIB_DIR}"
      if [ ! $found = 0 ]; then
        echo
        echo "${JETTY_LIB_DIR} already contains JAR ${jarPath}"
        cleanup_and_exit
      fi
      cp ${jarPath} ${JETTY_LIB_DIR}
      checkExec "copying jar ${jarPath} to '${JETTY_LIB_DIR}'"
    done
   fi
}
 
  #Unpacking original war
  unzip ${inputWar} -d ${tmpWarDir} &gt; /dev/null
  checkExec "unzipping Oozie input WAR"
prepare_tomcat() {
  if [ "${prepareWar}" == "" ]; then
    echo "no arguments given"
    printUsage
    exit -1
  else
    if [ -e "${outputWar}" ]; then
        chmod -f u+w ${outputWar}
        rm -rf ${outputWar}
    fi
    rm -rf ${outputWarExpanded}
 
  components=""
    check_adding_extensions
 
  if [ "${secure}" != "" ]; then
    #Use the SSL version of server.xml in oozie-server
    checkFileExists ${secureConfigsDir}/ssl-server.xml
    cp ${secureConfigsDir}/ssl-server.xml ${CATALINA_BASE}/conf/server.xml
    #Inject the SSL version of web.xml in oozie war
    checkFileExists ${secureConfigsDir}/ssl-web.xml
    cp ${secureConfigsDir}/ssl-web.xml ${tmpWarDir}/WEB-INF/web.xml
    echo "INFO: Using secure server.xml and secure web.xml"
  else
    #Use the regular version of server.xml in oozie-server
    checkFileExists ${secureConfigsDir}/server.xml
    cp ${secureConfigsDir}/server.xml ${CATALINA_BASE}/conf/server.xml
    #No need to restore web.xml because its already in the original WAR file
  fi
    prepare
 
  if [ "${addExtjs}" = "true" ]; then
    if [ ! "${components}" = "" ];then
      components="${components}, "
    fi
    components="${components}ExtJS library"
    if [ -e ${tmpWarDir}/ext-2.2 ]; then
      echo
      echo "Specified Oozie WAR '${inputWar}' already contains ExtJS library files"
      echo
      cleanUp
      exit -1
    fi
    #If the extjs path given is a ZIP, expand it and use it from there
    if [ -f ${extjsHome} ]; then
      unzip ${extjsHome} -d ${tmpDir} &gt; /dev/null
      extjsHome=${tmpDir}/ext-2.2
    checkFileExists ${inputWar}
    checkFileDoesNotExist ${outputWar}

    check_extjs

    if [ "${addJars}" = "true" ]; then
        for jarPath in ${jarsPath//:/$'\n'}
        do
          checkFileExists ${jarPath}
        done
     fi
    #Inject the library in oozie war
    cp -r ${extjsHome} ${tmpWarDir}/ext-2.2
    checkExec "copying ExtJS files into staging"
  fi
 
  if [ "${addJars}" = "true" ]; then
    if [ ! "${components}" = "" ];then
      components="${components}, "
    #Unpacking original war
    unzip ${inputWar} -d ${tmpWarDir} &gt; /dev/null
    checkExec "unzipping Oozie input WAR"

    components=""

    if [ "${OOZIE_USE_TOMCAT}" == "1" ]; then
      if [ "${secure}" != "" ]; then
        #Use the SSL version of server.xml in oozie-server
        checkFileExists ${secureConfigsDir}/ssl-server.xml
        cp ${secureConfigsDir}/ssl-server.xml ${CATALINA_BASE}/conf/server.xml
        #Inject the SSL version of web.xml in oozie war
        checkFileExists ${secureConfigsDir}/ssl-web.xml
        cp ${secureConfigsDir}/ssl-web.xml ${tmpWarDir}/WEB-INF/web.xml
        echo "INFO: Using secure server.xml and secure web.xml"
      else
        #Use the regular version of server.xml in oozie-server
        checkFileExists ${secureConfigsDir}/server.xml
        cp ${secureConfigsDir}/server.xml ${CATALINA_BASE}/conf/server.xml
        #No need to restore web.xml because its already in the original WAR file
      fi
     fi
    components="${components}JARs"
 
    for jarPath in ${jarsPath//:/$'\n'}
    do
      found=`ls ${tmpWarDir}/WEB-INF/lib/${jarPath} 2&gt; /dev/null | wc -l`
      checkExec "looking for JAR ${jarPath} in input WAR"
      if [ ! $found = 0 ]; then
        echo
        echo "Specified Oozie WAR '${inputWar}' already contains JAR ${jarPath}"
    if [ "${addExtjs}" = "true" ]; then
      if [ ! "${components}" = "" ];then
        components="${components}, "
      fi
      components="${components}ExtJS library"
      if [ -e ${tmpWarDir}/ext-2.2 ]; then
         echo
        cleanUp
        exit -1
        echo "Specified Oozie WAR '${inputWar}' already contains ExtJS library files"
        cleanup_and_exit
       fi
      cp ${jarPath} ${tmpWarDir}/WEB-INF/lib/
      checkExec "copying jar ${jarPath} to staging"
    done
  fi
      #If the extjs path given is a ZIP, expand it and use it from there
      if [ -f ${extjsHome} ]; then
        unzip ${extjsHome} -d ${tmpDir} &gt; /dev/null
        extjsHome=${tmpDir}/ext-2.2
      fi
      #Inject the library in oozie war
      cp -r ${extjsHome} ${tmpWarDir}/ext-2.2
      checkExec "copying ExtJS files into staging"
    fi
 
  #Creating new Oozie WAR
  currentDir=`pwd`
  cd ${tmpWarDir}
  zip -r oozie.war * &gt; /dev/null
  checkExec "creating new Oozie WAR"
  cd ${currentDir}
    if [ "${addJars}" = "true" ]; then
      if [ ! "${components}" = "" ];then
        components="${components}, "
      fi
      components="${components}JARs"
 
  #copying new Oozie WAR to asked location
  cp ${tmpWarDir}/oozie.war ${outputWar}
  checkExec "copying new Oozie WAR"
      for jarPath in ${jarsPath//:/$'\n'}
      do
        found=`ls ${tmpWarDir}/WEB-INF/lib/${jarPath} 2&gt; /dev/null | wc -l`
        checkExec "looking for JAR ${jarPath} in input WAR"
        if [ ! $found = 0 ]; then
          echo
          echo "Specified Oozie WAR '${inputWar}' already contains JAR ${jarPath}"
          cleanup_and_exit
        fi
        cp ${jarPath} ${tmpWarDir}/WEB-INF/lib/
        checkExec "copying jar ${jarPath} to staging"
      done
    fi
 
  echo
  echo "New Oozie WAR file with added '${components}' at ${outputWar}"
  echo
  cleanUp
    #Creating new Oozie WAR
    currentDir=`pwd`
    cd ${tmpWarDir}
    zip -r oozie.war * &gt; /dev/null
    checkExec "creating new Oozie WAR"
    cd ${currentDir}
 
  if [ "$?" != "0" ]; then
    exit -1
  fi
    #copying new Oozie WAR to asked location
    if [ "${OOZIE_USE_TOMCAT}" == "1" ]; then
      cp ${tmpWarDir}/oozie.war ${outputWar}
      checkExec "copying new Oozie WAR"
 
  echo
      echo
      echo "New Oozie WAR file with added '${components}' at ${outputWar}"
      echo
    fi
 
  echo "INFO: Oozie is ready to be started"
    cleanUp
 
  echo
    if [ "$?" -ne "0" ]; then
      exit -1
    fi
 
    log_ready_to_start

  fi
}

if [ "${OOZIE_USE_TOMCAT}" = "1" ]; then
  prepare_tomcat
else
  prepare_jetty
 fi

log_ready_to_start
exit 0
diff --git a/distro/src/main/bin/oozie-sys.sh b/distro/src/main/bin/oozie-sys.sh
index 97d55a2b6..688aeb286 100755
-- a/distro/src/main/bin/oozie-sys.sh
++ b/distro/src/main/bin/oozie-sys.sh
@@ -195,7 +195,7 @@ else
   print "Using   OOZIE_BASE_URL:      ${OOZIE_BASE_URL}"
 fi
 
if [ "${CATALINA_BASE}" = "" ]; then
if [ "${OOZIE_USE_TOMCAT}" = "1" -a "${CATALINA_BASE}" = "" ]; then
   export CATALINA_BASE=${OOZIE_HOME}/oozie-server
   print "Setting CATALINA_BASE:       ${CATALINA_BASE}"
 else
@@ -223,20 +223,40 @@ else
   print "Using   OOZIE_INSTANCE_ID:       ${OOZIE_INSTANCE_ID}"
 fi
 
if [ "${CATALINA_OUT}" = "" ]; then
  export CATALINA_OUT=${OOZIE_LOG}/catalina.out
  print "Setting CATALINA_OUT:        ${CATALINA_OUT}"
else
  print "Using   CATALINA_OUT:        ${CATALINA_OUT}"
if [ "${OOZIE_USE_TOMCAT}" = "1" ]; then
  if [  "${CATALINA_OUT}" = "" ]; then
    export CATALINA_OUT=${OOZIE_LOG}/catalina.out
    print "Setting CATALINA_OUT:        ${CATALINA_OUT}"
  else
    print "Using   CATALINA_OUT:        ${CATALINA_OUT}"
  fi
 fi
 
if [ "${CATALINA_PID}" = "" ]; then
if [ "${OOZIE_USE_TOMCAT}" = "1" -a "${CATALINA_PID}" = "" ]; then
   export CATALINA_PID=${OOZIE_HOME}/oozie-server/temp/oozie.pid
   print "Setting CATALINA_PID:        ${CATALINA_PID}"
 else
   print "Using   CATALINA_PID:        ${CATALINA_PID}"
 fi
 
export CATALINA_OPTS="${CATALINA_OPTS} -Dderby.stream.error.file=${OOZIE_LOG}/derby.log"
if [ "${OOZIE_USE_TOMCAT}" = "1" ]; then
  export CATALINA_OPTS="${CATALINA_OPTS} -Dderby.stream.error.file=${OOZIE_LOG}/derby.log"
fi
 
 print

setup_ooziedb() {
  echo "Setting up oozie DB"
  ${BASEDIR}/bin/ooziedb.sh create -run
  if [ "$?" -ne "0" ]; then
    exit -1
  fi
  echo
}

if [ "${JAVA_HOME}" != "" ]; then
    JAVA_BIN=java
else
    JAVA_BIN=${JAVA_HOME}/bin/java
fi

diff --git a/distro/src/main/bin/oozie-tomcat-server.sh b/distro/src/main/bin/oozie-tomcat-server.sh
new file mode 100644
index 000000000..18dd0f600
-- /dev/null
++ b/distro/src/main/bin/oozie-tomcat-server.sh
@@ -0,0 +1,89 @@
#!/bin/bash
#
# Licensed to the Apache Software Foundation (ASF) under one
# or more contributor license agreements.  See the NOTICE file
# distributed with this work for additional information
# regarding copyright ownership.  The ASF licenses this file
# to you under the Apache License, Version 2.0 (the
# "License"); you may not use this file except in compliance
# with the License.  You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

CATALINA=${OOZIE_CATALINA_HOME:-${BASEDIR}/oozie-server}/bin/catalina.sh

setup_catalina_opts() {
  # The Java System properties 'oozie.http.port' and 'oozie.https.port' are not
  # used by Oozie, they are used in Tomcat's server.xml configuration file
  #
  echo "Using   CATALINA_OPTS:       ${CATALINA_OPTS}"

  catalina_opts="-Doozie.home.dir=${OOZIE_HOME}";
  catalina_opts="${catalina_opts} -Doozie.config.dir=${OOZIE_CONFIG}";
  catalina_opts="${catalina_opts} -Doozie.log.dir=${OOZIE_LOG}";
  catalina_opts="${catalina_opts} -Doozie.data.dir=${OOZIE_DATA}";
  catalina_opts="${catalina_opts} -Doozie.instance.id=${OOZIE_INSTANCE_ID}"

  catalina_opts="${catalina_opts} -Doozie.config.file=${OOZIE_CONFIG_FILE}";

  catalina_opts="${catalina_opts} -Doozie.log4j.file=${OOZIE_LOG4J_FILE}";
  catalina_opts="${catalina_opts} -Doozie.log4j.reload=${OOZIE_LOG4J_RELOAD}";

  catalina_opts="${catalina_opts} -Doozie.http.hostname=${OOZIE_HTTP_HOSTNAME}";
  catalina_opts="${catalina_opts} -Doozie.admin.port=${OOZIE_ADMIN_PORT}";
  catalina_opts="${catalina_opts} -Doozie.http.port=${OOZIE_HTTP_PORT}";
  catalina_opts="${catalina_opts} -Doozie.https.port=${OOZIE_HTTPS_PORT}";
  catalina_opts="${catalina_opts} -Doozie.base.url=${OOZIE_BASE_URL}";
  catalina_opts="${catalina_opts} -Doozie.https.keystore.file=${OOZIE_HTTPS_KEYSTORE_FILE}";
  catalina_opts="${catalina_opts} -Doozie.https.keystore.pass=${OOZIE_HTTPS_KEYSTORE_PASS}";

  # add required native libraries such as compression codecs
  catalina_opts="${catalina_opts} -Djava.library.path=${JAVA_LIBRARY_PATH}";

  echo "Adding to CATALINA_OPTS:     ${catalina_opts}"

  export CATALINA_OPTS="${CATALINA_OPTS} ${catalina_opts}"
}

setup_oozie() {
  if [ ! -e "${CATALINA_BASE}/webapps/oozie.war" ]; then
    echo "WARN: Oozie WAR has not been set up at '${CATALINA_BASE}/webapps', doing default set up"
    ${BASEDIR}/bin/oozie-setup.sh prepare-war
    if [ "$?" -ne "0" ]; then
      exit -1
    fi
  fi
  echo
}

tomcat_main() {
  source ${BASEDIR}/bin/oozie-sys.sh

  #Create webapp directory from war if lib doesn't exist
  if [ ! -d "${BASEDIR}/embedded-oozie-server/webapp" ]; then
    unzip "${BASEDIR}/oozie.war" -d "${BASEDIR}/embedded-oozie-server/webapp" &gt; /dev/null
  fi

  actionCmd=$1
  case $actionCmd in
    (start|run)
      setup_catalina_opts
      setup_oozie
      setup_ooziedb
      #TODO setup default oozie sharelib
      ;;
    (stop)
      setup_catalina_opts

      # A bug in catalina.sh script does not use CATALINA_OPTS for stopping the server
      export JAVA_OPTS=${CATALINA_OPTS}
      ;;
  esac
  exec $CATALINA $actionCmd "$@"
}
diff --git a/distro/src/main/bin/oozied.sh b/distro/src/main/bin/oozied.sh
index a869c3da1..462ba76e9 100644
-- a/distro/src/main/bin/oozied.sh
++ b/distro/src/main/bin/oozied.sh
@@ -17,14 +17,6 @@
 # limitations under the License.
 #
 
if [ $# -le 0 ]; then
  echo "Usage: oozied.sh (start|stop|run) [&lt;catalina-args...&gt;]"
  exit 1
fi

actionCmd=$1
shift

 # resolve links - $0 may be a softlink
 PRG="${0}"
 
@@ -41,76 +33,28 @@ done
 BASEDIR=`dirname ${PRG}`
 BASEDIR=`cd ${BASEDIR}/..;pwd`
 
source ${BASEDIR}/bin/oozie-sys.sh

CATALINA=${OOZIE_CATALINA_HOME:-${BASEDIR}/oozie-server}/bin/catalina.sh

setup_catalina_opts() {
  # The Java System properties 'oozie.http.port' and 'oozie.https.port' are not
  # used by Oozie, they are used in Tomcat's server.xml configuration file
  #
  echo "Using   CATALINA_OPTS:       ${CATALINA_OPTS}"

  catalina_opts="-Doozie.home.dir=${OOZIE_HOME}";
  catalina_opts="${catalina_opts} -Doozie.config.dir=${OOZIE_CONFIG}";
  catalina_opts="${catalina_opts} -Doozie.log.dir=${OOZIE_LOG}";
  catalina_opts="${catalina_opts} -Doozie.data.dir=${OOZIE_DATA}";
  catalina_opts="${catalina_opts} -Doozie.instance.id=${OOZIE_INSTANCE_ID}"

  catalina_opts="${catalina_opts} -Doozie.config.file=${OOZIE_CONFIG_FILE}";

  catalina_opts="${catalina_opts} -Doozie.log4j.file=${OOZIE_LOG4J_FILE}";
  catalina_opts="${catalina_opts} -Doozie.log4j.reload=${OOZIE_LOG4J_RELOAD}";

  catalina_opts="${catalina_opts} -Doozie.http.hostname=${OOZIE_HTTP_HOSTNAME}";
  catalina_opts="${catalina_opts} -Doozie.admin.port=${OOZIE_ADMIN_PORT}";
  catalina_opts="${catalina_opts} -Doozie.http.port=${OOZIE_HTTP_PORT}";
  catalina_opts="${catalina_opts} -Doozie.https.port=${OOZIE_HTTPS_PORT}";
  catalina_opts="${catalina_opts} -Doozie.base.url=${OOZIE_BASE_URL}";
  catalina_opts="${catalina_opts} -Doozie.https.keystore.file=${OOZIE_HTTPS_KEYSTORE_FILE}";
  catalina_opts="${catalina_opts} -Doozie.https.keystore.pass=${OOZIE_HTTPS_KEYSTORE_PASS}";

  # add required native libraries such as compression codecs
  catalina_opts="${catalina_opts} -Djava.library.path=${JAVA_LIBRARY_PATH}";

  echo "Adding to CATALINA_OPTS:     ${catalina_opts}"

  export CATALINA_OPTS="${CATALINA_OPTS} ${catalina_opts}"
}

setup_oozie() {
  if [ ! -e "${CATALINA_BASE}/webapps/oozie.war" ]; then
    echo "WARN: Oozie WAR has not been set up at '${CATALINA_BASE}/webapps', doing default set up"
    ${BASEDIR}/bin/oozie-setup.sh prepare-war
    if [ "$?" != "0" ]; then
      exit -1
    fi
  fi
  echo
}
if [ -e "${BASEDIR}/oozie-server" ]; then
  export OOZIE_USE_TOMCAT=1
else
  export OOZIE_USE_TOMCAT=0
fi
 
setup_ooziedb() {
  echo "Setting up oozie DB"
  ${BASEDIR}/bin/ooziedb.sh create -run
  if [ "$?" != "0" ]; then
    exit -1
if [ $# -le 0 ]; then
  if [ "${OOZIE_USE_TOMCAT}" -eq "1" ]; then
    echo "Usage: oozied.sh (start|stop|run) [&lt;catalina-args...&gt;]"
  else
    echo "Usage: oozied.sh (start|stop|run)"
   fi
  echo
}

case $actionCmd in
  (start|run)
    setup_catalina_opts
    setup_oozie
    setup_ooziedb
    #TODO setup default oozie sharelib
    ;;
  (stop)
    setup_catalina_opts
  exit 1
fi
 
    # A bug in catalina.sh script does not use CATALINA_OPTS for stopping the server
    export JAVA_OPTS=${CATALINA_OPTS}
    ;;
esac
actionCmd=$1
shift
 
exec $CATALINA $actionCmd "$@"
if [ "${OOZIE_USE_TOMCAT}" == "1" ]; then
  source ${BASEDIR}/bin/oozie-tomcat-server.sh
  tomcat_main $actionCmd
else
  source ${BASEDIR}/bin/oozie-jetty-server.sh
  jetty_main $actionCmd
fi
diff --git a/pom.xml b/pom.xml
index a3db3da3e..c9a19def7 100644
-- a/pom.xml
++ b/pom.xml
@@ -56,7 +56,7 @@
         &lt;failIfNoTests&gt;false&lt;/failIfNoTests&gt;
 
         &lt;test.timeout&gt;5400&lt;/test.timeout&gt;

        &lt;clover.version&gt;4.0.6&lt;/clover.version&gt;
         &lt;!-- platform encoding override --&gt;
         &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;
         &lt;project.reporting.outputEncoding&gt;UTF-8&lt;/project.reporting.outputEncoding&gt;
@@ -105,7 +105,9 @@
          &lt;distcp.version&gt;${hadoop.version}&lt;/distcp.version&gt;
          &lt;hadoop.auth.version&gt;${hadoop.version}&lt;/hadoop.auth.version&gt;
 
         &lt;!-- Tomcat version --&gt;
         &lt;jetty.version&gt;9.2.19.v20160908&lt;/jetty.version&gt;

        &lt;!-- Tomcat version --&gt;
          &lt;tomcat.version&gt;6.0.44&lt;/tomcat.version&gt;
          &lt;jline.version&gt;0.9.94&lt;/jline.version&gt;
          &lt;openjpa.version&gt;2.4.1&lt;/openjpa.version&gt;
@@ -130,6 +132,7 @@
         &lt;module&gt;docs&lt;/module&gt;
         &lt;module&gt;tools&lt;/module&gt;
         &lt;module&gt;minitest&lt;/module&gt;
        &lt;module&gt;server&lt;/module&gt;
         &lt;module&gt;distro&lt;/module&gt;
         &lt;module&gt;zookeeper-security-tests&lt;/module&gt;
     &lt;/modules&gt;
@@ -809,6 +812,12 @@
                 &lt;version&gt;${streaming.version}&lt;/version&gt;
             &lt;/dependency&gt;
 
            &lt;dependency&gt;
                &lt;groupId&gt;org.apache.hadoop&lt;/groupId&gt;
                &lt;artifactId&gt;hadoop-common&lt;/artifactId&gt;
                &lt;version&gt;${hadoop.version}&lt;/version&gt;
            &lt;/dependency&gt;

             &lt;dependency&gt;
                 &lt;groupId&gt;org.apache.pig&lt;/groupId&gt;
                 &lt;artifactId&gt;pig&lt;/artifactId&gt;
@@ -1545,6 +1554,58 @@
                 &lt;artifactId&gt;gson&lt;/artifactId&gt;
                 &lt;version&gt;2.7&lt;/version&gt;
             &lt;/dependency&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;com.google.inject&lt;/groupId&gt;
                &lt;artifactId&gt;guice&lt;/artifactId&gt;
                &lt;version&gt;3.0&lt;/version&gt;
            &lt;/dependency&gt;

            &lt;dependency&gt;
                &lt;groupId&gt;org.eclipse.jetty&lt;/groupId&gt;
                &lt;artifactId&gt;jetty-server&lt;/artifactId&gt;
                &lt;version&gt;${jetty.version}&lt;/version&gt;
            &lt;/dependency&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;org.eclipse.jetty&lt;/groupId&gt;
                &lt;artifactId&gt;jetty-servlet&lt;/artifactId&gt;
                &lt;version&gt;${jetty.version}&lt;/version&gt;
            &lt;/dependency&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;org.eclipse.jetty&lt;/groupId&gt;
                &lt;artifactId&gt;jetty-util&lt;/artifactId&gt;
                &lt;version&gt;${jetty.version}&lt;/version&gt;
            &lt;/dependency&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;org.eclipse.jetty&lt;/groupId&gt;
                &lt;artifactId&gt;jetty-http&lt;/artifactId&gt;
                &lt;version&gt;${jetty.version}&lt;/version&gt;
            &lt;/dependency&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;org.eclipse.jetty&lt;/groupId&gt;
                &lt;artifactId&gt;jetty-rewrite&lt;/artifactId&gt;
                &lt;version&gt;${jetty.version}&lt;/version&gt;
            &lt;/dependency&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;org.eclipse.jetty&lt;/groupId&gt;
                &lt;artifactId&gt;jetty-annotations&lt;/artifactId&gt;
                &lt;version&gt;${jetty.version}&lt;/version&gt;
            &lt;/dependency&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;org.eclipse.jetty&lt;/groupId&gt;
                &lt;artifactId&gt;jetty-webapp&lt;/artifactId&gt;
                &lt;version&gt;${jetty.version}&lt;/version&gt;
            &lt;/dependency&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;org.eclipse.jetty&lt;/groupId&gt;
                &lt;artifactId&gt;apache-jsp&lt;/artifactId&gt;
                &lt;type&gt;jar&lt;/type&gt;
                &lt;version&gt;${jetty.version}&lt;/version&gt;
            &lt;/dependency&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;org.eclipse.jetty&lt;/groupId&gt;
                &lt;artifactId&gt;jetty-plus&lt;/artifactId&gt;
                &lt;version&gt;${jetty.version}&lt;/version&gt;
            &lt;/dependency&gt;
         &lt;/dependencies&gt;
     &lt;/dependencyManagement&gt;
 
@@ -1659,6 +1720,7 @@
             &lt;plugin&gt;
                 &lt;groupId&gt;com.atlassian.maven.plugins&lt;/groupId&gt;
                 &lt;artifactId&gt;maven-clover2-plugin&lt;/artifactId&gt;
                &lt;version&gt;${clover.version}&lt;/version&gt;
                 &lt;configuration&gt;
                     &lt;licenseLocation&gt;${clover.license}&lt;/licenseLocation&gt;
                     &lt;generateXml&gt;true&lt;/generateXml&gt;
@@ -1959,5 +2021,11 @@
                 &lt;spark.bagel.version&gt;1.6.2&lt;/spark.bagel.version&gt;
             &lt;/properties&gt;
         &lt;/profile&gt;
        &lt;profile&gt;
            &lt;id&gt;tomcat&lt;/id&gt;
            &lt;activation&gt;
                &lt;activeByDefault&gt;false&lt;/activeByDefault&gt;
            &lt;/activation&gt;
        &lt;/profile&gt;
     &lt;/profiles&gt;
 &lt;/project&gt;
diff --git a/release-log.txt b/release-log.txt
index 70ffaa6a9..3071c7ba3 100644
-- a/release-log.txt
++ b/release-log.txt
@@ -1,5 +1,6 @@
 -- Oozie 4.4.0 release (trunk - unreleased)
 
OOZIE-2666 Support embedding Jetty into Oozie (asasvari via rkanter)
 OOZIE-1459 Remove the version in the child poms for maven-antrun-plugin (Jan Hentschel via rkanter)
 OOZIE-2225 Add wild card filter for gathering jobs (sai-krish via rkanter)
 OOZIE-2536 Hadoop's cleanup of local directory in uber mode causing failures (satishsaley via rohini)
diff --git a/server/pom.xml b/server/pom.xml
new file mode 100644
index 000000000..a336aa80d
-- /dev/null
++ b/server/pom.xml
@@ -0,0 +1,257 @@
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!--
  Licensed to the Apache Software Foundation (ASF) under one
  or more contributor license agreements.  See the NOTICE file
  distributed with this work for additional information
  regarding copyright ownership.  The ASF licenses this file
  to you under the Apache License, Version 2.0 (the
  "License"); you may not use this file except in compliance
  with the License.  You may obtain a copy of the License at

       http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
--&gt;
&lt;project xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xmlns="http://maven.apache.org/POM/4.0.0"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"&gt;
    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
    &lt;parent&gt;
        &lt;groupId&gt;org.apache.oozie&lt;/groupId&gt;
        &lt;artifactId&gt;oozie-main&lt;/artifactId&gt;
        &lt;version&gt;4.4.0-SNAPSHOT&lt;/version&gt;
    &lt;/parent&gt;
    &lt;groupId&gt;org.apache.oozie&lt;/groupId&gt;
    &lt;artifactId&gt;oozie-server&lt;/artifactId&gt;
    &lt;version&gt;4.4.0-SNAPSHOT&lt;/version&gt;
    &lt;description&gt;Apache Oozie Server&lt;/description&gt;
    &lt;name&gt;Apache Oozie Server&lt;/name&gt;
    &lt;packaging&gt;jar&lt;/packaging&gt;

    &lt;properties&gt;
        &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;
    &lt;/properties&gt;

    &lt;dependencies&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.eclipse.jetty&lt;/groupId&gt;
            &lt;artifactId&gt;jetty-server&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.eclipse.jetty&lt;/groupId&gt;
            &lt;artifactId&gt;jetty-servlet&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.eclipse.jetty&lt;/groupId&gt;
            &lt;artifactId&gt;jetty-util&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.eclipse.jetty&lt;/groupId&gt;
            &lt;artifactId&gt;jetty-http&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.eclipse.jetty&lt;/groupId&gt;
            &lt;artifactId&gt;jetty-rewrite&lt;/artifactId&gt;
        &lt;/dependency&gt;

        &lt;!--  begin JSP support --&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.eclipse.jetty&lt;/groupId&gt;
            &lt;artifactId&gt;jetty-annotations&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.eclipse.jetty&lt;/groupId&gt;
            &lt;artifactId&gt;jetty-webapp&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.eclipse.jetty&lt;/groupId&gt;
            &lt;artifactId&gt;apache-jsp&lt;/artifactId&gt;
            &lt;type&gt;jar&lt;/type&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.eclipse.jetty&lt;/groupId&gt;
            &lt;artifactId&gt;jetty-plus&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;!--  end JSP support --&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.apache.hadoop&lt;/groupId&gt;
            &lt;artifactId&gt;hadoop-common&lt;/artifactId&gt;
            &lt;exclusions&gt;
                &lt;exclusion&gt;
                    &lt;groupId&gt;org.mortbay.jetty&lt;/groupId&gt;
                    &lt;artifactId&gt;jetty&lt;/artifactId&gt;
                &lt;/exclusion&gt;
                &lt;exclusion&gt;
                    &lt;groupId&gt;org.mortbay.jetty&lt;/groupId&gt;
                    &lt;artifactId&gt;jetty-util&lt;/artifactId&gt;
                &lt;/exclusion&gt;
            &lt;/exclusions&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.apache.oozie&lt;/groupId&gt;
            &lt;artifactId&gt;oozie-client&lt;/artifactId&gt;
            &lt;exclusions&gt;
                &lt;exclusion&gt;
                    &lt;groupId&gt;org.slf4j&lt;/groupId&gt;
                    &lt;artifactId&gt;slf4j-simple&lt;/artifactId&gt;
                &lt;/exclusion&gt;
            &lt;/exclusions&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.apache.oozie&lt;/groupId&gt;
            &lt;artifactId&gt;oozie-core&lt;/artifactId&gt;
            &lt;exclusions&gt;
                &lt;exclusion&gt;
                    &lt;groupId&gt;org.apache.hadoop&lt;/groupId&gt;
                    &lt;artifactId&gt;hadoop-core&lt;/artifactId&gt;
                &lt;/exclusion&gt;
                &lt;exclusion&gt;
                    &lt;groupId&gt;org.apache.oozie&lt;/groupId&gt;
                    &lt;artifactId&gt;hadoop-auth&lt;/artifactId&gt;
                &lt;/exclusion&gt;
                &lt;exclusion&gt;
                    &lt;groupId&gt;org.apache.oozie&lt;/groupId&gt;
                    &lt;artifactId&gt;oozie-client&lt;/artifactId&gt;
                &lt;/exclusion&gt;
                &lt;exclusion&gt;
                    &lt;groupId&gt;org.mortbay.jetty&lt;/groupId&gt;
                    &lt;artifactId&gt;jetty&lt;/artifactId&gt;
                &lt;/exclusion&gt;
                &lt;exclusion&gt;
                    &lt;groupId&gt;org.eclipse.jetty.aggregate&lt;/groupId&gt;
                    &lt;artifactId&gt;jetty-all&lt;/artifactId&gt;
                &lt;/exclusion&gt;
            &lt;/exclusions&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;com.google.inject&lt;/groupId&gt;
            &lt;artifactId&gt;guice&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;junit&lt;/groupId&gt;
            &lt;artifactId&gt;junit&lt;/artifactId&gt;
            &lt;scope&gt;test&lt;/scope&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.mockito&lt;/groupId&gt;
            &lt;artifactId&gt;mockito-all&lt;/artifactId&gt;
            &lt;scope&gt;test&lt;/scope&gt;
        &lt;/dependency&gt;
    &lt;/dependencies&gt;
    &lt;build&gt;
        &lt;plugins&gt;
            &lt;plugin&gt;
                &lt;groupId&gt;org.apache.openjpa&lt;/groupId&gt;
                &lt;artifactId&gt;openjpa-maven-plugin&lt;/artifactId&gt;
            &lt;/plugin&gt;

            &lt;plugin&gt;
                &lt;artifactId&gt;maven-assembly-plugin&lt;/artifactId&gt;
                &lt;configuration&gt;
                    &lt;descriptors&gt;
                        &lt;descriptor&gt;../src/main/assemblies/empty.xml&lt;/descriptor&gt;
                    &lt;/descriptors&gt;
                &lt;/configuration&gt;
            &lt;/plugin&gt;

            &lt;plugin&gt;
                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
                &lt;artifactId&gt;maven-jar-plugin&lt;/artifactId&gt;
                &lt;configuration&gt;
                    &lt;archive&gt;
                        &lt;manifest&gt;
                            &lt;mainClass&gt;org.apache.oozie.server.EmbeddedOozieServer&lt;/mainClass&gt;
                        &lt;/manifest&gt;
                    &lt;/archive&gt;
                &lt;/configuration&gt;
            &lt;/plugin&gt;
            &lt;plugin&gt;
                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
                &lt;artifactId&gt;maven-dependency-plugin&lt;/artifactId&gt;
                &lt;version&gt;2.10&lt;/version&gt;
                &lt;executions&gt;
                    &lt;execution&gt;
                        &lt;id&gt;copy-dependencies&lt;/id&gt;
                        &lt;phase&gt;package&lt;/phase&gt;
                        &lt;goals&gt;
                            &lt;goal&gt;copy-dependencies&lt;/goal&gt;
                        &lt;/goals&gt;
                        &lt;configuration&gt;
                            &lt;artifactItems&gt;
                                &lt;artifactItem&gt;
                                    &lt;groupId&gt;org.eclipse.jetty&lt;/groupId&gt;
                                    &lt;artifactId&gt;jetty-server&lt;/artifactId&gt;
                                &lt;/artifactItem&gt;
                                &lt;artifactItem&gt;
                                    &lt;groupId&gt;org.eclipse.jetty&lt;/groupId&gt;
                                    &lt;artifactId&gt;jetty-util&lt;/artifactId&gt;
                                &lt;/artifactItem&gt;
                                &lt;artifactItem&gt;
                                    &lt;groupId&gt;org.eclipse.jetty&lt;/groupId&gt;
                                    &lt;artifactId&gt;jetty-http&lt;/artifactId&gt;
                                &lt;/artifactItem&gt;
                                &lt;artifactItem&gt;
                                    &lt;groupId&gt;org.eclipse.jetty&lt;/groupId&gt;
                                    &lt;artifactId&gt;jetty-io&lt;/artifactId&gt;
                                &lt;/artifactItem&gt;
                                &lt;artifactItem&gt;
                                    &lt;groupId&gt;org.eclipse.jetty&lt;/groupId&gt;
                                    &lt;artifactId&gt;jetty-webapp&lt;/artifactId&gt;
                                &lt;/artifactItem&gt;
                                &lt;artifactItem&gt;
                                    &lt;groupId&gt;org.eclipse.jetty&lt;/groupId&gt;
                                    &lt;artifactId&gt;jetty-servlet&lt;/artifactId&gt;
                                &lt;/artifactItem&gt;
                                &lt;artifactItem&gt;
                                    &lt;groupId&gt;org.eclipse.jetty&lt;/groupId&gt;
                                    &lt;artifactId&gt;jetty-security&lt;/artifactId&gt;
                                &lt;/artifactItem&gt;
                                &lt;artifactItem&gt;
                                    &lt;groupId&gt;org.eclipse.jetty&lt;/groupId&gt;
                                    &lt;artifactId&gt;jetty-jsp&lt;/artifactId&gt;
                                &lt;/artifactItem&gt;
                                &lt;artifactItem&gt;
                                    &lt;groupId&gt;org.eclipse.jetty&lt;/groupId&gt;
                                    &lt;artifactId&gt;jetty-plus&lt;/artifactId&gt;
                                &lt;/artifactItem&gt;
                                &lt;artifactItem&gt;
                                    &lt;groupId&gt;org.eclipse.jetty&lt;/groupId&gt;
                                    &lt;artifactId&gt;jetty-annotations&lt;/artifactId&gt;
                                &lt;/artifactItem&gt;

                                &lt;!--  JSP support --&gt;
                                &lt;artifactItem&gt;
                                    &lt;groupId&gt;org.eclipse.jetty&lt;/groupId&gt;
                                    &lt;artifactId&gt;jetty-annotations&lt;/artifactId&gt;
                                &lt;/artifactItem&gt;
                                &lt;artifactItem&gt;
                                    &lt;groupId&gt;org.eclipse.jetty&lt;/groupId&gt;
                                    &lt;artifactId&gt;jetty-webapp&lt;/artifactId&gt;
                                &lt;/artifactItem&gt;
                                &lt;artifactItem&gt;
                                    &lt;groupId&gt;org.eclipse.jetty&lt;/groupId&gt;
                                    &lt;artifactId&gt;apache-jsp&lt;/artifactId&gt;
                                    &lt;type&gt;jar&lt;/type&gt;
                                &lt;/artifactItem&gt;
                                &lt;artifactItem&gt;
                                    &lt;groupId&gt;org.eclipse.jetty&lt;/groupId&gt;
                                    &lt;artifactId&gt;jetty-plus&lt;/artifactId&gt;
                                &lt;/artifactItem&gt;

                                &lt;artifactItem&gt;
                                    &lt;groupId&gt;org.apache.oozie&lt;/groupId&gt;
                                    &lt;artifactId&gt;webapp&lt;/artifactId&gt;
                                &lt;/artifactItem&gt;

                            &lt;/artifactItems&gt;
                        &lt;/configuration&gt;
                    &lt;/execution&gt;
                &lt;/executions&gt;
            &lt;/plugin&gt;
        &lt;/plugins&gt;
    &lt;/build&gt;
&lt;/project&gt;
diff --git a/server/src/main/assemblies/empty.xml b/server/src/main/assemblies/empty.xml
new file mode 100644
index 000000000..17ff68a8b
-- /dev/null
++ b/server/src/main/assemblies/empty.xml
@@ -0,0 +1,21 @@
&lt;!--
  Licensed to the Apache Software Foundation (ASF) under one
  or more contributor license agreements.  See the NOTICE file
  distributed with this work for additional information
  regarding copyright ownership.  The ASF licenses this file
  to you under the Apache License, Version 2.0 (the
  "License"); you may not use this file except in compliance
  with the License.  You may obtain a copy of the License at

       http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
--&gt;
&lt;assembly&gt;
    &lt;id&gt;empty&lt;/id&gt;
    &lt;formats/&gt;
&lt;/assembly&gt;
diff --git a/server/src/main/java/org/apache/oozie/server/EmbeddedOozieServer.java b/server/src/main/java/org/apache/oozie/server/EmbeddedOozieServer.java
new file mode 100644
index 000000000..b7918b735
-- /dev/null
++ b/server/src/main/java/org/apache/oozie/server/EmbeddedOozieServer.java
@@ -0,0 +1,206 @@
/**
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */</comment>

<package>package <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>server</name></name>;</package>

<import>import <name><name>com</name><operator>.</operator><name>google</name><operator>.</operator><name>common</name><operator>.</operator><name>base</name><operator>.</operator><name>Preconditions</name></name>;</import>
<import>import <name><name>com</name><operator>.</operator><name>google</name><operator>.</operator><name>inject</name><operator>.</operator><name>Guice</name></name>;</import>
<import>import <name><name>com</name><operator>.</operator><name>google</name><operator>.</operator><name>inject</name><operator>.</operator><name>Inject</name></name>;</import>
<import>import <name><name>com</name><operator>.</operator><name>google</name><operator>.</operator><name>inject</name><operator>.</operator><name>Injector</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>hadoop</name><operator>.</operator><name>conf</name><operator>.</operator><name>Configuration</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>server</name><operator>.</operator><name>guice</name><operator>.</operator><name>OozieGuiceModule</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>ConfigurationService</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>ServiceException</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>Services</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>util</name><operator>.</operator><name>ConfigUtils</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>eclipse</name><operator>.</operator><name>jetty</name><operator>.</operator><name>rewrite</name><operator>.</operator><name>handler</name><operator>.</operator><name>RewriteHandler</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>eclipse</name><operator>.</operator><name>jetty</name><operator>.</operator><name>security</name><operator>.</operator><name>ConstraintSecurityHandler</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>eclipse</name><operator>.</operator><name>jetty</name><operator>.</operator><name>server</name><operator>.</operator><name>Connector</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>eclipse</name><operator>.</operator><name>jetty</name><operator>.</operator><name>server</name><operator>.</operator><name>HttpConfiguration</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>eclipse</name><operator>.</operator><name>jetty</name><operator>.</operator><name>server</name><operator>.</operator><name>HttpConnectionFactory</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>eclipse</name><operator>.</operator><name>jetty</name><operator>.</operator><name>server</name><operator>.</operator><name>Server</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>eclipse</name><operator>.</operator><name>jetty</name><operator>.</operator><name>server</name><operator>.</operator><name>ServerConnector</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>eclipse</name><operator>.</operator><name>jetty</name><operator>.</operator><name>server</name><operator>.</operator><name>handler</name><operator>.</operator><name>HandlerCollection</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>eclipse</name><operator>.</operator><name>jetty</name><operator>.</operator><name>servlet</name><operator>.</operator><name>ErrorPageErrorHandler</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>eclipse</name><operator>.</operator><name>jetty</name><operator>.</operator><name>webapp</name><operator>.</operator><name>WebAppContext</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>slf4j</name><operator>.</operator><name>Logger</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>slf4j</name><operator>.</operator><name>LoggerFactory</name></name>;</import>

<import>import <name><name>java</name><operator>.</operator><name>io</name><operator>.</operator><name>IOException</name></name>;</import>
<import>import <name><name>java</name><operator>.</operator><name>net</name><operator>.</operator><name>URISyntaxException</name></name>;</import>

<comment type="block" format="javadoc">/**
 *  Class to start Oozie inside an embedded Jetty server.
 */</comment>
<class><specifier>public</specifier> class <name>EmbeddedOozieServer</name> <block>{
    <decl_stmt><decl><type><specifier>private</specifier> <specifier>static</specifier> <specifier>final</specifier> <name>Logger</name></type> <name>LOG</name> <init>= <expr><call><name><name>LoggerFactory</name><operator>.</operator><name>getLogger</name></name><argument_list>(<argument><expr><name><name>EmbeddedOozieServer</name><operator>.</operator><name>class</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
    <decl_stmt><decl><type><specifier>protected</specifier> <name>Server</name></type> <name>server</name></decl>;</decl_stmt>
    <decl_stmt><decl><type><specifier>private</specifier> <name>int</name></type> <name>httpPort</name></decl>;</decl_stmt>
    <decl_stmt><decl><type><specifier>private</specifier> <name>int</name></type> <name>httpsPort</name></decl>;</decl_stmt>
    <decl_stmt><decl><type><specifier>private</specifier> <specifier>final</specifier> <name>WebAppContext</name></type> <name>servletContextHandler</name></decl>;</decl_stmt>
    <decl_stmt><decl><type><specifier>private</specifier> <specifier>final</specifier> <name>ServletMapper</name></type> <name>oozieServletMapper</name></decl>;</decl_stmt>
    <decl_stmt><decl><type><specifier>private</specifier> <specifier>final</specifier> <name>FilterMapper</name></type> <name>oozieFilterMapper</name></decl>;</decl_stmt>
    <decl_stmt><decl><type><specifier>private</specifier> <name>JspHandler</name></type> <name>jspHandler</name></decl>;</decl_stmt>
    <decl_stmt><decl><type><specifier>private</specifier> <name>Services</name></type> <name>serviceController</name></decl>;</decl_stmt>
    <decl_stmt><decl><type><specifier>private</specifier> <name>SSLServerConnectorFactory</name></type> <name>sslServerConnectorFactory</name></decl>;</decl_stmt>
    <decl_stmt><decl><type><specifier>private</specifier> <name>Configuration</name></type> <name>conf</name></decl>;</decl_stmt>
    <decl_stmt><decl><type><specifier>private</specifier> <specifier>final</specifier> <name>RewriteHandler</name></type> <name>oozieRewriteHandler</name></decl>;</decl_stmt>
    <decl_stmt><decl><type><specifier>private</specifier> <specifier>final</specifier> <name>ConstraintSecurityHandler</name></type> <name>constraintSecurityHandler</name></decl>;</decl_stmt>

    <comment type="block" format="javadoc">/**
     * Construct Oozie server
     * @param server jetty server to be embedded
     * @param jspHandler handler responsible for setting webapp context for JSP
     * @param serviceController controller for Oozie services; must be already initialized
     * @param sslServerConnectorFactory factory to create server connector configured for SSL
     * @param oozieRewriteHandler URL rewriter
     * @param servletContextHandler main web application context handler
     * @param oozieServletMapper maps servlets to URLs
     * @param oozieFilterMapper  maps filters
     * @param constraintSecurityHandler
     */</comment>
    <constructor><annotation>@<name>Inject</name></annotation>
    <specifier>public</specifier> <name>EmbeddedOozieServer</name><parameter_list>(<parameter><decl><type><specifier>final</specifier> <name>Server</name></type> <name>server</name></decl></parameter>,
                               <parameter><decl><type><specifier>final</specifier> <name>JspHandler</name></type> <name>jspHandler</name></decl></parameter>,
                               <parameter><decl><type><specifier>final</specifier> <name>Services</name></type> <name>serviceController</name></decl></parameter>,
                               <parameter><decl><type><specifier>final</specifier> <name>SSLServerConnectorFactory</name></type> <name>sslServerConnectorFactory</name></decl></parameter>,
                               <parameter><decl><type><specifier>final</specifier> <name>RewriteHandler</name></type> <name>oozieRewriteHandler</name></decl></parameter>,
                               <parameter><decl><type><specifier>final</specifier> <name>WebAppContext</name></type> <name>servletContextHandler</name></decl></parameter>,
                               <parameter><decl><type><specifier>final</specifier> <name>ServletMapper</name></type> <name>oozieServletMapper</name></decl></parameter>,
                               <parameter><decl><type><specifier>final</specifier> <name>FilterMapper</name></type> <name>oozieFilterMapper</name></decl></parameter>,
                               <parameter><decl><type><specifier>final</specifier> <name>ConstraintSecurityHandler</name></type> <name>constraintSecurityHandler</name></decl></parameter>)</parameter_list>
    <block>{<block_content>
        <expr_stmt><expr><name><name>this</name><operator>.</operator><name>constraintSecurityHandler</name></name> <operator>=</operator> <name>constraintSecurityHandler</name></expr>;</expr_stmt>
        <expr_stmt><expr><name><name>this</name><operator>.</operator><name>serviceController</name></name> <operator>=</operator> <call><name><name>Preconditions</name><operator>.</operator><name>checkNotNull</name></name><argument_list>(<argument><expr><name>serviceController</name></expr></argument>, <argument><expr><literal type="string">"serviceController is null"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><name><name>this</name><operator>.</operator><name>jspHandler</name></name> <operator>=</operator> <call><name><name>Preconditions</name><operator>.</operator><name>checkNotNull</name></name><argument_list>(<argument><expr><name>jspHandler</name></expr></argument>, <argument><expr><literal type="string">"jspHandler is null"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><name><name>this</name><operator>.</operator><name>sslServerConnectorFactory</name></name> <operator>=</operator> <call><name><name>Preconditions</name><operator>.</operator><name>checkNotNull</name></name><argument_list>(<argument><expr><name>sslServerConnectorFactory</name></expr></argument>,
                <argument><expr><literal type="string">"sslServerConnectorFactory is null"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><name><name>this</name><operator>.</operator><name>server</name></name> <operator>=</operator> <call><name><name>Preconditions</name><operator>.</operator><name>checkNotNull</name></name><argument_list>(<argument><expr><name>server</name></expr></argument>, <argument><expr><literal type="string">"server is null"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><name><name>this</name><operator>.</operator><name>oozieRewriteHandler</name></name> <operator>=</operator> <call><name><name>Preconditions</name><operator>.</operator><name>checkNotNull</name></name><argument_list>(<argument><expr><name>oozieRewriteHandler</name></expr></argument>, <argument><expr><literal type="string">"rewriter is null"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><name><name>this</name><operator>.</operator><name>servletContextHandler</name></name> <operator>=</operator> <call><name><name>Preconditions</name><operator>.</operator><name>checkNotNull</name></name><argument_list>(<argument><expr><name>servletContextHandler</name></expr></argument>, <argument><expr><literal type="string">"servletContextHandler is null"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><name><name>this</name><operator>.</operator><name>oozieServletMapper</name></name> <operator>=</operator> <call><name><name>Preconditions</name><operator>.</operator><name>checkNotNull</name></name><argument_list>(<argument><expr><name>oozieServletMapper</name></expr></argument>, <argument><expr><literal type="string">"oozieServletMapper is null"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><name><name>this</name><operator>.</operator><name>oozieFilterMapper</name></name> <operator>=</operator> <call><name><name>Preconditions</name><operator>.</operator><name>checkNotNull</name></name><argument_list>(<argument><expr><name>oozieFilterMapper</name></expr></argument>, <argument><expr><literal type="string">"oozieFilterMapper is null"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    </block_content>}</block></constructor>

    <comment type="block" format="javadoc">/**
     * Set up the Oozie server by configuring jetty server settings and starts Oozie services
     *
     * @throws URISyntaxException
     * @throws IOException
     * @throws ServiceException
     */</comment>
    <function><type><specifier>public</specifier> <name>void</name></type> <name>setup</name><parameter_list>()</parameter_list> <throws>throws <argument><expr><name>URISyntaxException</name></expr></argument>, <argument><expr><name>IOException</name></expr></argument>, <argument><expr><name>ServiceException</name></expr></argument></throws> <block>{<block_content>
        <expr_stmt><expr><name>conf</name> <operator>=</operator> <call><name><name>serviceController</name><operator>.</operator><name>get</name></name><argument_list>(<argument><expr><name><name>ConfigurationService</name><operator>.</operator><name>class</name></name></expr></argument>)</argument_list></call><operator>.</operator><call><name>getConf</name><argument_list>()</argument_list></call></expr>;</expr_stmt>

        <expr_stmt><expr><name>httpPort</name> <operator>=</operator> <call><name>getConfigPort</name><argument_list>(<argument><expr><name><name>ConfigUtils</name><operator>.</operator><name>OOZIE_HTTP_PORT</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <decl_stmt><decl><type><name>HttpConfiguration</name></type> <name>httpConfiguration</name> <init>= <expr><operator>new</operator> <call><name>HttpConfigurationWrapper</name><argument_list>(<argument><expr><name>conf</name></expr></argument>)</argument_list></call><operator>.</operator><call><name>getDefaultHttpConfiguration</name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>

        <decl_stmt><decl><type><name>ServerConnector</name></type> <name>connector</name> <init>= <expr><operator>new</operator> <call><name>ServerConnector</name><argument_list>(<argument><expr><name>server</name></expr></argument>, <argument><expr><operator>new</operator> <call><name>HttpConnectionFactory</name><argument_list>(<argument><expr><name>httpConfiguration</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name><name>connector</name><operator>.</operator><name>setPort</name></name><argument_list>(<argument><expr><name>httpPort</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>connector</name><operator>.</operator><name>setHost</name></name><argument_list>(<argument><expr><call><name><name>conf</name><operator>.</operator><name>get</name></name><argument_list>(<argument><expr><name><name>ConfigUtils</name><operator>.</operator><name>OOZIE_HTTP_HOSTNAME</name></name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <decl_stmt><decl><type><name>HandlerCollection</name></type> <name>handlerCollection</name> <init>= <expr><operator>new</operator> <call><name>HandlerCollection</name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>

        <if_stmt><if>if <condition>(<expr><call><name>isSecured</name><argument_list>()</argument_list></call></expr>)</condition> <block>{<block_content>
            <expr_stmt><expr><name>httpsPort</name> <operator>=</operator>  <call><name>getConfigPort</name><argument_list>(<argument><expr><name><name>ConfigUtils</name><operator>.</operator><name>OOZIE_HTTPS_PORT</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <decl_stmt><decl><type><name>ServerConnector</name></type> <name>sslConnector</name> <init>= <expr><call><name><name>sslServerConnectorFactory</name><operator>.</operator><name>createSecureServerConnector</name></name><argument_list>(<argument><expr><name>httpsPort</name></expr></argument>, <argument><expr><name>conf</name></expr></argument>, <argument><expr><name>server</name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
            <expr_stmt><expr><call><name><name>server</name><operator>.</operator><name>setConnectors</name></name><argument_list>(<argument><expr><operator>new</operator> <name><name>Connector</name><index>[]</index></name><block>{<expr><name>connector</name></expr>, <expr><name>sslConnector</name></expr>}</block></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name><name>constraintSecurityHandler</name><operator>.</operator><name>setHandler</name></name><argument_list>(<argument><expr><name>servletContextHandler</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name><name>handlerCollection</name><operator>.</operator><name>addHandler</name></name><argument_list>(<argument><expr><name>constraintSecurityHandler</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        </block_content>}</block></if>
        <else>else <block>{<block_content>
            <expr_stmt><expr><call><name><name>server</name><operator>.</operator><name>setConnectors</name></name><argument_list>(<argument><expr><operator>new</operator> <name><name>Connector</name><index>[]</index></name><block>{<expr><name>connector</name></expr>}</block></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        </block_content>}</block></else></if_stmt>

        <expr_stmt><expr><call><name><name>servletContextHandler</name><operator>.</operator><name>setContextPath</name></name><argument_list>(<argument><expr><literal type="string">"/oozie/"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>oozieServletMapper</name><operator>.</operator><name>mapOozieServlets</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>oozieFilterMapper</name><operator>.</operator><name>addFilters</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>

        <expr_stmt><expr><call><name><name>servletContextHandler</name><operator>.</operator><name>setParentLoaderPriority</name></name><argument_list>(<argument><expr><literal type="boolean">true</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>jspHandler</name><operator>.</operator><name>setupWebAppContext</name></name><argument_list>(<argument><expr><name>servletContextHandler</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <expr_stmt><expr><call><name>addErrorHandler</name><argument_list>()</argument_list></call></expr>;</expr_stmt>

        <expr_stmt><expr><call><name><name>handlerCollection</name><operator>.</operator><name>addHandler</name></name><argument_list>(<argument><expr><name>servletContextHandler</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>handlerCollection</name><operator>.</operator><name>addHandler</name></name><argument_list>(<argument><expr><name>oozieRewriteHandler</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>server</name><operator>.</operator><name>setHandler</name></name><argument_list>(<argument><expr><name>handlerCollection</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    </block_content>}</block></function>

    <function><type><specifier>private</specifier> <name>void</name></type> <name>addErrorHandler</name><parameter_list>()</parameter_list> <block>{<block_content>
        <decl_stmt><decl><type><name>ErrorPageErrorHandler</name></type> <name>errorHandler</name> <init>= <expr><operator>new</operator> <call><name>ErrorPageErrorHandler</name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name><name>errorHandler</name><operator>.</operator><name>addErrorPage</name></name><argument_list>(<argument><expr><literal type="number">404</literal></expr></argument>, <argument><expr><literal type="string">"/404.html"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>errorHandler</name><operator>.</operator><name>addErrorPage</name></name><argument_list>(<argument><expr><literal type="number">403</literal></expr></argument>, <argument><expr><literal type="string">"/403.html"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>servletContextHandler</name><operator>.</operator><name>setErrorHandler</name></name><argument_list>(<argument><expr><name>errorHandler</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    </block_content>}</block></function>

    <function><type><specifier>private</specifier> <name>int</name></type> <name>getConfigPort</name><parameter_list>(<parameter><decl><type><name>String</name></type> <name>confVar</name></decl></parameter>)</parameter_list> <block>{<block_content>
        <decl_stmt><decl><type><name>String</name></type> <name>confHttpPort</name> <init>= <expr><call><name><name>conf</name><operator>.</operator><name>get</name></name><argument_list>(<argument><expr><name>confVar</name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <decl_stmt><decl><type><name>int</name></type> <name>port</name></decl>;</decl_stmt>
        <try>try <block>{<block_content>
            <expr_stmt><expr><name>port</name> <operator>=</operator> <call><name><name>Integer</name><operator>.</operator><name>parseInt</name></name><argument_list>(<argument><expr><name>confHttpPort</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        </block_content>}</block>
        <catch>catch <parameter_list>(<parameter><decl><type><specifier>final</specifier> <name>NumberFormatException</name></type> <name>nfe</name></decl></parameter>)</parameter_list> <block>{<block_content>
            <throw>throw <expr><operator>new</operator> <call><name>NumberFormatException</name><argument_list>(<argument><expr><call><name><name>String</name><operator>.</operator><name>format</name></name><argument_list>(<argument><expr><literal type="string">"Port number for '%s \"%s\" ('%s') is not an integer."</literal></expr></argument>,
                    <argument><expr><name>confVar</name></expr></argument>, <argument><expr><name>confHttpPort</name></expr></argument>, <argument><expr><name>confHttpPort</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</throw>
        </block_content>}</block></catch></try>
        <return>return <expr><name>port</name></expr>;</return>
    </block_content>}</block></function>

    <function><type><specifier>private</specifier> <name>boolean</name></type> <name>isSecured</name><parameter_list>()</parameter_list> <block>{<block_content>
        <decl_stmt><decl><type><name>String</name></type> <name>isSSLEnabled</name> <init>= <expr><call><name><name>conf</name><operator>.</operator><name>get</name></name><argument_list>(<argument><expr><literal type="string">"oozie.https.enabled"</literal></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name><name>LOG</name><operator>.</operator><name>info</name></name><argument_list>(<argument><expr><literal type="string">"Server started with oozie.https.enabled = "</literal> <operator>+</operator> <name>isSSLEnabled</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <return>return <expr><name>isSSLEnabled</name> <operator>!=</operator> <literal type="null">null</literal> <operator>&amp;&amp;</operator> <call><name><name>Boolean</name><operator>.</operator><name>valueOf</name></name><argument_list>(<argument><expr><name>isSSLEnabled</name></expr></argument>)</argument_list></call></expr>;</return>
    </block_content>}</block></function>


    <function><type><specifier>public</specifier> <name>void</name></type> <name>start</name><parameter_list>()</parameter_list> <throws>throws <argument><expr><name>Exception</name></expr></argument></throws> <block>{<block_content>
        <expr_stmt><expr><call><name><name>server</name><operator>.</operator><name>start</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>LOG</name><operator>.</operator><name>info</name></name><argument_list>(<argument><expr><literal type="string">"Server started."</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    </block_content>}</block></function>

    <function><type><specifier>public</specifier> <name>void</name></type> <name>join</name><parameter_list>()</parameter_list> <throws>throws <argument><expr><name>InterruptedException</name></expr></argument></throws> <block>{<block_content>
        <expr_stmt><expr><call><name><name>server</name><operator>.</operator><name>join</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
    </block_content>}</block></function>

    <function><type><specifier>public</specifier> <name>void</name></type> <name>addShutdownHook</name><parameter_list>()</parameter_list> <block>{<block_content>
        <expr_stmt><expr><call><name><name>Runtime</name><operator>.</operator><name>getRuntime</name></name><argument_list>()</argument_list></call><operator>.</operator><call><name>addShutdownHook</name><argument_list>(<argument><expr><operator>new</operator> <class><super><name>Thread</name></super><argument_list>()</argument_list> <block>{
            <function><type><specifier>public</specifier> <name>void</name></type> <name>run</name><parameter_list>()</parameter_list> <block>{<block_content>
                <expr_stmt><expr><call><name><name>LOG</name><operator>.</operator><name>info</name></name><argument_list>(<argument><expr><literal type="string">"Shutting down."</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                <expr_stmt><expr><call><name><name>serviceController</name><operator>.</operator><name>destroy</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
                <expr_stmt><expr><call><name><name>LOG</name><operator>.</operator><name>info</name></name><argument_list>(<argument><expr><literal type="string">"Oozie services stopped."</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            </block_content>}</block></function>
        }</block></class></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    </block_content>}</block></function>

    <function><type><specifier>public</specifier> <specifier>static</specifier> <name>void</name></type> <name>main</name><parameter_list>(<parameter><decl><type><name><name>String</name><index>[]</index></name></type> <name>args</name></decl></parameter>)</parameter_list> <throws>throws <argument><expr><name>Exception</name></expr></argument></throws> <block>{<block_content>
        <decl_stmt><decl><type><specifier>final</specifier> <name>Injector</name></type> <name>guiceInjector</name> <init>= <expr><call><name><name>Guice</name><operator>.</operator><name>createInjector</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>OozieGuiceModule</name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>

        <decl_stmt><decl><type><specifier>final</specifier> <name>EmbeddedOozieServer</name></type> <name>embeddedOozieServer</name> <init>= <expr><call><name><name>guiceInjector</name><operator>.</operator><name>getInstance</name></name><argument_list>(<argument><expr><name><name>EmbeddedOozieServer</name><operator>.</operator><name>class</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>

        <expr_stmt><expr><call><name><name>embeddedOozieServer</name><operator>.</operator><name>setup</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>embeddedOozieServer</name><operator>.</operator><name>addShutdownHook</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <try>try <block>{<block_content>
            <expr_stmt><expr><call><name><name>embeddedOozieServer</name><operator>.</operator><name>start</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        </block_content>}</block> <catch>catch <parameter_list>(<parameter><decl><type><name>Exception</name></type> <name>e</name></decl></parameter>)</parameter_list> <block>{<block_content>
            <expr_stmt><expr><call><name><name>LOG</name><operator>.</operator><name>error</name></name><argument_list>(<argument><expr><literal type="string">"Could not start EmbeddedOozieServer!"</literal></expr></argument>, <argument><expr><name>e</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name><name>System</name><operator>.</operator><name>exit</name></name><argument_list>(<argument><expr><literal type="number">1</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        </block_content>}</block></catch></try>
        <expr_stmt><expr><call><name><name>embeddedOozieServer</name><operator>.</operator><name>join</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
    </block_content>}</block></function>
}</block></class>
<expr_stmt><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>server</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>server</name><operator>/</operator><name><name>FilterMapper</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>server</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>server</name><operator>/</operator><name><name>FilterMapper</name><operator>.</operator><name>java</name></name>
<operator>new</operator> <name>file</name> <name>mode</name> <literal type="number">100644</literal>
<name>index</name> <literal type="number">000000000..bd7861799</literal>
<operator>--</operator> <operator>/</operator><name>dev</name><operator>/</operator><literal type="null">null</literal>
<operator>++</operator> <name>b</name><operator>/</operator><name>server</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>server</name><operator>/</operator><name><name>FilterMapper</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">0</literal></expr><operator>,</operator><expr><literal type="number">0</literal> <operator>+</operator><literal type="number">1</literal></expr><operator>,</operator><expr><literal type="number">61</literal> @@</expr></expr_stmt>
<comment type="block" format="javadoc">/**
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */</comment>

<package>package <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>server</name></name>;</package>

<import>import <name><name>com</name><operator>.</operator><name>google</name><operator>.</operator><name>common</name><operator>.</operator><name>base</name><operator>.</operator><name>Preconditions</name></name>;</import>
<import>import <name><name>com</name><operator>.</operator><name>google</name><operator>.</operator><name>inject</name><operator>.</operator><name>Inject</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>servlet</name><operator>.</operator><name>AuthFilter</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>servlet</name><operator>.</operator><name>HostnameFilter</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>eclipse</name><operator>.</operator><name>jetty</name><operator>.</operator><name>servlet</name><operator>.</operator><name>FilterHolder</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>eclipse</name><operator>.</operator><name>jetty</name><operator>.</operator><name>servlet</name><operator>.</operator><name>ServletContextHandler</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>eclipse</name><operator>.</operator><name>jetty</name><operator>.</operator><name>webapp</name><operator>.</operator><name>WebAppContext</name></name>;</import>

<import>import <name><name>javax</name><operator>.</operator><name>servlet</name><operator>.</operator><name>DispatcherType</name></name>;</import>
<import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>EnumSet</name></name>;</import>

<class><specifier>public</specifier> class <name>FilterMapper</name> <block>{
    <decl_stmt><decl><type><specifier>private</specifier> <specifier>final</specifier> <name>WebAppContext</name></type> <name>servletContextHandler</name></decl>;</decl_stmt>

    <constructor><annotation>@<name>Inject</name></annotation>
    <specifier>public</specifier> <name>FilterMapper</name><parameter_list>(<parameter><decl><type><specifier>final</specifier> <name>WebAppContext</name></type> <name>servletContextHandler</name></decl></parameter>)</parameter_list> <block>{<block_content>
        <expr_stmt><expr><name><name>this</name><operator>.</operator><name>servletContextHandler</name></name> <operator>=</operator> <call><name><name>Preconditions</name><operator>.</operator><name>checkNotNull</name></name><argument_list>(<argument><expr><name>servletContextHandler</name></expr></argument>, <argument><expr><literal type="string">"ServletContextHandler is null"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    </block_content>}</block></constructor>

    <comment type="block" format="javadoc">/**
     *  Map filters to endpoints. Make sure it in sync with ServletMapper when making changes
     * */</comment>
    <function><type><name>void</name></type> <name>addFilters</name><parameter_list>()</parameter_list> <block>{<block_content>
        <expr_stmt><expr><call><name>mapFilter</name><argument_list>(<argument><expr><operator>new</operator> <call><name>FilterHolder</name><argument_list>(<argument><expr><operator>new</operator> <call><name>HostnameFilter</name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr></argument>, <argument><expr><literal type="string">"/*"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <decl_stmt><decl><type><name>FilterHolder</name></type> <name>authFilter</name> <init>= <expr><operator>new</operator> <call><name>FilterHolder</name><argument_list>(<argument><expr><operator>new</operator> <call><name>AuthFilter</name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name>mapFilter</name><argument_list>(<argument><expr><name>authFilter</name></expr></argument>, <argument><expr><literal type="string">"/versions/*"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>mapFilter</name><argument_list>(<argument><expr><name>authFilter</name></expr></argument>, <argument><expr><literal type="string">"/v0/*"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>mapFilter</name><argument_list>(<argument><expr><name>authFilter</name></expr></argument>, <argument><expr><literal type="string">"/v1/*"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>mapFilter</name><argument_list>(<argument><expr><name>authFilter</name></expr></argument>, <argument><expr><literal type="string">"/v2/*"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>mapFilter</name><argument_list>(<argument><expr><name>authFilter</name></expr></argument>, <argument><expr><literal type="string">"/index.jsp"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>mapFilter</name><argument_list>(<argument><expr><name>authFilter</name></expr></argument>, <argument><expr><literal type="string">"/admin/*"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>mapFilter</name><argument_list>(<argument><expr><name>authFilter</name></expr></argument>, <argument><expr><literal type="string">"/*.js"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>mapFilter</name><argument_list>(<argument><expr><name>authFilter</name></expr></argument>, <argument><expr><literal type="string">"/ext-2.2/*"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>mapFilter</name><argument_list>(<argument><expr><name>authFilter</name></expr></argument>, <argument><expr><literal type="string">"/docs/*"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    </block_content>}</block></function>

    <function><type><specifier>private</specifier> <name>void</name></type> <name>mapFilter</name><parameter_list>(<parameter><decl><type><name>FilterHolder</name></type> <name>authFilter</name></decl></parameter>, <parameter><decl><type><name>String</name></type> <name>pathSpec</name></decl></parameter>)</parameter_list> <block>{<block_content>
        <expr_stmt><expr><call><name><name>servletContextHandler</name><operator>.</operator><name>addFilter</name></name><argument_list>(<argument><expr><name>authFilter</name></expr></argument>, <argument><expr><name>pathSpec</name></expr></argument>, <argument><expr><call><name><name>EnumSet</name><operator>.</operator><name>of</name></name><argument_list>(<argument><expr><name><name>DispatcherType</name><operator>.</operator><name>REQUEST</name></name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    </block_content>}</block></function>
}</block></class>
<expr_stmt><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>server</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>server</name><operator>/</operator><name><name>HttpConfigurationWrapper</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>server</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>server</name><operator>/</operator><name><name>HttpConfigurationWrapper</name><operator>.</operator><name>java</name></name>
<operator>new</operator> <name>file</name> <name>mode</name> <literal type="number">100644</literal>
<name>index</name> <literal type="number">000000000..0341f9cea</literal>
<operator>--</operator> <operator>/</operator><name>dev</name><operator>/</operator><literal type="null">null</literal>
<operator>++</operator> <name>b</name><operator>/</operator><name>server</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>server</name><operator>/</operator><name><name>HttpConfigurationWrapper</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">0</literal></expr><operator>,</operator><expr><literal type="number">0</literal> <operator>+</operator><literal type="number">1</literal></expr><operator>,</operator><expr><literal type="number">63</literal> @@</expr></expr_stmt>
<comment type="block" format="javadoc">/**
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */</comment>
<package>package <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>server</name></name>;</package>

<import>import <name><name>com</name><operator>.</operator><name>google</name><operator>.</operator><name>common</name><operator>.</operator><name>base</name><operator>.</operator><name>Preconditions</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>hadoop</name><operator>.</operator><name>conf</name><operator>.</operator><name>Configuration</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>eclipse</name><operator>.</operator><name>jetty</name><operator>.</operator><name>server</name><operator>.</operator><name>HttpConfiguration</name></name>;</import>

<comment type="block" format="javadoc">/**
 *  Class that wraps HTTP configuration settings.
 */</comment>
<class><specifier>public</specifier> class <name>HttpConfigurationWrapper</name> <block>{
    <decl_stmt><decl><type><specifier>public</specifier> <specifier>static</specifier> <specifier>final</specifier> <name>String</name></type> <name>OOZIE_HTTP_REQUEST_HEADER_SIZE</name> <init>= <expr><literal type="string">"oozie.http.request.header.size"</literal></expr></init></decl>;</decl_stmt>
    <decl_stmt><decl><type><specifier>public</specifier> <specifier>static</specifier> <specifier>final</specifier> <name>String</name></type> <name>OOZIE_HTTP_RESPONSE_HEADER_SIZE</name> <init>= <expr><literal type="string">"oozie.http.response.header.size"</literal></expr></init></decl>;</decl_stmt>
    <decl_stmt><decl><type><specifier>private</specifier> <name>Configuration</name></type> <name>conf</name></decl>;</decl_stmt>

    <constructor><specifier>public</specifier> <name>HttpConfigurationWrapper</name><parameter_list>(<parameter><decl><type><name>Configuration</name></type> <name>conf</name></decl></parameter>)</parameter_list> <block>{<block_content>
        <expr_stmt><expr><name><name>this</name><operator>.</operator><name>conf</name></name> <operator>=</operator> <call><name><name>Preconditions</name><operator>.</operator><name>checkNotNull</name></name><argument_list>(<argument><expr><name>conf</name></expr></argument>, <argument><expr><literal type="string">"conf"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    </block_content>}</block></constructor>

    <comment type="block" format="javadoc">/**
     * Set up and return default HTTP configuration for the Oozie server
     * @return default HttpConfiguration with the configured request and response header size
     */</comment>
    <function><type><specifier>public</specifier> <name>HttpConfiguration</name></type> <name>getDefaultHttpConfiguration</name><parameter_list>()</parameter_list> <block>{<block_content>
        <decl_stmt><decl><type><name>HttpConfiguration</name></type> <name>httpConfiguration</name> <init>= <expr><operator>new</operator> <call><name>HttpConfiguration</name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name><name>httpConfiguration</name><operator>.</operator><name>setRequestHeaderSize</name></name><argument_list>(
                <argument><expr><call><name>getConfigHeaderSize</name><argument_list>(<argument><expr><name>OOZIE_HTTP_REQUEST_HEADER_SIZE</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>httpConfiguration</name><operator>.</operator><name>setResponseHeaderSize</name></name><argument_list>(
                <argument><expr><call><name>getConfigHeaderSize</name><argument_list>(<argument><expr><name>OOZIE_HTTP_RESPONSE_HEADER_SIZE</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>httpConfiguration</name><operator>.</operator><name>setSendServerVersion</name></name><argument_list>(<argument><expr><literal type="boolean">false</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>httpConfiguration</name><operator>.</operator><name>setSendXPoweredBy</name></name><argument_list>(<argument><expr><literal type="boolean">false</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <return>return <expr><name>httpConfiguration</name></expr>;</return>
    </block_content>}</block></function>

    <function><type><specifier>private</specifier> <name>int</name></type> <name>getConfigHeaderSize</name><parameter_list>(<parameter><decl><type><name>String</name></type> <name>confVar</name></decl></parameter>)</parameter_list> <block>{<block_content>
        <decl_stmt><decl><type><name>String</name></type> <name>confHeaderSize</name> <init>= <expr><call><name><name>conf</name><operator>.</operator><name>get</name></name><argument_list>(<argument><expr><name>confVar</name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <decl_stmt><decl><type><name>int</name></type> <name>headerSize</name></decl>;</decl_stmt>
        <try>try <block>{<block_content>
            <expr_stmt><expr><name>headerSize</name> <operator>=</operator> <call><name><name>Integer</name><operator>.</operator><name>parseInt</name></name><argument_list>(<argument><expr><name>confHeaderSize</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        </block_content>}</block>
        <catch>catch <parameter_list>(<parameter><decl><type><specifier>final</specifier> <name>NumberFormatException</name></type> <name>nfe</name></decl></parameter>)</parameter_list> <block>{<block_content>
            <throw>throw <expr><operator>new</operator> <call><name>NumberFormatException</name><argument_list>(<argument><expr><call><name><name>String</name><operator>.</operator><name>format</name></name><argument_list>(<argument><expr><literal type="string">"Header size for %s \"%s\" ( '%s') is not an integer."</literal></expr></argument>,
                    <argument><expr><name>confVar</name></expr></argument>, <argument><expr><name>confVar</name></expr></argument>, <argument><expr><name>confHeaderSize</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</throw>
        </block_content>}</block></catch></try>
        <return>return <expr><name>headerSize</name></expr>;</return>
    </block_content>}</block></function>
}</block></class>
<expr_stmt><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>server</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>server</name><operator>/</operator><name><name>JspHandler</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>server</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>server</name><operator>/</operator><name><name>JspHandler</name><operator>.</operator><name>java</name></name>
<operator>new</operator> <name>file</name> <name>mode</name> <literal type="number">100644</literal>
<name>index</name> <literal type="number">000000000..9658fd698</literal>
<operator>--</operator> <operator>/</operator><name>dev</name><operator>/</operator><literal type="null">null</literal>
<operator>++</operator> <name>b</name><operator>/</operator><name>server</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>server</name><operator>/</operator><name><name>JspHandler</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">0</literal></expr><operator>,</operator><expr><literal type="number">0</literal> <operator>+</operator><literal type="number">1</literal></expr><operator>,</operator><expr><literal type="number">161</literal> @@</expr></expr_stmt>
<comment type="block" format="javadoc">/**
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */</comment>

<package>package <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>server</name></name>;</package>

<import>import <name><name>com</name><operator>.</operator><name>google</name><operator>.</operator><name>common</name><operator>.</operator><name>base</name><operator>.</operator><name>Preconditions</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>tomcat</name><operator>.</operator><name>InstanceManager</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>tomcat</name><operator>.</operator><name>SimpleInstanceManager</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>eclipse</name><operator>.</operator><name>jetty</name><operator>.</operator><name>annotations</name><operator>.</operator><name>ServletContainerInitializersStarter</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>eclipse</name><operator>.</operator><name>jetty</name><operator>.</operator><name>apache</name><operator>.</operator><name>jsp</name><operator>.</operator><name>JettyJasperInitializer</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>eclipse</name><operator>.</operator><name>jetty</name><operator>.</operator><name>jsp</name><operator>.</operator><name>JettyJspServlet</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>eclipse</name><operator>.</operator><name>jetty</name><operator>.</operator><name>plus</name><operator>.</operator><name>annotation</name><operator>.</operator><name>ContainerInitializer</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>eclipse</name><operator>.</operator><name>jetty</name><operator>.</operator><name>servlet</name><operator>.</operator><name>DefaultServlet</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>eclipse</name><operator>.</operator><name>jetty</name><operator>.</operator><name>servlet</name><operator>.</operator><name>ServletHolder</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>eclipse</name><operator>.</operator><name>jetty</name><operator>.</operator><name>webapp</name><operator>.</operator><name>WebAppContext</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>slf4j</name><operator>.</operator><name>Logger</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>slf4j</name><operator>.</operator><name>LoggerFactory</name></name>;</import>

<import>import <name><name>java</name><operator>.</operator><name>io</name><operator>.</operator><name>File</name></name>;</import>
<import>import <name><name>java</name><operator>.</operator><name>io</name><operator>.</operator><name>IOException</name></name>;</import>
<import>import <name><name>java</name><operator>.</operator><name>net</name><operator>.</operator><name>URI</name></name>;</import>
<import>import <name><name>java</name><operator>.</operator><name>net</name><operator>.</operator><name>URISyntaxException</name></name>;</import>
<import>import <name><name>java</name><operator>.</operator><name>net</name><operator>.</operator><name>URL</name></name>;</import>
<import>import <name><name>java</name><operator>.</operator><name>net</name><operator>.</operator><name>URLClassLoader</name></name>;</import>
<import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>ArrayList</name></name>;</import>
<import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>List</name></name>;</import>

<comment type="block" format="javadoc">/**
 * Helper class that is used to handle JSP requests in Oozie server.
 */</comment>
<class><specifier>public</specifier> class <name>JspHandler</name> <block>{
    <decl_stmt><decl><type><specifier>private</specifier> <specifier>static</specifier> <specifier>final</specifier> <name>Logger</name></type> <name>LOG</name> <init>= <expr><call><name><name>LoggerFactory</name><operator>.</operator><name>getLogger</name></name><argument_list>(<argument><expr><name><name>JspHandler</name><operator>.</operator><name>class</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
    <decl_stmt><decl><type><specifier>private</specifier> <specifier>final</specifier> <name>File</name></type> <name>scratchDir</name></decl>;</decl_stmt>
    <decl_stmt><decl><type><specifier>private</specifier> <specifier>final</specifier> <name>WebRootResourceLocator</name></type> <name>webRootResourceLocator</name></decl>;</decl_stmt>

    <constructor><specifier>public</specifier> <name>JspHandler</name><parameter_list>(<parameter><decl><type><specifier>final</specifier> <name>File</name></type> <name>scratchDir</name></decl></parameter>, <parameter><decl><type><specifier>final</specifier> <name>WebRootResourceLocator</name></type> <name>webRootResourceLocator</name></decl></parameter>)</parameter_list> <block>{<block_content>
        <expr_stmt><expr><name><name>this</name><operator>.</operator><name>scratchDir</name></name> <operator>=</operator> <name>scratchDir</name></expr>;</expr_stmt>
        <expr_stmt><expr><name><name>this</name><operator>.</operator><name>webRootResourceLocator</name></name> <operator>=</operator> <name>webRootResourceLocator</name></expr>;</expr_stmt>
    </block_content>}</block></constructor>

    <comment type="block" format="javadoc">/**
     * Establish Scratch directory for the servlet context (used by JSP compilation)
     */</comment>
    <function><type><specifier>private</specifier> <name>File</name></type> <name>getScratchDir</name><parameter_list>()</parameter_list> <throws>throws <argument><expr><name>IOException</name></expr></argument></throws>
    <block>{<block_content>
        <if_stmt><if>if <condition>(<expr><call><name><name>scratchDir</name><operator>.</operator><name>exists</name></name><argument_list>()</argument_list></call></expr>)</condition> <block>{<block_content>
            <expr_stmt><expr><call><name><name>LOG</name><operator>.</operator><name>info</name></name><argument_list>(<argument><expr><call><name><name>String</name><operator>.</operator><name>format</name></name><argument_list>(<argument><expr><literal type="string">"Scratch directory exists and will be reused: %s"</literal></expr></argument>, <argument><expr><call><name><name>scratchDir</name><operator>.</operator><name>getAbsolutePath</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <return>return <expr><name>scratchDir</name></expr>;</return>
        </block_content>}</block></if></if_stmt>

        <if_stmt><if>if <condition>(<expr><operator>!</operator><call><name><name>scratchDir</name><operator>.</operator><name>mkdirs</name></name><argument_list>()</argument_list></call></expr>)</condition> <block>{<block_content>
            <throw>throw <expr><operator>new</operator> <call><name>IOException</name><argument_list>(<argument><expr><literal type="string">"Unable to create scratch directory: "</literal> <operator>+</operator> <name>scratchDir</name></expr></argument>)</argument_list></call></expr>;</throw>
        </block_content>}</block></if></if_stmt>

        <expr_stmt><expr><call><name><name>LOG</name><operator>.</operator><name>info</name></name><argument_list>(<argument><expr><call><name><name>String</name><operator>.</operator><name>format</name></name><argument_list>(<argument><expr><literal type="string">"Scratch directory created: %s"</literal></expr></argument>, <argument><expr><call><name><name>scratchDir</name><operator>.</operator><name>getAbsolutePath</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <return>return <expr><name>scratchDir</name></expr>;</return>
    </block_content>}</block></function>

    <comment type="block" format="javadoc">/**
     * Setup the basic application "context" for this application at "/"
     * This is also known as the handler tree (in jetty speak)
     */</comment>
    <function><type><specifier>public</specifier> <name>void</name></type> <name>setupWebAppContext</name><parameter_list>(<parameter><decl><type><name>WebAppContext</name></type> <name>servletContextHandler</name></decl></parameter>)</parameter_list>
            <throws>throws <argument><expr><name>IOException</name></expr></argument>, <argument><expr><name>URISyntaxException</name></expr></argument></throws>
    <block>{<block_content>
        <expr_stmt><expr><call><name><name>Preconditions</name><operator>.</operator><name>checkNotNull</name></name><argument_list>(<argument><expr><name>servletContextHandler</name></expr></argument>, <argument><expr><literal type="string">"servletContextHandler is null"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <decl_stmt><decl><type><name>File</name></type> <name>scratchDir</name> <init>= <expr><call><name>getScratchDir</name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name><name>servletContextHandler</name><operator>.</operator><name>setAttribute</name></name><argument_list>(<argument><expr><literal type="string">"javax.servlet.context.tempdir"</literal></expr></argument>, <argument><expr><name>scratchDir</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>servletContextHandler</name><operator>.</operator><name>setAttribute</name></name><argument_list>(<argument><expr><literal type="string">"org.eclipse.jetty.server.webapp.ContainerIncludeJarPattern"</literal></expr></argument>,
                <argument><expr><literal type="string">".*/[^/]*servlet-api-[^/]*\\.jar$|.*/javax.servlet.jsp.jstl-.*\\.jar$|.*/.*taglibs.*\\.jar$"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <decl_stmt><decl><type><name>URI</name></type> <name>baseUri</name> <init>= <expr><call><name><name>webRootResourceLocator</name><operator>.</operator><name>getWebRootResourceUri</name></name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name><name>servletContextHandler</name><operator>.</operator><name>setResourceBase</name></name><argument_list>(<argument><expr><call><name><name>baseUri</name><operator>.</operator><name>toASCIIString</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>servletContextHandler</name><operator>.</operator><name>setAttribute</name></name><argument_list>(<argument><expr><literal type="string">"org.eclipse.jetty.containerInitializers"</literal></expr></argument>, <argument><expr><call><name>jspInitializers</name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>servletContextHandler</name><operator>.</operator><name>setAttribute</name></name><argument_list>(<argument><expr><call><name><name>InstanceManager</name><operator>.</operator><name><name>class</name><operator>.</operator><name>getName</name></name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><operator>new</operator> <call><name>SimpleInstanceManager</name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>servletContextHandler</name><operator>.</operator><name>addBean</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>ServletContainerInitializersStarter</name><argument_list>(<argument><expr><name>servletContextHandler</name></expr></argument>)</argument_list></call></expr></argument>, <argument><expr><literal type="boolean">true</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>servletContextHandler</name><operator>.</operator><name>setClassLoader</name></name><argument_list>(<argument><expr><call><name>getUrlClassLoader</name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <expr_stmt><expr><call><name><name>servletContextHandler</name><operator>.</operator><name>addServlet</name></name><argument_list>(<argument><expr><call><name>jspServletHolder</name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><literal type="string">"*.jsp"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <expr_stmt><expr><call><name><name>servletContextHandler</name><operator>.</operator><name>addServlet</name></name><argument_list>(<argument><expr><call><name>jspFileMappedServletHolder</name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><literal type="string">"/oozie/"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>servletContextHandler</name><operator>.</operator><name>addServlet</name></name><argument_list>(<argument><expr><call><name>defaultServletHolder</name><argument_list>(<argument><expr><name>baseUri</name></expr></argument>)</argument_list></call></expr></argument>, <argument><expr><literal type="string">"/"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    </block_content>}</block></function>

    <comment type="block" format="javadoc">/**
     * Ensure the jsp engine is initialized correctly
     */</comment>
    <function><type><specifier>private</specifier> <name><name>List</name><argument_list type="generic">&lt;<argument><name>ContainerInitializer</name></argument>&gt;</argument_list></name></type> <name>jspInitializers</name><parameter_list>()</parameter_list>
    <block>{<block_content>
        <decl_stmt><decl><type><name>JettyJasperInitializer</name></type> <name>sci</name> <init>= <expr><operator>new</operator> <call><name>JettyJasperInitializer</name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
        <decl_stmt><decl><type><name>ContainerInitializer</name></type> <name>initializer</name> <init>= <expr><operator>new</operator> <call><name>ContainerInitializer</name><argument_list>(<argument><expr><name>sci</name></expr></argument>, <argument><expr><literal type="null">null</literal></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <decl_stmt><decl><type><name><name>List</name><argument_list type="generic">&lt;<argument><name>ContainerInitializer</name></argument>&gt;</argument_list></name></type> <name>initializers</name> <init>= <expr><operator>new</operator> <call><name><name>ArrayList</name><argument_list type="generic">&lt;&gt;</argument_list></name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name><name>initializers</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>initializer</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <return>return <expr><name>initializers</name></expr>;</return>
    </block_content>}</block></function>

    <comment type="block" format="javadoc">/**
     * Set Classloader of Context to be sane (needed for JSTL)
     * JSP requires a non-System classloader, this simply wraps the
     * embedded System classloader in a way that makes it suitable
     * for JSP to use
     */</comment>
    <function><type><specifier>private</specifier> <name>ClassLoader</name></type> <name>getUrlClassLoader</name><parameter_list>()</parameter_list>
    <block>{<block_content>
        <decl_stmt><decl><type><name>ClassLoader</name></type> <name>jspClassLoader</name> <init>= <expr><operator>new</operator> <call><name>URLClassLoader</name><argument_list>(<argument><expr><operator>new</operator> <name><name>URL</name><index>[<expr><literal type="number">0</literal></expr>]</index></name></expr></argument>, <argument><expr><call><name><name>this</name><operator>.</operator><name>getClass</name></name><argument_list>()</argument_list></call><operator>.</operator><call><name>getClassLoader</name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <return>return <expr><name>jspClassLoader</name></expr>;</return>
    </block_content>}</block></function>

    <comment type="block" format="javadoc">/**
     * Create JSP Servlet (must be named "jsp")
     */</comment>
    <function><type><specifier>private</specifier> <name>ServletHolder</name></type> <name>jspServletHolder</name><parameter_list>()</parameter_list>
    <block>{<block_content>
        <decl_stmt><decl><type><name>ServletHolder</name></type> <name>holderJsp</name> <init>= <expr><operator>new</operator> <call><name>ServletHolder</name><argument_list>(<argument><expr><literal type="string">"jsp"</literal></expr></argument>, <argument><expr><name><name>JettyJspServlet</name><operator>.</operator><name>class</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name><name>holderJsp</name><operator>.</operator><name>setInitOrder</name></name><argument_list>(<argument><expr><literal type="number">0</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>holderJsp</name><operator>.</operator><name>setInitParameter</name></name><argument_list>(<argument><expr><literal type="string">"logVerbosityLevel"</literal></expr></argument>, <argument><expr><literal type="string">"DEBUG"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>holderJsp</name><operator>.</operator><name>setInitParameter</name></name><argument_list>(<argument><expr><literal type="string">"fork"</literal></expr></argument>, <argument><expr><literal type="string">"false"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>holderJsp</name><operator>.</operator><name>setInitParameter</name></name><argument_list>(<argument><expr><literal type="string">"xpoweredBy"</literal></expr></argument>, <argument><expr><literal type="string">"false"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>holderJsp</name><operator>.</operator><name>setInitParameter</name></name><argument_list>(<argument><expr><literal type="string">"compilerTargetVM"</literal></expr></argument>, <argument><expr><literal type="string">"1.7"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>holderJsp</name><operator>.</operator><name>setInitParameter</name></name><argument_list>(<argument><expr><literal type="string">"compilerSourceVM"</literal></expr></argument>, <argument><expr><literal type="string">"1.7"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>holderJsp</name><operator>.</operator><name>setInitParameter</name></name><argument_list>(<argument><expr><literal type="string">"keepgenerated"</literal></expr></argument>, <argument><expr><literal type="string">"true"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <return>return <expr><name>holderJsp</name></expr>;</return>
    </block_content>}</block></function>

    <comment type="block" format="javadoc">/**
     * Create Example of mapping jsp to path spec
     */</comment>
    <function><type><specifier>private</specifier> <name>ServletHolder</name></type> <name>jspFileMappedServletHolder</name><parameter_list>()</parameter_list>
    <block>{<block_content>
        <decl_stmt><decl><type><name>ServletHolder</name></type> <name>holderAltMapping</name> <init>= <expr><operator>new</operator> <call><name>ServletHolder</name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name><name>holderAltMapping</name><operator>.</operator><name>setName</name></name><argument_list>(<argument><expr><literal type="string">"index.jsp"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>holderAltMapping</name><operator>.</operator><name>setForcedPath</name></name><argument_list>(<argument><expr><literal type="string">"/index.jsp"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <return>return <expr><name>holderAltMapping</name></expr>;</return>
    </block_content>}</block></function>

    <comment type="block" format="javadoc">/**
     * Create Default Servlet (must be named "default")
     */</comment>
    <function><type><specifier>private</specifier> <name>ServletHolder</name></type> <name>defaultServletHolder</name><parameter_list>(<parameter><decl><type><name>URI</name></type> <name>baseUri</name></decl></parameter>)</parameter_list>
    <block>{<block_content>
        <decl_stmt><decl><type><name>ServletHolder</name></type> <name>holderDefault</name> <init>= <expr><operator>new</operator> <call><name>ServletHolder</name><argument_list>(<argument><expr><literal type="string">"default"</literal></expr></argument>, <argument><expr><name><name>DefaultServlet</name><operator>.</operator><name>class</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name><name>holderDefault</name><operator>.</operator><name>setInitParameter</name></name><argument_list>(<argument><expr><literal type="string">"resourceBase"</literal></expr></argument>, <argument><expr><call><name><name>baseUri</name><operator>.</operator><name>toASCIIString</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>holderDefault</name><operator>.</operator><name>setInitParameter</name></name><argument_list>(<argument><expr><literal type="string">"dirAllowed"</literal></expr></argument>, <argument><expr><literal type="string">"true"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <return>return <expr><name>holderDefault</name></expr>;</return>
    </block_content>}</block></function>
}</block></class>
<expr_stmt><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>server</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>server</name><operator>/</operator><name><name>SSLServerConnectorFactory</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>server</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>server</name><operator>/</operator><name><name>SSLServerConnectorFactory</name><operator>.</operator><name>java</name></name>
<operator>new</operator> <name>file</name> <name>mode</name> <literal type="number">100644</literal>
<name>index</name> <literal type="number">000000000..2797cf433</literal>
<operator>--</operator> <operator>/</operator><name>dev</name><operator>/</operator><literal type="null">null</literal>
<operator>++</operator> <name>b</name><operator>/</operator><name>server</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>server</name><operator>/</operator><name><name>SSLServerConnectorFactory</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">0</literal></expr><operator>,</operator><expr><literal type="number">0</literal> <operator>+</operator><literal type="number">1</literal></expr><operator>,</operator><expr><literal type="number">136</literal> @@</expr></expr_stmt>
<comment type="block" format="javadoc">/**
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */</comment>

<package>package <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>server</name></name>;</package>


<import>import <name><name>com</name><operator>.</operator><name>google</name><operator>.</operator><name>common</name><operator>.</operator><name>base</name><operator>.</operator><name>Preconditions</name></name>;</import>
<import>import <name><name>com</name><operator>.</operator><name>google</name><operator>.</operator><name>inject</name><operator>.</operator><name>Inject</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>hadoop</name><operator>.</operator><name>conf</name><operator>.</operator><name>Configuration</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>eclipse</name><operator>.</operator><name>jetty</name><operator>.</operator><name>http</name><operator>.</operator><name>HttpVersion</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>eclipse</name><operator>.</operator><name>jetty</name><operator>.</operator><name>server</name><operator>.</operator><name>HttpConfiguration</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>eclipse</name><operator>.</operator><name>jetty</name><operator>.</operator><name>server</name><operator>.</operator><name>HttpConnectionFactory</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>eclipse</name><operator>.</operator><name>jetty</name><operator>.</operator><name>server</name><operator>.</operator><name>SecureRequestCustomizer</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>eclipse</name><operator>.</operator><name>jetty</name><operator>.</operator><name>server</name><operator>.</operator><name>Server</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>eclipse</name><operator>.</operator><name>jetty</name><operator>.</operator><name>server</name><operator>.</operator><name>ServerConnector</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>eclipse</name><operator>.</operator><name>jetty</name><operator>.</operator><name>server</name><operator>.</operator><name>SslConnectionFactory</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>eclipse</name><operator>.</operator><name>jetty</name><operator>.</operator><name>util</name><operator>.</operator><name>ssl</name><operator>.</operator><name>SslContextFactory</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>slf4j</name><operator>.</operator><name>Logger</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>slf4j</name><operator>.</operator><name>LoggerFactory</name></name>;</import>

<import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>Arrays</name></name>;</import>

<comment type="block" format="javadoc">/**
 * Factory that is used to configure SSL settings for the Oozie server.
 */</comment>
<class>class <name>SSLServerConnectorFactory</name> <block>{
    <decl_stmt><decl><type><specifier>private</specifier> <specifier>static</specifier> <specifier>final</specifier> <name>Logger</name></type> <name>LOG</name> <init>= <expr><call><name><name>LoggerFactory</name><operator>.</operator><name>getLogger</name></name><argument_list>(<argument><expr><name><name>SSLServerConnectorFactory</name><operator>.</operator><name>class</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
    <decl_stmt><decl><type><specifier>public</specifier> <specifier>static</specifier> <specifier>final</specifier> <name>String</name></type> <name>OOZIE_HTTPS_TRUSTSTORE_FILE</name> <init>= <expr><literal type="string">"oozie.https.truststore.file"</literal></expr></init></decl>;</decl_stmt>
    <decl_stmt><decl><type><specifier>public</specifier> <specifier>static</specifier> <specifier>final</specifier> <name>String</name></type> <name>OOZIE_HTTPS_TRUSTSTORE_PASS</name> <init>= <expr><literal type="string">"oozie.https.truststore.pass"</literal></expr></init></decl>;</decl_stmt>
    <decl_stmt><decl><type><specifier>public</specifier> <specifier>static</specifier> <specifier>final</specifier> <name>String</name></type> <name>OOZIE_HTTPS_KEYSTORE_PASS</name> <init>= <expr><literal type="string">"oozie.https.keystore.pass"</literal></expr></init></decl>;</decl_stmt>
    <decl_stmt><decl><type><specifier>public</specifier> <specifier>static</specifier> <specifier>final</specifier> <name>String</name></type> <name>OOZIE_HTTPS_KEYSTORE_FILE</name> <init>= <expr><literal type="string">"oozie.https.keystore.file"</literal></expr></init></decl>;</decl_stmt>

    <decl_stmt><decl><type><specifier>private</specifier> <name>SslContextFactory</name></type> <name>sslContextFactory</name></decl>;</decl_stmt>
    <decl_stmt><decl><type><specifier>private</specifier> <name>Configuration</name></type> <name>conf</name></decl>;</decl_stmt>

    <constructor><annotation>@<name>Inject</name></annotation>
    <specifier>public</specifier> <name>SSLServerConnectorFactory</name><parameter_list>(<parameter><decl><type><specifier>final</specifier> <name>SslContextFactory</name></type> <name>sslContextFactory</name></decl></parameter>)</parameter_list> <block>{<block_content>
        <expr_stmt><expr><name><name>this</name><operator>.</operator><name>sslContextFactory</name></name> <operator>=</operator> <call><name><name>Preconditions</name><operator>.</operator><name>checkNotNull</name></name><argument_list>(<argument><expr><name>sslContextFactory</name></expr></argument>,  <argument><expr><literal type="string">"sslContextFactory is null"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    </block_content>}</block></constructor>

    <comment type="block" format="javadoc">/**
     *  Construct a ServerConnector object with SSL settings
     *
     *  @param oozieHttpsPort Oozie HTTPS port
     *  @param conf Oozie configuration
     *  @param server jetty Server which the connector is attached to
     *
     *  @return ServerConnector
    */</comment>
    <function><type><specifier>public</specifier> <name>ServerConnector</name></type> <name>createSecureServerConnector</name><parameter_list>(<parameter><decl><type><name>int</name></type> <name>oozieHttpsPort</name></decl></parameter>, <parameter><decl><type><name>Configuration</name></type> <name>conf</name></decl></parameter>, <parameter><decl><type><name>Server</name></type> <name>server</name></decl></parameter>)</parameter_list> <block>{<block_content>
        <expr_stmt><expr><name><name>this</name><operator>.</operator><name>conf</name></name> <operator>=</operator> <call><name><name>Preconditions</name><operator>.</operator><name>checkNotNull</name></name><argument_list>(<argument><expr><name>conf</name></expr></argument>, <argument><expr><literal type="string">"conf is null"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>Preconditions</name><operator>.</operator><name>checkNotNull</name></name><argument_list>(<argument><expr><name>server</name></expr></argument>, <argument><expr><literal type="string">"server is null"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>Preconditions</name><operator>.</operator><name>checkState</name></name><argument_list>(<argument><expr><name>oozieHttpsPort</name> <operator>&gt;=</operator> <literal type="number">1</literal> <operator>&amp;&amp;</operator> <name>oozieHttpsPort</name> <operator>&lt;=</operator> <literal type="number">65535</literal></expr></argument>,
                <argument><expr><call><name><name>String</name><operator>.</operator><name>format</name></name><argument_list>(<argument><expr><literal type="string">"Invalid port number specified: \'%d\'. It should be between 1 and 65535."</literal></expr></argument>, <argument><expr><name>oozieHttpsPort</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <expr_stmt><expr><call><name>setIncludeProtocols</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>setCipherSuites</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>setTrustStorePath</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>setTrustStorePass</name><argument_list>()</argument_list></call></expr>;</expr_stmt>

        <expr_stmt><expr><call><name>setKeyStoreFile</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>setKeystorePass</name><argument_list>()</argument_list></call></expr>;</expr_stmt>

        <decl_stmt><decl><type><name>HttpConfiguration</name></type> <name>httpsConfiguration</name> <init>= <expr><call><name>getHttpsConfiguration</name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
        <decl_stmt><decl><type><name>ServerConnector</name></type> <name>secureServerConnector</name> <init>= <expr><operator>new</operator> <call><name>ServerConnector</name><argument_list>(<argument><expr><name>server</name></expr></argument>,
                <argument><expr><operator>new</operator> <call><name>SslConnectionFactory</name><argument_list>(<argument><expr><name>sslContextFactory</name></expr></argument>, <argument><expr><call><name><name>HttpVersion</name><operator>.</operator><name>HTTP_1_1</name><operator>.</operator><name>asString</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr></argument>,
                <argument><expr><operator>new</operator> <call><name>HttpConnectionFactory</name><argument_list>(<argument><expr><name>httpsConfiguration</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>

        <expr_stmt><expr><call><name><name>secureServerConnector</name><operator>.</operator><name>setPort</name></name><argument_list>(<argument><expr><name>oozieHttpsPort</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <expr_stmt><expr><call><name><name>LOG</name><operator>.</operator><name>info</name></name><argument_list>(<argument><expr><call><name><name>String</name><operator>.</operator><name>format</name></name><argument_list>(<argument><expr><literal type="string">"Secure server connector created, listenning on port %d"</literal></expr></argument>, <argument><expr><name>oozieHttpsPort</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <return>return <expr><name>secureServerConnector</name></expr>;</return>
    </block_content>}</block></function>

    <function><type><specifier>private</specifier> <name>void</name></type> <name>setCipherSuites</name><parameter_list>()</parameter_list> <block>{<block_content>
        <decl_stmt><decl><type><name>String</name></type> <name>excludeCipherList</name> <init>= <expr><call><name><name>conf</name><operator>.</operator><name>get</name></name><argument_list>(<argument><expr><literal type="string">"oozie.https.exclude.cipher.suites"</literal></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <decl_stmt><decl><type><name><name>String</name><index>[]</index></name></type> <name>excludeCipherSuites</name> <init>= <expr><call><name><name>excludeCipherList</name><operator>.</operator><name>split</name></name><argument_list>(<argument><expr><literal type="string">","</literal></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name><name>sslContextFactory</name><operator>.</operator><name>setExcludeCipherSuites</name></name><argument_list>(<argument><expr><name>excludeCipherSuites</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <expr_stmt><expr><call><name><name>LOG</name><operator>.</operator><name>info</name></name><argument_list>(<argument><expr><call><name><name>String</name><operator>.</operator><name>format</name></name><argument_list>(<argument><expr><literal type="string">"SSL context - excluding cipher suites: %s"</literal></expr></argument>, <argument><expr><call><name><name>Arrays</name><operator>.</operator><name>toString</name></name><argument_list>(<argument><expr><name>excludeCipherSuites</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    </block_content>}</block></function>

    <function><type><specifier>private</specifier> <name>void</name></type> <name>setIncludeProtocols</name><parameter_list>()</parameter_list> <block>{<block_content>
        <decl_stmt><decl><type><name>String</name></type> <name>enabledProtocolsList</name> <init>= <expr><call><name><name>conf</name><operator>.</operator><name>get</name></name><argument_list>(<argument><expr><literal type="string">"oozie.https.include.protocols"</literal></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <decl_stmt><decl><type><name><name>String</name><index>[]</index></name></type> <name>enabledProtocols</name> <init>= <expr><call><name><name>enabledProtocolsList</name><operator>.</operator><name>split</name></name><argument_list>(<argument><expr><literal type="string">","</literal></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name><name>sslContextFactory</name><operator>.</operator><name>setIncludeProtocols</name></name><argument_list>(<argument><expr><name>enabledProtocols</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <expr_stmt><expr><call><name><name>LOG</name><operator>.</operator><name>info</name></name><argument_list>(<argument><expr><call><name><name>String</name><operator>.</operator><name>format</name></name><argument_list>(<argument><expr><literal type="string">"SSL context - including protocols: %s"</literal></expr></argument>, <argument><expr><call><name><name>Arrays</name><operator>.</operator><name>toString</name></name><argument_list>(<argument><expr><name>enabledProtocols</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    </block_content>}</block></function>

    <function><type><specifier>private</specifier> <name>void</name></type> <name>setTrustStorePath</name><parameter_list>()</parameter_list> <block>{<block_content>
        <decl_stmt><decl><type><name>String</name></type> <name>trustStorePath</name> <init>= <expr><call><name><name>conf</name><operator>.</operator><name>get</name></name><argument_list>(<argument><expr><name>OOZIE_HTTPS_TRUSTSTORE_FILE</name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name><name>Preconditions</name><operator>.</operator><name>checkNotNull</name></name><argument_list>(<argument><expr><name>trustStorePath</name></expr></argument>, <argument><expr><literal type="string">"trustStorePath is null"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>sslContextFactory</name><operator>.</operator><name>setTrustStorePath</name></name><argument_list>(<argument><expr><name>trustStorePath</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    </block_content>}</block></function>

    <function><type><specifier>private</specifier> <name>void</name></type> <name>setTrustStorePass</name><parameter_list>()</parameter_list> <block>{<block_content>
        <decl_stmt><decl><type><name>String</name></type> <name>trustStorePass</name> <init>= <expr><call><name><name>conf</name><operator>.</operator><name>get</name></name><argument_list>(<argument><expr><name>OOZIE_HTTPS_TRUSTSTORE_PASS</name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name><name>Preconditions</name><operator>.</operator><name>checkNotNull</name></name><argument_list>(<argument><expr><name>trustStorePass</name></expr></argument>, <argument><expr><literal type="string">"setTrustStorePass is null"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>sslContextFactory</name><operator>.</operator><name>setTrustStorePassword</name></name><argument_list>(<argument><expr><name>trustStorePass</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    </block_content>}</block></function>

    <function><type><specifier>private</specifier> <name>void</name></type> <name>setKeystorePass</name><parameter_list>()</parameter_list> <block>{<block_content>
        <decl_stmt><decl><type><name>String</name></type> <name>keystorePass</name> <init>= <expr><call><name><name>conf</name><operator>.</operator><name>get</name></name><argument_list>(<argument><expr><name>OOZIE_HTTPS_KEYSTORE_PASS</name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name><name>Preconditions</name><operator>.</operator><name>checkNotNull</name></name><argument_list>(<argument><expr><name>keystorePass</name></expr></argument>, <argument><expr><literal type="string">"keystorePass is null"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>sslContextFactory</name><operator>.</operator><name>setKeyManagerPassword</name></name><argument_list>(<argument><expr><name>keystorePass</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    </block_content>}</block></function>

    <function><type><specifier>private</specifier> <name>void</name></type> <name>setKeyStoreFile</name><parameter_list>()</parameter_list> <block>{<block_content>
        <decl_stmt><decl><type><name>String</name></type> <name>keystoreFile</name> <init>= <expr><call><name><name>conf</name><operator>.</operator><name>get</name></name><argument_list>(<argument><expr><name>OOZIE_HTTPS_KEYSTORE_FILE</name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name><name>Preconditions</name><operator>.</operator><name>checkNotNull</name></name><argument_list>(<argument><expr><name>keystoreFile</name></expr></argument>, <argument><expr><literal type="string">"keystoreFile is null"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>sslContextFactory</name><operator>.</operator><name>setKeyStorePath</name></name><argument_list>(<argument><expr><name>keystoreFile</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    </block_content>}</block></function>

    <function><type><specifier>private</specifier> <name>HttpConfiguration</name></type> <name>getHttpsConfiguration</name><parameter_list>()</parameter_list> <block>{<block_content>
        <decl_stmt><decl><type><name>HttpConfiguration</name></type> <name>https</name> <init>= <expr><operator>new</operator> <call><name>HttpConfigurationWrapper</name><argument_list>(<argument><expr><name>conf</name></expr></argument>)</argument_list></call><operator>.</operator><call><name>getDefaultHttpConfiguration</name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name><name>https</name><operator>.</operator><name>setSecureScheme</name></name><argument_list>(<argument><expr><literal type="string">"https"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>https</name><operator>.</operator><name>addCustomizer</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>SecureRequestCustomizer</name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <return>return <expr><name>https</name></expr>;</return>
    </block_content>}</block></function>
}</block></class>
<expr_stmt><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>server</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>server</name><operator>/</operator><name><name>ServletMapper</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>server</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>server</name><operator>/</operator><name><name>ServletMapper</name><operator>.</operator><name>java</name></name>
<operator>new</operator> <name>file</name> <name>mode</name> <literal type="number">100644</literal>
<name>index</name> <literal type="number">000000000..ae27ac3d5</literal>
<operator>--</operator> <operator>/</operator><name>dev</name><operator>/</operator><literal type="null">null</literal>
<operator>++</operator> <name>b</name><operator>/</operator><name>server</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>server</name><operator>/</operator><name><name>ServletMapper</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">0</literal></expr><operator>,</operator><expr><literal type="number">0</literal> <operator>+</operator><literal type="number">1</literal></expr><operator>,</operator><expr><literal type="number">95</literal> @@</expr></expr_stmt>
<comment type="block" format="javadoc">/**
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */</comment>

<package>package <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>server</name></name>;</package>

<import>import <name><name>com</name><operator>.</operator><name>google</name><operator>.</operator><name>common</name><operator>.</operator><name>base</name><operator>.</operator><name>Preconditions</name></name>;</import>
<import>import <name><name>com</name><operator>.</operator><name>google</name><operator>.</operator><name>inject</name><operator>.</operator><name>Inject</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>servlet</name><operator>.</operator><name>CallbackServlet</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>servlet</name><operator>.</operator><name>SLAServlet</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>servlet</name><operator>.</operator><name>V0AdminServlet</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>servlet</name><operator>.</operator><name>V0JobServlet</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>servlet</name><operator>.</operator><name>V0JobsServlet</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>servlet</name><operator>.</operator><name>V1AdminServlet</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>servlet</name><operator>.</operator><name>V1JobServlet</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>servlet</name><operator>.</operator><name>V2AdminServlet</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>servlet</name><operator>.</operator><name>V2JobServlet</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>servlet</name><operator>.</operator><name>V2SLAServlet</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>servlet</name><operator>.</operator><name>V2ValidateServlet</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>servlet</name><operator>.</operator><name>VersionServlet</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>eclipse</name><operator>.</operator><name>jetty</name><operator>.</operator><name>servlet</name><operator>.</operator><name>ServletHandler</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>eclipse</name><operator>.</operator><name>jetty</name><operator>.</operator><name>servlet</name><operator>.</operator><name>ServletHolder</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>eclipse</name><operator>.</operator><name>jetty</name><operator>.</operator><name>servlet</name><operator>.</operator><name>ServletMapping</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>eclipse</name><operator>.</operator><name>jetty</name><operator>.</operator><name>webapp</name><operator>.</operator><name>WebAppContext</name></name>;</import>

<import>import <name><name>javax</name><operator>.</operator><name>servlet</name><operator>.</operator><name>Servlet</name></name>;</import>


<class><specifier>public</specifier> class <name>ServletMapper</name> <block>{
    <decl_stmt><decl><type><specifier>private</specifier> <specifier>final</specifier> <name>WebAppContext</name></type> <name>servletContextHandler</name></decl>;</decl_stmt>

    <constructor><annotation>@<name>Inject</name></annotation>
    <specifier>public</specifier> <name>ServletMapper</name><parameter_list>(<parameter><decl><type><specifier>final</specifier> <name>WebAppContext</name></type> <name>servletContextHandler</name></decl></parameter>)</parameter_list> <block>{<block_content>
        <expr_stmt><expr><name><name>this</name><operator>.</operator><name>servletContextHandler</name></name> <operator>=</operator> <call><name><name>Preconditions</name><operator>.</operator><name>checkNotNull</name></name><argument_list>(<argument><expr><name>servletContextHandler</name></expr></argument>, <argument><expr><literal type="string">"ServletContextHandler is null"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    </block_content>}</block></constructor>
    <comment type="block" format="javadoc">/**
     * Maps Oozie servlets to path specs. Make sure it is in sync with FilterMapper when making changes.
     * */</comment>
    <function><type><name>void</name></type> <name>mapOozieServlets</name><parameter_list>()</parameter_list> <block>{<block_content>
        <expr_stmt><expr><call><name>mapServlet</name><argument_list>(<argument><expr><name><name>VersionServlet</name><operator>.</operator><name>class</name></name></expr></argument>, <argument><expr><literal type="string">"/versions"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>mapServlet</name><argument_list>(<argument><expr><name><name>V0AdminServlet</name><operator>.</operator><name>class</name></name></expr></argument>, <argument><expr><literal type="string">"/v0/admin/*"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>mapServlet</name><argument_list>(<argument><expr><name><name>V1AdminServlet</name><operator>.</operator><name>class</name></name></expr></argument>, <argument><expr><literal type="string">"/v1/admin/*"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>mapServlet</name><argument_list>(<argument><expr><name><name>V2AdminServlet</name><operator>.</operator><name>class</name></name></expr></argument>, <argument><expr><literal type="string">"/v2/admin/*"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <expr_stmt><expr><call><name>mapServlet</name><argument_list>(<argument><expr><name><name>CallbackServlet</name><operator>.</operator><name>class</name></name></expr></argument>, <argument><expr><literal type="string">"/callback/*"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <decl_stmt><decl><type><name>ServletHandler</name></type> <name>servletHandler</name> <init>= <expr><call><name><name>servletContextHandler</name><operator>.</operator><name>getServletHandler</name></name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
        <decl_stmt><decl><type><name>String</name></type> <name>voJobservletName</name> <init>= <expr><call><name><name>V0JobsServlet</name><operator>.</operator><name><name>class</name><operator>.</operator><name>getSimpleName</name></name></name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name><name>servletHandler</name><operator>.</operator><name>addServlet</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>ServletHolder</name><argument_list>(<argument><expr><name>voJobservletName</name></expr></argument>, <argument><expr><operator>new</operator> <call><name>V0JobsServlet</name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <decl_stmt><decl><type><name>ServletMapping</name></type> <name>jobServletMappingV0</name> <init>= <expr><operator>new</operator> <call><name>ServletMapping</name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name><name>jobServletMappingV0</name><operator>.</operator><name>setPathSpec</name></name><argument_list>(<argument><expr><literal type="string">"/v0/jobs"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>jobServletMappingV0</name><operator>.</operator><name>setServletName</name></name><argument_list>(<argument><expr><name>voJobservletName</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <decl_stmt><decl><type><name>ServletMapping</name></type> <name>jobServletMappingV1</name> <init>= <expr><operator>new</operator> <call><name>ServletMapping</name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name><name>jobServletMappingV1</name><operator>.</operator><name>setPathSpec</name></name><argument_list>(<argument><expr><literal type="string">"/v1/jobs"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>jobServletMappingV1</name><operator>.</operator><name>setServletName</name></name><argument_list>(<argument><expr><name>voJobservletName</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <decl_stmt><decl><type><name>ServletMapping</name></type> <name>jobServletMappingV2</name> <init>= <expr><operator>new</operator> <call><name>ServletMapping</name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name><name>jobServletMappingV2</name><operator>.</operator><name>setPathSpec</name></name><argument_list>(<argument><expr><literal type="string">"/v2/jobs"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>jobServletMappingV2</name><operator>.</operator><name>setServletName</name></name><argument_list>(<argument><expr><name>voJobservletName</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <expr_stmt><expr><call><name><name>servletHandler</name><operator>.</operator><name>addServletMapping</name></name><argument_list>(<argument><expr><name>jobServletMappingV0</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>servletHandler</name><operator>.</operator><name>addServletMapping</name></name><argument_list>(<argument><expr><name>jobServletMappingV1</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>servletHandler</name><operator>.</operator><name>addServletMapping</name></name><argument_list>(<argument><expr><name>jobServletMappingV2</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <expr_stmt><expr><call><name>mapServlet</name><argument_list>(<argument><expr><name><name>V0JobServlet</name><operator>.</operator><name>class</name></name></expr></argument>, <argument><expr><literal type="string">"/v0/job/*"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>mapServlet</name><argument_list>(<argument><expr><name><name>V1JobServlet</name><operator>.</operator><name>class</name></name></expr></argument>, <argument><expr><literal type="string">"/v1/job/*"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>mapServlet</name><argument_list>(<argument><expr><name><name>V2JobServlet</name><operator>.</operator><name>class</name></name></expr></argument>, <argument><expr><literal type="string">"/v2/job/*"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>mapServlet</name><argument_list>(<argument><expr><name><name>SLAServlet</name><operator>.</operator><name>class</name></name></expr></argument>, <argument><expr><literal type="string">"/v1/sla/*"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>mapServlet</name><argument_list>(<argument><expr><name><name>V2SLAServlet</name><operator>.</operator><name>class</name></name></expr></argument>, <argument><expr><literal type="string">"/v2/sla/*"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>mapServlet</name><argument_list>(<argument><expr><name><name>V2ValidateServlet</name><operator>.</operator><name>class</name></name></expr></argument>, <argument><expr><literal type="string">"/v2/validate/*"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    </block_content>}</block></function>

    <function><type><specifier>private</specifier> <name>void</name></type> <name>mapServlet</name><parameter_list>(<parameter><decl><type><specifier>final</specifier> <name><name>Class</name><argument_list type="generic">&lt;<argument><name>?</name> <extends>extends <name>Servlet</name></extends></argument>&gt;</argument_list></name></type> <name>servletClass</name></decl></parameter>, <parameter><decl><type><specifier>final</specifier> <name>String</name></type> <name>servletPath</name></decl></parameter>)</parameter_list> <block>{<block_content>
        <try>try <block>{<block_content>
            <expr_stmt><expr><call><name><name>servletContextHandler</name><operator>.</operator><name>addServlet</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>ServletHolder</name><argument_list>(<argument><expr><call><name><name>servletClass</name><operator>.</operator><name>newInstance</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr></argument>, <argument><expr><name>servletPath</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        </block_content>}</block> <catch>catch <parameter_list>(<parameter><decl><type><specifier>final</specifier> <name>InstantiationException</name></type> | <type><name>IllegalAccessException</name></type> <name>e</name></decl></parameter>)</parameter_list> <block>{<block_content>
            <expr_stmt><expr><call><name><name>e</name><operator>.</operator><name>printStackTrace</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        </block_content>}</block></catch></try>
    </block_content>}</block></function>
}</block></class>
<expr_stmt><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>server</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>server</name><operator>/</operator><name><name>WebRootResourceLocator</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>server</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>server</name><operator>/</operator><name><name>WebRootResourceLocator</name><operator>.</operator><name>java</name></name>
<operator>new</operator> <name>file</name> <name>mode</name> <literal type="number">100644</literal>
<name>index</name> <literal type="number">000000000..190d1c203</literal>
<operator>--</operator> <operator>/</operator><name>dev</name><operator>/</operator><literal type="null">null</literal>
<operator>++</operator> <name>b</name><operator>/</operator><name>server</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>server</name><operator>/</operator><name><name>WebRootResourceLocator</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">0</literal></expr><operator>,</operator><expr><literal type="number">0</literal> <operator>+</operator><literal type="number">1</literal></expr><operator>,</operator><expr><literal type="number">39</literal> @@</expr></expr_stmt>
<comment type="block" format="javadoc">/**
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */</comment>

<package>package <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>server</name></name>;</package>

<import>import <name><name>java</name><operator>.</operator><name>io</name><operator>.</operator><name>FileNotFoundException</name></name>;</import>
<import>import <name><name>java</name><operator>.</operator><name>net</name><operator>.</operator><name>URI</name></name>;</import>
<import>import <name><name>java</name><operator>.</operator><name>net</name><operator>.</operator><name>URISyntaxException</name></name>;</import>
<import>import <name><name>java</name><operator>.</operator><name>net</name><operator>.</operator><name>URL</name></name>;</import>

<class><specifier>public</specifier> class <name>WebRootResourceLocator</name> <block>{
    <decl_stmt><decl><type><specifier>private</specifier> <specifier>static</specifier> <specifier>final</specifier> <name>String</name></type> <name>WEBROOT_INDEX</name> <init>= <expr><literal type="string">"/webapp/"</literal></expr></init></decl>;</decl_stmt>

    <function><type><specifier>public</specifier> <name>URI</name></type> <name>getWebRootResourceUri</name><parameter_list>()</parameter_list> <throws>throws <argument><expr><name>FileNotFoundException</name></expr></argument>, <argument><expr><name>URISyntaxException</name></expr></argument></throws>
    <block>{<block_content>
        <decl_stmt><decl><type><name>URL</name></type> <name>indexUri</name> <init>= <expr><call><name><name>JspHandler</name><operator>.</operator><name><name>class</name><operator>.</operator><name>getResource</name></name></name><argument_list>(<argument><expr><name><name>WebRootResourceLocator</name><operator>.</operator><name>WEBROOT_INDEX</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <if_stmt><if>if <condition>(<expr><name>indexUri</name> <operator>==</operator> <literal type="null">null</literal></expr>)</condition>
        <block>{<block_content>
            <throw>throw <expr><operator>new</operator> <call><name>FileNotFoundException</name><argument_list>(<argument><expr><literal type="string">"Unable to find resource "</literal> <operator>+</operator> <name><name>WebRootResourceLocator</name><operator>.</operator><name>WEBROOT_INDEX</name></name></expr></argument>)</argument_list></call></expr>;</throw>
        </block_content>}</block></if></if_stmt>
        <comment type="line">// Points to wherever /webroot/ (the resource) is</comment>
        <return>return <expr><call><name><name>indexUri</name><operator>.</operator><name>toURI</name></name><argument_list>()</argument_list></call></expr>;</return>
    </block_content>}</block></function>
}</block></class>
<expr_stmt><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>server</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>server</name><operator>/</operator><name>guice</name><operator>/</operator><name><name>ConstraintSecurityHandlerProvider</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>server</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>server</name><operator>/</operator><name>guice</name><operator>/</operator><name><name>ConstraintSecurityHandlerProvider</name><operator>.</operator><name>java</name></name>
<operator>new</operator> <name>file</name> <name>mode</name> <literal type="number">100644</literal>
<name>index</name> <literal type="number">000000000..6c313fe67</literal>
<operator>--</operator> <operator>/</operator><name>dev</name><operator>/</operator><literal type="null">null</literal>
<operator>++</operator> <name>b</name><operator>/</operator><name>server</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>server</name><operator>/</operator><name>guice</name><operator>/</operator><name><name>ConstraintSecurityHandlerProvider</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">0</literal></expr><operator>,</operator><expr><literal type="number">0</literal> <operator>+</operator><literal type="number">1</literal></expr><operator>,</operator><expr><literal type="number">47</literal> @@</expr></expr_stmt>
<comment type="block" format="javadoc">/**
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */</comment>

<package>package <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>server</name><operator>.</operator><name>guice</name></name>;</package>

<import>import <name><name>com</name><operator>.</operator><name>google</name><operator>.</operator><name>inject</name><operator>.</operator><name>Provider</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>eclipse</name><operator>.</operator><name>jetty</name><operator>.</operator><name>security</name><operator>.</operator><name>ConstraintMapping</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>eclipse</name><operator>.</operator><name>jetty</name><operator>.</operator><name>security</name><operator>.</operator><name>ConstraintSecurityHandler</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>eclipse</name><operator>.</operator><name>jetty</name><operator>.</operator><name>util</name><operator>.</operator><name>security</name><operator>.</operator><name>Constraint</name></name>;</import>

<import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>Arrays</name></name>;</import>

<class>class <name>ConstraintSecurityHandlerProvider</name> <super_list><implements>implements <super><name><name>Provider</name><argument_list type="generic">&lt;<argument><name>ConstraintSecurityHandler</name></argument>&gt;</argument_list></name></super></implements></super_list> <block>{
    <function><annotation>@<name>Override</name></annotation>
    <type><specifier>public</specifier> <name>ConstraintSecurityHandler</name></type> <name>get</name><parameter_list>()</parameter_list> <block>{<block_content>
        <decl_stmt><decl><type><name>ConstraintMapping</name></type> <name>callbackConstraintMapping</name> <init>= <expr><operator>new</operator> <call><name>ConstraintMapping</name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name><name>callbackConstraintMapping</name><operator>.</operator><name>setPathSpec</name></name><argument_list>(<argument><expr><literal type="string">"/callback/*"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <decl_stmt><decl><type><name>Constraint</name></type> <name>unsecureConstraint</name> <init>= <expr><operator>new</operator> <call><name>Constraint</name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name><name>unsecureConstraint</name><operator>.</operator><name>setDataConstraint</name></name><argument_list>(<argument><expr><name><name>Constraint</name><operator>.</operator><name>DC_NONE</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>callbackConstraintMapping</name><operator>.</operator><name>setConstraint</name></name><argument_list>(<argument><expr><name>unsecureConstraint</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <decl_stmt><decl><type><name>ConstraintMapping</name></type> <name>mapping</name> <init>= <expr><operator>new</operator> <call><name>ConstraintMapping</name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name><name>mapping</name><operator>.</operator><name>setPathSpec</name></name><argument_list>(<argument><expr><literal type="string">"/*"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <decl_stmt><decl><type><name>Constraint</name></type> <name>constraint</name> <init>= <expr><operator>new</operator> <call><name>Constraint</name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name><name>constraint</name><operator>.</operator><name>setDataConstraint</name></name><argument_list>(<argument><expr><name><name>Constraint</name><operator>.</operator><name>DC_CONFIDENTIAL</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>mapping</name><operator>.</operator><name>setConstraint</name></name><argument_list>(<argument><expr><name>constraint</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <decl_stmt><decl><type><name>ConstraintSecurityHandler</name></type> <name>security</name> <init>= <expr><operator>new</operator> <call><name>ConstraintSecurityHandler</name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name><name>security</name><operator>.</operator><name>setConstraintMappings</name></name><argument_list>(<argument><expr><call><name><name>Arrays</name><operator>.</operator><name>asList</name></name><argument_list>(<argument><expr><name>callbackConstraintMapping</name></expr></argument>, <argument><expr><name>mapping</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <return>return <expr><name>security</name></expr>;</return>
    </block_content>}</block></function>
}</block></class>
<expr_stmt><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>server</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>server</name><operator>/</operator><name>guice</name><operator>/</operator><name><name>JettyServerProvider</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>server</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>server</name><operator>/</operator><name>guice</name><operator>/</operator><name><name>JettyServerProvider</name><operator>.</operator><name>java</name></name>
<operator>new</operator> <name>file</name> <name>mode</name> <literal type="number">100644</literal>
<name>index</name> <literal type="number">000000000..6580a9a7d</literal>
<operator>--</operator> <operator>/</operator><name>dev</name><operator>/</operator><literal type="null">null</literal>
<operator>++</operator> <name>b</name><operator>/</operator><name>server</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>server</name><operator>/</operator><name>guice</name><operator>/</operator><name><name>JettyServerProvider</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">0</literal></expr><operator>,</operator><expr><literal type="number">0</literal> <operator>+</operator><literal type="number">1</literal></expr><operator>,</operator><expr><literal type="number">48</literal> @@</expr></expr_stmt>
<comment type="block" format="javadoc">/**
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */</comment>

<package>package <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>server</name><operator>.</operator><name>guice</name></name>;</package>

<import>import <name><name>com</name><operator>.</operator><name>google</name><operator>.</operator><name>inject</name><operator>.</operator><name>Inject</name></name>;</import>
<import>import <name><name>com</name><operator>.</operator><name>google</name><operator>.</operator><name>inject</name><operator>.</operator><name>Provider</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>hadoop</name><operator>.</operator><name>conf</name><operator>.</operator><name>Configuration</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>ConfigurationService</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>Services</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>eclipse</name><operator>.</operator><name>jetty</name><operator>.</operator><name>server</name><operator>.</operator><name>Server</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>eclipse</name><operator>.</operator><name>jetty</name><operator>.</operator><name>util</name><operator>.</operator><name>thread</name><operator>.</operator><name>QueuedThreadPool</name></name>;</import>

<class>class <name>JettyServerProvider</name> <super_list><implements>implements <super><name><name>Provider</name><argument_list type="generic">&lt;<argument><name>Server</name></argument>&gt;</argument_list></name></super></implements></super_list> <block>{
    <decl_stmt><decl><type><specifier>public</specifier> <specifier>static</specifier> <specifier>final</specifier> <name>String</name></type> <name>OOZIE_SERVER_THREADPOOL_MAX_THREADS</name> <init>= <expr><literal type="string">"oozie.server.threadpool.max.threads"</literal></expr></init></decl>;</decl_stmt>
    <decl_stmt><decl><type><specifier>private</specifier> <specifier>final</specifier> <name>Configuration</name></type> <name>oozieConfiguration</name></decl>;</decl_stmt>

    <constructor><annotation>@<name>Inject</name></annotation>
    <specifier>public</specifier> <name>JettyServerProvider</name><parameter_list>(<parameter><decl><type><specifier>final</specifier> <name>Services</name></type> <name>oozieServices</name></decl></parameter>)</parameter_list> <block>{<block_content>
        <expr_stmt><expr><name>oozieConfiguration</name> <operator>=</operator> <call><name><name>oozieServices</name><operator>.</operator><name>get</name></name><argument_list>(<argument><expr><name><name>ConfigurationService</name><operator>.</operator><name>class</name></name></expr></argument>)</argument_list></call><operator>.</operator><call><name>getConf</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
    </block_content>}</block></constructor>

    <function><annotation>@<name>Override</name></annotation>
    <type><specifier>public</specifier> <name>Server</name></type> <name>get</name><parameter_list>()</parameter_list> <block>{<block_content>
        <decl_stmt><decl><type><specifier>final</specifier> <name>QueuedThreadPool</name></type> <name>threadPool</name> <init>= <expr><operator>new</operator> <call><name>QueuedThreadPool</name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>

        <decl_stmt><decl><type><specifier>final</specifier> <name>int</name></type> <name>maxThreads</name> <init>= <expr><call><name><name>Integer</name><operator>.</operator><name>parseInt</name></name><argument_list>(
                <argument><expr><call><name><name>oozieConfiguration</name><operator>.</operator><name>get</name></name><argument_list>(<argument><expr><name>OOZIE_SERVER_THREADPOOL_MAX_THREADS</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name><name>threadPool</name><operator>.</operator><name>setMaxThreads</name></name><argument_list>(<argument><expr><name>maxThreads</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <return>return <expr><operator>new</operator> <call><name>Server</name><argument_list>(<argument><expr><name>threadPool</name></expr></argument>)</argument_list></call></expr>;</return>
    </block_content>}</block></function>
}</block></class>
<expr_stmt><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>server</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>server</name><operator>/</operator><name>guice</name><operator>/</operator><name><name>JspHandlerProvider</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>server</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>server</name><operator>/</operator><name>guice</name><operator>/</operator><name><name>JspHandlerProvider</name><operator>.</operator><name>java</name></name>
<operator>new</operator> <name>file</name> <name>mode</name> <literal type="number">100644</literal>
<name>index</name> <literal type="number">000000000..8a54a9a6d</literal>
<operator>--</operator> <operator>/</operator><name>dev</name><operator>/</operator><literal type="null">null</literal>
<operator>++</operator> <name>b</name><operator>/</operator><name>server</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>server</name><operator>/</operator><name>guice</name><operator>/</operator><name><name>JspHandlerProvider</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">0</literal></expr><operator>,</operator><expr><literal type="number">0</literal> <operator>+</operator><literal type="number">1</literal></expr><operator>,</operator><expr><literal type="number">47</literal> @@</expr></expr_stmt>
<comment type="block" format="javadoc">/**
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */</comment>

<package>package <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>server</name><operator>.</operator><name>guice</name></name>;</package>

<import>import <name><name>com</name><operator>.</operator><name>google</name><operator>.</operator><name>inject</name><operator>.</operator><name>Inject</name></name>;</import>
<import>import <name><name>com</name><operator>.</operator><name>google</name><operator>.</operator><name>inject</name><operator>.</operator><name>Provider</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>hadoop</name><operator>.</operator><name>conf</name><operator>.</operator><name>Configuration</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>server</name><operator>.</operator><name>JspHandler</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>server</name><operator>.</operator><name>WebRootResourceLocator</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>ConfigurationService</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>Services</name></name>;</import>

<import>import <name><name>java</name><operator>.</operator><name>io</name><operator>.</operator><name>File</name></name>;</import>

<class><specifier>public</specifier> class <name>JspHandlerProvider</name> <super_list><implements>implements <super><name><name>Provider</name><argument_list type="generic">&lt;<argument><name>JspHandler</name></argument>&gt;</argument_list></name></super></implements></super_list> <block>{
    <decl_stmt><decl><type><specifier>public</specifier> <specifier>static</specifier> <specifier>final</specifier> <name>String</name></type> <name>OOZIE_JSP_TMP_DIR</name> <init>= <expr><literal type="string">"oozie.jsp.tmp.dir"</literal></expr></init></decl>;</decl_stmt>
    <decl_stmt><decl><type><specifier>public</specifier> <specifier>static</specifier> <specifier>final</specifier> <name>String</name></type> <name>EMBEDDED_JETTY_JSP_DIR</name> <init>= <expr><literal type="string">"embedded-jetty-jsp"</literal></expr></init></decl>;</decl_stmt>
    <decl_stmt><decl><type><specifier>private</specifier> <specifier>final</specifier> <name>Configuration</name></type> <name>oozieConfiguration</name></decl>;</decl_stmt>

    <constructor><annotation>@<name>Inject</name></annotation>
    <specifier>public</specifier> <name>JspHandlerProvider</name><parameter_list>(<parameter><decl><type><specifier>final</specifier> <name>Services</name></type> <name>oozieServices</name></decl></parameter>)</parameter_list> <block>{<block_content>
        <expr_stmt><expr><name>oozieConfiguration</name> <operator>=</operator> <call><name><name>oozieServices</name><operator>.</operator><name>get</name></name><argument_list>(<argument><expr><name><name>ConfigurationService</name><operator>.</operator><name>class</name></name></expr></argument>)</argument_list></call><operator>.</operator><call><name>getConf</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
    </block_content>}</block></constructor>

    <function><annotation>@<name>Override</name></annotation>
    <type><specifier>public</specifier> <name>JspHandler</name></type> <name>get</name><parameter_list>()</parameter_list> <block>{<block_content>
        <decl_stmt><decl><type><specifier>final</specifier> <name>File</name></type> <name>tempDir</name> <init>= <expr><operator>new</operator> <call><name>File</name><argument_list>(<argument><expr><call><name><name>oozieConfiguration</name><operator>.</operator><name>get</name></name><argument_list>(<argument><expr><name>OOZIE_JSP_TMP_DIR</name></expr></argument>)</argument_list></call></expr></argument>, <argument><expr><name>EMBEDDED_JETTY_JSP_DIR</name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>

        <return>return <expr><operator>new</operator> <call><name>JspHandler</name><argument_list>(<argument><expr><name>tempDir</name></expr></argument>, <argument><expr><operator>new</operator> <call><name>WebRootResourceLocator</name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</return>
    </block_content>}</block></function>
}</block></class>
<expr_stmt><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>server</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>server</name><operator>/</operator><name>guice</name><operator>/</operator><name><name>OozieGuiceModule</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>server</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>server</name><operator>/</operator><name>guice</name><operator>/</operator><name><name>OozieGuiceModule</name><operator>.</operator><name>java</name></name>
<operator>new</operator> <name>file</name> <name>mode</name> <literal type="number">100644</literal>
<name>index</name> <literal type="number">000000000..bb79f0f79</literal>
<operator>--</operator> <operator>/</operator><name>dev</name><operator>/</operator><literal type="null">null</literal>
<operator>++</operator> <name>b</name><operator>/</operator><name>server</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>server</name><operator>/</operator><name>guice</name><operator>/</operator><name><name>OozieGuiceModule</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">0</literal></expr><operator>,</operator><expr><literal type="number">0</literal> <operator>+</operator><literal type="number">1</literal></expr><operator>,</operator><expr><literal type="number">45</literal> @@</expr></expr_stmt>
<comment type="block" format="javadoc">/**
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */</comment>

<package>package <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>server</name><operator>.</operator><name>guice</name></name>;</package>

<import>import <name><name>com</name><operator>.</operator><name>google</name><operator>.</operator><name>inject</name><operator>.</operator><name>AbstractModule</name></name>;</import>
<import>import <name><name>com</name><operator>.</operator><name>google</name><operator>.</operator><name>inject</name><operator>.</operator><name>Singleton</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>server</name><operator>.</operator><name>JspHandler</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>Services</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>eclipse</name><operator>.</operator><name>jetty</name><operator>.</operator><name>rewrite</name><operator>.</operator><name>handler</name><operator>.</operator><name>RewriteHandler</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>eclipse</name><operator>.</operator><name>jetty</name><operator>.</operator><name>security</name><operator>.</operator><name>ConstraintSecurityHandler</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>eclipse</name><operator>.</operator><name>jetty</name><operator>.</operator><name>server</name><operator>.</operator><name>Server</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>eclipse</name><operator>.</operator><name>jetty</name><operator>.</operator><name>webapp</name><operator>.</operator><name>WebAppContext</name></name>;</import>

<class><specifier>public</specifier> class <name>OozieGuiceModule</name> <super_list><extends>extends <super><name>AbstractModule</name></super></extends></super_list> <block>{
    <function><annotation>@<name>Override</name></annotation>
    <type><specifier>protected</specifier> <name>void</name></type> <name>configure</name><parameter_list>()</parameter_list> <block>{<block_content>
        <expr_stmt><expr><call><name>bind</name><argument_list>(<argument><expr><name><name>Services</name><operator>.</operator><name>class</name></name></expr></argument>)</argument_list></call><operator>.</operator><call><name>toProvider</name><argument_list>(<argument><expr><name><name>ServicesProvider</name><operator>.</operator><name>class</name></name></expr></argument>)</argument_list></call><operator>.</operator><call><name>in</name><argument_list>(<argument><expr><name><name>Singleton</name><operator>.</operator><name>class</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <expr_stmt><expr><call><name>bind</name><argument_list>(<argument><expr><name><name>Server</name><operator>.</operator><name>class</name></name></expr></argument>)</argument_list></call><operator>.</operator><call><name>toProvider</name><argument_list>(<argument><expr><name><name>JettyServerProvider</name><operator>.</operator><name>class</name></name></expr></argument>)</argument_list></call><operator>.</operator><call><name>in</name><argument_list>(<argument><expr><name><name>Singleton</name><operator>.</operator><name>class</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <expr_stmt><expr><call><name>bind</name><argument_list>(<argument><expr><name><name>WebAppContext</name><operator>.</operator><name>class</name></name></expr></argument>)</argument_list></call><operator>.</operator><call><name>in</name><argument_list>(<argument><expr><name><name>Singleton</name><operator>.</operator><name>class</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <expr_stmt><expr><call><name>bind</name><argument_list>(<argument><expr><name><name>ConstraintSecurityHandler</name><operator>.</operator><name>class</name></name></expr></argument>)</argument_list></call><operator>.</operator><call><name>toProvider</name><argument_list>(<argument><expr><name><name>ConstraintSecurityHandlerProvider</name><operator>.</operator><name>class</name></name></expr></argument>)</argument_list></call><operator>.</operator><call><name>in</name><argument_list>(<argument><expr><name><name>Singleton</name><operator>.</operator><name>class</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <expr_stmt><expr><call><name>bind</name><argument_list>(<argument><expr><name><name>JspHandler</name><operator>.</operator><name>class</name></name></expr></argument>)</argument_list></call><operator>.</operator><call><name>toProvider</name><argument_list>(<argument><expr><name><name>JspHandlerProvider</name><operator>.</operator><name>class</name></name></expr></argument>)</argument_list></call><operator>.</operator><call><name>in</name><argument_list>(<argument><expr><name><name>Singleton</name><operator>.</operator><name>class</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <expr_stmt><expr><call><name>bind</name><argument_list>(<argument><expr><name><name>RewriteHandler</name><operator>.</operator><name>class</name></name></expr></argument>)</argument_list></call><operator>.</operator><call><name>toProvider</name><argument_list>(<argument><expr><name><name>RewriteHandlerProvider</name><operator>.</operator><name>class</name></name></expr></argument>)</argument_list></call><operator>.</operator><call><name>in</name><argument_list>(<argument><expr><name><name>Singleton</name><operator>.</operator><name>class</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    </block_content>}</block></function>
}</block></class>
<expr_stmt><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>server</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>server</name><operator>/</operator><name>guice</name><operator>/</operator><name><name>RewriteHandlerProvider</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>server</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>server</name><operator>/</operator><name>guice</name><operator>/</operator><name><name>RewriteHandlerProvider</name><operator>.</operator><name>java</name></name>
<operator>new</operator> <name>file</name> <name>mode</name> <literal type="number">100644</literal>
<name>index</name> <literal type="number">000000000..e54d0cb9f</literal>
<operator>--</operator> <operator>/</operator><name>dev</name><operator>/</operator><literal type="null">null</literal>
<operator>++</operator> <name>b</name><operator>/</operator><name>server</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>server</name><operator>/</operator><name>guice</name><operator>/</operator><name><name>RewriteHandlerProvider</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">0</literal></expr><operator>,</operator><expr><literal type="number">0</literal> <operator>+</operator><literal type="number">1</literal></expr><operator>,</operator><expr><literal type="number">44</literal> @@</expr></expr_stmt>
<comment type="block" format="javadoc">/**
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */</comment>

<package>package <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>server</name><operator>.</operator><name>guice</name></name>;</package>

<import>import <name><name>com</name><operator>.</operator><name>google</name><operator>.</operator><name>inject</name><operator>.</operator><name>Inject</name></name>;</import>
<import>import <name><name>com</name><operator>.</operator><name>google</name><operator>.</operator><name>inject</name><operator>.</operator><name>Provider</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>eclipse</name><operator>.</operator><name>jetty</name><operator>.</operator><name>rewrite</name><operator>.</operator><name>handler</name><operator>.</operator><name>RedirectPatternRule</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>eclipse</name><operator>.</operator><name>jetty</name><operator>.</operator><name>rewrite</name><operator>.</operator><name>handler</name><operator>.</operator><name>RewriteHandler</name></name>;</import>

<class>class <name>RewriteHandlerProvider</name> <super_list><implements>implements <super><name><name>Provider</name><argument_list type="generic">&lt;<argument><name>RewriteHandler</name></argument>&gt;</argument_list></name></super></implements></super_list> <block>{
    <decl_stmt><decl><type><specifier>private</specifier> <specifier>final</specifier> <name>RewriteHandler</name></type> <name>rewriteHandler</name></decl>;</decl_stmt>

    <function><annotation>@<name>Override</name></annotation>
    <type><specifier>public</specifier> <name>RewriteHandler</name></type> <name>get</name><parameter_list>()</parameter_list> <block>{<block_content>
        <return>return <expr><name>rewriteHandler</name></expr>;</return>
    </block_content>}</block></function>

    <constructor><annotation>@<name>Inject</name></annotation>
    <specifier>public</specifier> <name>RewriteHandlerProvider</name><parameter_list>(<parameter><decl><type><specifier>final</specifier> <name>RedirectPatternRule</name></type> <name>redirectPatternRule</name></decl></parameter>)</parameter_list> <block>{<block_content>
        <expr_stmt><expr><name><name>this</name><operator>.</operator><name>rewriteHandler</name></name> <operator>=</operator> <operator>new</operator> <call><name>RewriteHandler</name><argument_list>()</argument_list></call></expr>;</expr_stmt>

        <expr_stmt><expr><call><name><name>redirectPatternRule</name><operator>.</operator><name>setPattern</name></name><argument_list>(<argument><expr><literal type="string">""</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>redirectPatternRule</name><operator>.</operator><name>setLocation</name></name><argument_list>(<argument><expr><literal type="string">"/oozie"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>redirectPatternRule</name><operator>.</operator><name>setTerminating</name></name><argument_list>(<argument><expr><literal type="boolean">true</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <expr_stmt><expr><call><name><name>this</name><operator>.</operator><name>rewriteHandler</name><operator>.</operator><name>addRule</name></name><argument_list>(<argument><expr><name>redirectPatternRule</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    </block_content>}</block></constructor>
}</block></class>
<expr_stmt><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>server</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>server</name><operator>/</operator><name>guice</name><operator>/</operator><name><name>ServicesProvider</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>server</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>server</name><operator>/</operator><name>guice</name><operator>/</operator><name><name>ServicesProvider</name><operator>.</operator><name>java</name></name>
<operator>new</operator> <name>file</name> <name>mode</name> <literal type="number">100644</literal>
<name>index</name> <literal type="number">000000000..cc4ed1798</literal>
<operator>--</operator> <operator>/</operator><name>dev</name><operator>/</operator><literal type="null">null</literal>
<operator>++</operator> <name>b</name><operator>/</operator><name>server</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>server</name><operator>/</operator><name>guice</name><operator>/</operator><name><name>ServicesProvider</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">0</literal></expr><operator>,</operator><expr><literal type="number">0</literal> <operator>+</operator><literal type="number">1</literal></expr><operator>,</operator><expr><literal type="number">39</literal> @@</expr></expr_stmt>
<comment type="block" format="javadoc">/**
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */</comment>

<package>package <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>server</name><operator>.</operator><name>guice</name></name>;</package>

<import>import <name><name>com</name><operator>.</operator><name>google</name><operator>.</operator><name>inject</name><operator>.</operator><name>Provider</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>ServiceException</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>Services</name></name>;</import>

<class>class <name>ServicesProvider</name> <super_list><implements>implements <super><name><name>Provider</name><argument_list type="generic">&lt;<argument><name>Services</name></argument>&gt;</argument_list></name></super></implements></super_list> <block>{
    <function><annotation>@<name>Override</name></annotation>
    <type><specifier>public</specifier> <name>Services</name></type> <name>get</name><parameter_list>()</parameter_list> <block>{<block_content>
        <try>try <block>{<block_content>
            <decl_stmt><decl><type><specifier>final</specifier> <name>Services</name></type> <name>oozieServices</name> <init>= <expr><operator>new</operator> <call><name>Services</name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>

            <expr_stmt><expr><call><name><name>oozieServices</name><operator>.</operator><name>init</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>

            <return>return <expr><name>oozieServices</name></expr>;</return>
        </block_content>}</block> <catch>catch <parameter_list>(<parameter><decl><type><name>ServiceException</name></type> <name>e</name></decl></parameter>)</parameter_list> <block>{<block_content>
            <throw>throw <expr><operator>new</operator> <call><name>ExceptionInInitializerError</name><argument_list>(
                    <argument><expr><call><name><name>String</name><operator>.</operator><name>format</name></name><argument_list>(<argument><expr><literal type="string">"Could not instantiate Oozie services. [e.message=%s]"</literal></expr></argument>, <argument><expr><call><name><name>e</name><operator>.</operator><name>getMessage</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</throw>
        </block_content>}</block></catch></try>
    </block_content>}</block></function>
}</block></class>
<expr_stmt><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>server</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>resources</name><operator>/</operator><name>checkstyle</name><operator>-</operator><name><name>header</name><operator>.</operator><name>txt</name></name> <name>b</name><operator>/</operator><name>server</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>resources</name><operator>/</operator><name>checkstyle</name><operator>-</operator><name><name>header</name><operator>.</operator><name>txt</name></name>
<operator>new</operator> <name>file</name> <name>mode</name> <literal type="number">100644</literal>
<name>index</name> <literal type="number">000000000..424745248</literal>
<operator>--</operator> <operator>/</operator><name>dev</name><operator>/</operator><literal type="null">null</literal>
<operator>++</operator> <name>b</name><operator>/</operator><name>server</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>resources</name><operator>/</operator><name>checkstyle</name><operator>-</operator><name><name>header</name><operator>.</operator><name>txt</name></name>
@@ <operator>-</operator><literal type="number">0</literal></expr><operator>,</operator><expr><literal type="number">0</literal> <operator>+</operator><literal type="number">1</literal></expr><operator>,</operator><expr><literal type="number">17</literal> @@
<comment type="block" format="javadoc">/**
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */</comment>
<operator>\</operator> <name>No</name> <name>newline</name> <name>at</name> <name>end</name> <name>of</name> <name>file</name>
<name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>server</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>resources</name><operator>/</operator><name><name>checkstyle</name><operator>.</operator><name>xml</name></name> <name>b</name><operator>/</operator><name>server</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>resources</name><operator>/</operator><name><name>checkstyle</name><operator>.</operator><name>xml</name></name>
<operator>new</operator> <name>file</name> <name>mode</name> <literal type="number">100644</literal>
<name>index</name> <literal type="number">000000000..6e8be5d11</literal>
<operator>--</operator> <operator>/</operator><name>dev</name><operator>/</operator><literal type="null">null</literal>
<operator>++</operator> <name>b</name><operator>/</operator><name>server</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>resources</name><operator>/</operator><name><name>checkstyle</name><operator>.</operator><name>xml</name></name>
@@ <operator>-</operator><literal type="number">0</literal></expr><operator>,</operator><expr><literal type="number">0</literal> <operator>+</operator><literal type="number">1</literal></expr><operator>,</operator><expr><ternary><condition><expr><literal type="number">41</literal> @@
<operator>&lt;</operator></expr>?</condition><then><expr><name>xml</name> <name>version</name><operator>=</operator><ternary><condition><expr><literal type="string">"1.0"</literal></expr>?</condition><then><expr><operator>&gt;</operator>
<operator>&lt;</operator><operator>!</operator><name>DOCTYPE</name> <name>module</name> <name>PUBLIC</name> <literal type="string">"-//Puppy Crawl//DTD Check Configuration 1.2//EN"</literal> <literal type="string">"http://www.puppycrawl.com/dtds/configuration_1_2.dtd"</literal><operator>&gt;</operator>
<operator>&lt;</operator><operator>!</operator><operator>--</operator>
  <name>Licensed</name> <name>to</name> <name>the</name> <name>Apache</name> <name>Software</name> <call><name>Foundation</name> <argument_list>(<argument><expr><name>ASF</name></expr></argument>)</argument_list></call> <name>under</name> <name>one</name>
  <name>or</name> <name>more</name> <name>contributor</name> <name>license</name> <name><name>agreements</name><operator>.</operator>  <name>See</name></name> <name>the</name> <name>NOTICE</name> <name>file</name>
  <name>distributed</name> <name>with</name> <name>this</name> <name>work</name></expr></then></ternary></expr></then></ternary></expr></expr_stmt> <for>for additional information
  regarding copyright ownership.  The ASF licenses this file
  to you under the Apache License<operator>,</operator> <expr_stmt><expr><name>Version</name> <literal type="number">2.0</literal> <operator>(</operator><name>the</name>
  <literal type="string">"License"</literal><operator>)</operator></expr>;</expr_stmt></for> <expr_stmt><expr><name>you</name> <name>may</name> <name>not</name> <name>use</name> <name>this</name> <name>file</name> <name>except</name> <name>in</name> <name>compliance</name>
  <name>with</name> <name>the</name> <name><name>License</name><operator>.</operator>  <name>You</name></name> <name>may</name> <name>obtain</name> <name>a</name> <name>copy</name> <name>of</name> <name>the</name> <name>License</name> <name>at</name>

       <name>http</name><operator>:</operator><comment type="line">//www.apache.org/licenses/LICENSE-2.0</comment>

  <name>Unless</name> <name>required</name> <name>by</name> <name>applicable</name> <name>law</name> <name>or</name> <name>agreed</name> <name>to</name> <name>in</name> <name>writing</name></expr><operator>,</operator> <expr><name>software</name>
  <name>distributed</name> <name>under</name> <name>the</name> <name>License</name> <name>is</name> <name>distributed</name> <name>on</name> <name>an</name> <literal type="string">"AS IS"</literal> <name>BASIS</name></expr><operator>,</operator>
  <expr><name>WITHOUT</name> <name>WARRANTIES</name> <name>OR</name> <name>CONDITIONS</name> <name>OF</name> <name>ANY</name> <name>KIND</name></expr><operator>,</operator> <expr><name>either</name> <name>express</name> <name>or</name> <name><name>implied</name><operator>.</operator>
  <name>See</name></name> <name>the</name> <name>License</name></expr></expr_stmt> <for>for the specific language governing permissions and
  limitations under the License.
--&gt;

&lt;module name="Checker"&gt;

    &lt;module name="RegexpSingleline"&gt;
        &lt;property name="severity" value="warning"/&gt;
        &lt;property name="format" value="\s+$"/&gt;
        &lt;property name="message" value="Line has trailing spaces."/&gt;
    &lt;/module&gt;

    &lt;module name="Header"&gt;
        &lt;property name="headerFile" value="${checkstyle.header.file}"/&gt;
    &lt;/module&gt;

    &lt;module name="TreeWalker"&gt;
        &lt;module name="LineLength"&gt;
            &lt;property name="severity" value="warning"/&gt;
            &lt;property name="max" value="132"/&gt;
        &lt;/module&gt;
    &lt;/module&gt;

&lt;/module&gt;

diff --git a/server/src/test/java/org/apache/oozie/server/TestEmbeddedOozieServer.java b/server/src/test/java/org/apache/oozie/server/TestEmbeddedOozieServer.java
new file mode 100644
index 000000000..0f36e8c57
-- /dev/null
++ b/server/src/test/java/org/apache/oozie/server/TestEmbeddedOozieServer.java
@@ -0<operator>,</operator><expr_stmt><expr><literal type="number">0</literal> <operator>+</operator><literal type="number">1</literal></expr><operator>,</operator><expr><literal type="number">119</literal> @@</expr></expr_stmt></for>
<comment type="block" format="javadoc">/**
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */</comment>

<package>package <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>server</name></name>;</package>

<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>hadoop</name><operator>.</operator><name>conf</name><operator>.</operator><name>Configuration</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>ConfigurationService</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>ServiceException</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>Services</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>eclipse</name><operator>.</operator><name>jetty</name><operator>.</operator><name>rewrite</name><operator>.</operator><name>handler</name><operator>.</operator><name>RewriteHandler</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>eclipse</name><operator>.</operator><name>jetty</name><operator>.</operator><name>security</name><operator>.</operator><name>ConstraintSecurityHandler</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>eclipse</name><operator>.</operator><name>jetty</name><operator>.</operator><name>server</name><operator>.</operator><name>Server</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>eclipse</name><operator>.</operator><name>jetty</name><operator>.</operator><name>server</name><operator>.</operator><name>ServerConnector</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>eclipse</name><operator>.</operator><name>jetty</name><operator>.</operator><name>util</name><operator>.</operator><name>ssl</name><operator>.</operator><name>SslContextFactory</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>eclipse</name><operator>.</operator><name>jetty</name><operator>.</operator><name>webapp</name><operator>.</operator><name>WebAppContext</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>junit</name><operator>.</operator><name>After</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>junit</name><operator>.</operator><name>Before</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>junit</name><operator>.</operator><name>Test</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>junit</name><operator>.</operator><name>runner</name><operator>.</operator><name>RunWith</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>mockito</name><operator>.</operator><name>Mock</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>mockito</name><operator>.</operator><name>runners</name><operator>.</operator><name>MockitoJUnitRunner</name></name>;</import>

<import>import <name><name>java</name><operator>.</operator><name>io</name><operator>.</operator><name>IOException</name></name>;</import>
<import>import <name><name>java</name><operator>.</operator><name>net</name><operator>.</operator><name>URISyntaxException</name></name>;</import>

<import>import static <name><name>org</name><operator>.</operator><name>mockito</name><operator>.</operator><name>Matchers</name><operator>.</operator><name>any</name></name>;</import>
<import>import static <name><name>org</name><operator>.</operator><name>mockito</name><operator>.</operator><name>Matchers</name><operator>.</operator><name>anyInt</name></name>;</import>
<import>import static <name><name>org</name><operator>.</operator><name>mockito</name><operator>.</operator><name>Matchers</name><operator>.</operator><name>isA</name></name>;</import>
<import>import static <name><name>org</name><operator>.</operator><name>mockito</name><operator>.</operator><name>Mockito</name><operator>.</operator><name>doReturn</name></name>;</import>
<import>import static <name><name>org</name><operator>.</operator><name>mockito</name><operator>.</operator><name>Mockito</name><operator>.</operator><name>verify</name></name>;</import>
<import>import static <name><name>org</name><operator>.</operator><name>mockito</name><operator>.</operator><name>Mockito</name><operator>.</operator><name>verifyNoMoreInteractions</name></name>;</import>

<comment type="block" format="javadoc">/**
 *  Server tests
 */</comment>
<class><annotation>@<name>RunWith</name><argument_list>(<argument><expr><name><name>MockitoJUnitRunner</name><operator>.</operator><name>class</name></name></expr></argument>)</argument_list></annotation>
<specifier>public</specifier> class <name>TestEmbeddedOozieServer</name> <block>{
    <decl_stmt><decl><annotation>@<name>Mock</name></annotation> <type><specifier>private</specifier> <name>JspHandler</name></type> <name>mockJspHandler</name></decl>;</decl_stmt>
    <decl_stmt><decl><annotation>@<name>Mock</name></annotation> <type><specifier>private</specifier> <name>Services</name></type> <name>mockServices</name></decl>;</decl_stmt>
    <decl_stmt><decl><annotation>@<name>Mock</name></annotation> <type><specifier>private</specifier> <name>SslContextFactory</name></type> <name>mockSSLContextFactory</name></decl>;</decl_stmt>
    <decl_stmt><decl><annotation>@<name>Mock</name></annotation> <type><specifier>private</specifier> <name>SSLServerConnectorFactory</name></type> <name>mockSSLServerConnectorFactory</name></decl>;</decl_stmt>
    <decl_stmt><decl><annotation>@<name>Mock</name></annotation> <type><specifier>private</specifier> <name>Server</name></type> <name>mockServer</name></decl>;</decl_stmt>
    <decl_stmt><decl><annotation>@<name>Mock</name></annotation> <type><specifier>private</specifier> <name>ServerConnector</name></type> <name>mockServerConnector</name></decl>;</decl_stmt>
    <decl_stmt><decl><annotation>@<name>Mock</name></annotation> <type><specifier>private</specifier> <name>ConfigurationService</name></type> <name>mockConfigService</name></decl>;</decl_stmt>
    <decl_stmt><decl><annotation>@<name>Mock</name></annotation> <type><specifier>private</specifier> <name>Configuration</name></type> <name>mockConfiguration</name></decl>;</decl_stmt>
    <decl_stmt><decl><annotation>@<name>Mock</name></annotation> <type><specifier>private</specifier> <name>RewriteHandler</name></type> <name>mockOozieRewriteHandler</name></decl>;</decl_stmt>
    <decl_stmt><decl><annotation>@<name>Mock</name></annotation> <type><specifier>private</specifier> <name>EmbeddedOozieServer</name></type> <name>embeddedOozieServer</name></decl>;</decl_stmt>
    <decl_stmt><decl><annotation>@<name>Mock</name></annotation> <type><specifier>private</specifier> <name>WebAppContext</name></type> <name>servletContextHandler</name></decl>;</decl_stmt>
    <decl_stmt><decl><annotation>@<name>Mock</name></annotation> <type><specifier>private</specifier> <name>ServletMapper</name></type> <name>oozieServletMapper</name></decl>;</decl_stmt>
    <decl_stmt><decl><annotation>@<name>Mock</name></annotation> <type><specifier>private</specifier> <name>FilterMapper</name></type> <name>oozieFilterMapper</name></decl>;</decl_stmt>
    <decl_stmt><decl><annotation>@<name>Mock</name></annotation> <type><specifier>private</specifier> <name>ConstraintSecurityHandler</name></type> <name>constraintSecurityHandler</name></decl>;</decl_stmt>

    <function><annotation>@<name>Before</name></annotation> <type><specifier>public</specifier> <name>void</name></type> <name>setUp</name><parameter_list>()</parameter_list> <block>{<block_content>
        <expr_stmt><expr><name>embeddedOozieServer</name> <operator>=</operator> <operator>new</operator> <call><name>EmbeddedOozieServer</name><argument_list>(<argument><expr><name>mockServer</name></expr></argument>, <argument><expr><name>mockJspHandler</name></expr></argument>, <argument><expr><name>mockServices</name></expr></argument>, <argument><expr><name>mockSSLServerConnectorFactory</name></expr></argument>,
                <argument><expr><name>mockOozieRewriteHandler</name></expr></argument>, <argument><expr><name>servletContextHandler</name></expr></argument>, <argument><expr><name>oozieServletMapper</name></expr></argument>, <argument><expr><name>oozieFilterMapper</name></expr></argument>, <argument><expr><name>constraintSecurityHandler</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <expr_stmt><expr><call><name>doReturn</name><argument_list>(<argument><expr><literal type="string">"11000"</literal></expr></argument>)</argument_list></call><operator>.</operator><call><name>when</name><argument_list>(<argument><expr><name>mockConfiguration</name></expr></argument>)</argument_list></call><operator>.</operator><call><name>get</name><argument_list>(<argument><expr><literal type="string">"oozie.http.port"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>doReturn</name><argument_list>(<argument><expr><literal type="string">"11443"</literal></expr></argument>)</argument_list></call><operator>.</operator><call><name>when</name><argument_list>(<argument><expr><name>mockConfiguration</name></expr></argument>)</argument_list></call><operator>.</operator><call><name>get</name><argument_list>(<argument><expr><literal type="string">"oozie.https.port"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>doReturn</name><argument_list>(<argument><expr><literal type="string">"65536"</literal></expr></argument>)</argument_list></call><operator>.</operator><call><name>when</name><argument_list>(<argument><expr><name>mockConfiguration</name></expr></argument>)</argument_list></call><operator>.</operator><call><name>get</name><argument_list>(<argument><expr><literal type="string">"oozie.http.request.header.size"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>doReturn</name><argument_list>(<argument><expr><literal type="string">"65536"</literal></expr></argument>)</argument_list></call><operator>.</operator><call><name>when</name><argument_list>(<argument><expr><name>mockConfiguration</name></expr></argument>)</argument_list></call><operator>.</operator><call><name>get</name><argument_list>(<argument><expr><literal type="string">"oozie.http.response.header.size"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>doReturn</name><argument_list>(<argument><expr><literal type="string">"42"</literal></expr></argument>)</argument_list></call><operator>.</operator><call><name>when</name><argument_list>(<argument><expr><name>mockConfiguration</name></expr></argument>)</argument_list></call><operator>.</operator><call><name>get</name><argument_list>(<argument><expr><literal type="string">"oozie.server.threadpool.max.threads"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>doReturn</name><argument_list>(<argument><expr><name>mockConfiguration</name></expr></argument>)</argument_list></call><operator>.</operator><call><name>when</name><argument_list>(<argument><expr><name>mockConfigService</name></expr></argument>)</argument_list></call><operator>.</operator><call><name>getConf</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>doReturn</name><argument_list>(<argument><expr><name>mockConfigService</name></expr></argument>)</argument_list></call><operator>.</operator><call><name>when</name><argument_list>(<argument><expr><name>mockServices</name></expr></argument>)</argument_list></call><operator>.</operator><call><name>get</name><argument_list>(<argument><expr><name><name>ConfigurationService</name><operator>.</operator><name>class</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    </block_content>}</block></function>

    <function><annotation>@<name>After</name></annotation> <type><specifier>public</specifier> <name>void</name></type> <name>tearDown</name><parameter_list>()</parameter_list> <block>{<block_content>
        <expr_stmt><expr><call><name>verify</name><argument_list>(<argument><expr><name>mockServices</name></expr></argument>)</argument_list></call><operator>.</operator><call><name>get</name><argument_list>(<argument><expr><name><name>ConfigurationService</name><operator>.</operator><name>class</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <expr_stmt><expr><call><name>verifyNoMoreInteractions</name><argument_list>(
                <argument><expr><name>mockJspHandler</name></expr></argument>,
                <argument><expr><name>mockServices</name></expr></argument>,
                <argument><expr><name>mockServerConnector</name></expr></argument>,
                <argument><expr><name>mockSSLServerConnectorFactory</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    </block_content>}</block></function>

    <function><annotation>@<name>Test</name></annotation>
    <type><specifier>public</specifier> <name>void</name></type> <name>testServerSetup</name><parameter_list>()</parameter_list> <throws>throws <argument><expr><name>Exception</name></expr></argument></throws> <block>{<block_content>
        <expr_stmt><expr><call><name>doReturn</name><argument_list>(<argument><expr><literal type="string">"false"</literal></expr></argument>)</argument_list></call><operator>.</operator><call><name>when</name><argument_list>(<argument><expr><name>mockConfiguration</name></expr></argument>)</argument_list></call><operator>.</operator><call><name>get</name><argument_list>(<argument><expr><literal type="string">"oozie.https.enabled"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>embeddedOozieServer</name><operator>.</operator><name>setup</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>verify</name><argument_list>(<argument><expr><name>mockJspHandler</name></expr></argument>)</argument_list></call><operator>.</operator><call><name>setupWebAppContext</name><argument_list>(<argument><expr><call><name>isA</name><argument_list>(<argument><expr><name><name>WebAppContext</name><operator>.</operator><name>class</name></name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    </block_content>}</block></function>

    <function><annotation>@<name>Test</name></annotation>
    <type><specifier>public</specifier> <name>void</name></type> <name>testSecureServerSetup</name><parameter_list>()</parameter_list> <throws>throws <argument><expr><name>Exception</name></expr></argument></throws> <block>{<block_content>
        <expr_stmt><expr><call><name>doReturn</name><argument_list>(<argument><expr><literal type="string">"true"</literal></expr></argument>)</argument_list></call><operator>.</operator><call><name>when</name><argument_list>(<argument><expr><name>mockConfiguration</name></expr></argument>)</argument_list></call><operator>.</operator><call><name>get</name><argument_list>(<argument><expr><literal type="string">"oozie.https.enabled"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <decl_stmt><decl><type><name>ServerConnector</name></type> <name>mockSecuredServerConnector</name> <init>= <expr><operator>new</operator> <call><name>ServerConnector</name><argument_list>(<argument><expr><name><name>embeddedOozieServer</name><operator>.</operator><name>server</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name>doReturn</name><argument_list>(<argument><expr><name>mockSecuredServerConnector</name></expr></argument>)</argument_list></call>
                <operator>.</operator><call><name>when</name><argument_list>(<argument><expr><name>mockSSLServerConnectorFactory</name></expr></argument>)</argument_list></call>
                <operator>.</operator><call><name>createSecureServerConnector</name><argument_list>(<argument><expr><call><name>anyInt</name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><call><name>any</name><argument_list>(<argument><expr><name><name>Configuration</name><operator>.</operator><name>class</name></name></expr></argument>)</argument_list></call></expr></argument>, <argument><expr><call><name>any</name><argument_list>(<argument><expr><name><name>Server</name><operator>.</operator><name>class</name></name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <expr_stmt><expr><call><name><name>embeddedOozieServer</name><operator>.</operator><name>setup</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>

        <expr_stmt><expr><call><name>verify</name><argument_list>(<argument><expr><name>mockJspHandler</name></expr></argument>)</argument_list></call><operator>.</operator><call><name>setupWebAppContext</name><argument_list>(<argument><expr><call><name>isA</name><argument_list>(<argument><expr><name><name>WebAppContext</name><operator>.</operator><name>class</name></name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>verify</name><argument_list>(<argument><expr><name>mockSSLServerConnectorFactory</name></expr></argument>)</argument_list></call><operator>.</operator><call><name>createSecureServerConnector</name><argument_list>(
                <argument><expr><call><name>isA</name><argument_list>(<argument><expr><name><name>Integer</name><operator>.</operator><name>class</name></name></expr></argument>)</argument_list></call></expr></argument>, <argument><expr><call><name>isA</name><argument_list>(<argument><expr><name><name>Configuration</name><operator>.</operator><name>class</name></name></expr></argument>)</argument_list></call></expr></argument>, <argument><expr><call><name>isA</name><argument_list>(<argument><expr><name><name>Server</name><operator>.</operator><name>class</name></name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    </block_content>}</block></function>

    <function><annotation>@<name>Test</name><argument_list>(<argument><expr><name>expected</name><operator>=</operator><name><name>NumberFormatException</name><operator>.</operator><name>class</name></name></expr></argument>)</argument_list></annotation>
    <type><specifier>public</specifier> <name>void</name></type> <name>numberFormatExceptionThrownWithInvalidHttpPort</name><parameter_list>()</parameter_list> <throws>throws <argument><expr><name>ServiceException</name></expr></argument>, <argument><expr><name>IOException</name></expr></argument>, <argument><expr><name>URISyntaxException</name></expr></argument></throws> <block>{<block_content>
        <expr_stmt><expr><call><name>doReturn</name><argument_list>(<argument><expr><literal type="string">"INVALID_PORT"</literal></expr></argument>)</argument_list></call><operator>.</operator><call><name>when</name><argument_list>(<argument><expr><name>mockConfiguration</name></expr></argument>)</argument_list></call><operator>.</operator><call><name>get</name><argument_list>(<argument><expr><literal type="string">"oozie.http.port"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>embeddedOozieServer</name><operator>.</operator><name>setup</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
    </block_content>}</block></function>
}</block></class>
<expr_stmt><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>server</name><operator>/</operator><name>src</name><operator>/</operator><name>test</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>server</name><operator>/</operator><name><name>TestJspHandler</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>server</name><operator>/</operator><name>src</name><operator>/</operator><name>test</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>server</name><operator>/</operator><name><name>TestJspHandler</name><operator>.</operator><name>java</name></name>
<operator>new</operator> <name>file</name> <name>mode</name> <literal type="number">100644</literal>
<name>index</name> <literal type="number">000000000..741aa5d9c</literal>
<operator>--</operator> <operator>/</operator><name>dev</name><operator>/</operator><literal type="null">null</literal>
<operator>++</operator> <name>b</name><operator>/</operator><name>server</name><operator>/</operator><name>src</name><operator>/</operator><name>test</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>server</name><operator>/</operator><name><name>TestJspHandler</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">0</literal></expr><operator>,</operator><expr><literal type="number">0</literal> <operator>+</operator><literal type="number">1</literal></expr><operator>,</operator><expr><literal type="number">94</literal> @@</expr></expr_stmt>
<comment type="block" format="javadoc">/**
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */</comment>

<package>package <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>server</name></name>;</package>

<import>import <name><name>org</name><operator>.</operator><name>eclipse</name><operator>.</operator><name>jetty</name><operator>.</operator><name>webapp</name><operator>.</operator><name>WebAppContext</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>junit</name><operator>.</operator><name>After</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>junit</name><operator>.</operator><name>Before</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>junit</name><operator>.</operator><name>Rule</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>junit</name><operator>.</operator><name>Test</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>junit</name><operator>.</operator><name>rules</name><operator>.</operator><name>ExpectedException</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>junit</name><operator>.</operator><name>runner</name><operator>.</operator><name>RunWith</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>mockito</name><operator>.</operator><name>Mock</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>mockito</name><operator>.</operator><name>runners</name><operator>.</operator><name>MockitoJUnitRunner</name></name>;</import>

<import>import <name><name>java</name><operator>.</operator><name>io</name><operator>.</operator><name>File</name></name>;</import>
<import>import <name><name>java</name><operator>.</operator><name>io</name><operator>.</operator><name>IOException</name></name>;</import>
<import>import <name><name>java</name><operator>.</operator><name>net</name><operator>.</operator><name>URI</name></name>;</import>
<import>import <name><name>java</name><operator>.</operator><name>net</name><operator>.</operator><name>URISyntaxException</name></name>;</import>

<import>import static <name><name>org</name><operator>.</operator><name>mockito</name><operator>.</operator><name>Matchers</name><operator>.</operator><name>anyString</name></name>;</import>
<import>import static <name><name>org</name><operator>.</operator><name>mockito</name><operator>.</operator><name>Mockito</name><operator>.</operator><name>times</name></name>;</import>
<import>import static <name><name>org</name><operator>.</operator><name>mockito</name><operator>.</operator><name>Mockito</name><operator>.</operator><name>verify</name></name>;</import>
<import>import static <name><name>org</name><operator>.</operator><name>mockito</name><operator>.</operator><name>Mockito</name><operator>.</operator><name>verifyNoMoreInteractions</name></name>;</import>
<import>import static <name><name>org</name><operator>.</operator><name>mockito</name><operator>.</operator><name>Mockito</name><operator>.</operator><name>when</name></name>;</import>

<class><annotation>@<name>RunWith</name><argument_list>(<argument><expr><name><name>MockitoJUnitRunner</name><operator>.</operator><name>class</name></name></expr></argument>)</argument_list></annotation>
<specifier>public</specifier> class <name>TestJspHandler</name> <block>{
    <decl_stmt><decl><annotation>@<name>Rule</name></annotation>
    <type><specifier>public</specifier> <name>ExpectedException</name></type> <name>expectedException</name> <init>= <expr><call><name><name>ExpectedException</name><operator>.</operator><name>none</name></name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>

    <decl_stmt><decl><annotation>@<name>Mock</name></annotation> <type><name>File</name></type> <name>mockScratchDir</name></decl>;</decl_stmt>
    <decl_stmt><decl><annotation>@<name>Mock</name></annotation> <type><name>WebAppContext</name></type> <name>mockWebAppContext</name></decl>;</decl_stmt>
    <decl_stmt><decl><annotation>@<name>Mock</name></annotation> <type><name>WebRootResourceLocator</name></type> <name>mockWebRootResourceLocator</name></decl>;</decl_stmt>

    <decl_stmt><decl><type><specifier>private</specifier> <name>JspHandler</name></type> <name>jspHandler</name></decl>;</decl_stmt>

    <function><annotation>@<name>Before</name></annotation>
    <type><specifier>public</specifier> <name>void</name></type> <name>setUp</name><parameter_list>()</parameter_list> <throws>throws <argument><expr><name>Exception</name></expr></argument></throws> <block>{<block_content>
        <expr_stmt><expr><name>jspHandler</name> <operator>=</operator> <operator>new</operator> <call><name>JspHandler</name><argument_list>(<argument><expr><name>mockScratchDir</name></expr></argument>, <argument><expr><name>mockWebRootResourceLocator</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>when</name><argument_list>(<argument><expr><call><name><name>mockWebRootResourceLocator</name><operator>.</operator><name>getWebRootResourceUri</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call><operator>.</operator><call><name>thenReturn</name><argument_list>(<argument><expr><operator>new</operator> <call><name>URI</name><argument_list>(<argument><expr><literal type="string">"/webroot"</literal></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    </block_content>}</block></function>

    <function><annotation>@<name>After</name></annotation>
    <type><specifier>public</specifier> <name>void</name></type> <name>tearDown</name><parameter_list>()</parameter_list> <throws>throws <argument><expr><name>Exception</name></expr></argument></throws> <block>{<block_content>
        <expr_stmt><expr><call><name>verify</name><argument_list>(<argument><expr><name>mockScratchDir</name></expr></argument>)</argument_list></call><operator>.</operator><call><name>exists</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
    </block_content>}</block></function>

    <function><annotation>@<name>Test</name></annotation>
    <type><specifier>public</specifier> <name>void</name></type> <name>scratchDir_Is_Created_When_Setup_Called_And_ScratchDir_Did_Not_Exist</name><parameter_list>()</parameter_list> <throws>throws <argument><expr><name>IOException</name></expr></argument>, <argument><expr><name>URISyntaxException</name></expr></argument></throws> <block>{<block_content>
        <expr_stmt><expr><call><name>when</name><argument_list>(<argument><expr><call><name><name>mockScratchDir</name><operator>.</operator><name>exists</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call><operator>.</operator><call><name>thenReturn</name><argument_list>(<argument><expr><literal type="boolean">false</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>when</name><argument_list>(<argument><expr><call><name><name>mockScratchDir</name><operator>.</operator><name>mkdirs</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call><operator>.</operator><call><name>thenReturn</name><argument_list>(<argument><expr><literal type="boolean">true</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <expr_stmt><expr><call><name><name>jspHandler</name><operator>.</operator><name>setupWebAppContext</name></name><argument_list>(<argument><expr><name>mockWebAppContext</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <expr_stmt><expr><call><name>verify</name><argument_list>(<argument><expr><name>mockScratchDir</name></expr></argument>)</argument_list></call><operator>.</operator><call><name>mkdirs</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
    </block_content>}</block></function>

    <function><annotation>@<name>Test</name></annotation>
    <type><specifier>public</specifier> <name>void</name></type> <name>scratchDir_Cannot_Be_Created_When_Setup_Called_And_ScratchDir_Did_Not_Exist</name><parameter_list>()</parameter_list>
            <throws>throws <argument><expr><name>IOException</name></expr></argument>, <argument><expr><name>URISyntaxException</name></expr></argument></throws> <block>{<block_content>
        <expr_stmt><expr><call><name>when</name><argument_list>(<argument><expr><call><name><name>mockScratchDir</name><operator>.</operator><name>exists</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call><operator>.</operator><call><name>thenReturn</name><argument_list>(<argument><expr><literal type="boolean">false</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>when</name><argument_list>(<argument><expr><call><name><name>mockScratchDir</name><operator>.</operator><name>mkdirs</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call><operator>.</operator><call><name>thenReturn</name><argument_list>(<argument><expr><literal type="boolean">false</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <expr_stmt><expr><call><name><name>expectedException</name><operator>.</operator><name>expect</name></name><argument_list>(<argument><expr><name><name>IOException</name><operator>.</operator><name>class</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>jspHandler</name><operator>.</operator><name>setupWebAppContext</name></name><argument_list>(<argument><expr><name>mockWebAppContext</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <expr_stmt><expr><call><name>verify</name><argument_list>(<argument><expr><name>mockScratchDir</name></expr></argument>)</argument_list></call><operator>.</operator><call><name>mkdirs</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
    </block_content>}</block></function>

    <function><annotation>@<name>Test</name></annotation>
    <type><specifier>public</specifier> <name>void</name></type> <name>scratchDir_Is_Reused_When_Setup_Called_And_ScratchDir_Existed</name><parameter_list>()</parameter_list> <throws>throws <argument><expr><name>IOException</name></expr></argument>, <argument><expr><name>URISyntaxException</name></expr></argument></throws> <block>{<block_content>
        <expr_stmt><expr><call><name>when</name><argument_list>(<argument><expr><call><name><name>mockScratchDir</name><operator>.</operator><name>exists</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call><operator>.</operator><call><name>thenReturn</name><argument_list>(<argument><expr><literal type="boolean">true</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <expr_stmt><expr><call><name><name>jspHandler</name><operator>.</operator><name>setupWebAppContext</name></name><argument_list>(<argument><expr><name>mockWebAppContext</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <expr_stmt><expr><call><name>verify</name><argument_list>(<argument><expr><name>mockScratchDir</name></expr></argument>, <argument><expr><call><name>times</name><argument_list>(<argument><expr><literal type="number">0</literal></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call><operator>.</operator><call><name>mkdirs</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
    </block_content>}</block></function>
}</block></class>
<expr_stmt><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>server</name><operator>/</operator><name>src</name><operator>/</operator><name>test</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>server</name><operator>/</operator><name><name>TestSSLServerConnectorFactory</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>server</name><operator>/</operator><name>src</name><operator>/</operator><name>test</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>server</name><operator>/</operator><name><name>TestSSLServerConnectorFactory</name><operator>.</operator><name>java</name></name>
<operator>new</operator> <name>file</name> <name>mode</name> <literal type="number">100644</literal>
<name>index</name> <literal type="number">000000000..9634da83f</literal>
<operator>--</operator> <operator>/</operator><name>dev</name><operator>/</operator><literal type="null">null</literal>
<operator>++</operator> <name>b</name><operator>/</operator><name>server</name><operator>/</operator><name>src</name><operator>/</operator><name>test</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>server</name><operator>/</operator><name><name>TestSSLServerConnectorFactory</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">0</literal></expr><operator>,</operator><expr><literal type="number">0</literal> <operator>+</operator><literal type="number">1</literal></expr><operator>,</operator><expr><literal type="number">137</literal> @@</expr></expr_stmt>
<comment type="block" format="javadoc">/**
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */</comment>

<package>package <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>server</name></name>;</package>

<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>hadoop</name><operator>.</operator><name>conf</name><operator>.</operator><name>Configuration</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>eclipse</name><operator>.</operator><name>jetty</name><operator>.</operator><name>server</name><operator>.</operator><name>Server</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>eclipse</name><operator>.</operator><name>jetty</name><operator>.</operator><name>server</name><operator>.</operator><name>ServerConnector</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>eclipse</name><operator>.</operator><name>jetty</name><operator>.</operator><name>util</name><operator>.</operator><name>ssl</name><operator>.</operator><name>SslContextFactory</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>junit</name><operator>.</operator><name>After</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>junit</name><operator>.</operator><name>Before</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>junit</name><operator>.</operator><name>Test</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>junit</name><operator>.</operator><name>runner</name><operator>.</operator><name>RunWith</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>mockito</name><operator>.</operator><name>Mock</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>mockito</name><operator>.</operator><name>runners</name><operator>.</operator><name>MockitoJUnitRunner</name></name>;</import>

<import>import static <name><name>org</name><operator>.</operator><name>mockito</name><operator>.</operator><name>Matchers</name><operator>.</operator><name>anyString</name></name>;</import>
<import>import static <name><name>org</name><operator>.</operator><name>mockito</name><operator>.</operator><name>Mockito</name><operator>.</operator><name>verify</name></name>;</import>
<import>import static <name><name>org</name><operator>.</operator><name>mockito</name><operator>.</operator><name>Mockito</name><operator>.</operator><name>verifyNoMoreInteractions</name></name>;</import>

<comment type="block" format="javadoc">/**
 *  Server tests
 */</comment>
<class><annotation>@<name>RunWith</name><argument_list>(<argument><expr><name><name>MockitoJUnitRunner</name><operator>.</operator><name>class</name></name></expr></argument>)</argument_list></annotation>
<specifier>public</specifier> class <name>TestSSLServerConnectorFactory</name> <block>{
    <decl_stmt><decl><annotation>@<name>Mock</name></annotation> <type><specifier>private</specifier> <name>SslContextFactory</name></type> <name>mockSSLContextFactory</name></decl>;</decl_stmt>
    <decl_stmt><decl><annotation>@<name>Mock</name></annotation> <type><specifier>private</specifier> <name>SSLServerConnectorFactory</name></type> <name>mockSSLServerConnectorFactory</name></decl>;</decl_stmt>
    <decl_stmt><decl><annotation>@<name>Mock</name></annotation> <type><specifier>private</specifier> <name>Server</name></type> <name>mockServer</name></decl>;</decl_stmt>
    <decl_stmt><decl><annotation>@<name>Mock</name></annotation> <type><specifier>private</specifier> <name>ServerConnector</name></type> <name>mockServerConnector</name></decl>;</decl_stmt>

    <decl_stmt><decl><type><specifier>private</specifier> <name>Configuration</name></type> <name>testConfig</name></decl>;</decl_stmt>
    <decl_stmt><decl><type><specifier>private</specifier> <name>SSLServerConnectorFactory</name></type> <name>sslServerConnectorFactory</name></decl>;</decl_stmt>

    <function><annotation>@<name>Before</name></annotation> <type><specifier>public</specifier> <name>void</name></type> <name>setUp</name><parameter_list>()</parameter_list> <block>{<block_content>
        <expr_stmt><expr><name>testConfig</name> <operator>=</operator> <operator>new</operator> <call><name>Configuration</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>testConfig</name><operator>.</operator><name>set</name></name><argument_list>(<argument><expr><literal type="string">"oozie.https.truststore.file"</literal></expr></argument>, <argument><expr><literal type="string">"test_truststore_file"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>testConfig</name><operator>.</operator><name>set</name></name><argument_list>(<argument><expr><literal type="string">"oozie.https.truststore.pass"</literal></expr></argument>, <argument><expr><literal type="string">"trustpass"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>testConfig</name><operator>.</operator><name>set</name></name><argument_list>(<argument><expr><literal type="string">"oozie.https.keystore.file"</literal></expr></argument>, <argument><expr><literal type="string">"test_keystore_file"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>testConfig</name><operator>.</operator><name>set</name></name><argument_list>(<argument><expr><literal type="string">"oozie.https.keystore.pass"</literal></expr></argument>, <argument><expr><literal type="string">"keypass"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>testConfig</name><operator>.</operator><name>set</name></name><argument_list>(<argument><expr><literal type="string">"oozie.http.port"</literal></expr></argument>, <argument><expr><literal type="string">"11000"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>testConfig</name><operator>.</operator><name>set</name></name><argument_list>(<argument><expr><literal type="string">"oozie.http.request.header.size"</literal></expr></argument>, <argument><expr><literal type="string">"65536"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>testConfig</name><operator>.</operator><name>set</name></name><argument_list>(<argument><expr><literal type="string">"oozie.http.response.header.size"</literal></expr></argument>, <argument><expr><literal type="string">"65536"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>testConfig</name><operator>.</operator><name>set</name></name><argument_list>(<argument><expr><literal type="string">"oozie.https.include.protocols"</literal></expr></argument>, <argument><expr><literal type="string">"TLSv1,SSLv2Hello,TLSv1.1,TLSv1.2"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>testConfig</name><operator>.</operator><name>set</name></name><argument_list>(<argument><expr><literal type="string">"oozie.https.exclude.cipher.suites"</literal></expr></argument>,
                <argument><expr><literal type="string">"TLS_ECDHE_RSA_WITH_RC4_128_SHA,SSL_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA,SSL_RSA_WITH_DES_CBC_SHA,"</literal> <operator>+</operator>
                <literal type="string">"SSL_DHE_RSA_WITH_DES_CBC_SHA,SSL_RSA_EXPORT_WITH_RC4_40_MD5,SSL_RSA_EXPORT_WITH_DES40_CBC_SHA,"</literal> <operator>+</operator>
                <literal type="string">"SSL_RSA_WITH_RC4_128_MD5"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <expr_stmt><expr><name>sslServerConnectorFactory</name> <operator>=</operator> <operator>new</operator> <call><name>SSLServerConnectorFactory</name><argument_list>(<argument><expr><name>mockSSLContextFactory</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    </block_content>}</block></function>

    <function><annotation>@<name>After</name></annotation>
    <type><specifier>public</specifier> <name>void</name></type> <name>tearDown</name><parameter_list>()</parameter_list> <block>{<block_content>
        <expr_stmt><expr><call><name>verify</name><argument_list>(<argument><expr><name>mockSSLContextFactory</name></expr></argument>)</argument_list></call><operator>.</operator><call><name>setTrustStorePath</name><argument_list>(<argument><expr><call><name>anyString</name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>verify</name><argument_list>(<argument><expr><name>mockSSLContextFactory</name></expr></argument>)</argument_list></call><operator>.</operator><call><name>setTrustStorePassword</name><argument_list>(<argument><expr><call><name>anyString</name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>verify</name><argument_list>(<argument><expr><name>mockSSLContextFactory</name></expr></argument>)</argument_list></call><operator>.</operator><call><name>setKeyStorePath</name><argument_list>(<argument><expr><call><name>anyString</name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>verify</name><argument_list>(<argument><expr><name>mockSSLContextFactory</name></expr></argument>)</argument_list></call><operator>.</operator><call><name>setKeyManagerPassword</name><argument_list>(<argument><expr><call><name>anyString</name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>verifyNoMoreInteractions</name><argument_list>(
                <argument><expr><name>mockServerConnector</name></expr></argument>,
                <argument><expr><name>mockSSLServerConnectorFactory</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    </block_content>}</block></function>

    <function><type><specifier>private</specifier> <name>void</name></type> <name>verifyDefaultExcludeCipherSuites</name><parameter_list>()</parameter_list> <block>{<block_content>
        <expr_stmt><expr><call><name>verify</name><argument_list>(<argument><expr><name>mockSSLContextFactory</name></expr></argument>)</argument_list></call><operator>.</operator><call><name>setExcludeCipherSuites</name><argument_list>(
                <argument><expr><literal type="string">"TLS_ECDHE_RSA_WITH_RC4_128_SHA"</literal></expr></argument>,
                <argument><expr><literal type="string">"SSL_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA"</literal></expr></argument>,
                <argument><expr><literal type="string">"SSL_RSA_WITH_DES_CBC_SHA"</literal></expr></argument>,
                <argument><expr><literal type="string">"SSL_DHE_RSA_WITH_DES_CBC_SHA"</literal></expr></argument>,
                <argument><expr><literal type="string">"SSL_RSA_EXPORT_WITH_RC4_40_MD5"</literal></expr></argument>,
                <argument><expr><literal type="string">"SSL_RSA_EXPORT_WITH_DES40_CBC_SHA"</literal></expr></argument>,
                <argument><expr><literal type="string">"SSL_RSA_WITH_RC4_128_MD5"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    </block_content>}</block></function>

    <function><type><specifier>private</specifier> <name>void</name></type> <name>verifyDefaultIncludeProtocols</name><parameter_list>()</parameter_list> <block>{<block_content>
        <expr_stmt><expr><call><name>verify</name><argument_list>(<argument><expr><name>mockSSLContextFactory</name></expr></argument>)</argument_list></call><operator>.</operator><call><name>setIncludeProtocols</name><argument_list>(
                <argument><expr><literal type="string">"TLSv1"</literal></expr></argument>,
                <argument><expr><literal type="string">"SSLv2Hello"</literal></expr></argument>,
                <argument><expr><literal type="string">"TLSv1.1"</literal></expr></argument>,
                <argument><expr><literal type="string">"TLSv1.2"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    </block_content>}</block></function>

    <function><annotation>@<name>Test</name></annotation>
    <type><specifier>public</specifier> <name>void</name></type> <name>includeProtocolsHaveDefaultValues</name><parameter_list>()</parameter_list> <throws>throws <argument><expr><name>Exception</name></expr></argument></throws> <block>{<block_content>
        <expr_stmt><expr><call><name><name>sslServerConnectorFactory</name><operator>.</operator><name>createSecureServerConnector</name></name><argument_list>(<argument><expr><literal type="number">42</literal></expr></argument>, <argument><expr><name>testConfig</name></expr></argument>, <argument><expr><name>mockServer</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <expr_stmt><expr><call><name>verifyDefaultIncludeProtocols</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>verifyDefaultExcludeCipherSuites</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
    </block_content>}</block></function>

    <function><annotation>@<name>Test</name></annotation>
    <type><specifier>public</specifier> <name>void</name></type> <name>includeProtocolsCanBeSetViaConfigFile</name><parameter_list>()</parameter_list> <throws>throws <argument><expr><name>Exception</name></expr></argument></throws> <block>{<block_content>
        <decl_stmt><decl><type><name>SSLServerConnectorFactory</name></type> <name>sslServerConnectorFactory</name> <init>= <expr><operator>new</operator> <call><name>SSLServerConnectorFactory</name><argument_list>(<argument><expr><name>mockSSLContextFactory</name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name><name>testConfig</name><operator>.</operator><name>set</name></name><argument_list>(<argument><expr><literal type="string">"oozie.https.include.protocols"</literal></expr></argument>, <argument><expr><literal type="string">"TLSv1,TLSv1.2"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>sslServerConnectorFactory</name><operator>.</operator><name>createSecureServerConnector</name></name><argument_list>(<argument><expr><literal type="number">42</literal></expr></argument>, <argument><expr><name>testConfig</name></expr></argument>, <argument><expr><name>mockServer</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <expr_stmt><expr><call><name>verify</name><argument_list>(<argument><expr><name>mockSSLContextFactory</name></expr></argument>)</argument_list></call><operator>.</operator><call><name>setIncludeProtocols</name><argument_list>(
                <argument><expr><literal type="string">"TLSv1"</literal></expr></argument>,
                <argument><expr><literal type="string">"TLSv1.2"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    </block_content>}</block></function>

    <function><annotation>@<name>Test</name></annotation>
    <type><specifier>public</specifier> <name>void</name></type> <name>excludeCipherSuitesHaveDefaultValues</name><parameter_list>()</parameter_list> <throws>throws <argument><expr><name>Exception</name></expr></argument></throws> <block>{<block_content>
        <expr_stmt><expr><call><name><name>sslServerConnectorFactory</name><operator>.</operator><name>createSecureServerConnector</name></name><argument_list>(<argument><expr><literal type="number">42</literal></expr></argument>, <argument><expr><name>testConfig</name></expr></argument>, <argument><expr><name>mockServer</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <expr_stmt><expr><call><name>verifyDefaultExcludeCipherSuites</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>verifyDefaultIncludeProtocols</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
    </block_content>}</block></function>

    <function><annotation>@<name>Test</name></annotation>
    <type><specifier>public</specifier> <name>void</name></type> <name>excludeCipherSuitesCanBeSetViaConfigFile</name><parameter_list>()</parameter_list> <throws>throws <argument><expr><name>Exception</name></expr></argument></throws> <block>{<block_content>
        <expr_stmt><expr><call><name><name>testConfig</name><operator>.</operator><name>set</name></name><argument_list>(<argument><expr><literal type="string">"oozie.https.exclude.cipher.suites"</literal></expr></argument>,<argument><expr><literal type="string">"TLS_ECDHE_RSA_WITH_RC4_128_SHA,SSL_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA,"</literal>
                <operator>+</operator> <literal type="string">"SSL_RSA_EXPORT_WITH_DES40_CBC_SHA"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <expr_stmt><expr><call><name><name>sslServerConnectorFactory</name><operator>.</operator><name>createSecureServerConnector</name></name><argument_list>(<argument><expr><literal type="number">42</literal></expr></argument>, <argument><expr><name>testConfig</name></expr></argument>, <argument><expr><name>mockServer</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <expr_stmt><expr><call><name>verify</name><argument_list>(<argument><expr><name>mockSSLContextFactory</name></expr></argument>)</argument_list></call><operator>.</operator><call><name>setExcludeCipherSuites</name><argument_list>(
                <argument><expr><literal type="string">"TLS_ECDHE_RSA_WITH_RC4_128_SHA"</literal></expr></argument>,
                <argument><expr><literal type="string">"SSL_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA"</literal></expr></argument>,
                <argument><expr><literal type="string">"SSL_RSA_EXPORT_WITH_DES40_CBC_SHA"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>verifyDefaultIncludeProtocols</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
    </block_content>}</block></function>
}</block></class>
<expr_stmt><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>assemblies</name><operator>/</operator><name>distro</name><operator>-</operator><name><name>jetty</name><operator>.</operator><name>xml</name></name> <name>b</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>assemblies</name><operator>/</operator><name>distro</name><operator>-</operator><name><name>jetty</name><operator>.</operator><name>xml</name></name>
<operator>new</operator> <name>file</name> <name>mode</name> <literal type="number">100644</literal>
<name>index</name> <literal type="number">000000000..a4bee03c8</literal>
<operator>--</operator> <operator>/</operator><name>dev</name><operator>/</operator><literal type="null">null</literal>
<operator>++</operator> <name>b</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>assemblies</name><operator>/</operator><name>distro</name><operator>-</operator><name><name>jetty</name><operator>.</operator><name>xml</name></name>
@@ <operator>-</operator><literal type="number">0</literal></expr><operator>,</operator><expr><literal type="number">0</literal> <operator>+</operator><literal type="number">1</literal></expr><operator>,</operator><expr><literal type="number">155</literal> @@
<operator>&lt;</operator><operator>!</operator><operator>--</operator>
  <name>Licensed</name> <name>to</name> <name>the</name> <name>Apache</name> <name>Software</name> <call><name>Foundation</name> <argument_list>(<argument><expr><name>ASF</name></expr></argument>)</argument_list></call> <name>under</name> <name>one</name>
  <name>or</name> <name>more</name> <name>contributor</name> <name>license</name> <name><name>agreements</name><operator>.</operator>  <name>See</name></name> <name>the</name> <name>NOTICE</name> <name>file</name>
  <name>distributed</name> <name>with</name> <name>this</name> <name>work</name></expr></expr_stmt> <for>for additional information
  regarding copyright ownership.  The ASF licenses this file
  to you under the Apache License<operator>,</operator> <expr_stmt><expr><name>Version</name> <literal type="number">2.0</literal> <operator>(</operator><name>the</name>
  <literal type="string">"License"</literal><operator>)</operator></expr>;</expr_stmt></for> <expr_stmt><expr><name>you</name> <name>may</name> <name>not</name> <name>use</name> <name>this</name> <name>file</name> <name>except</name> <name>in</name> <name>compliance</name>
  <name>with</name> <name>the</name> <name><name>License</name><operator>.</operator>  <name>You</name></name> <name>may</name> <name>obtain</name> <name>a</name> <name>copy</name> <name>of</name> <name>the</name> <name>License</name> <name>at</name>

       <name>http</name><operator>:</operator><comment type="line">//www.apache.org/licenses/LICENSE-2.0</comment>

  <name>Unless</name> <name>required</name> <name>by</name> <name>applicable</name> <name>law</name> <name>or</name> <name>agreed</name> <name>to</name> <name>in</name> <name>writing</name></expr><operator>,</operator> <expr><name>software</name>
  <name>distributed</name> <name>under</name> <name>the</name> <name>License</name> <name>is</name> <name>distributed</name> <name>on</name> <name>an</name> <literal type="string">"AS IS"</literal> <name>BASIS</name></expr><operator>,</operator>
  <expr><name>WITHOUT</name> <name>WARRANTIES</name> <name>OR</name> <name>CONDITIONS</name> <name>OF</name> <name>ANY</name> <name>KIND</name></expr><operator>,</operator> <expr><name>either</name> <name>express</name> <name>or</name> <name><name>implied</name><operator>.</operator>
  <name>See</name></name> <name>the</name> <name>License</name></expr></expr_stmt> <for>for the specific language governing permissions and
  limitations under the License.
--&gt;
&lt;assembly&gt;
    &lt;id&gt;distro&lt;/id&gt;
    &lt;formats&gt;
        &lt;format&gt;dir&lt;/format&gt;
        &lt;format&gt;tar.gz&lt;/format&gt;
    &lt;/formats&gt;
    &lt;includeBaseDirectory&gt;true&lt;/includeBaseDirectory&gt;
    &lt;baseDirectory&gt;oozie-$<block>{<block_content><expr><name><name>project</name><operator>.</operator><name>version</name></name></expr></block_content>}</block></for><expr_stmt><expr><operator>&lt;</operator><operator>/</operator><name>baseDirectory</name><operator>&gt;</operator>
    <operator>&lt;</operator><name>fileSets</name><operator>&gt;</operator>
        <operator>&lt;</operator><operator>!</operator><operator>--</operator> <name>Oozie</name> <name>configuration</name> <name>files</name> <operator>--</operator><operator>&gt;</operator>
        <operator>&lt;</operator><name>fileSet</name><operator>&gt;</operator>
            <operator>&lt;</operator><name>directory</name><operator>&gt;</operator><name>$</name><block>{<expr><name>basedir</name></expr>}</block><operator>/</operator><operator>..</operator><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>conf</name><operator>/</operator><operator>&lt;</operator><operator>/</operator><name>directory</name><operator>&gt;</operator>
            <operator>&lt;</operator><name>outputDirectory</name><operator>&gt;</operator><operator>/</operator><name><name>conf</name><argument_list type="generic">&lt;<argument><operator>/</operator><name>outputDirectory</name></argument>&gt;</argument_list></name>
            <operator>&lt;</operator><name>includes</name><operator>&gt;</operator>
                <operator>&lt;</operator><name>include</name><operator>&gt;</operator><operator>*</operator><operator>*</operator><operator>&lt;</operator><operator>/</operator><name>include</name><operator>&gt;</operator>
            <operator>&lt;</operator><operator>/</operator><name>includes</name><operator>&gt;</operator>
        <operator>&lt;</operator><operator>/</operator><name>fileSet</name><operator>&gt;</operator>
        <operator>&lt;</operator><operator>!</operator><operator>--</operator> <name>Distro</name> <name>files</name></expr><operator>,</operator> <expr><name>readme</name></expr><operator>,</operator> <expr><name>licenses</name></expr><operator>,</operator> <expr><name>etc</name> <operator>--</operator><operator>&gt;</operator>
        <operator>&lt;</operator><name>fileSet</name><operator>&gt;</operator>
            <operator>&lt;</operator><name>directory</name><operator>&gt;</operator><name>$</name><block>{<expr><name>basedir</name></expr>}</block><operator>/</operator><operator>..</operator><operator>/</operator><operator>&lt;</operator><operator>/</operator><name>directory</name><operator>&gt;</operator>
            <operator>&lt;</operator><name>outputDirectory</name><operator>&gt;</operator><operator>/</operator><operator>&lt;</operator><operator>/</operator><name>outputDirectory</name><operator>&gt;</operator>
            <operator>&lt;</operator><name>includes</name><operator>&gt;</operator>
                <operator>&lt;</operator><name>include</name><operator>&gt;</operator><name><name>license</name><operator>.</operator><name><name>txt</name><argument_list type="generic">&lt;<argument><operator>/</operator><name>include</name></argument>&gt;</argument_list></name></name>
                <operator>&lt;</operator><name>include</name><operator>&gt;</operator><name><name>notice</name><operator>.</operator><name><name>txt</name><argument_list type="generic">&lt;<argument><operator>/</operator><name>include</name></argument>&gt;</argument_list></name></name>
                <operator>&lt;</operator><name>include</name><operator>&gt;</operator><name><name>readme</name><operator>.</operator><name><name>txt</name><argument_list type="generic">&lt;<argument><operator>/</operator><name>include</name></argument>&gt;</argument_list></name></name>
                <operator>&lt;</operator><name>include</name><operator>&gt;</operator><name>release</name><operator>-</operator><name><name>log</name><operator>.</operator><name><name>txt</name><argument_list type="generic">&lt;<argument><operator>/</operator><name>include</name></argument>&gt;</argument_list></name></name>
            <operator>&lt;</operator><operator>/</operator><name>includes</name><operator>&gt;</operator>
        <operator>&lt;</operator><operator>/</operator><name>fileSet</name><operator>&gt;</operator>
        <operator>&lt;</operator><name>fileSet</name><operator>&gt;</operator>
            <operator>&lt;</operator><name>directory</name><operator>&gt;</operator><name>$</name><block>{<expr><name>basedir</name></expr>}</block><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name><name>bin</name><argument_list type="generic">&lt;<argument><operator>/</operator><name>directory</name></argument>&gt;</argument_list></name>
            <operator>&lt;</operator><name>outputDirectory</name><operator>&gt;</operator><operator>/</operator><name><name>bin</name><argument_list type="generic">&lt;<argument><operator>/</operator><name>outputDirectory</name></argument>&gt;</argument_list></name>
            <operator>&lt;</operator><name>includes</name><operator>&gt;</operator>
                <operator>&lt;</operator><name>include</name><operator>&gt;</operator><operator>*</operator><operator>&lt;</operator><operator>/</operator><name>include</name><operator>&gt;</operator>
            <operator>&lt;</operator><operator>/</operator><name>includes</name><operator>&gt;</operator>
            <operator>&lt;</operator><name>fileMode</name><operator>&gt;</operator><literal type="number">0755</literal><operator>&lt;</operator><operator>/</operator><name>fileMode</name><operator>&gt;</operator>
        <operator>&lt;</operator><operator>/</operator><name>fileSet</name><operator>&gt;</operator>
        <operator>&lt;</operator><operator>!</operator><operator>--</operator> <name>Client</name> <operator>--</operator><operator>&gt;</operator>
        <operator>&lt;</operator><name>fileSet</name><operator>&gt;</operator>
            <operator>&lt;</operator><name>directory</name><operator>&gt;</operator><name>$</name><block>{<expr><name>basedir</name></expr>}</block><operator>/</operator><operator>..</operator><operator>/</operator><name>client</name><operator>/</operator><name>target</name><operator>/</operator><name>oozie</name><operator>-</operator><name>client</name><operator>-</operator><name>$</name><block>{<expr><name><name>project</name><operator>.</operator><name>version</name></name></expr>}</block><operator>-</operator><name>client</name><operator>/</operator><name>oozie</name><operator>-</operator><name>client</name><operator>-</operator><name>$</name><block>{<expr><name><name>project</name><operator>.</operator><name>version</name></name></expr>}</block><operator>/</operator><name><name>bin</name><argument_list type="generic">&lt;<argument><operator>/</operator><name>directory</name></argument>&gt;</argument_list></name>
            <operator>&lt;</operator><name>outputDirectory</name><operator>&gt;</operator><operator>/</operator><name><name>bin</name><argument_list type="generic">&lt;<argument><operator>/</operator><name>outputDirectory</name></argument>&gt;</argument_list></name>
            <operator>&lt;</operator><name>includes</name><operator>&gt;</operator>
                <operator>&lt;</operator><name>include</name><operator>&gt;</operator><operator>*</operator><operator>&lt;</operator><operator>/</operator><name>include</name><operator>&gt;</operator>
            <operator>&lt;</operator><operator>/</operator><name>includes</name><operator>&gt;</operator>
            <operator>&lt;</operator><name>fileMode</name><operator>&gt;</operator><literal type="number">0755</literal><operator>&lt;</operator><operator>/</operator><name>fileMode</name><operator>&gt;</operator>
        <operator>&lt;</operator><operator>/</operator><name>fileSet</name><operator>&gt;</operator>
        <operator>&lt;</operator><operator>!</operator><operator>--</operator> <name>Tools</name> <operator>--</operator><operator>&gt;</operator>
        <operator>&lt;</operator><name>fileSet</name><operator>&gt;</operator>
            <operator>&lt;</operator><name>directory</name><operator>&gt;</operator><name>$</name><block>{<expr><name>basedir</name></expr>}</block><operator>/</operator><operator>..</operator><operator>/</operator><name>tools</name><operator>/</operator><name>target</name><operator>/</operator><name>oozie</name><operator>-</operator><name>tools</name><operator>-</operator><name>$</name><block>{<expr><name><name>project</name><operator>.</operator><name>version</name></name></expr>}</block><operator>-</operator><name>tools</name><operator>/</operator><name>oozie</name><operator>-</operator><name>tools</name><operator>-</operator><name>$</name><block>{<expr><name><name>project</name><operator>.</operator><name>version</name></name></expr>}</block><operator>/</operator><name><name>bin</name><argument_list type="generic">&lt;<argument><operator>/</operator><name>directory</name></argument>&gt;</argument_list></name>
            <operator>&lt;</operator><name>outputDirectory</name><operator>&gt;</operator><operator>/</operator><name><name>bin</name><argument_list type="generic">&lt;<argument><operator>/</operator><name>outputDirectory</name></argument>&gt;</argument_list></name>
            <operator>&lt;</operator><name>includes</name><operator>&gt;</operator>
                <operator>&lt;</operator><name>include</name><operator>&gt;</operator><operator>*</operator><operator>&lt;</operator><operator>/</operator><name>include</name><operator>&gt;</operator>
            <operator>&lt;</operator><operator>/</operator><name>includes</name><operator>&gt;</operator>
            <operator>&lt;</operator><name>fileMode</name><operator>&gt;</operator><literal type="number">0755</literal><operator>&lt;</operator><operator>/</operator><name>fileMode</name><operator>&gt;</operator>
        <operator>&lt;</operator><operator>/</operator><name>fileSet</name><operator>&gt;</operator>
        <operator>&lt;</operator><name>fileSet</name><operator>&gt;</operator>
            <operator>&lt;</operator><name>directory</name><operator>&gt;</operator><name>$</name><block>{<expr><name>basedir</name></expr>}</block><operator>/</operator><operator>..</operator><operator>/</operator><name>tools</name><operator>/</operator><name>target</name><operator>/</operator><name>oozie</name><operator>-</operator><name>tools</name><operator>-</operator><name>$</name><block>{<expr><name><name>project</name><operator>.</operator><name>version</name></name></expr>}</block><operator>-</operator><name>tools</name><operator>/</operator><name>oozie</name><operator>-</operator><name>tools</name><operator>-</operator><name>$</name><block>{<expr><name><name>project</name><operator>.</operator><name>version</name></name></expr>}</block><operator>/</operator><name><name>libtools</name><argument_list type="generic">&lt;<argument><operator>/</operator><name>directory</name></argument>&gt;</argument_list></name>
            <operator>&lt;</operator><name>outputDirectory</name><operator>&gt;</operator><operator>/</operator><name><name>libtools</name><argument_list type="generic">&lt;<argument><operator>/</operator><name>outputDirectory</name></argument>&gt;</argument_list></name>
            <operator>&lt;</operator><name>includes</name><operator>&gt;</operator>
                <operator>&lt;</operator><name>include</name><operator>&gt;</operator><operator>*</operator><operator>&lt;</operator><operator>/</operator><name>include</name><operator>&gt;</operator>
            <operator>&lt;</operator><operator>/</operator><name>includes</name><operator>&gt;</operator>
        <operator>&lt;</operator><operator>/</operator><name>fileSet</name><operator>&gt;</operator>
        <operator>&lt;</operator><operator>!</operator><operator>--</operator>  <name>Oozie</name> <name>Login</name> <name>Server</name> <name>Example</name> <name>war</name> <name>and</name> <name>jar</name> <operator>--</operator><operator>&gt;</operator>
         <operator>&lt;</operator><name>fileSet</name><operator>&gt;</operator>
            <operator>&lt;</operator><name>directory</name><operator>&gt;</operator><name>$</name><block>{<expr><name>basedir</name></expr>}</block><operator>/</operator><operator>..</operator><operator>/</operator><name>login</name><operator>/</operator><name><name>target</name><argument_list type="generic">&lt;<argument><operator>/</operator><name>directory</name></argument>&gt;</argument_list></name>
            <operator>&lt;</operator><name>outputDirectory</name><operator>&gt;</operator><operator>/</operator><operator>&lt;</operator><operator>/</operator><name>outputDirectory</name><operator>&gt;</operator>
            <operator>&lt;</operator><name>includes</name><operator>&gt;</operator>
                <operator>&lt;</operator><name>include</name><operator>&gt;</operator><name>oozie</name><operator>-</operator><name><name>login</name><operator>.</operator><name><name>war</name><argument_list type="generic">&lt;<argument><operator>/</operator><name>include</name></argument>&gt;</argument_list></name></name>
                <operator>&lt;</operator><name>include</name><operator>&gt;</operator><name>oozie</name><operator>-</operator><name><name>login</name><operator>.</operator><name><name>jar</name><argument_list type="generic">&lt;<argument><operator>/</operator><name>include</name></argument>&gt;</argument_list></name></name>
            <operator>&lt;</operator><operator>/</operator><name>includes</name><operator>&gt;</operator>
            <operator>&lt;</operator><name>fileMode</name><operator>&gt;</operator><literal type="number">0555</literal><operator>&lt;</operator><operator>/</operator><name>fileMode</name><operator>&gt;</operator>
        <operator>&lt;</operator><operator>/</operator><name>fileSet</name><operator>&gt;</operator>
        <operator>&lt;</operator><operator>!</operator><operator>--</operator> <name>Oozie</name> <name>Server</name> <operator>-</operator> <name>embedded</name> <name>jetty</name> <operator>--</operator><operator>&gt;</operator>
        <operator>&lt;</operator><name>fileSet</name><operator>&gt;</operator>
                <operator>&lt;</operator><name>directory</name><operator>&gt;</operator><name>$</name><block>{<expr><name>basedir</name></expr>}</block><operator>/</operator><operator>..</operator><operator>/</operator><name>server</name><operator>/</operator><name>target</name><operator>/</operator><operator>&lt;</operator><operator>/</operator><name>directory</name><operator>&gt;</operator>
                <operator>&lt;</operator><name>outputDirectory</name><operator>&gt;</operator><operator>/</operator><name>embedded</name><operator>-</operator><name>oozie</name><operator>-</operator><name><name>server</name><argument_list type="generic">&lt;<argument><operator>/</operator><name>outputDirectory</name></argument>&gt;</argument_list></name>
                <operator>&lt;</operator><name>includes</name><operator>&gt;</operator>
                    <operator>&lt;</operator><name>include</name><operator>&gt;</operator><name>oozie</name><operator>-</operator><name>server</name><operator>*</operator><operator>.</operator><name><name>jar</name><argument_list type="generic">&lt;<argument><operator>/</operator><name>include</name></argument>&gt;</argument_list></name>
                    <operator>&lt;</operator><name>include</name><operator>&gt;</operator><operator>*</operator><operator>*</operator><operator>/</operator><name>jetty</name><operator>*</operator><operator>.</operator><name><name>jar</name><argument_list type="generic">&lt;<argument><operator>/</operator><name>include</name></argument>&gt;</argument_list></name>
                    <operator>&lt;</operator><name>include</name><operator>&gt;</operator><operator>*</operator><operator>*</operator><comment type="block">/*jsp*.jar&lt;/include&gt;
                    &lt;include&gt;**/</comment><name>mail</name><operator>*</operator><operator>.</operator><name><name>jar</name><argument_list type="generic">&lt;<argument><operator>/</operator><name>include</name></argument>&gt;</argument_list></name>
                    <operator>&lt;</operator><name>include</name><operator>&gt;</operator><operator>*</operator><operator>*</operator><operator>/</operator><name>apache</name><operator>*</operator><operator>.</operator><name><name>jar</name><argument_list type="generic">&lt;<argument><operator>/</operator><name>include</name></argument>&gt;</argument_list></name>
                    <operator>&lt;</operator><name>include</name><operator>&gt;</operator><operator>*</operator><operator>*</operator><operator>/</operator><name>commons</name><operator>-</operator><name>el</name><operator>*</operator><operator>.</operator><name><name>jar</name><argument_list type="generic">&lt;<argument><operator>/</operator><name>include</name></argument>&gt;</argument_list></name>
                    <operator>&lt;</operator><name>include</name><operator>&gt;</operator><operator>*</operator><operator>*</operator><operator>/</operator><name><name>javax</name><operator>.</operator><name>servlet</name></name><operator>-</operator><name>api</name><operator>-</operator><literal type="number">3.1.0.jar</literal><operator>&lt;</operator><operator>/</operator><name>include</name><operator>&gt;</operator>
                    <operator>&lt;</operator><name>include</name><operator>&gt;</operator><operator>*</operator><operator>*</operator><operator>/</operator><name>jasper</name><operator>*</operator><name><name>jar</name><argument_list type="generic">&lt;<argument><operator>/</operator><name>include</name></argument>&gt;</argument_list></name>
                    <operator>&lt;</operator><name>include</name><operator>&gt;</operator><operator>*</operator><operator>*</operator><operator>/</operator><name>taglibs</name><operator>-</operator><operator>*</operator><name><name>jar</name><argument_list type="generic">&lt;<argument><operator>/</operator><name>include</name></argument>&gt;</argument_list></name>
                    <operator>&lt;</operator><name>include</name><operator>&gt;</operator><operator>*</operator><operator>*</operator><operator>/</operator><name><name>org</name><operator>.</operator><name>eclipse</name><operator>.</operator><name>jdt</name><operator>.</operator><name>core</name></name><operator>-</operator><operator>*</operator><name><name>jar</name><argument_list type="generic">&lt;<argument><operator>/</operator><name>include</name></argument>&gt;</argument_list></name>
                <operator>&lt;</operator><operator>/</operator><name>includes</name><operator>&gt;</operator>
        <operator>&lt;</operator><operator>/</operator><name>fileSet</name><operator>&gt;</operator>
        <operator>&lt;</operator><name>fileSet</name><operator>&gt;</operator>
            <operator>&lt;</operator><name>directory</name><operator>&gt;</operator><name>$</name><block>{<expr><name>basedir</name></expr>}</block><operator>/</operator><operator>..</operator><operator>/</operator><name>webapp</name><operator>/</operator><name>target</name><operator>/</operator><name>oozie</name><operator>-</operator><name>webapp</name><operator>-</operator><name>$</name><block>{<expr><name><name>project</name><operator>.</operator><name>version</name></name></expr>}</block><operator>&lt;</operator><operator>/</operator><name>directory</name><operator>&gt;</operator>
            <operator>&lt;</operator><name>outputDirectory</name><operator>&gt;</operator><operator>/</operator><name>embedded</name><operator>-</operator><name>oozie</name><operator>-</operator><name>server</name><operator>/</operator><name><name>webapp</name><argument_list type="generic">&lt;<argument><operator>/</operator><name>outputDirectory</name></argument>&gt;</argument_list></name>
            <operator>&lt;</operator><name>excludes</name><operator>&gt;</operator>
                <operator>&lt;</operator><name>exclude</name><operator>&gt;</operator><operator>*</operator><operator>*</operator><operator>/</operator><name><name>web</name><operator>.</operator><name><name>xml</name><argument_list type="generic">&lt;<argument><operator>/</operator><name>exclude</name></argument>&gt;</argument_list></name></name>
            <operator>&lt;</operator><operator>/</operator><name>excludes</name><operator>&gt;</operator>
        <operator>&lt;</operator><operator>/</operator><name>fileSet</name><operator>&gt;</operator>
    <operator>&lt;</operator><operator>/</operator><name>fileSets</name><operator>&gt;</operator>
    <operator>&lt;</operator><name>files</name><operator>&gt;</operator>
        <operator>&lt;</operator><operator>!</operator><operator>--</operator> <name>Oozie</name> <name>configuration</name> <name>files</name> <operator>--</operator><operator>&gt;</operator>
        <operator>&lt;</operator><name>file</name><operator>&gt;</operator>
            <operator>&lt;</operator><name>source</name><operator>&gt;</operator><name>$</name><block>{<expr><name>basedir</name></expr>}</block><operator>/</operator><operator>..</operator><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>resources</name><operator>/</operator><name>oozie</name><operator>-</operator>default<operator>.</operator><name><name>xml</name><argument_list type="generic">&lt;<argument><operator>/</operator><name>source</name></argument>&gt;</argument_list></name>
            <operator>&lt;</operator><name>outputDirectory</name><operator>&gt;</operator><operator>/</operator><name><name>conf</name><argument_list type="generic">&lt;<argument><operator>/</operator><name>outputDirectory</name></argument>&gt;</argument_list></name>
        <operator>&lt;</operator><operator>/</operator><name>file</name><operator>&gt;</operator>
        <operator>&lt;</operator><operator>!</operator><operator>--</operator> <name>Oozie</name> <name>core</name> <name>jar</name> <operator>--</operator><operator>&gt;</operator>
        <operator>&lt;</operator><name>file</name><operator>&gt;</operator>
            <operator>&lt;</operator><name>source</name><operator>&gt;</operator><name>$</name><block>{<expr><name>basedir</name></expr>}</block><operator>/</operator><operator>..</operator><operator>/</operator><name>core</name><operator>/</operator><name>target</name><operator>/</operator><name>oozie</name><operator>-</operator><name>core</name><operator>-</operator><name>$</name><block>{<expr><name><name>project</name><operator>.</operator><name>version</name></name></expr>}</block><operator>.</operator><name><name>jar</name><argument_list type="generic">&lt;<argument><operator>/</operator><name>source</name></argument>&gt;</argument_list></name>
            <operator>&lt;</operator><name>outputDirectory</name><operator>&gt;</operator><operator>/</operator><name>oozie</name><operator>-</operator><name><name>core</name><argument_list type="generic">&lt;<argument><operator>/</operator><name>outputDirectory</name></argument>&gt;</argument_list></name>
        <operator>&lt;</operator><operator>/</operator><name>file</name><operator>&gt;</operator>
        <operator>&lt;</operator><operator>!</operator><operator>--</operator> <name>Oozie</name> <name>core</name> <name>test</name> <name>jar</name> <operator>--</operator><operator>&gt;</operator>
        <operator>&lt;</operator><name>file</name><operator>&gt;</operator>
            <operator>&lt;</operator><name>source</name><operator>&gt;</operator><name>$</name><block>{<expr><name>basedir</name></expr>}</block><operator>/</operator><operator>..</operator><operator>/</operator><name>core</name><operator>/</operator><name>target</name><operator>/</operator><name>oozie</name><operator>-</operator><name>core</name><operator>-</operator><name>$</name><block>{<expr><name><name>project</name><operator>.</operator><name>version</name></name></expr>}</block><operator>-</operator><name><name>tests</name><operator>.</operator><name><name>jar</name><argument_list type="generic">&lt;<argument><operator>/</operator><name>source</name></argument>&gt;</argument_list></name></name>
            <operator>&lt;</operator><name>outputDirectory</name><operator>&gt;</operator><operator>/</operator><name>oozie</name><operator>-</operator><name><name>core</name><argument_list type="generic">&lt;<argument><operator>/</operator><name>outputDirectory</name></argument>&gt;</argument_list></name>
        <operator>&lt;</operator><operator>/</operator><name>file</name><operator>&gt;</operator>
        <operator>&lt;</operator><operator>!</operator><operator>--</operator> <name>Oozie</name> <name>Documentation</name> <operator>--</operator><operator>&gt;</operator>
        <operator>&lt;</operator><name>file</name><operator>&gt;</operator>
            <operator>&lt;</operator><name>source</name><operator>&gt;</operator><name>$</name><block>{<expr><name>basedir</name></expr>}</block><operator>/</operator><operator>..</operator><operator>/</operator><name>docs</name><operator>/</operator><name>target</name><operator>/</operator><name>oozie</name><operator>-</operator><name>docs</name><operator>-</operator><name>$</name><block>{<expr><name><name>project</name><operator>.</operator><name>version</name></name></expr>}</block><operator>-</operator><name><name>docs</name><operator>.</operator><name><name>zip</name><argument_list type="generic">&lt;<argument><operator>/</operator><name>source</name></argument>&gt;</argument_list></name></name>
            <operator>&lt;</operator><name>outputDirectory</name><operator>&gt;</operator><operator>/</operator><operator>&lt;</operator><operator>/</operator><name>outputDirectory</name><operator>&gt;</operator>
            <operator>&lt;</operator><name>destName</name><operator>&gt;</operator><name><name>docs</name><operator>.</operator><name><name>zip</name><argument_list type="generic">&lt;<argument><operator>/</operator><name>destName</name></argument>&gt;</argument_list></name></name>
        <operator>&lt;</operator><operator>/</operator><name>file</name><operator>&gt;</operator>
        <operator>&lt;</operator><operator>!</operator><operator>--</operator> <name>Oozie</name> <name>Client</name> <name><name>TAR</name><operator>.</operator><name>GZ</name></name>  <operator>--</operator><operator>&gt;</operator>
        <operator>&lt;</operator><name>file</name><operator>&gt;</operator>
            <operator>&lt;</operator><name>source</name><operator>&gt;</operator><name>$</name><block>{<expr><name>basedir</name></expr>}</block><operator>/</operator><operator>..</operator><operator>/</operator><name>client</name><operator>/</operator><name>target</name><operator>/</operator><name>oozie</name><operator>-</operator><name>client</name><operator>-</operator><name>$</name><block>{<expr><name><name>project</name><operator>.</operator><name>version</name></name></expr>}</block><operator>-</operator><name><name>client</name><operator>.</operator><name>tar</name><operator>.</operator><name><name>gz</name><argument_list type="generic">&lt;<argument><operator>/</operator><name>source</name></argument>&gt;</argument_list></name></name>
            <operator>&lt;</operator><name>outputDirectory</name><operator>&gt;</operator><operator>/</operator><operator>&lt;</operator><operator>/</operator><name>outputDirectory</name><operator>&gt;</operator>
            <operator>&lt;</operator><name>destName</name><operator>&gt;</operator><name>oozie</name><operator>-</operator><name>client</name><operator>-</operator><name>$</name><block>{<expr><name><name>project</name><operator>.</operator><name>version</name></name></expr>}</block><operator>.</operator><name><name>tar</name><operator>.</operator><name><name>gz</name><argument_list type="generic">&lt;<argument><operator>/</operator><name>destName</name></argument>&gt;</argument_list></name></name>
        <operator>&lt;</operator><operator>/</operator><name>file</name><operator>&gt;</operator>
        <operator>&lt;</operator><operator>!</operator><operator>--</operator> <name>Oozie</name> <name>examples</name> <name><name>TAR</name><operator>.</operator><name>GZ</name></name>  <operator>--</operator><operator>&gt;</operator>
        <operator>&lt;</operator><name>file</name><operator>&gt;</operator>
            <operator>&lt;</operator><name>source</name><operator>&gt;</operator><name>$</name><block>{<expr><name>basedir</name></expr>}</block><operator>/</operator><operator>..</operator><operator>/</operator><name>examples</name><operator>/</operator><name>target</name><operator>/</operator><name>oozie</name><operator>-</operator><name>examples</name><operator>-</operator><name>$</name><block>{<expr><name><name>project</name><operator>.</operator><name>version</name></name></expr>}</block><operator>-</operator><name><name>examples</name><operator>.</operator><name>tar</name><operator>.</operator><name><name>gz</name><argument_list type="generic">&lt;<argument><operator>/</operator><name>source</name></argument>&gt;</argument_list></name></name>
            <operator>&lt;</operator><name>outputDirectory</name><operator>&gt;</operator><operator>/</operator><operator>&lt;</operator><operator>/</operator><name>outputDirectory</name><operator>&gt;</operator>
            <operator>&lt;</operator><name>destName</name><operator>&gt;</operator><name>oozie</name><operator>-</operator><name><name>examples</name><operator>.</operator><name>tar</name><operator>.</operator><name><name>gz</name><argument_list type="generic">&lt;<argument><operator>/</operator><name>destName</name></argument>&gt;</argument_list></name></name>
        <operator>&lt;</operator><operator>/</operator><name>file</name><operator>&gt;</operator>
        <operator>&lt;</operator><operator>!</operator><operator>--</operator> <name>Oozie</name> <name>sharelib</name> <name><name>TAR</name><operator>.</operator><name>GZ</name></name>  <operator>--</operator><operator>&gt;</operator>
        <operator>&lt;</operator><name>file</name><operator>&gt;</operator>
            <operator>&lt;</operator><name>source</name><operator>&gt;</operator><name>$</name><block>{<expr><name>basedir</name></expr>}</block><operator>/</operator><operator>..</operator><operator>/</operator><name>sharelib</name><operator>/</operator><name>target</name><operator>/</operator><name>oozie</name><operator>-</operator><name>sharelib</name><operator>-</operator><name>$</name><block>{<expr><name><name>project</name><operator>.</operator><name>version</name></name></expr>}</block><operator>.</operator><name><name>tar</name><operator>.</operator><name><name>gz</name><argument_list type="generic">&lt;<argument><operator>/</operator><name>source</name></argument>&gt;</argument_list></name></name>
            <operator>&lt;</operator><name>outputDirectory</name><operator>&gt;</operator><operator>/</operator><operator>&lt;</operator><operator>/</operator><name>outputDirectory</name><operator>&gt;</operator>
            <operator>&lt;</operator><name>fileMode</name><operator>&gt;</operator><literal type="number">0444</literal><operator>&lt;</operator><operator>/</operator><name>fileMode</name><operator>&gt;</operator>
        <operator>&lt;</operator><operator>/</operator><name>file</name><operator>&gt;</operator>
    <operator>&lt;</operator><operator>/</operator><name>files</name><operator>&gt;</operator>
<operator>&lt;</operator><operator>/</operator><name>assembly</name><operator>&gt;</operator>
<name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>assemblies</name><operator>/</operator><name><name>distro</name><operator>.</operator><name>xml</name></name> <name>b</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>assemblies</name><operator>/</operator><name>distro</name><operator>-</operator><name><name>tomcat</name><operator>.</operator><name>xml</name></name>
<name>similarity</name> <name>index</name> <literal type="number">98</literal><operator>%</operator>
<name>rename</name> <name>from</name> <name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>assemblies</name><operator>/</operator><name><name>distro</name><operator>.</operator><name>xml</name></name>
<name>rename</name> <name>to</name> <name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>assemblies</name><operator>/</operator><name>distro</name><operator>-</operator><name><name>tomcat</name><operator>.</operator><name>xml</name></name>
<name>index</name> <literal type="number">1ffbfd6d2</literal><operator>..</operator><name>d7018a394</name> <literal type="number">100644</literal>
<operator>--</operator> <name>a</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>assemblies</name><operator>/</operator><name><name>distro</name><operator>.</operator><name>xml</name></name>
<operator>++</operator> <name>b</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>assemblies</name><operator>/</operator><name>distro</name><operator>-</operator><name><name>tomcat</name><operator>.</operator><name>xml</name></name>
@@ <operator>-</operator><literal type="number">6</literal></expr><operator>,</operator><expr><literal type="number">9</literal> <operator>+</operator><literal type="number">6</literal></expr><operator>,</operator><expr><literal type="number">9</literal> @@
   <name>to</name> <name>you</name> <name>under</name> <name>the</name> <name>Apache</name> <name>License</name></expr><operator>,</operator> <expr><name>Version</name> <literal type="number">2.0</literal> <operator>(</operator><name>the</name>
   <literal type="string">"License"</literal><operator>)</operator></expr>;</expr_stmt> <expr_stmt><expr><name>you</name> <name>may</name> <name>not</name> <name>use</name> <name>this</name> <name>file</name> <name>except</name> <name>in</name> <name>compliance</name>
   <name>with</name> <name>the</name> <name><name>License</name><operator>.</operator>  <name>You</name></name> <name>may</name> <name>obtain</name> <name>a</name> <name>copy</name> <name>of</name> <name>the</name> <name>License</name> <name>at</name>
  

        <name>http</name><operator>:</operator><comment type="line">//www.apache.org/licenses/LICENSE-2.0</comment>
  

   <name>Unless</name> <name>required</name> <name>by</name> <name>applicable</name> <name>law</name> <name>or</name> <name>agreed</name> <name>to</name> <name>in</name> <name>writing</name></expr><operator>,</operator> <expr><name>software</name>
   <name>distributed</name> <name>under</name> <name>the</name> <name>License</name> <name>is</name> <name>distributed</name> <name>on</name> <name>an</name> <literal type="string">"AS IS"</literal> <name>BASIS</name></expr><operator>,</operator>
   <expr><name>WITHOUT</name> <name>WARRANTIES</name> <name>OR</name> <name>CONDITIONS</name> <name>OF</name> <name>ANY</name> <name>KIND</name></expr><operator>,</operator> <expr><name>either</name> <name>express</name> <name>or</name> <name><name>implied</name><operator>.</operator></name>
@@ <operator>-</operator><literal type="number">46</literal></expr><operator>,</operator><expr><literal type="number">7</literal> <operator>+</operator><literal type="number">46</literal></expr><operator>,</operator><expr><literal type="number">7</literal> @@
         <operator>&lt;</operator><name>fileSet</name><operator>&gt;</operator>
             <operator>&lt;</operator><name>directory</name><operator>&gt;</operator><name>$</name><block>{<expr><name>basedir</name></expr>}</block><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name><name>bin</name><argument_list type="generic">&lt;<argument><operator>/</operator><name>directory</name></argument>&gt;</argument_list></name>
             <operator>&lt;</operator><name>outputDirectory</name><operator>&gt;</operator><operator>/</operator><name><name>bin</name><argument_list type="generic">&lt;<argument><operator>/</operator><name>outputDirectory</name></argument>&gt;</argument_list></name>
            <operator>&lt;</operator><name>includes</name><operator>&gt;</operator>          
            <operator>&lt;</operator><name>includes</name><operator>&gt;</operator>
                 <operator>&lt;</operator><name>include</name><operator>&gt;</operator><operator>*</operator><operator>&lt;</operator><operator>/</operator><name>include</name><operator>&gt;</operator>
             <operator>&lt;</operator><operator>/</operator><name>includes</name><operator>&gt;</operator>
             <operator>&lt;</operator><name>fileMode</name><operator>&gt;</operator><literal type="number">0755</literal><operator>&lt;</operator><operator>/</operator><name>fileMode</name><operator>&gt;</operator>
@@ <operator>-</operator><literal type="number">102</literal></expr><operator>,</operator><expr><literal type="number">14</literal> <operator>+</operator><literal type="number">102</literal></expr><operator>,</operator><expr><literal type="number">12</literal> @@
             <operator>&lt;</operator><operator>/</operator><name>includes</name><operator>&gt;</operator>
             <operator>&lt;</operator><name>fileMode</name><operator>&gt;</operator><literal type="number">0555</literal><operator>&lt;</operator><operator>/</operator><name>fileMode</name><operator>&gt;</operator>
         <operator>&lt;</operator><operator>/</operator><name>fileSet</name><operator>&gt;</operator>

     <operator>&lt;</operator><operator>/</operator><name>fileSets</name><operator>&gt;</operator>
     <operator>&lt;</operator><name>files</name><operator>&gt;</operator>
         <operator>&lt;</operator><operator>!</operator><operator>--</operator> <name>Oozie</name> <name>configuration</name> <name>files</name> <operator>--</operator><operator>&gt;</operator>
         <operator>&lt;</operator><name>file</name><operator>&gt;</operator>
             <operator>&lt;</operator><name>source</name><operator>&gt;</operator><name>$</name><block>{<expr><name>basedir</name></expr>}</block><operator>/</operator><operator>..</operator><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>resources</name><operator>/</operator><name>oozie</name><operator>-</operator>default<operator>.</operator><name><name>xml</name><argument_list type="generic">&lt;<argument><operator>/</operator><name>source</name></argument>&gt;</argument_list></name>
             <operator>&lt;</operator><name>outputDirectory</name><operator>&gt;</operator><operator>/</operator><name><name>conf</name><argument_list type="generic">&lt;<argument><operator>/</operator><name>outputDirectory</name></argument>&gt;</argument_list></name>
            <operator>&lt;</operator><name>destName</name><operator>&gt;</operator><name>oozie</name><operator>-</operator>default<operator>.</operator><name><name>xml</name><operator>.</operator><name><name>reference</name><argument_list type="generic">&lt;<argument><operator>/</operator><name>destName</name></argument>&gt;</argument_list></name></name>
         <operator>&lt;</operator><operator>/</operator><name>file</name><operator>&gt;</operator>
         <operator>&lt;</operator><operator>!</operator><operator>--</operator> <name>Oozie</name> <name>core</name> <name>jar</name> <operator>--</operator><operator>&gt;</operator>
         <operator>&lt;</operator><name>file</name><operator>&gt;</operator>
<name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>webapp</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>webapp</name><operator>/</operator><literal type="number">403.html</literal> <name>b</name><operator>/</operator><name>webapp</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>webapp</name><operator>/</operator><literal type="number">403.html</literal>
<operator>new</operator> <name>file</name> <name>mode</name> <literal type="number">100644</literal>
<name>index</name> <literal type="number">000000000..f3183d91b</literal>
<operator>--</operator> <operator>/</operator><name>dev</name><operator>/</operator><literal type="null">null</literal>
<operator>++</operator> <name>b</name><operator>/</operator><name>webapp</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>webapp</name><operator>/</operator><literal type="number">403.html</literal>
@@ <operator>-</operator><literal type="number">0</literal></expr><operator>,</operator><expr><literal type="number">0</literal> <operator>+</operator><literal type="number">1</literal></expr><operator>,</operator><expr><literal type="number">31</literal> @@
<operator>&lt;</operator><operator>!</operator><name>DOCTYPE</name> <name>HTML</name> <name>PUBLIC</name> <literal type="string">"-//W3C//DTD HTML 4.01//EN"</literal> <literal type="string">"http://www.w3.org/TR/html4/strict.dtd"</literal><operator>&gt;</operator>
<operator>&lt;</operator><operator>!</operator><operator>--</operator>
  <name>Licensed</name> <name>to</name> <name>the</name> <name>Apache</name> <name>Software</name> <call><name>Foundation</name> <argument_list>(<argument><expr><name>ASF</name></expr></argument>)</argument_list></call> <name>under</name> <name>one</name>
  <name>or</name> <name>more</name> <name>contributor</name> <name>license</name> <name><name>agreements</name><operator>.</operator>  <name>See</name></name> <name>the</name> <name>NOTICE</name> <name>file</name>
  <name>distributed</name> <name>with</name> <name>this</name> <name>work</name></expr></expr_stmt> <for>for additional information
  regarding copyright ownership.  The ASF licenses this file
  to you under the Apache License<operator>,</operator> <expr_stmt><expr><name>Version</name> <literal type="number">2.0</literal> <operator>(</operator><name>the</name>
  <literal type="string">"License"</literal><operator>)</operator></expr>;</expr_stmt></for> <expr_stmt><expr><name>you</name> <name>may</name> <name>not</name> <name>use</name> <name>this</name> <name>file</name> <name>except</name> <name>in</name> <name>compliance</name>
  <name>with</name> <name>the</name> <name><name>License</name><operator>.</operator>  <name>You</name></name> <name>may</name> <name>obtain</name> <name>a</name> <name>copy</name> <name>of</name> <name>the</name> <name>License</name> <name>at</name>

       <name>http</name><operator>:</operator><comment type="line">//www.apache.org/licenses/LICENSE-2.0</comment>

  <name>Unless</name> <name>required</name> <name>by</name> <name>applicable</name> <name>law</name> <name>or</name> <name>agreed</name> <name>to</name> <name>in</name> <name>writing</name></expr><operator>,</operator> <expr><name>software</name>
  <name>distributed</name> <name>under</name> <name>the</name> <name>License</name> <name>is</name> <name>distributed</name> <name>on</name> <name>an</name> <literal type="string">"AS IS"</literal> <name>BASIS</name></expr><operator>,</operator>
  <expr><name>WITHOUT</name> <name>WARRANTIES</name> <name>OR</name> <name>CONDITIONS</name> <name>OF</name> <name>ANY</name> <name>KIND</name></expr><operator>,</operator> <expr><name>either</name> <name>express</name> <name>or</name> <name><name>implied</name><operator>.</operator>
  <name>See</name></name> <name>the</name> <name>License</name></expr></expr_stmt> <for>for the specific language governing permissions and
  limitations under the License.
--&gt;

&lt;html&gt;
&lt;head&gt;
    &lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8"&gt;
    &lt;title&gt;Error 403 Not Found&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h2&gt;HTTP ERROR 403&lt;/h2&gt;
    &lt;p&gt;Problem accessing page. Reason:&lt;/p&gt;
    &lt;pre&gt;    Forbidden&lt;/pre&gt;
    &lt;p&gt;&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;
diff --git a/webapp/src/main/webapp/404.html b/webapp/src/main/webapp/404.html
new file mode 100644
index 000000000..a953df285
-- /dev/null
++ b/webapp/src/main/webapp/404.html
@@ -0<operator>,</operator><expr_stmt><expr><literal type="number">0</literal> <operator>+</operator><literal type="number">1</literal></expr><operator>,</operator><expr><literal type="number">31</literal> @@
<operator>&lt;</operator><operator>!</operator><name>DOCTYPE</name> <name>HTML</name> <name>PUBLIC</name> <literal type="string">"-//W3C//DTD HTML 4.01//EN"</literal> <literal type="string">"http://www.w3.org/TR/html4/strict.dtd"</literal><operator>&gt;</operator>
<operator>&lt;</operator><operator>!</operator><operator>--</operator>
  <name>Licensed</name> <name>to</name> <name>the</name> <name>Apache</name> <name>Software</name> <call><name>Foundation</name> <argument_list>(<argument><expr><name>ASF</name></expr></argument>)</argument_list></call> <name>under</name> <name>one</name>
  <name>or</name> <name>more</name> <name>contributor</name> <name>license</name> <name><name>agreements</name><operator>.</operator>  <name>See</name></name> <name>the</name> <name>NOTICE</name> <name>file</name>
  <name>distributed</name> <name>with</name> <name>this</name> <name>work</name></expr></expr_stmt></for> <for>for additional information
  regarding copyright ownership.  The ASF licenses this file
  to you under the Apache License<operator>,</operator> <expr_stmt><expr><name>Version</name> <literal type="number">2.0</literal> <operator>(</operator><name>the</name>
  <literal type="string">"License"</literal><operator>)</operator></expr>;</expr_stmt></for> <expr_stmt><expr><name>you</name> <name>may</name> <name>not</name> <name>use</name> <name>this</name> <name>file</name> <name>except</name> <name>in</name> <name>compliance</name>
  <name>with</name> <name>the</name> <name><name>License</name><operator>.</operator>  <name>You</name></name> <name>may</name> <name>obtain</name> <name>a</name> <name>copy</name> <name>of</name> <name>the</name> <name>License</name> <name>at</name>

       <name>http</name><operator>:</operator><comment type="line">//www.apache.org/licenses/LICENSE-2.0</comment>

  <name>Unless</name> <name>required</name> <name>by</name> <name>applicable</name> <name>law</name> <name>or</name> <name>agreed</name> <name>to</name> <name>in</name> <name>writing</name></expr><operator>,</operator> <expr><name>software</name>
  <name>distributed</name> <name>under</name> <name>the</name> <name>License</name> <name>is</name> <name>distributed</name> <name>on</name> <name>an</name> <literal type="string">"AS IS"</literal> <name>BASIS</name></expr><operator>,</operator>
  <expr><name>WITHOUT</name> <name>WARRANTIES</name> <name>OR</name> <name>CONDITIONS</name> <name>OF</name> <name>ANY</name> <name>KIND</name></expr><operator>,</operator> <expr><name>either</name> <name>express</name> <name>or</name> <name><name>implied</name><operator>.</operator>
  <name>See</name></name> <name>the</name> <name>License</name></expr></expr_stmt> <for>for the specific language governing permissions and
  limitations under the License.
--&gt;

&lt;html&gt;
&lt;head&gt;
    &lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8"&gt;
    &lt;title&gt;Error 404 Not Found&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h2&gt;HTTP ERROR 404&lt;/h2&gt;
    &lt;p&gt;Problem accessing page Reason:&lt;/p&gt;
    &lt;pre&gt;    Not Found&lt;/pre&gt;
    &lt;p&gt;&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;
- 
2.19.1.windows.1</for></block_content></block>

</unit>
