<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<unit xmlns="http://www.srcML.org/srcML/src" revision="1.0.0" language="Java" filename="E:/01Courses@USASK/CMPT898-HumanDrivenSoftwareEngineeringForScientificResearch/ProjectProgress/data_files/final_dataset/gen_patch_codes/filtered/oozie/c95c809a.java"><expr_stmt><expr><name>From</name> <name>c95c809a55005b44b05f0c496e4a3fd75a26be91</name> <name>Mon</name> <name>Sep</name> <literal type="number">17</literal> <literal type="number">00</literal><operator>:</operator><literal type="number">00</literal><operator>:</operator><literal type="number">00</literal> <literal type="number">2001</literal>
<name>From</name><operator>:</operator> <name><name>virag</name> <argument_list type="generic">&lt;<argument><name>virag</name><annotation>@<name>unknown</name></annotation></argument>&gt;</argument_list></name>
<name>Date</name><operator>:</operator> <name>Wed</name></expr><operator>,</operator> <expr><literal type="number">22</literal> <name>Aug</name> <literal type="number">2012</literal> <literal type="number">19</literal><operator>:</operator><literal type="number">32</literal><operator>:</operator><literal type="number">02</literal> <operator>+</operator><literal type="number">0000</literal>
<name>Subject</name><operator>:</operator> <index>[<expr><name>PATCH</name></expr>]</index> <name>OOZIE</name><operator>-</operator><literal type="number">914</literal> <name>Make</name> <name>sure</name> <name>all</name> <name>commands</name></expr></expr_stmt> <do>do<block type="pseudo"><block_content> <decl_stmt><decl><type><name>their</name> <name>JPA</name> <name>writes</name> <name>within</name> <name>a</name>
 <name>single</name> <name>JPA</name></type> <name>executor</name> <argument_list>(<argument><expr><name>mona</name> <name>via</name> <name>virag</name></expr></argument>)</argument_list>

<name>git</name>-<name>svn</name>-<name>id</name><range>: <expr><name>https</name><operator>:</operator><comment type="line">//svn.apache.org/repos/asf/incubator/oozie/trunk@1376204 13f79535-47bb-0310-9956-ffa450edef68</comment>
<operator>--</operator>
 <operator>...</operator><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name><name>BundleActionBean</name><operator>.</operator><name>java</name></name>    <operator>|</operator>  <literal type="number">15</literal> <operator>+</operator><operator>-</operator>
 <operator>...</operator><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name><name>KillTransitionXCommand</name><operator>.</operator><name>java</name></name> <operator>|</operator>   <literal type="number">1</literal> <operator>+</operator>
 <operator>...</operator><operator>/</operator><name><name>MaterializeTransitionXCommand</name><operator>.</operator><name>java</name></name>        <operator>|</operator>   <literal type="number">1</literal> <operator>+</operator>
 <operator>...</operator><operator>/</operator><name>command</name><operator>/</operator><name><name>RerunTransitionXCommand</name><operator>.</operator><name>java</name></name>      <operator>|</operator>   <literal type="number">2</literal> <operator>+</operator><operator>-</operator>
 <operator>...</operator><operator>/</operator><name>command</name><operator>/</operator><name><name>ResumeTransitionXCommand</name><operator>.</operator><name>java</name></name>     <operator>|</operator>   <literal type="number">1</literal> <operator>+</operator>
 <operator>...</operator><operator>/</operator><name>command</name><operator>/</operator><name><name>StartTransitionXCommand</name><operator>.</operator><name>java</name></name>      <operator>|</operator>   <literal type="number">1</literal> <operator>+</operator>
 <operator>...</operator><operator>/</operator><name>command</name><operator>/</operator><name><name>SuspendTransitionXCommand</name><operator>.</operator><name>java</name></name>    <operator>|</operator>   <literal type="number">1</literal> <operator>+</operator>
 <operator>...</operator><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name><name>TransitionXCommand</name><operator>.</operator><name>java</name></name>     <operator>|</operator>  <literal type="number">13</literal> <operator>+</operator>
 <operator>...</operator><operator>/</operator><name>bundle</name><operator>/</operator><name><name>BundleJobChangeXCommand</name><operator>.</operator><name>java</name></name>       <operator>|</operator>  <literal type="number">11</literal> <operator>+</operator><operator>-</operator>
 <operator>...</operator><operator>/</operator><name>bundle</name><operator>/</operator><name><name>BundleJobResumeXCommand</name><operator>.</operator><name>java</name></name>       <operator>|</operator>  <literal type="number">62</literal> <operator>++</operator><operator>--</operator><operator>-</operator>
 <operator>...</operator><operator>/</operator><name>bundle</name><operator>/</operator><name><name>BundleJobSuspendXCommand</name><operator>.</operator><name>java</name></name>      <operator>|</operator>  <literal type="number">72</literal> <operator>++</operator><operator>+</operator><operator>--</operator>
 <operator>...</operator><operator>/</operator><name>command</name><operator>/</operator><name>bundle</name><operator>/</operator><name><name>BundleKillXCommand</name><operator>.</operator><name>java</name></name>    <operator>|</operator>  <literal type="number">24</literal> <operator>+</operator><operator>-</operator>
 <operator>...</operator><operator>/</operator><name>command</name><operator>/</operator><name>bundle</name><operator>/</operator><name><name>BundlePauseXCommand</name><operator>.</operator><name>java</name></name>   <operator>|</operator>   <literal type="number">4</literal> <operator>+</operator>
 <operator>...</operator><operator>/</operator><name>command</name><operator>/</operator><name>bundle</name><operator>/</operator><name><name>BundlePurgeXCommand</name><operator>.</operator><name>java</name></name>   <operator>|</operator>  <literal type="number">23</literal> <operator>+</operator><operator>-</operator>
 <operator>...</operator><operator>/</operator><name>command</name><operator>/</operator><name>bundle</name><operator>/</operator><name><name>BundleRerunXCommand</name><operator>.</operator><name>java</name></name>   <operator>|</operator>  <literal type="number">53</literal> <operator>++</operator><operator>--</operator>
 <operator>...</operator><operator>/</operator><name>command</name><operator>/</operator><name>bundle</name><operator>/</operator><name><name>BundleStartXCommand</name><operator>.</operator><name>java</name></name>   <operator>|</operator>  <literal type="number">67</literal> <operator>++</operator><operator>+</operator><operator>--</operator>
 <operator>...</operator><operator>/</operator><name>bundle</name><operator>/</operator><name><name>BundleStatusUpdateXCommand</name><operator>.</operator><name>java</name></name>    <operator>|</operator>   <literal type="number">3</literal> <operator>-</operator>
 <operator>...</operator><operator>/</operator><name>command</name><operator>/</operator><name>bundle</name><operator>/</operator><name><name>BundleSubmitXCommand</name><operator>.</operator><name>java</name></name>  <operator>|</operator>   <literal type="number">4</literal> <operator>+</operator>
 <operator>...</operator><operator>/</operator><name>command</name><operator>/</operator><name>bundle</name><operator>/</operator><name><name>BundleUnpauseXCommand</name><operator>.</operator><name>java</name></name> <operator>|</operator>   <literal type="number">4</literal> <operator>+</operator>
 <operator>...</operator><operator>/</operator><name>coord</name><operator>/</operator><name><name>CoordActionCheckXCommand</name><operator>.</operator><name>java</name></name>       <operator>|</operator>  <literal type="number">19</literal> <operator>+</operator><operator>-</operator>
 <operator>...</operator><operator>/</operator><name>coord</name><operator>/</operator><name><name>CoordActionMaterializeCommand</name><operator>.</operator><name>java</name></name>  <operator>|</operator>  <literal type="number">58</literal> <operator>++</operator><operator>+</operator><operator>-</operator>
 <operator>...</operator><operator>/</operator><name>coord</name><operator>/</operator><name><name>CoordActionStartXCommand</name><operator>.</operator><name>java</name></name>       <operator>|</operator>  <literal type="number">54</literal> <operator>++</operator><operator>--</operator>
 <operator>...</operator><operator>/</operator><name>coord</name><operator>/</operator><name><name>CoordActionUpdateXCommand</name><operator>.</operator><name>java</name></name>      <operator>|</operator>  <literal type="number">25</literal> <operator>+</operator><operator>-</operator>
 <operator>...</operator><operator>/</operator><name>command</name><operator>/</operator><name>coord</name><operator>/</operator><name><name>CoordChangeXCommand</name><operator>.</operator><name>java</name></name>    <operator>|</operator>  <literal type="number">16</literal> <operator>+</operator><operator>-</operator>
 <operator>...</operator><operator>/</operator><name>command</name><operator>/</operator><name>coord</name><operator>/</operator><name><name>CoordKillXCommand</name><operator>.</operator><name>java</name></name>      <operator>|</operator>  <literal type="number">68</literal> <operator>++</operator><operator>+</operator><operator>--</operator>
 <operator>...</operator><operator>/</operator><name><name>CoordMaterializeTransitionXCommand</name><operator>.</operator><name>java</name></name>   <operator>|</operator>  <literal type="number">21</literal> <operator>+</operator><operator>-</operator>
 <operator>...</operator><operator>/</operator><name>command</name><operator>/</operator><name>coord</name><operator>/</operator><name><name>CoordPauseXCommand</name><operator>.</operator><name>java</name></name>     <operator>|</operator>   <literal type="number">4</literal> <operator>+</operator>
 <operator>...</operator><operator>/</operator><name>command</name><operator>/</operator><name>coord</name><operator>/</operator><name><name>CoordPurgeXCommand</name><operator>.</operator><name>java</name></name>     <operator>|</operator>  <literal type="number">22</literal> <operator>+</operator><operator>-</operator>
 <operator>...</operator><operator>/</operator><name>command</name><operator>/</operator><name>coord</name><operator>/</operator><name><name>CoordRerunXCommand</name><operator>.</operator><name>java</name></name>     <operator>|</operator>  <literal type="number">60</literal> <operator>++</operator><operator>--</operator>
 <operator>...</operator><operator>/</operator><name>command</name><operator>/</operator><name>coord</name><operator>/</operator><name><name>CoordResumeXCommand</name><operator>.</operator><name>java</name></name>    <operator>|</operator>  <literal type="number">37</literal> <operator>++</operator><operator>-</operator>
 <operator>...</operator><operator>/</operator><name>command</name><operator>/</operator><name>coord</name><operator>/</operator><name><name>CoordSubmitXCommand</name><operator>.</operator><name>java</name></name>    <operator>|</operator>   <literal type="number">4</literal> <operator>+</operator>
 <operator>...</operator><operator>/</operator><name>command</name><operator>/</operator><name>coord</name><operator>/</operator><name><name>CoordSuspendXCommand</name><operator>.</operator><name>java</name></name>   <operator>|</operator>  <literal type="number">35</literal> <operator>++</operator><operator>-</operator>
 <operator>...</operator><operator>/</operator><name>command</name><operator>/</operator><name>coord</name><operator>/</operator><name><name>CoordUnpauseXCommand</name><operator>.</operator><name>java</name></name>   <operator>|</operator>   <literal type="number">4</literal> <operator>+</operator>
 <operator>...</operator><operator>/</operator><name>command</name><operator>/</operator><name>coord</name><operator>/</operator><name><name>CoordinatorCommand</name><operator>.</operator><name>java</name></name>     <operator>|</operator>  <literal type="number">16</literal> <operator>+</operator><operator>-</operator>
 <operator>...</operator><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>wf</name><operator>/</operator><name><name>ActionCheckXCommand</name><operator>.</operator><name>java</name></name> <operator>|</operator>  <literal type="number">34</literal> <operator>++</operator><operator>-</operator>
 <operator>...</operator><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>wf</name><operator>/</operator><name><name>ActionEndXCommand</name><operator>.</operator><name>java</name></name>   <operator>|</operator> <literal type="number">104</literal> <operator>++</operator><operator>+</operator><operator>--</operator><operator>--</operator>
 <operator>...</operator><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>wf</name><operator>/</operator><name><name>ActionKillXCommand</name><operator>.</operator><name>java</name></name>  <operator>|</operator>  <literal type="number">49</literal> <operator>++</operator><operator>--</operator>
 <operator>...</operator><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>wf</name><operator>/</operator><name><name>ActionStartXCommand</name><operator>.</operator><name>java</name></name> <operator>|</operator> <literal type="number">151</literal> <operator>++</operator><operator>++</operator><operator>+</operator><operator>--</operator><operator>--</operator><operator>-</operator>
 <operator>...</operator><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>wf</name><operator>/</operator><name><name>KillXCommand</name><operator>.</operator><name>java</name></name> <operator>|</operator>  <literal type="number">33</literal> <operator>++</operator><operator>-</operator>
 <operator>...</operator><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>wf</name><operator>/</operator><name><name>PurgeXCommand</name><operator>.</operator><name>java</name></name>       <operator>|</operator>  <literal type="number">22</literal> <operator>+</operator><operator>-</operator>
 <operator>...</operator><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>wf</name><operator>/</operator><name><name>ReRunXCommand</name><operator>.</operator><name>java</name></name>       <operator>|</operator>  <literal type="number">58</literal> <operator>++</operator><operator>--</operator>
 <operator>...</operator><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>wf</name><operator>/</operator><name><name>ResumeXCommand</name><operator>.</operator><name>java</name></name>      <operator>|</operator>  <literal type="number">13</literal> <operator>+</operator><operator>-</operator>
 <operator>...</operator><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>wf</name><operator>/</operator><name><name>SignalXCommand</name><operator>.</operator><name>java</name></name>      <operator>|</operator>  <literal type="number">30</literal> <operator>+</operator><operator>-</operator>
 <operator>...</operator><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>wf</name><operator>/</operator><name><name>SubmitXCommand</name><operator>.</operator><name>java</name></name>      <operator>|</operator>  <literal type="number">21</literal> <operator>+</operator><operator>-</operator>
 <operator>...</operator><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>wf</name><operator>/</operator><name><name>SuspendXCommand</name><operator>.</operator><name>java</name></name>     <operator>|</operator>  <literal type="number">13</literal> <operator>+</operator><operator>-</operator>
 <operator>...</operator><operator>/</operator><name>jpa</name><operator>/</operator><name><name>BulkDeleteForPurgeJPAExecutor</name><operator>.</operator><name>java</name></name>    <operator>|</operator> <literal type="number">113</literal> <operator>++</operator><operator>++</operator><operator>++</operator><operator>++</operator>
 <operator>...</operator><operator>/</operator><name>jpa</name><operator>/</operator><name><name>BulkUpdateDeleteJPAExecutor</name><operator>.</operator><name>java</name></name>      <operator>|</operator> <literal type="number">133</literal> <operator>++</operator><operator>++</operator><operator>++</operator><operator>++</operator><operator>+</operator>
 <operator>...</operator><name><name>eInsertForCoordActionStartJPAExecutor</name><operator>.</operator><name>java</name></name> <operator>|</operator> <literal type="number">127</literal> <operator>++</operator><operator>++</operator><operator>++</operator><operator>++</operator><operator>+</operator>
 <operator>...</operator><name><name>InsertForCoordActionStatusJPAExecutor</name><operator>.</operator><name>java</name></name> <operator>|</operator> <literal type="number">124</literal> <operator>++</operator><operator>++</operator><operator>++</operator><operator>++</operator><operator>+</operator>
 <operator>...</operator><operator>/</operator><name>jpa</name><operator>/</operator><name><name>BulkUpdateInsertJPAExecutor</name><operator>.</operator><name>java</name></name>      <operator>|</operator>  <literal type="number">12</literal> <operator>+</operator><operator>-</operator>
 <operator>...</operator><name><name>undleActionsDeleteForPurgeJPAExecutor</name><operator>.</operator><name>java</name></name> <operator>|</operator>  <literal type="number">62</literal> <operator>--</operator><operator>--</operator><operator>-</operator>
 <operator>...</operator><operator>/</operator><name>jpa</name><operator>/</operator><name><name>BundleJobDeleteJPAExecutor</name><operator>.</operator><name>java</name></name>       <operator>|</operator>  <literal type="number">56</literal> <operator>--</operator><operator>--</operator>
 <operator>...</operator><operator>/</operator><name><name>CoordActionUpdateForStartJPAExecutor</name><operator>.</operator><name>java</name></name> <operator>|</operator>  <literal type="number">76</literal> <operator>--</operator><operator>--</operator><operator>-</operator>
 <operator>...</operator><name><name>CoordActionsDeleteForPurgeJPAExecutor</name><operator>.</operator><name>java</name></name> <operator>|</operator>  <literal type="number">62</literal> <operator>--</operator><operator>--</operator><operator>-</operator>
 <operator>...</operator><name><name>JobGetActionByActionNumberJPAExecutor</name><operator>.</operator><name>java</name></name> <operator>|</operator>   <literal type="number">3</literal> <operator>-</operator>
 <operator>...</operator><name><name>kflowActionsDeleteForPurgeJPAExecutor</name><operator>.</operator><name>java</name></name> <operator>|</operator>  <literal type="number">63</literal> <operator>--</operator><operator>--</operator><operator>-</operator>
 <operator>...</operator><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>store</name><operator>/</operator><name><name>SLAStore</name><operator>.</operator><name>java</name></name> <operator>|</operator>   <literal type="number">3</literal> <operator>-</operator>
 <operator>...</operator><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>util</name><operator>/</operator><name>db</name><operator>/</operator><name><name>SLADbOperations</name><operator>.</operator><name>java</name></name> <operator>|</operator>  <literal type="number">54</literal> <operator>++</operator><operator>--</operator>
 <operator>...</operator><operator>/</operator><name>oozie</name><operator>/</operator><name>util</name><operator>/</operator><name>db</name><operator>/</operator><name><name>SLADbXOperations</name><operator>.</operator><name>java</name></name>       <operator>|</operator>  <literal type="number">32</literal> <operator>+</operator><operator>--</operator>
 <operator>...</operator><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>wf</name><operator>/</operator><name><name>TestActionErrors</name><operator>.</operator><name>java</name></name>    <operator>|</operator>   <literal type="number">1</literal> <operator>-</operator>
 <operator>...</operator><operator>/</operator><name><name>TestBulkDeleteForPurgeJPAExecutor</name><operator>.</operator><name>java</name></name>    <operator>|</operator> <literal type="number">216</literal> <operator>++</operator><operator>++</operator><operator>++</operator><operator>++</operator><operator>++</operator><operator>++</operator><operator>++</operator><operator>+</operator>
 <operator>...</operator><operator>/</operator><name>jpa</name><operator>/</operator><name><name>TestBulkUpdateDeleteJPAExecutor</name><operator>.</operator><name>java</name></name>  <operator>|</operator> <literal type="number">231</literal> <operator>++</operator><operator>++</operator><operator>++</operator><operator>++</operator><operator>++</operator><operator>++</operator><operator>++</operator><operator>++</operator>
 <operator>...</operator><name><name>eInsertForCoordActionStartJPAExecutor</name><operator>.</operator><name>java</name></name> <operator>|</operator> <literal type="number">260</literal> <operator>++</operator><operator>++</operator><operator>++</operator><operator>++</operator><operator>++</operator><operator>++</operator><operator>++</operator><operator>++</operator><operator>++</operator>
 <operator>...</operator><name><name>InsertForCoordActionStatusJPAExecutor</name><operator>.</operator><name>java</name></name> <operator>|</operator> <literal type="number">260</literal> <operator>++</operator><operator>++</operator><operator>++</operator><operator>++</operator><operator>++</operator><operator>++</operator><operator>++</operator><operator>++</operator><operator>++</operator>
 <operator>...</operator><operator>/</operator><name>jpa</name><operator>/</operator><name><name>TestBulkUpdateInsertJPAExecutor</name><operator>.</operator><name>java</name></name>  <operator>|</operator>   <literal type="number">3</literal> <operator>+</operator>
 <operator>...</operator><name><name>undleActionsDeleteForPurgeJPAExecutor</name><operator>.</operator><name>java</name></name> <operator>|</operator>  <literal type="number">88</literal> <operator>--</operator><operator>--</operator><operator>--</operator>
 <operator>...</operator><operator>/</operator><name>jpa</name><operator>/</operator><name><name>TestBundleJobDeleteJPAExecutor</name><operator>.</operator><name>java</name></name>   <operator>|</operator>  <literal type="number">86</literal> <operator>--</operator><operator>--</operator><operator>--</operator>
 <operator>...</operator><name><name>tCoordActionUpdateForStartJPAExecutor</name><operator>.</operator><name>java</name></name> <operator>|</operator>  <literal type="number">80</literal> <operator>--</operator><operator>--</operator><operator>--</operator>
 <operator>...</operator><name><name>CoordActionsDeleteForPurgeJPAExecutor</name><operator>.</operator><name>java</name></name> <operator>|</operator>  <literal type="number">65</literal> <operator>--</operator><operator>--</operator><operator>-</operator>
 <operator>...</operator><name><name>kflowActionsDeleteForPurgeJPAExecutor</name><operator>.</operator><name>java</name></name> <operator>|</operator>  <literal type="number">64</literal> <operator>--</operator><operator>--</operator><operator>-</operator>
 <operator>...</operator><operator>/</operator><name>service</name><operator>/</operator><name><name>TestStatusTransitService</name><operator>.</operator><name>java</name></name>     <operator>|</operator>   <literal type="number">4</literal> <operator>+</operator><operator>-</operator>
 <name>release</name><operator>-</operator><name><name>log</name><operator>.</operator><name>txt</name></name>                               <operator>|</operator>   <literal type="number">1</literal> <operator>+</operator>
 <literal type="number">72</literal> <name>files</name> <name>changed</name></expr></range></decl>, 2283 <decl><type ref="prev"/><name>insertions</name><argument_list>(<argument><expr><operator>+</operator></expr></argument>)</argument_list></decl>, 1329 <decl><type ref="prev"/><name>deletions</name><argument_list>(<argument><expr><operator>-</operator></expr></argument>)</argument_list>
 <name>create</name> <name>mode</name> 100644 <name>core</name>/<name>src</name>/<name>main</name>/<name>java</name>/<name>org</name>/<name>apache</name>/<name>oozie</name>/<name>executor</name>/<name>jpa</name>/<name><name>BulkDeleteForPurgeJPAExecutor</name><operator>.</operator><name>java</name></name>
 <name>create</name> <name>mode</name> 100644 <name>core</name>/<name>src</name>/<name>main</name>/<name>java</name>/<name>org</name>/<name>apache</name>/<name>oozie</name>/<name>executor</name>/<name>jpa</name>/<name><name>BulkUpdateDeleteJPAExecutor</name><operator>.</operator><name>java</name></name>
 <name>create</name> <name>mode</name> 100644 <name>core</name>/<name>src</name>/<name>main</name>/<name>java</name>/<name>org</name>/<name>apache</name>/<name>oozie</name>/<name>executor</name>/<name>jpa</name>/<name><name>BulkUpdateInsertForCoordActionStartJPAExecutor</name><operator>.</operator><name>java</name></name>
 <name>create</name> <name>mode</name> 100644 <name>core</name>/<name>src</name>/<name>main</name>/<name>java</name>/<name>org</name>/<name>apache</name>/<name>oozie</name>/<name>executor</name>/<name>jpa</name>/<name><name>BulkUpdateInsertForCoordActionStatusJPAExecutor</name><operator>.</operator><name>java</name></name>
 <name>create</name> <name>mode</name> 100644 <name>core</name>/<name>src</name>/<name>test</name>/<name>java</name>/<name>org</name>/<name>apache</name>/<name>oozie</name>/<name>executor</name>/<name>jpa</name>/<name><name>TestBulkDeleteForPurgeJPAExecutor</name><operator>.</operator><name>java</name></name>
 <name>create</name> <name>mode</name> 100644 <name>core</name>/<name>src</name>/<name>test</name>/<name>java</name>/<name>org</name>/<name>apache</name>/<name>oozie</name>/<name>executor</name>/<name>jpa</name>/<name><name>TestBulkUpdateDeleteJPAExecutor</name><operator>.</operator><name>java</name></name>
 <name>create</name> <name>mode</name> 100644 <name>core</name>/<name>src</name>/<name>test</name>/<name>java</name>/<name>org</name>/<name>apache</name>/<name>oozie</name>/<name>executor</name>/<name>jpa</name>/<name><name>TestBulkUpdateInsertForCoordActionStartJPAExecutor</name><operator>.</operator><name>java</name></name>
 <name>create</name> <name>mode</name> 100644 <name>core</name>/<name>src</name>/<name>test</name>/<name>java</name>/<name>org</name>/<name>apache</name>/<name>oozie</name>/<name>executor</name>/<name>jpa</name>/<name><name>TestBulkUpdateInsertForCoordActionStatusJPAExecutor</name><operator>.</operator><name>java</name></name>

<name>diff</name> --<name>git</name> <name>a</name>/<name>core</name>/<name>src</name>/<name>main</name>/<name>java</name>/<name>org</name>/<name>apache</name>/<name>oozie</name>/<name><name>BundleActionBean</name><operator>.</operator><name>java</name></name> <name>b</name>/<name>core</name>/<name>src</name>/<name>main</name>/<name>java</name>/<name>org</name>/<name>apache</name>/<name>oozie</name>/<name><name>BundleActionBean</name><operator>.</operator><name>java</name></name>
<name>index</name> 62de01a75..879d639c4 100644
-- <name>a</name>/<name>core</name>/<name>src</name>/<name>main</name>/<name>java</name>/<name>org</name>/<name>apache</name>/<name>oozie</name>/<name><name>BundleActionBean</name><operator>.</operator><name>java</name></name>
++ <name>b</name>/<name>core</name>/<name>src</name>/<name>main</name>/<name>java</name>/<name>org</name>/<name>apache</name>/<name>oozie</name>/<name><name>BundleActionBean</name><operator>.</operator><name>java</name></name>
@@ -35</decl>,9 +35,10 @@ <decl><type ref="prev"/><name>import</name> <name><name>javax</name><operator>.</operator><name>persistence</name><operator>.</operator><name>Table</name></name></decl>;</decl_stmt></block_content></block>
 
 import org.apache.hadoop.io.Writable;
 import org.apache.oozie.client.Job.Status;
import org.apache.oozie.client.rest.JsonBean;
 import org.apache.oozie.util.DateUtils;
 import org.apache.oozie.util.WritableUtils;
import org.apache.openjpa.persistence.jdbc.Index;
import org.json.simple.JSONObject;
 
 @Entity
 @Table(name = "BUNDLE_ACTIONS"</do>)
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">72</literal></expr><operator>,</operator><expr><literal type="number">7</literal> <operator>+</operator><literal type="number">73</literal></expr><operator>,</operator><expr><literal type="number">7</literal> @@</expr></expr_stmt> <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>openjpa</name><operator>.</operator><name>persistence</name><operator>.</operator><name>jdbc</name><operator>.</operator><name>Index</name></name>;</import>
         <annotation>@<name>NamedQuery</name><argument_list>(<argument><expr><name>name</name> <operator>=</operator> <literal type="string">"GET_BUNDLE_ACTIONS_OLDER_THAN"</literal></expr></argument>, <argument><expr><name>query</name> <operator>=</operator> <literal type="string">"select OBJECT(w) from BundleActionBean w order by w.lastModifiedTimestamp"</literal></expr></argument>)</argument_list></annotation><operator>,</operator>
 
         <annotation>@<name>NamedQuery</name><argument_list>(<argument><expr><name>name</name> <operator>=</operator> <literal type="string">"DELETE_COMPLETED_ACTIONS_FOR_BUNDLE"</literal></expr></argument>, <argument><expr><name>query</name> <operator>=</operator> <literal type="string">"delete from BundleActionBean a where a.bundleId = :bundleId and (a.status = 'SUCCEEDED' OR a.status = 'FAILED' OR a.status= 'KILLED' OR a.status = 'DONEWITHERROR')"</literal></expr></argument>)</argument_list></annotation>})
<class><specifier>public</specifier> class <name>BundleActionBean</name> <super_list><implements>implements <super><name>Writable</name></super></implements></super_list> <block>{
<class><specifier>public</specifier> class <name>BundleActionBean</name> <super_list><implements>implements <super><name>Writable</name></super>, <super><name>JsonBean</name></super></implements></super_list> <block>{
 
     <annotation>@<name>Id</name></annotation>
     <annotation>@<name>Column</name><argument_list>(<argument><expr><name>name</name> <operator>=</operator> <literal type="string">"bundle_action_id"</literal></expr></argument>)</argument_list></annotation>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">364</literal></expr><operator>,</operator><expr><literal type="number">4</literal> <operator>+</operator><literal type="number">365</literal></expr><operator>,</operator><expr><literal type="number">14</literal> @@ <specifier>public</specifier> <name>class</name> <name>BundleActionBean</name> implements <name>Writable</name> <block>{
             <expr><call><name>setLastModifiedTime</name><argument_list>(<argument><expr><operator>new</operator> <call><name>Date</name><argument_list>(<argument><expr><name>d</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;
         }</block></expr></expr_stmt>
     }</block></class>

    <function><annotation>@<name>Override</name></annotation>
    <type><specifier>public</specifier> <name>JSONObject</name></type> <name>toJSONObject</name><parameter_list>()</parameter_list> <block>{<block_content>
        <return>return <expr><literal type="null">null</literal></expr>;</return>
    </block_content>}</block></function>

    <function><annotation>@<name>Override</name></annotation>
    <type><specifier>public</specifier> <name>JSONObject</name></type> <name>toJSONObject</name><parameter_list>(<parameter><decl><type><name>String</name></type> <name>timeZoneId</name></decl></parameter>)</parameter_list> <block>{<block_content>
        <return>return <expr><literal type="null">null</literal></expr>;</return>
    </block_content>}</block></function>
 }</block></class>
<expr_stmt><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name><name>KillTransitionXCommand</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name><name>KillTransitionXCommand</name><operator>.</operator><name>java</name></name>
<name>index</name> <literal type="number">369c8b340</literal><operator>..</operator><literal type="number">73f861b6e</literal> <literal type="number">100644</literal>
<operator>--</operator> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name><name>KillTransitionXCommand</name><operator>.</operator><name>java</name></name>
<operator>++</operator> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name><name>KillTransitionXCommand</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">51</literal></expr><operator>,</operator><expr><literal type="number">6</literal> <operator>+</operator><literal type="number">51</literal></expr><operator>,</operator><expr><literal type="number">7</literal> @@ <specifier>public</specifier> <specifier>abstract</specifier> <name>class</name> <name>KillTransitionXCommand</name> extends <name><name>TransitionXCommand</name><argument_list type="generic">&lt;<argument><name>Void</name></argument>&gt;</argument_list></name> <block>{
             <expr><call><name>transitToNext</name><argument_list>()</argument_list></call></expr>;
             <expr><call><name>killChildren</name><argument_list>()</argument_list></call></expr>;
             <expr><call><name>updateJob</name><argument_list>()</argument_list></call></expr>;
            <expr><call><name>performWrites</name><argument_list>()</argument_list></call></expr>;
         }</block></expr></expr_stmt>
         <finally>finally <block>{<block_content>
             <expr_stmt><expr><call><name>notifyParent</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
<expr_stmt><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name><name>MaterializeTransitionXCommand</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name><name>MaterializeTransitionXCommand</name><operator>.</operator><name>java</name></name>
<name>index</name> <name>bfa8feaec</name><operator>..</operator><name>d84457981</name> <literal type="number">100644</literal>
<operator>--</operator> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name><name>MaterializeTransitionXCommand</name><operator>.</operator><name>java</name></name>
<operator>++</operator> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name><name>MaterializeTransitionXCommand</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">71</literal></expr><operator>,</operator><expr><literal type="number">6</literal> <operator>+</operator><literal type="number">71</literal></expr><operator>,</operator><expr><literal type="number">7</literal> @@ <specifier>public</specifier> <specifier>abstract</specifier> <name>class</name> <name>MaterializeTransitionXCommand</name> extends <name>TransitionXCommand</name><operator>&lt;</operator><name>V</name></expr></expr_stmt>
         <try>try <block>{<block_content>
             <expr_stmt><expr><call><name>materialize</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
             <expr_stmt><expr><call><name>updateJob</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name>performWrites</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
         </block_content>}</block> <finally>finally <block>{<block_content>
             <expr_stmt><expr><call><name>notifyParent</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
         </block_content>}</block></finally></try>
<expr_stmt><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name><name>RerunTransitionXCommand</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name><name>RerunTransitionXCommand</name><operator>.</operator><name>java</name></name>
<name>index</name> <literal type="number">6b82f73f6</literal><operator>..</operator><name>f0569f460</name> <literal type="number">100644</literal>
<operator>--</operator> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name><name>RerunTransitionXCommand</name><operator>.</operator><name>java</name></name>
<operator>++</operator> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name><name>RerunTransitionXCommand</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">18</literal></expr><operator>,</operator><expr><literal type="number">7</literal> <operator>+</operator><literal type="number">18</literal></expr><operator>,</operator><expr><literal type="number">6</literal> @@</expr></expr_stmt>
 <package>package <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name></name>;</package>
 
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>ErrorCode</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>CoordinatorJob</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>Job</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>util</name><operator>.</operator><name>StatusUtils</name></name>;</import>
 
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">96</literal></expr><operator>,</operator><expr><literal type="number">6</literal> <operator>+</operator><literal type="number">95</literal></expr><operator>,</operator><expr><literal type="number">7</literal> @@ <specifier>public</specifier> <specifier>abstract</specifier> <name>class</name> <name><name>RerunTransitionXCommand</name><argument_list type="generic">&lt;<argument><name>T</name></argument>&gt;</argument_list></name> extends <name><name>TransitionXCommand</name><argument_list type="generic">&lt;<argument><name>T</name></argument>&gt;</argument_list></name> <block>{
             <expr><call><name>transitToNext</name><argument_list>()</argument_list></call></expr>;
             <expr><call><name>rerunChildren</name><argument_list>()</argument_list></call></expr>;
             <expr><call><name>updateJob</name><argument_list>()</argument_list></call></expr>;
            <expr><call><name>performWrites</name><argument_list>()</argument_list></call></expr>;
         }</block></expr></expr_stmt>
         <finally>finally <block>{<block_content>
             <expr_stmt><expr><call><name>notifyParent</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
<expr_stmt><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name><name>ResumeTransitionXCommand</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name><name>ResumeTransitionXCommand</name><operator>.</operator><name>java</name></name>
<name>index</name> <name>ff1de064c</name><operator>..</operator><name>a6fe5b83f</name> <literal type="number">100644</literal>
<operator>--</operator> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name><name>ResumeTransitionXCommand</name><operator>.</operator><name>java</name></name>
<operator>++</operator> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name><name>ResumeTransitionXCommand</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">67</literal></expr><operator>,</operator><expr><literal type="number">6</literal> <operator>+</operator><literal type="number">67</literal></expr><operator>,</operator><expr><literal type="number">7</literal> @@ <specifier>public</specifier> <specifier>abstract</specifier> <name>class</name> <name>ResumeTransitionXCommand</name> extends <name><name>TransitionXCommand</name><argument_list type="generic">&lt;<argument><name>Void</name></argument>&gt;</argument_list></name></expr></expr_stmt>
         <try>try <block>{<block_content>
             <expr_stmt><expr><call><name>resumeChildren</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
             <expr_stmt><expr><call><name>updateJob</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name>performWrites</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
         </block_content>}</block> <finally>finally <block>{<block_content>
             <expr_stmt><expr><call><name>notifyParent</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
         </block_content>}</block></finally></try>
<expr_stmt><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name><name>StartTransitionXCommand</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name><name>StartTransitionXCommand</name><operator>.</operator><name>java</name></name>
<name>index</name> <name>aa376d6f9</name><operator>..</operator><literal type="number">520356a25</literal> <literal type="number">100644</literal>
<operator>--</operator> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name><name>StartTransitionXCommand</name><operator>.</operator><name>java</name></name>
<operator>++</operator> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name><name>StartTransitionXCommand</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">79</literal></expr><operator>,</operator><expr><literal type="number">6</literal> <operator>+</operator><literal type="number">79</literal></expr><operator>,</operator><expr><literal type="number">7</literal> @@ <specifier>public</specifier> <specifier>abstract</specifier> <name>class</name> <name>StartTransitionXCommand</name> extends <name><name>TransitionXCommand</name><argument_list type="generic">&lt;<argument><name>Void</name></argument>&gt;</argument_list></name> <block>{
         <expr><call><name>transitToNext</name><argument_list>()</argument_list></call></expr>;
         <expr><call><name>updateJob</name><argument_list>()</argument_list></call></expr>;
         <expr><call><name>StartChildren</name><argument_list>()</argument_list></call></expr>;
        <expr><call><name>performWrites</name><argument_list>()</argument_list></call></expr>;
         <expr><call><name>notifyParent</name><argument_list>()</argument_list></call></expr>;
         <return>return <expr><literal type="null">null</literal></expr>;</return>
     }</block></expr></expr_stmt>
<expr_stmt><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name><name>SuspendTransitionXCommand</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name><name>SuspendTransitionXCommand</name><operator>.</operator><name>java</name></name>
<name>index</name> <literal type="number">6b7872184</literal><operator>..</operator><literal type="number">3f432cb77</literal> <literal type="number">100644</literal>
<operator>--</operator> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name><name>SuspendTransitionXCommand</name><operator>.</operator><name>java</name></name>
<operator>++</operator> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name><name>SuspendTransitionXCommand</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">73</literal></expr><operator>,</operator><expr><literal type="number">6</literal> <operator>+</operator><literal type="number">73</literal></expr><operator>,</operator><expr><literal type="number">7</literal> @@ <specifier>public</specifier> <specifier>abstract</specifier> <name>class</name> <name>SuspendTransitionXCommand</name> extends <name><name>TransitionXCommand</name><argument_list type="generic">&lt;<argument><name>Void</name></argument>&gt;</argument_list></name></expr></expr_stmt>
         <try>try <block>{<block_content>
             <expr_stmt><expr><call><name>suspendChildren</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
             <expr_stmt><expr><call><name>updateJob</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name>performWrites</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
         </block_content>}</block> <finally>finally <block>{<block_content>
             <expr_stmt><expr><call><name>notifyParent</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
         </block_content>}</block></finally></try>
<expr_stmt><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name><name>TransitionXCommand</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name><name>TransitionXCommand</name><operator>.</operator><name>java</name></name>
<name>index</name> <literal type="number">135b67c04</literal><operator>..</operator><name>c69d77762</name> <literal type="number">100644</literal>
<operator>--</operator> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name><name>TransitionXCommand</name><operator>.</operator><name>java</name></name>
<operator>++</operator> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name><name>TransitionXCommand</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">17</literal></expr><operator>,</operator><expr><literal type="number">7</literal> <operator>+</operator><literal type="number">17</literal></expr><operator>,</operator><expr><literal type="number">11</literal> @@
  <operator>*</operator><operator>/</operator></expr></expr_stmt>
 <package>package <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name></name>;</package>
 
<import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>ArrayList</name></name>;</import>
<import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>List</name></name>;</import>

 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>Job</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>rest</name><operator>.</operator><name>JsonBean</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>util</name><operator>.</operator><name>ParamChecker</name></name>;</import>
 
 <comment type="block" format="javadoc">/**
@@ -29,6 +33,8 @@ import org.apache.oozie.util.ParamChecker;
 public abstract class TransitionXCommand&lt;T&gt; extends XCommand&lt;T&gt; {
 
     protected Job job;
    protected List&lt;JsonBean&gt; updateList = new ArrayList&lt;JsonBean&gt;();
    protected List&lt;JsonBean&gt; insertList = new ArrayList&lt;JsonBean&gt;();
 
     public TransitionXCommand(String name, String type, int priority) {
         super(name, type, priority);
@@ -59,6 +65,13 @@ public abstract class TransitionXCommand&lt;T&gt; extends XCommand&lt;T&gt; {
      */</comment>
     <function_decl><type><specifier>public</specifier> <specifier>abstract</specifier> <name>void</name></type> <name>notifyParent</name><parameter_list>()</parameter_list> <throws>throws <argument><expr><name>CommandException</name></expr></argument></throws>;</function_decl>
 
    <comment type="block" format="javadoc">/**
     * This will be used to perform atomically all the writes within this command.
     *
     * @throws CommandException
     */</comment>
    <function_decl><type><specifier>public</specifier> <specifier>abstract</specifier> <name>void</name></type> <name>performWrites</name><parameter_list>()</parameter_list> <throws>throws <argument><expr><name>CommandException</name></expr></argument></throws>;</function_decl>

     <comment type="block">/* (non-Javadoc)
      * @see org.apache.oozie.command.XCommand#execute()
      */</comment>
<expr_stmt><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>bundle</name><operator>/</operator><name><name>BundleJobChangeXCommand</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>bundle</name><operator>/</operator><name><name>BundleJobChangeXCommand</name><operator>.</operator><name>java</name></name>
<name>index</name> <literal type="number">8cb3aba54</literal><operator>..</operator><name>d310ec4bc</name> <literal type="number">100644</literal>
<operator>--</operator> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>bundle</name><operator>/</operator><name><name>BundleJobChangeXCommand</name><operator>.</operator><name>java</name></name>
<operator>++</operator> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>bundle</name><operator>/</operator><name><name>BundleJobChangeXCommand</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">17</literal></expr><operator>,</operator><expr><literal type="number">6</literal> <operator>+</operator><literal type="number">17</literal></expr><operator>,</operator><expr><literal type="number">7</literal> @@
  <operator>*</operator><operator>/</operator></expr></expr_stmt>
 <package>package <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>bundle</name></name>;</package>
 
<import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>ArrayList</name></name>;</import>
 <import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>Date</name></name>;</import>
 <import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>HashSet</name></name>;</import>
 <import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>List</name></name>;</import>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">29</literal></expr><operator>,</operator><expr><literal type="number">14</literal> <operator>+</operator><literal type="number">30</literal></expr><operator>,</operator><expr><literal type="number">14</literal> @@</expr></expr_stmt> <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>ErrorCode</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>XException</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>Job</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>OozieClient</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>rest</name><operator>.</operator><name>JsonBean</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>CommandException</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>PreconditionException</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>XCommand</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>coord</name><operator>.</operator><name>CoordChangeXCommand</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>BundleActionUpdateJPAExecutor</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>BulkUpdateInsertJPAExecutor</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>BundleActionsGetJPAExecutor</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>BundleJobGetJPAExecutor</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>BundleJobUpdateJPAExecutor</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>JPAService</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>Services</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>util</name><operator>.</operator><name>DateUtils</name></name>;</import>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">55</literal></expr><operator>,</operator><expr><literal type="number">6</literal> <operator>+</operator><literal type="number">56</literal></expr><operator>,</operator><expr><literal type="number">7</literal> @@ <specifier>public</specifier> <name>class</name> <name>BundleJobChangeXCommand</name> extends <name><name>XCommand</name><argument_list type="generic">&lt;<argument><name>Void</name></argument>&gt;</argument_list></name> <block>{
     <expr><specifier>private</specifier> <name>Date</name> <name>newEndTime</name> <operator>=</operator> <literal type="null">null</literal></expr>;
     <expr><name>boolean</name> <name>isChangePauseTime</name> <operator>=</operator> <literal type="boolean">false</literal></expr>;
     <expr><name>boolean</name> <name>isChangeEndTime</name> <operator>=</operator> <literal type="boolean">false</literal></expr>;
    <expr><specifier>private</specifier> <name><name>List</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name> <name>updateList</name> <operator>=</operator> <operator>new</operator> <call><name><name>ArrayList</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name><argument_list>()</argument_list></call></expr>;
 
     <expr><specifier>private</specifier> <specifier>static</specifier> <name>final</name> <name><name>Set</name><argument_list type="generic">&lt;<argument><name>String</name></argument>&gt;</argument_list></name> <name>ALLOWED_CHANGE_OPTIONS</name> <operator>=</operator> <operator>new</operator> <call><name><name>HashSet</name><argument_list type="generic">&lt;<argument><name>String</name></argument>&gt;</argument_list></name><argument_list>()</argument_list></call></expr>;
     <expr><specifier>static</specifier> <block>{
@@ <expr><operator>-</operator><literal type="number">179</literal></expr>,<expr><literal type="number">10</literal> <operator>+</operator><literal type="number">181</literal></expr>,<expr><literal type="number">11</literal> @@ <specifier>public</specifier> <name>class</name> <name>BundleJobChangeXCommand</name> extends <name><name>XCommand</name><argument_list type="generic">&lt;<argument><name>Void</name></argument>&gt;</argument_list></name> <block>{
                         <expr><call><name><name>LOG</name><operator>.</operator><name>info</name></name><argument_list>(<argument><expr><literal type="string">"Queuing CoordChangeXCommand coord job = "</literal> <operator>+</operator> <call><name><name>action</name><operator>.</operator><name>getCoordId</name></name><argument_list>()</argument_list></call> <operator>+</operator> <literal type="string">" to change "</literal>
                                 <operator>+</operator> <name>changeValue</name></expr></argument>)</argument_list></call></expr>;
                         <expr><call><name><name>action</name><operator>.</operator><name>setPending</name></name><argument_list>(<argument><expr><call><name><name>action</name><operator>.</operator><name>getPending</name></name><argument_list>()</argument_list></call> <operator>+</operator> <literal type="number">1</literal></expr></argument>)</argument_list></call></expr>;
                        <expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>BundleActionUpdateJPAExecutor</name><argument_list>(<argument><expr><name>action</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;
                        <expr><call><name><name>updateList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>action</name></expr></argument>)</argument_list></call></expr>;
                     }</block></expr>
                 }</block>
                <call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>BundleJobUpdateJPAExecutor</name><argument_list>(<argument><expr><name>bundleJob</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;
                <expr><call><name><name>updateList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>bundleJob</name></expr></argument>)</argument_list></call></expr>;
                <expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>BulkUpdateInsertJPAExecutor</name><argument_list>(<argument><expr><name>updateList</name></expr></argument>, <argument><expr><literal type="null">null</literal></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;
             }</block></expr></expr_stmt>
             <return>return <expr><literal type="null">null</literal></expr>;</return>
         </block_content>}</block></finally>
<expr_stmt><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>bundle</name><operator>/</operator><name><name>BundleJobResumeXCommand</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>bundle</name><operator>/</operator><name><name>BundleJobResumeXCommand</name><operator>.</operator><name>java</name></name>
<name>index</name> <literal type="number">99c742fa8</literal><operator>..</operator><literal type="number">8db9117e4</literal> <literal type="number">100644</literal>
<operator>--</operator> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>bundle</name><operator>/</operator><name><name>BundleJobResumeXCommand</name><operator>.</operator><name>java</name></name>
<operator>++</operator> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>bundle</name><operator>/</operator><name><name>BundleJobResumeXCommand</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">23</literal></expr><operator>,</operator><expr><literal type="number">16</literal> <operator>+</operator><literal type="number">23</literal></expr><operator>,</operator><expr><literal type="number">14</literal> @@</expr></expr_stmt> <import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>List</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>BundleActionBean</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>BundleJobBean</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>ErrorCode</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>XException</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>Job</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>CommandException</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>PreconditionException</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>ResumeTransitionXCommand</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>coord</name><operator>.</operator><name>CoordResumeXCommand</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>BundleActionUpdateJPAExecutor</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>BulkUpdateInsertJPAExecutor</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>BundleActionsGetJPAExecutor</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>BundleJobGetJPAExecutor</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>BundleJobUpdateJPAExecutor</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>JPAExecutorException</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>JPAService</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>Services</name></name>;</import>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">61</literal></expr><operator>,</operator><expr><literal type="number">33</literal> <operator>+</operator><literal type="number">59</literal></expr><operator>,</operator><expr><literal type="number">28</literal> @@ <specifier>public</specifier> <name>class</name> <name>BundleJobResumeXCommand</name> extends <name>ResumeTransitionXCommand</name> <block>{
      <expr><operator>*</operator> @<name>see</name> <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>ResumeTransitionXCommand</name></name><operator>#</operator><call><name>resumeChildren</name><argument_list>()</argument_list></call>
      <operator>*</operator><operator>/</operator>
     @<name>Override</name>
    <specifier>public</specifier> <name>void</name> <call><name>resumeChildren</name><argument_list>()</argument_list></call> <throws>throws <argument><expr><name>CommandException</name> <block>{</block></expr></argument></throws></expr>
        <try>try <block>{<block_content>
            <for>for <control>(<init><decl><type><name>BundleActionBean</name></type> <name>action</name> <range>: <expr><name>bundleActions</name></expr></range></decl></init>)</control> <block>{<block_content>
                <if_stmt><if>if <condition>(<expr><call><name><name>action</name><operator>.</operator><name>getStatus</name></name><argument_list>()</argument_list></call> <operator>==</operator> <name><name>Job</name><operator>.</operator><name>Status</name><operator>.</operator><name>SUSPENDED</name></name> <operator>||</operator> <call><name><name>action</name><operator>.</operator><name>getStatus</name></name><argument_list>()</argument_list></call> <operator>==</operator> <name><name>Job</name><operator>.</operator><name>Status</name><operator>.</operator><name>SUSPENDEDWITHERROR</name></name> <operator>||</operator> <call><name><name>action</name><operator>.</operator><name>getStatus</name></name><argument_list>()</argument_list></call> <operator>==</operator> <name><name>Job</name><operator>.</operator><name>Status</name><operator>.</operator><name>PREPSUSPENDED</name></name></expr>)</condition> <block>{<block_content>
                    <comment type="line">// queue a CoordResumeXCommand</comment>
                    <if_stmt><if>if <condition>(<expr><call><name><name>action</name><operator>.</operator><name>getCoordId</name></name><argument_list>()</argument_list></call> <operator>!=</operator> <literal type="null">null</literal></expr>)</condition> <block>{<block_content>
                        <expr_stmt><expr><call><name>queue</name><argument_list>(<argument><expr><operator>new</operator> <call><name>CoordResumeXCommand</name><argument_list>(<argument><expr><call><name><name>action</name><operator>.</operator><name>getCoordId</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                        <expr_stmt><expr><call><name>updateBundleAction</name><argument_list>(<argument><expr><name>action</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                        <expr_stmt><expr><call><name><name>LOG</name><operator>.</operator><name>debug</name></name><argument_list>(<argument><expr><literal type="string">"Resume bundle action = [{0}], new status = [{1}], pending = [{2}] and queue CoordResumeXCommand for [{3}]"</literal></expr></argument>,
                                        <argument><expr><call><name><name>action</name><operator>.</operator><name>getBundleActionId</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><call><name><name>action</name><operator>.</operator><name>getStatus</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><call><name><name>action</name><operator>.</operator><name>getPending</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><call><name><name>action</name>
                                                <operator>.</operator><name>getCoordId</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                    <expr_stmt/></block_content></block></if></if_stmt></block_content></block></if></if_stmt></block_content></block></for></block_content></block></try>}</block></expr></expr_stmt>
                    <if_stmt><else>else <block>{<block_content>
                        <expr_stmt><expr><call><name>updateBundleAction</name><argument_list>(<argument><expr><name>action</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                        <expr_stmt><expr><call><name><name>LOG</name><operator>.</operator><name>debug</name></name><argument_list>(<argument><expr><literal type="string">"Resume bundle action = [{0}], new status = [{1}], pending = [{2}] and coord id is null"</literal></expr></argument>,
                                        <argument><expr><call><name><name>action</name><operator>.</operator><name>getBundleActionId</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><call><name><name>action</name><operator>.</operator><name>getStatus</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><call><name><name>action</name><operator>.</operator><name>getPending</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                    </block_content>}</block></else></if_stmt>
    <function><type><specifier>public</specifier> <name>void</name></type> <name>resumeChildren</name><parameter_list>()</parameter_list> <block>{<block_content>
        <for>for <control>(<init><decl><type><name>BundleActionBean</name></type> <name>action</name> <range>: <expr><name>bundleActions</name></expr></range></decl></init>)</control> <block>{<block_content>
            <if_stmt><if>if <condition>(<expr><call><name><name>action</name><operator>.</operator><name>getStatus</name></name><argument_list>()</argument_list></call> <operator>==</operator> <name><name>Job</name><operator>.</operator><name>Status</name><operator>.</operator><name>SUSPENDED</name></name> <operator>||</operator> <call><name><name>action</name><operator>.</operator><name>getStatus</name></name><argument_list>()</argument_list></call> <operator>==</operator> <name><name>Job</name><operator>.</operator><name>Status</name><operator>.</operator><name>SUSPENDEDWITHERROR</name></name> <operator>||</operator> <call><name><name>action</name><operator>.</operator><name>getStatus</name></name><argument_list>()</argument_list></call> <operator>==</operator> <name><name>Job</name><operator>.</operator><name>Status</name><operator>.</operator><name>PREPSUSPENDED</name></name></expr>)</condition> <block>{<block_content>
                <comment type="line">// queue a CoordResumeXCommand</comment>
                <if_stmt><if>if <condition>(<expr><call><name><name>action</name><operator>.</operator><name>getCoordId</name></name><argument_list>()</argument_list></call> <operator>!=</operator> <literal type="null">null</literal></expr>)</condition> <block>{<block_content>
                    <expr_stmt><expr><call><name>queue</name><argument_list>(<argument><expr><operator>new</operator> <call><name>CoordResumeXCommand</name><argument_list>(<argument><expr><call><name><name>action</name><operator>.</operator><name>getCoordId</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                    <expr_stmt><expr><call><name>updateBundleAction</name><argument_list>(<argument><expr><name>action</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                    <expr_stmt><expr><call><name><name>LOG</name><operator>.</operator><name>debug</name></name><argument_list>(<argument><expr><literal type="string">"Resume bundle action = [{0}], new status = [{1}], pending = [{2}] and queue CoordResumeXCommand for [{3}]"</literal></expr></argument>,
                                    <argument><expr><call><name><name>action</name><operator>.</operator><name>getBundleActionId</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><call><name><name>action</name><operator>.</operator><name>getStatus</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><call><name><name>action</name><operator>.</operator><name>getPending</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><call><name><name>action</name>
                                            <operator>.</operator><name>getCoordId</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                </block_content>}</block></if>
                <else>else <block>{<block_content>
                    <expr_stmt><expr><call><name>updateBundleAction</name><argument_list>(<argument><expr><name>action</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                    <expr_stmt><expr><call><name><name>LOG</name><operator>.</operator><name>debug</name></name><argument_list>(<argument><expr><literal type="string">"Resume bundle action = [{0}], new status = [{1}], pending = [{2}] and coord id is null"</literal></expr></argument>,
                                    <argument><expr><call><name><name>action</name><operator>.</operator><name>getBundleActionId</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><call><name><name>action</name><operator>.</operator><name>getStatus</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><call><name><name>action</name><operator>.</operator><name>getPending</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                 </block_content>}</block></else></if_stmt>
             </block_content>}</block></if></if_stmt>
            <expr_stmt><expr><call><name><name>LOG</name><operator>.</operator><name>debug</name></name><argument_list>(<argument><expr><literal type="string">"Resume bundle actions for the bundle=[{0}]"</literal></expr></argument>, <argument><expr><name>bundleId</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        </block_content>}</block></for>
        <catch>catch <parameter_list>(<parameter><decl><type><name>XException</name></type> <name>ex</name></decl></parameter>)</parameter_list> <block>{<block_content>
            <throw>throw <expr><operator>new</operator> <call><name>CommandException</name><argument_list>(<argument><expr><name>ex</name></expr></argument>)</argument_list></call></expr>;</throw>
         </block_content>}</block></catch>
        <expr_stmt><expr><call><name><name>LOG</name><operator>.</operator><name>debug</name></name><argument_list>(<argument><expr><literal type="string">"Resume bundle actions for the bundle=[{0}]"</literal></expr></argument>, <argument><expr><name>bundleId</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
     </block_content>}</block></function>
 
    <function><type><specifier>private</specifier> <name>void</name></type> <name>updateBundleAction</name><parameter_list>(<parameter><decl><type><name>BundleActionBean</name></type> <name>action</name></decl></parameter>)</parameter_list> <throws>throws <argument><expr><name>CommandException</name></expr></argument></throws> <block>{<block_content>
    <function><type><specifier>private</specifier> <name>void</name></type> <name>updateBundleAction</name><parameter_list>(<parameter><decl><type><name>BundleActionBean</name></type> <name>action</name></decl></parameter>)</parameter_list> <block>{<block_content>
         <if_stmt><if>if <condition>(<expr><call><name><name>action</name><operator>.</operator><name>getStatus</name></name><argument_list>()</argument_list></call> <operator>==</operator> <name><name>Job</name><operator>.</operator><name>Status</name><operator>.</operator><name>PREPSUSPENDED</name></name></expr>)</condition> <block>{<block_content>
             <expr_stmt><expr><call><name><name>action</name><operator>.</operator><name>setStatus</name></name><argument_list>(<argument><expr><name><name>Job</name><operator>.</operator><name>Status</name><operator>.</operator><name>PREP</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
         </block_content>}</block></if></if_stmt>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">99</literal></expr><operator>,</operator><expr><literal type="number">12</literal> <operator>+</operator><literal type="number">92</literal></expr><operator>,</operator><expr><literal type="number">7</literal> @@ <specifier>public</specifier> <name>class</name> <name>BundleJobResumeXCommand</name> extends <name>ResumeTransitionXCommand</name> <block>{
         }</block>
         <call><name><name>action</name><operator>.</operator><name>incrementAndGetPending</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
         <expr_stmt><expr><call><name><name>action</name><operator>.</operator><name>setLastModifiedTime</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>Date</name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <try>try <block>{<block_content>
            <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>BundleActionUpdateJPAExecutor</name><argument_list>(<argument><expr><name>action</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        </block_content>}</block>
        <catch>catch <parameter_list>(<parameter><decl><type><name>JPAExecutorException</name></type> <name>e</name></decl></parameter>)</parameter_list> <block>{<block_content>
            <throw>throw <expr><operator>new</operator> <call><name>CommandException</name><argument_list>(<argument><expr><name>e</name></expr></argument>)</argument_list></call></expr>;</throw>
        </block_content>}</block></catch></try>
        <expr_stmt><expr><call><name><name>updateList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>action</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
     </block_content>}</block></function>
 
     <comment type="block">/* (non-Javadoc)
@@ -119,13 +107,21 @@ public class BundleJobResumeXCommand extends ResumeTransitionXCommand {
      * @see org.apache.oozie.command.TransitionXCommand#updateJob()
      */</comment>
     <function><annotation>@<name>Override</name></annotation>
    <type><specifier>public</specifier> <name>void</name></type> <name>updateJob</name><parameter_list>()</parameter_list> <throws>throws <argument><expr><name>CommandException</name></expr></argument></throws> <block>{<block_content>
    <function><type><specifier>public</specifier> <name>void</name></type> <name>updateJob</name><parameter_list>()</parameter_list> <block>{<block_content>
         <expr_stmt><expr><call><name><name>InstrumentUtils</name><operator>.</operator><name>incrJobCounter</name></name><argument_list>(<argument><expr><literal type="string">"bundle_resume"</literal></expr></argument>, <argument><expr><literal type="number">1</literal></expr></argument>, <argument><expr><literal type="null">null</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
         <expr_stmt><expr><call><name><name>bundleJob</name><operator>.</operator><name>setSuspendedTime</name></name><argument_list>(<argument><expr><literal type="null">null</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
         <expr_stmt><expr><call><name><name>bundleJob</name><operator>.</operator><name>setLastModifiedTime</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>Date</name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
         <expr_stmt><expr><call><name><name>LOG</name><operator>.</operator><name>debug</name></name><argument_list>(<argument><expr><literal type="string">"Resume bundle job id = "</literal> <operator>+</operator> <name>bundleId</name> <operator>+</operator> <literal type="string">", status = "</literal> <operator>+</operator> <call><name><name>bundleJob</name><operator>.</operator><name>getStatus</name></name><argument_list>()</argument_list></call> <operator>+</operator> <literal type="string">", pending = "</literal> <operator>+</operator> <call><name><name>bundleJob</name><operator>.</operator><name>isPending</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>updateList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>bundleJob</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    </block_content>}</block></function>

    <comment type="block">/* (non-Javadoc)
     * @see org.apache.oozie.command.ResumeTransitionXCommand#performWrites()
     */</comment>
    <function><annotation>@<name>Override</name></annotation>
    <type><specifier>public</specifier> <name>void</name></type> <name>performWrites</name><parameter_list>()</parameter_list> <throws>throws <argument><expr><name>CommandException</name></expr></argument></throws> <block>{<block_content>
         <try>try <block>{<block_content>
            <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>BundleJobUpdateJPAExecutor</name><argument_list>(<argument><expr><name>bundleJob</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>BulkUpdateInsertJPAExecutor</name><argument_list>(<argument><expr><name>updateList</name></expr></argument>, <argument><expr><literal type="null">null</literal></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
         </block_content>}</block>
         <catch>catch <parameter_list>(<parameter><decl><type><name>JPAExecutorException</name></type> <name>e</name></decl></parameter>)</parameter_list> <block>{<block_content>
             <throw>throw <expr><operator>new</operator> <call><name>CommandException</name><argument_list>(<argument><expr><name>e</name></expr></argument>)</argument_list></call></expr>;</throw>
<expr_stmt><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>bundle</name><operator>/</operator><name><name>BundleJobSuspendXCommand</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>bundle</name><operator>/</operator><name><name>BundleJobSuspendXCommand</name><operator>.</operator><name>java</name></name>
<name>index</name> <name>e4c09c589</name><operator>..</operator><literal type="number">887333cea</literal> <literal type="number">100644</literal>
<operator>--</operator> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>bundle</name><operator>/</operator><name><name>BundleJobSuspendXCommand</name><operator>.</operator><name>java</name></name>
<operator>++</operator> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>bundle</name><operator>/</operator><name><name>BundleJobSuspendXCommand</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">23</literal></expr><operator>,</operator><expr><literal type="number">16</literal> <operator>+</operator><literal type="number">23</literal></expr><operator>,</operator><expr><literal type="number">14</literal> @@</expr></expr_stmt> <import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>List</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>BundleActionBean</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>BundleJobBean</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>ErrorCode</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>XException</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>Job</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>CommandException</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>PreconditionException</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>SuspendTransitionXCommand</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>coord</name><operator>.</operator><name>CoordSuspendXCommand</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>BundleActionUpdateJPAExecutor</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>BulkUpdateInsertJPAExecutor</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>BundleActionsGetJPAExecutor</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>BundleJobGetJPAExecutor</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>BundleJobUpdateJPAExecutor</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>JPAExecutorException</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>JPAService</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>Services</name></name>;</import>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">73</literal></expr><operator>,</operator><expr><literal type="number">6</literal> <operator>+</operator><literal type="number">71</literal></expr><operator>,</operator><expr><literal type="number">19</literal> @@ <specifier>public</specifier> <name>class</name> <name>BundleJobSuspendXCommand</name> extends <name>SuspendTransitionXCommand</name> <block>{
     <expr><specifier>public</specifier> <name>void</name> <call><name>setJob</name><argument_list>(<argument><expr><name>Job</name> <name>job</name></expr></argument>)</argument_list></call> <block>{
     }</block>
 
    <comment type="block">/* (non-Javadoc)
     * @see org.apache.oozie.command.SuspendTransitionXCommand#performWrites()
     */</comment>
    @<name>Override</name>
    <specifier>public</specifier> <name>void</name> <call><name>performWrites</name><argument_list>()</argument_list></call> <throws>throws <argument><expr><name>CommandException</name> <block>{</block></expr></argument></throws></expr>
        <try>try <block>{<block_content>
            <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>BulkUpdateInsertJPAExecutor</name><argument_list>(<argument><expr><name>updateList</name></expr></argument>, <argument><expr><literal type="null">null</literal></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt/></block_content></block></try>}</block></expr></expr_stmt>
        <catch>catch <parameter_list>(<parameter><decl><type><name>JPAExecutorException</name></type> <name>e</name></decl></parameter>)</parameter_list> <block>{<block_content>
            <throw>throw <expr><operator>new</operator> <call><name>CommandException</name><argument_list>(<argument><expr><name>e</name></expr></argument>)</argument_list></call></expr>;</throw>
        </block_content>}</block></catch>
    </block_content>}</block></catch></try>

     <comment type="block">/* (non-Javadoc)
      * @see org.apache.oozie.command.XCommand#getEntityKey()
      */</comment>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">133</literal></expr><operator>,</operator><expr><literal type="number">49</literal> <operator>+</operator><literal type="number">144</literal></expr><operator>,</operator><expr><literal type="number">39</literal> @@ <specifier>public</specifier> <name>class</name> <name>BundleJobSuspendXCommand</name> extends <name>SuspendTransitionXCommand</name> <block>{
      <expr><operator>*</operator> @<name>see</name> <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>TransitionXCommand</name></name><operator>#</operator><call><name>updateJob</name><argument_list>()</argument_list></call>
      <operator>*</operator><operator>/</operator>
     @<name>Override</name>
    <specifier>public</specifier> <name>void</name> <call><name>updateJob</name><argument_list>()</argument_list></call> <throws>throws <argument><expr><name>CommandException</name> <block>{
    <expr><specifier>public</specifier> <name>void</name> <call><name>updateJob</name><argument_list>()</argument_list></call> <block>{
         <expr><call><name><name>InstrumentUtils</name><operator>.</operator><name>incrJobCounter</name></name><argument_list>(<argument><expr><literal type="string">"bundle_suspend"</literal></expr></argument>, <argument><expr><literal type="number">1</literal></expr></argument>, <argument><expr><literal type="null">null</literal></expr></argument>)</argument_list></call></expr></block></expr></block></expr></argument></throws></expr>;
         <expr><call><name><name>bundleJob</name><operator>.</operator><name>setSuspendedTime</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>Date</name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;
         <expr><call><name><name>bundleJob</name><operator>.</operator><name>setLastModifiedTime</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>Date</name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;
 
         <expr><call><name><name>LOG</name><operator>.</operator><name>debug</name></name><argument_list>(<argument><expr><literal type="string">"Suspend bundle job id = "</literal> <operator>+</operator> <name>jobId</name> <operator>+</operator> <literal type="string">", status = "</literal> <operator>+</operator> <call><name><name>bundleJob</name><operator>.</operator><name>getStatus</name></name><argument_list>()</argument_list></call> <operator>+</operator> <literal type="string">", pending = "</literal> <operator>+</operator> <call><name><name>bundleJob</name><operator>.</operator><name>isPending</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;
        <try>try <block>{<block_content>
            <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>BundleJobUpdateJPAExecutor</name><argument_list>(<argument><expr><name>bundleJob</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt/></block_content></block></try>}</block></expr></expr_stmt>
        <catch>catch <parameter_list>(<parameter><decl><type><name>JPAExecutorException</name></type> <name>e</name></decl></parameter>)</parameter_list> <block>{<block_content>
            <throw>throw <expr><operator>new</operator> <call><name>CommandException</name><argument_list>(<argument><expr><name>e</name></expr></argument>)</argument_list></call></expr>;</throw>
        </block_content>}</block></catch>
        <expr_stmt><expr><call><name><name>updateList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>bundleJob</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
     </block_content>}</block></function>
 
     <function><annotation>@<name>Override</name></annotation>
     <type><specifier>public</specifier> <name>void</name></type> <name>suspendChildren</name><parameter_list>()</parameter_list> <throws>throws <argument><expr><name>CommandException</name></expr></argument></throws> <block>{<block_content>
        <try>try <block>{<block_content>
            <for>for <control>(<init><decl><type><name>BundleActionBean</name></type> <name>action</name> <range>: <expr><name><name>this</name><operator>.</operator><name>bundleActions</name></name></expr></range></decl></init>)</control> <block>{<block_content>
                <if_stmt><if>if <condition>(<expr><call><name><name>action</name><operator>.</operator><name>getStatus</name></name><argument_list>()</argument_list></call> <operator>==</operator> <name><name>Job</name><operator>.</operator><name>Status</name><operator>.</operator><name>RUNNING</name></name> <operator>||</operator> <call><name><name>action</name><operator>.</operator><name>getStatus</name></name><argument_list>()</argument_list></call> <operator>==</operator> <name><name>Job</name><operator>.</operator><name>Status</name><operator>.</operator><name>RUNNINGWITHERROR</name></name>
                        <operator>||</operator> <call><name><name>action</name><operator>.</operator><name>getStatus</name></name><argument_list>()</argument_list></call> <operator>==</operator> <name><name>Job</name><operator>.</operator><name>Status</name><operator>.</operator><name>PREP</name></name> <operator>||</operator> <call><name><name>action</name><operator>.</operator><name>getStatus</name></name><argument_list>()</argument_list></call> <operator>==</operator> <name><name>Job</name><operator>.</operator><name>Status</name><operator>.</operator><name>PAUSED</name></name>
                        <operator>||</operator> <call><name><name>action</name><operator>.</operator><name>getStatus</name></name><argument_list>()</argument_list></call> <operator>==</operator> <name><name>Job</name><operator>.</operator><name>Status</name><operator>.</operator><name>PAUSEDWITHERROR</name></name></expr>)</condition> <block>{<block_content>
                    <comment type="line">// queue a CoordSuspendXCommand</comment>
                    <if_stmt><if>if <condition>(<expr><call><name><name>action</name><operator>.</operator><name>getCoordId</name></name><argument_list>()</argument_list></call> <operator>!=</operator> <literal type="null">null</literal></expr>)</condition> <block>{<block_content>
                        <expr_stmt><expr><call><name>queue</name><argument_list>(<argument><expr><operator>new</operator> <call><name>CoordSuspendXCommand</name><argument_list>(<argument><expr><call><name><name>action</name><operator>.</operator><name>getCoordId</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                        <expr_stmt><expr><call><name>updateBundleAction</name><argument_list>(<argument><expr><name>action</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                        <expr_stmt><expr><call><name><name>LOG</name><operator>.</operator><name>debug</name></name><argument_list>(<argument><expr><literal type="string">"Suspend bundle action = [{0}], new status = [{1}], pending = [{2}] and queue CoordSuspendXCommand for [{3}]"</literal></expr></argument>,
                                <argument><expr><call><name><name>action</name><operator>.</operator><name>getBundleActionId</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><call><name><name>action</name><operator>.</operator><name>getStatus</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><call><name><name>action</name><operator>.</operator><name>getPending</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><call><name><name>action</name><operator>.</operator><name>getCoordId</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                    </block_content>}</block></if> <else>else <block>{<block_content>
                        <expr_stmt><expr><call><name>updateBundleAction</name><argument_list>(<argument><expr><name>action</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                        <expr_stmt><expr><call><name><name>LOG</name><operator>.</operator><name>debug</name></name><argument_list>(<argument><expr><literal type="string">"Suspend bundle action = [{0}], new status = [{1}], pending = [{2}] and coord id is null"</literal></expr></argument>,
                                <argument><expr><call><name><name>action</name><operator>.</operator><name>getBundleActionId</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><call><name><name>action</name><operator>.</operator><name>getStatus</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><call><name><name>action</name><operator>.</operator><name>getPending</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                    </block_content>}</block></else></if_stmt>

        <for>for <control>(<init><decl><type><name>BundleActionBean</name></type> <name>action</name> <range>: <expr><name><name>this</name><operator>.</operator><name>bundleActions</name></name></expr></range></decl></init>)</control> <block>{<block_content>
            <if_stmt><if>if <condition>(<expr><call><name><name>action</name><operator>.</operator><name>getStatus</name></name><argument_list>()</argument_list></call> <operator>==</operator> <name><name>Job</name><operator>.</operator><name>Status</name><operator>.</operator><name>RUNNING</name></name> <operator>||</operator> <call><name><name>action</name><operator>.</operator><name>getStatus</name></name><argument_list>()</argument_list></call> <operator>==</operator> <name><name>Job</name><operator>.</operator><name>Status</name><operator>.</operator><name>RUNNINGWITHERROR</name></name>
                    <operator>||</operator> <call><name><name>action</name><operator>.</operator><name>getStatus</name></name><argument_list>()</argument_list></call> <operator>==</operator> <name><name>Job</name><operator>.</operator><name>Status</name><operator>.</operator><name>PREP</name></name> <operator>||</operator> <call><name><name>action</name><operator>.</operator><name>getStatus</name></name><argument_list>()</argument_list></call> <operator>==</operator> <name><name>Job</name><operator>.</operator><name>Status</name><operator>.</operator><name>PAUSED</name></name>
                    <operator>||</operator> <call><name><name>action</name><operator>.</operator><name>getStatus</name></name><argument_list>()</argument_list></call> <operator>==</operator> <name><name>Job</name><operator>.</operator><name>Status</name><operator>.</operator><name>PAUSEDWITHERROR</name></name></expr>)</condition> <block>{<block_content>
                <comment type="line">// queue a CoordSuspendXCommand</comment>
                <if_stmt><if>if <condition>(<expr><call><name><name>action</name><operator>.</operator><name>getCoordId</name></name><argument_list>()</argument_list></call> <operator>!=</operator> <literal type="null">null</literal></expr>)</condition> <block>{<block_content>
                    <expr_stmt><expr><call><name>queue</name><argument_list>(<argument><expr><operator>new</operator> <call><name>CoordSuspendXCommand</name><argument_list>(<argument><expr><call><name><name>action</name><operator>.</operator><name>getCoordId</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                    <expr_stmt><expr><call><name>updateBundleAction</name><argument_list>(<argument><expr><name>action</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                    <expr_stmt><expr><call><name><name>LOG</name><operator>.</operator><name>debug</name></name><argument_list>(<argument><expr><literal type="string">"Suspend bundle action = [{0}], new status = [{1}], pending = [{2}] and queue CoordSuspendXCommand for [{3}]"</literal></expr></argument>,
                            <argument><expr><call><name><name>action</name><operator>.</operator><name>getBundleActionId</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><call><name><name>action</name><operator>.</operator><name>getStatus</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><call><name><name>action</name><operator>.</operator><name>getPending</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><call><name><name>action</name><operator>.</operator><name>getCoordId</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                </block_content>}</block></if> <else>else <block>{<block_content>
                    <expr_stmt><expr><call><name>updateBundleAction</name><argument_list>(<argument><expr><name>action</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                    <expr_stmt><expr><call><name><name>LOG</name><operator>.</operator><name>debug</name></name><argument_list>(<argument><expr><literal type="string">"Suspend bundle action = [{0}], new status = [{1}], pending = [{2}] and coord id is null"</literal></expr></argument>,
                            <argument><expr><call><name><name>action</name><operator>.</operator><name>getBundleActionId</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><call><name><name>action</name><operator>.</operator><name>getStatus</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><call><name><name>action</name><operator>.</operator><name>getPending</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                 </block_content>}</block></else></if_stmt>

             </block_content>}</block></if></if_stmt>
            <expr_stmt><expr><call><name><name>LOG</name><operator>.</operator><name>debug</name></name><argument_list>(<argument><expr><literal type="string">"Suspended bundle actions for the bundle=[{0}]"</literal></expr></argument>, <argument><expr><name>jobId</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        </block_content>}</block></for>
        <catch>catch <parameter_list>(<parameter><decl><type><name>XException</name></type> <name>ex</name></decl></parameter>)</parameter_list> <block>{<block_content>
            <throw>throw <expr><operator>new</operator> <call><name>CommandException</name><argument_list>(<argument><expr><name>ex</name></expr></argument>)</argument_list></call></expr>;</throw>
         </block_content>}</block></catch>
        <expr_stmt><expr><call><name><name>LOG</name><operator>.</operator><name>debug</name></name><argument_list>(<argument><expr><literal type="string">"Suspended bundle actions for the bundle=[{0}]"</literal></expr></argument>, <argument><expr><name>jobId</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
     </block_content>}</block></if></if_stmt>
 
    <function><type><specifier>private</specifier> <name>void</name></type> <name>updateBundleAction</name><parameter_list>(<parameter><decl><type><name>BundleActionBean</name></type> <name>action</name></decl></parameter>)</parameter_list> <throws>throws <argument><expr><name>CommandException</name></expr></argument></throws> <block>{<block_content>
    <function><type><specifier>private</specifier> <name>void</name></type> <name>updateBundleAction</name><parameter_list>(<parameter><decl><type><name>BundleActionBean</name></type> <name>action</name></decl></parameter>)</parameter_list> <block>{<block_content>
         <if_stmt><if>if <condition>(<expr><call><name><name>action</name><operator>.</operator><name>getStatus</name></name><argument_list>()</argument_list></call> <operator>==</operator> <name><name>Job</name><operator>.</operator><name>Status</name><operator>.</operator><name>PREP</name></name></expr>)</condition> <block>{<block_content>
             <expr_stmt><expr><call><name><name>action</name><operator>.</operator><name>setStatus</name></name><argument_list>(<argument><expr><name><name>Job</name><operator>.</operator><name>Status</name><operator>.</operator><name>PREPSUSPENDED</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
         </block_content>}</block></if></if_stmt>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">194</literal></expr><operator>,</operator><expr><literal type="number">11</literal> <operator>+</operator><literal type="number">195</literal></expr><operator>,</operator><expr><literal type="number">6</literal> @@ <specifier>public</specifier> <name>class</name> <name>BundleJobSuspendXCommand</name> extends <name>SuspendTransitionXCommand</name> <block>{
 
         <expr><call><name><name>action</name><operator>.</operator><name>incrementAndGetPending</name></name><argument_list>()</argument_list></call></expr>;
         <expr><call><name><name>action</name><operator>.</operator><name>setLastModifiedTime</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>Date</name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;
        <try>try <block>{<block_content>
            <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>BundleActionUpdateJPAExecutor</name><argument_list>(<argument><expr><name>action</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt/></block_content></block></try>}</block></expr></expr_stmt>
        <catch>catch <parameter_list>(<parameter><decl><type><name>JPAExecutorException</name></type> <name>e</name></decl></parameter>)</parameter_list> <block>{<block_content>
            <throw>throw <expr><operator>new</operator> <call><name>CommandException</name><argument_list>(<argument><expr><name>e</name></expr></argument>)</argument_list></call></expr>;</throw>
        </block_content>}</block></catch>
        <expr_stmt><expr><call><name><name>updateList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>action</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
     </block_content>}</block></function>
 </block_content>}</block></function>
<expr_stmt><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>bundle</name><operator>/</operator><name><name>BundleKillXCommand</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>bundle</name><operator>/</operator><name><name>BundleKillXCommand</name><operator>.</operator><name>java</name></name>
<name>index</name> <literal type="number">0105a65cd</literal><operator>..</operator><name>ab25a76ec</name> <literal type="number">100644</literal>
<operator>--</operator> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>bundle</name><operator>/</operator><name><name>BundleKillXCommand</name><operator>.</operator><name>java</name></name>
<operator>++</operator> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>bundle</name><operator>/</operator><name><name>BundleKillXCommand</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">30</literal></expr><operator>,</operator><expr><literal type="number">10</literal> <operator>+</operator><literal type="number">30</literal></expr><operator>,</operator><expr><literal type="number">9</literal> @@</expr></expr_stmt> <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>CommandException</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>KillTransitionXCommand</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>PreconditionException</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>coord</name><operator>.</operator><name>CoordKillXCommand</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>BundleActionUpdateJPAExecutor</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>BulkUpdateInsertJPAExecutor</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>BundleActionsGetJPAExecutor</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>BundleJobGetJPAExecutor</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>BundleJobUpdateJPAExecutor</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>JPAExecutorException</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>JPAService</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>Services</name></name>;</import>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">134</literal></expr><operator>,</operator><expr><literal type="number">16</literal> <operator>+</operator><literal type="number">133</literal></expr><operator>,</operator><expr><literal type="number">11</literal> @@ <specifier>public</specifier> <name>class</name> <name>BundleKillXCommand</name> extends <name>KillTransitionXCommand</name> <block>{
      <expr><operator>*</operator> @<name>param</name> <name>action</name>
      <operator>*</operator> @<throws>throws <argument><expr><name>CommandException</name>
      <operator>*</operator><operator>/</operator>
    <specifier>private</specifier> <name>void</name> <call><name>updateBundleAction</name><argument_list>(<argument><expr><name>BundleActionBean</name> <name>action</name></expr></argument>)</argument_list></call></expr></argument></throws> <throws>throws <argument><expr><name>CommandException</name> <block>{
    <expr><specifier>private</specifier> <name>void</name> <call><name>updateBundleAction</name><argument_list>(<argument><expr><name>BundleActionBean</name> <name>action</name></expr></argument>)</argument_list></call> <block>{
         <expr><call><name><name>action</name><operator>.</operator><name>incrementAndGetPending</name></name><argument_list>()</argument_list></call></expr></block></expr></block></expr></argument></throws></expr>;
         <expr><call><name><name>action</name><operator>.</operator><name>setLastModifiedTime</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>Date</name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;
         <expr><call><name><name>action</name><operator>.</operator><name>setStatus</name></name><argument_list>(<argument><expr><name><name>Job</name><operator>.</operator><name>Status</name><operator>.</operator><name>KILLED</name></name></expr></argument>)</argument_list></call></expr>;
        <try>try <block>{<block_content>
            <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>BundleActionUpdateJPAExecutor</name><argument_list>(<argument><expr><name>action</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt/></block_content></block></try>}</block></expr></expr_stmt>
        <catch>catch <parameter_list>(<parameter><decl><type><name>JPAExecutorException</name></type> <name>e</name></decl></parameter>)</parameter_list> <block>{<block_content>
            <throw>throw <expr><operator>new</operator> <call><name>CommandException</name><argument_list>(<argument><expr><name>e</name></expr></argument>)</argument_list></call></expr>;</throw>
        </block_content>}</block></catch>
        <expr_stmt><expr><call><name><name>updateList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>action</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
     </block_content>}</block></for>
 
     <comment type="block">/* (non-Javadoc)
@@ -165,9 +159,17 @@ public class BundleKillXCommand extends KillTransitionXCommand {
      * @see org.apache.oozie.command.TransitionXCommand#updateJob()
      */</comment>
     <function><annotation>@<name>Override</name></annotation>
    <type><specifier>public</specifier> <name>void</name></type> <name>updateJob</name><parameter_list>()</parameter_list> <throws>throws <argument><expr><name>CommandException</name></expr></argument></throws> <block>{<block_content>
    <function><type><specifier>public</specifier> <name>void</name></type> <name>updateJob</name><parameter_list>()</parameter_list> <block>{<block_content>
        <expr_stmt><expr><call><name><name>updateList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>bundleJob</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    </block_content>}</block></function>

    <comment type="block">/* (non-Javadoc)
     * @see org.apache.oozie.command.KillTransitionXCommand#performWrites()
     */</comment>
    <function><annotation>@<name>Override</name></annotation>
    <type><specifier>public</specifier> <name>void</name></type> <name>performWrites</name><parameter_list>()</parameter_list> <throws>throws <argument><expr><name>CommandException</name></expr></argument></throws> <block>{<block_content>
         <try>try <block>{<block_content>
            <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>BundleJobUpdateJPAExecutor</name><argument_list>(<argument><expr><name>bundleJob</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>BulkUpdateInsertJPAExecutor</name><argument_list>(<argument><expr><name>updateList</name></expr></argument>, <argument><expr><literal type="null">null</literal></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
         </block_content>}</block>
         <catch>catch <parameter_list>(<parameter><decl><type><name>JPAExecutorException</name></type> <name>e</name></decl></parameter>)</parameter_list> <block>{<block_content>
             <throw>throw <expr><operator>new</operator> <call><name>CommandException</name><argument_list>(<argument><expr><name>e</name></expr></argument>)</argument_list></call></expr>;</throw>
<expr_stmt><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>bundle</name><operator>/</operator><name><name>BundlePauseXCommand</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>bundle</name><operator>/</operator><name><name>BundlePauseXCommand</name><operator>.</operator><name>java</name></name>
<name>index</name> <literal type="number">3a4d77669</literal><operator>..</operator><name>cd63ca7d0</name> <literal type="number">100644</literal>
<operator>--</operator> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>bundle</name><operator>/</operator><name><name>BundlePauseXCommand</name><operator>.</operator><name>java</name></name>
<operator>++</operator> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>bundle</name><operator>/</operator><name><name>BundlePauseXCommand</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">102</literal></expr><operator>,</operator><expr><literal type="number">4</literal> <operator>+</operator><literal type="number">102</literal></expr><operator>,</operator><expr><literal type="number">8</literal> @@ <specifier>public</specifier> <name>class</name> <name>BundlePauseXCommand</name> extends <name>PauseTransitionXCommand</name> <block>{
 
     }</block>
 
    @<name>Override</name>
    <specifier>public</specifier> <name>void</name> <call><name>performWrites</name><argument_list>()</argument_list></call> <throws>throws <argument><expr><name>CommandException</name> <block>{
    }</block></expr></argument>

 }
<argument><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>bundle</name><operator>/</operator><name><name>BundlePurgeXCommand</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>bundle</name><operator>/</operator><name><name>BundlePurgeXCommand</name><operator>.</operator><name>java</name></name>
<name>index</name> <literal type="number">863fa3c71</literal><operator>..</operator><name>ca762de99</name> <literal type="number">100644</literal>
<operator>--</operator> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>bundle</name><operator>/</operator><name><name>BundlePurgeXCommand</name><operator>.</operator><name>java</name></name>
<operator>++</operator> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>bundle</name><operator>/</operator><name><name>BundlePurgeXCommand</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">17</literal></expr></argument>,<argument><expr><literal type="number">21</literal> <operator>+</operator><literal type="number">17</literal></expr></argument>,<argument><expr><literal type="number">20</literal> @@
  <operator>*</operator><operator>/</operator></expr></argument></throws></expr></expr_stmt>
 <package>package <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>bundle</name></name>;</package>
 
<import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>Collection</name></name>;</import>
 <import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>List</name></name>;</import>
 
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>BundleJobBean</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>ErrorCode</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>XException</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>rest</name><operator>.</operator><name>JsonBean</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>CommandException</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>PreconditionException</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>XCommand</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>BundleActionsDeleteForPurgeJPAExecutor</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>BundleJobDeleteJPAExecutor</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>BulkDeleteForPurgeJPAExecutor</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>BundleJobsGetForPurgeJPAExecutor</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>JPAExecutorException</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>JPAService</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>Services</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>util</name><operator>.</operator><name>XLog</name></name>;</import>
 
 <comment type="block" format="javadoc">/**
  * This class is used for bundle purge command
@@ -40,7 +39,7 @@ public class BundlePurgeXCommand extends XCommand&lt;Void&gt; {
     private JPAService jpaService = null;
     private final int olderThan;
     private final int limit;
    private List&lt;BundleJobBean&gt; jobList = null;
    private List&lt;? extends JsonBean&gt; jobList = null;
 
     public BundlePurgeXCommand(int olderThan, int limit) {
         super("bundle_purge", "bundle_purge", 0);
@@ -77,15 +76,11 @@ public class BundlePurgeXCommand extends XCommand&lt;Void&gt; {
 
         int actionDeleted = 0;
         if (jobList != null &amp;&amp; jobList.size() != 0) {
            for (BundleJobBean bundle : jobList) {
                String jobId = bundle.getId();
                try {
                    jpaService.execute(new BundleJobDeleteJPAExecutor(jobId));
                    actionDeleted += jpaService.execute(new BundleActionsDeleteForPurgeJPAExecutor(jobId));
                }
                catch (JPAExecutorException e) {
                    throw new CommandException(e);
                }
            try {
                actionDeleted = jpaService.execute(new BulkDeleteForPurgeJPAExecutor((Collection&lt;JsonBean&gt;) jobList));
            }
            catch (JPAExecutorException je) {
                throw new CommandException(je);
             }
             LOG.debug("ENDED Bundle-Purge deleted jobs :" + jobList.size() + " and actions " + actionDeleted);
         }
diff --git a/core/src/main/java/org/apache/oozie/command/bundle/BundleRerunXCommand.java b/core/src/main/java/org/apache/oozie/command/bundle/BundleRerunXCommand.java
index 2d87df0e4..eaa76e900 100644
-- a/core/src/main/java/org/apache/oozie/command/bundle/BundleRerunXCommand.java
++ b/core/src/main/java/org/apache/oozie/command/bundle/BundleRerunXCommand.java
@@ -32,10 +32,9 @@ import org.apache.oozie.client.rest.RestConstants;
 import org.apache.oozie.command.CommandException;
 import org.apache.oozie.command.RerunTransitionXCommand;
 import org.apache.oozie.command.coord.CoordRerunXCommand;
import org.apache.oozie.executor.jpa.BundleActionUpdateJPAExecutor;
import org.apache.oozie.executor.jpa.BulkUpdateInsertJPAExecutor;
 import org.apache.oozie.executor.jpa.BundleActionsGetJPAExecutor;
 import org.apache.oozie.executor.jpa.BundleJobGetJPAExecutor;
import org.apache.oozie.executor.jpa.BundleJobUpdateJPAExecutor;
 import org.apache.oozie.executor.jpa.CoordJobGetJPAExecutor;
 import org.apache.oozie.executor.jpa.JPAExecutorException;
 import org.apache.oozie.service.JPAService;
@@ -195,42 +194,44 @@ public class BundleRerunXCommand extends RerunTransitionXCommand&lt;Void&gt; {
      * @param action the bundle action
      * @throws CommandException thrown if failed to update bundle action
      */</comment>
    <function><type><specifier>private</specifier> <name>void</name></type> <name>updateBundleAction</name><parameter_list>(<parameter><decl><type><name>BundleActionBean</name></type> <name>action</name></decl></parameter>)</parameter_list> <throws>throws <argument><expr><name>CommandException</name></expr></argument></throws> <block>{<block_content>
    <function><type><specifier>private</specifier> <name>void</name></type> <name>updateBundleAction</name><parameter_list>(<parameter><decl><type><name>BundleActionBean</name></type> <name>action</name></decl></parameter>)</parameter_list> <block>{<block_content>
         <expr_stmt><expr><call><name><name>action</name><operator>.</operator><name>incrementAndGetPending</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
         <expr_stmt><expr><call><name><name>action</name><operator>.</operator><name>setLastModifiedTime</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>Date</name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <try>try <block>{<block_content>
            <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>BundleActionUpdateJPAExecutor</name><argument_list>(<argument><expr><name>action</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        </block_content>}</block>
        <catch>catch <parameter_list>(<parameter><decl><type><name>JPAExecutorException</name></type> <name>je</name></decl></parameter>)</parameter_list> <block>{<block_content>
            <throw>throw <expr><operator>new</operator> <call><name>CommandException</name><argument_list>(<argument><expr><name>je</name></expr></argument>)</argument_list></call></expr>;</throw>
        </block_content>}</block></catch></try>
        <expr_stmt><expr><call><name><name>updateList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>action</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
     </block_content>}</block></function>
 
     <comment type="block">/* (non-Javadoc)
      * @see org.apache.oozie.command.TransitionXCommand#updateJob()
      */</comment>
     <function><annotation>@<name>Override</name></annotation>
    <type><specifier>public</specifier> <name>void</name></type> <name>updateJob</name><parameter_list>()</parameter_list> <throws>throws <argument><expr><name>CommandException</name></expr></argument></throws> <block>{<block_content>
        <try>try <block>{<block_content>
            <comment type="line">// rerun a paused bundle job will keep job status at paused and pending at previous pending</comment>
            <if_stmt><if>if <condition>(<expr><call><name>getPrevStatus</name><argument_list>()</argument_list></call> <operator>!=</operator> <literal type="null">null</literal></expr>)</condition> <block>{<block_content>
                <decl_stmt><decl><type><name><name>Job</name><operator>.</operator><name>Status</name></name></type> <name>bundleJobStatus</name> <init>= <expr><call><name>getPrevStatus</name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
                <if_stmt><if>if <condition>(<expr><call><name><name>bundleJobStatus</name><operator>.</operator><name>equals</name></name><argument_list>(<argument><expr><name><name>Job</name><operator>.</operator><name>Status</name><operator>.</operator><name>PAUSED</name></name></expr></argument>)</argument_list></call> <operator>||</operator> <call><name><name>bundleJobStatus</name><operator>.</operator><name>equals</name></name><argument_list>(<argument><expr><name><name>Job</name><operator>.</operator><name>Status</name><operator>.</operator><name>PAUSEDWITHERROR</name></name></expr></argument>)</argument_list></call></expr>)</condition> <block>{<block_content>
                    <expr_stmt><expr><call><name><name>bundleJob</name><operator>.</operator><name>setStatus</name></name><argument_list>(<argument><expr><name>bundleJobStatus</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                    <if_stmt><if>if <condition>(<expr><name>prevPending</name></expr>)</condition> <block>{<block_content>
                        <expr_stmt><expr><call><name><name>bundleJob</name><operator>.</operator><name>setPending</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
                    </block_content>}</block></if>
                    <else>else <block>{<block_content>
                        <expr_stmt><expr><call><name><name>bundleJob</name><operator>.</operator><name>resetPending</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
                    </block_content>}</block></else></if_stmt>
    <function><type><specifier>public</specifier> <name>void</name></type> <name>updateJob</name><parameter_list>()</parameter_list> <block>{<block_content>
        <comment type="line">// rerun a paused bundle job will keep job status at paused and pending at previous pending</comment>
        <if_stmt><if>if <condition>(<expr><call><name>getPrevStatus</name><argument_list>()</argument_list></call> <operator>!=</operator> <literal type="null">null</literal></expr>)</condition> <block>{<block_content>
            <decl_stmt><decl><type><name><name>Job</name><operator>.</operator><name>Status</name></name></type> <name>bundleJobStatus</name> <init>= <expr><call><name>getPrevStatus</name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
            <if_stmt><if>if <condition>(<expr><call><name><name>bundleJobStatus</name><operator>.</operator><name>equals</name></name><argument_list>(<argument><expr><name><name>Job</name><operator>.</operator><name>Status</name><operator>.</operator><name>PAUSED</name></name></expr></argument>)</argument_list></call> <operator>||</operator> <call><name><name>bundleJobStatus</name><operator>.</operator><name>equals</name></name><argument_list>(<argument><expr><name><name>Job</name><operator>.</operator><name>Status</name><operator>.</operator><name>PAUSEDWITHERROR</name></name></expr></argument>)</argument_list></call></expr>)</condition> <block>{<block_content>
                <expr_stmt><expr><call><name><name>bundleJob</name><operator>.</operator><name>setStatus</name></name><argument_list>(<argument><expr><name>bundleJobStatus</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                <if_stmt><if>if <condition>(<expr><name>prevPending</name></expr>)</condition> <block>{<block_content>
                    <expr_stmt><expr><call><name><name>bundleJob</name><operator>.</operator><name>setPending</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
                </block_content>}</block></if>
                <else>else <block>{<block_content>
                    <expr_stmt><expr><call><name><name>bundleJob</name><operator>.</operator><name>resetPending</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
                 </block_content>}</block></else></if_stmt>
             </block_content>}</block></if></if_stmt>
            <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>BundleJobUpdateJPAExecutor</name><argument_list>(<argument><expr><name>bundleJob</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        </block_content>}</block></if></if_stmt>
        <catch>catch <parameter_list>(<parameter><decl><type><name>JPAExecutorException</name></type> <name>je</name></decl></parameter>)</parameter_list> <block>{<block_content>
            <throw>throw <expr><operator>new</operator> <call><name>CommandException</name><argument_list>(<argument><expr><name>je</name></expr></argument>)</argument_list></call></expr>;</throw>
         </block_content>}</block></catch>
        <expr_stmt><expr><call><name><name>updateList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>bundleJob</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    </block_content>}</block></function>
 
    <comment type="block">/* (non-Javadoc)
     * @see org.apache.oozie.command.RerunTransitionXCommand#performWrites()
     */</comment>
    <function><annotation>@<name>Override</name></annotation>
    <type><specifier>public</specifier> <name>void</name></type> <name>performWrites</name><parameter_list>()</parameter_list> <throws>throws <argument><expr><name>CommandException</name></expr></argument></throws> <block>{<block_content>
        <try>try <block>{<block_content>
            <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>BulkUpdateInsertJPAExecutor</name><argument_list>(<argument><expr><name>updateList</name></expr></argument>, <argument><expr><literal type="null">null</literal></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        </block_content>}</block>
        <catch>catch <parameter_list>(<parameter><decl><type><name>JPAExecutorException</name></type> <name>e</name></decl></parameter>)</parameter_list> <block>{<block_content>
            <throw>throw <expr><operator>new</operator> <call><name>CommandException</name><argument_list>(<argument><expr><name>e</name></expr></argument>)</argument_list></call></expr>;</throw>
        </block_content>}</block></catch></try>
     </block_content>}</block></function>
 
     <comment type="block">/* (non-Javadoc)
diff --git a/core/src/main/java/org/apache/oozie/command/bundle/BundleStartXCommand.java b/core/src/main/java/org/apache/oozie/command/bundle/BundleStartXCommand.java
index 24b438dba..14c579184 100644
-- a/core/src/main/java/org/apache/oozie/command/bundle/BundleStartXCommand.java
++ b/core/src/main/java/org/apache/oozie/command/bundle/BundleStartXCommand.java
@@ -32,13 +32,12 @@ import org.apache.oozie.ErrorCode;
 import org.apache.oozie.XException;
 import org.apache.oozie.client.Job;
 import org.apache.oozie.client.OozieClient;
import org.apache.oozie.client.rest.JsonBean;
 import org.apache.oozie.command.CommandException;
 import org.apache.oozie.command.PreconditionException;
 import org.apache.oozie.command.StartTransitionXCommand;
 import org.apache.oozie.command.coord.CoordSubmitXCommand;
import org.apache.oozie.executor.jpa.BundleActionGetJPAExecutor;
import org.apache.oozie.executor.jpa.BundleActionInsertJPAExecutor;
import org.apache.oozie.executor.jpa.BundleActionUpdateJPAExecutor;
import org.apache.oozie.executor.jpa.BulkUpdateInsertJPAExecutor;
 import org.apache.oozie.executor.jpa.BundleJobGetJPAExecutor;
 import org.apache.oozie.executor.jpa.BundleJobUpdateJPAExecutor;
 import org.apache.oozie.executor.jpa.JPAExecutorException;
@@ -166,6 +165,19 @@ public class BundleStartXCommand extends StartTransitionXCommand {
     public void notifyParent() {
     }
 
    /* (non-Javadoc)
     * @see org.apache.oozie.command.StartTransitionXCommand#performWrites()
     */</comment>
    <function><annotation>@<name>Override</name></annotation>
    <type><specifier>public</specifier> <name>void</name></type> <name>performWrites</name><parameter_list>()</parameter_list> <throws>throws <argument><expr><name>CommandException</name></expr></argument></throws> <block>{<block_content>
        <try>try <block>{<block_content>
            <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>BulkUpdateInsertJPAExecutor</name><argument_list>(<argument><expr><name>updateList</name></expr></argument>, <argument><expr><name>insertList</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        </block_content>}</block>
        <catch>catch <parameter_list>(<parameter><decl><type><name>JPAExecutorException</name></type> <name>e</name></decl></parameter>)</parameter_list> <block>{<block_content>
            <throw>throw <expr><operator>new</operator> <call><name>CommandException</name><argument_list>(<argument><expr><name>e</name></expr></argument>)</argument_list></call></expr>;</throw>
        </block_content>}</block></catch></try>
    </block_content>}</block></function>

     <comment type="block" format="javadoc">/**
      * Insert bundle actions
      *
@@ -200,26 +212,25 @@ public class BundleStartXCommand extends StartTransitionXCommand {
                 throw new CommandException(ErrorCode.E1301, jex);
             }
 
            try {
                // if there is no coordinator for this bundle, failed it.
                if (map.isEmpty()) {
                    bundleJob.setStatus(Job.Status.FAILED);
                    bundleJob.resetPending();
            // if there is no coordinator for this bundle, failed it.
            if (map.isEmpty()) {
                bundleJob.setStatus(Job.Status.FAILED);
                bundleJob.resetPending();
                try {
                     jpaService.execute(new BundleJobUpdateJPAExecutor(bundleJob));
                    LOG.debug("No coord jobs for the bundle=[{0}], failed it!!", jobId);
                    throw new CommandException(ErrorCode.E1318, jobId);
                 }

                for (Entry&lt;String, Boolean&gt; coordName : map.entrySet()) {
                    BundleActionBean action = createBundleAction(jobId, coordName.getKey(), coordName.getValue());

                    jpaService.execute(new BundleActionInsertJPAExecutor(action));
                catch (JPAExecutorException jex) {
                    throw new CommandException(jex);
                 }
            }
            catch (JPAExecutorException je) {
                throw new CommandException(je);

                LOG.debug("No coord jobs for the bundle=[{0}], failed it!!", jobId);
                throw new CommandException(ErrorCode.E1318, jobId);
             }
 
            for (Entry&lt;String, Boolean&gt; coordName : map.entrySet()) {
                BundleActionBean action = createBundleAction(jobId, coordName.getKey(), coordName.getValue());
                insertList.add(action);
            }
         }
         else {
             throw new CommandException(ErrorCode.E0604, jobId);
@@ -260,8 +271,8 @@ public class BundleStartXCommand extends StartTransitionXCommand {
 
                     queue(new CoordSubmitXCommand(coordConf, bundleJob.getAuthToken(), bundleJob.getId(), name.getValue()));
 
                    updateBundleAction(name.getValue());
                 }
                updateBundleAction();
             }
             catch (JDOMException jex) {
                 throw new CommandException(ErrorCode.E1301, jex);
@@ -275,11 +286,12 @@ public class BundleStartXCommand extends StartTransitionXCommand {
         }
     }
 
    private void updateBundleAction(String coordName) throws JPAExecutorException {
        BundleActionBean action = jpaService.execute(new BundleActionGetJPAExecutor(jobId, coordName));
        action.incrementAndGetPending();
        action.setLastModifiedTime(new Date());
        jpaService.execute(new BundleActionUpdateJPAExecutor(action));
    private void updateBundleAction() throws JPAExecutorException {
        for(JsonBean bAction : insertList) {
            BundleActionBean action = (BundleActionBean) bAction;
            action.incrementAndGetPending();
            action.setLastModifiedTime(new Date());
        }
     }
 
     /**
@@ -348,11 +360,6 @@ public class BundleStartXCommand extends StartTransitionXCommand {
      */</comment>
     <function><annotation>@<name>Override</name></annotation>
     <type><specifier>public</specifier> <name>void</name></type> <name>updateJob</name><parameter_list>()</parameter_list> <throws>throws <argument><expr><name>CommandException</name></expr></argument></throws> <block>{<block_content>
        <try>try <block>{<block_content>
            <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>BundleJobUpdateJPAExecutor</name><argument_list>(<argument><expr><name>bundleJob</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        </block_content>}</block>
        <catch>catch <parameter_list>(<parameter><decl><type><name>JPAExecutorException</name></type> <name>je</name></decl></parameter>)</parameter_list> <block>{<block_content>
            <throw>throw <expr><operator>new</operator> <call><name>CommandException</name><argument_list>(<argument><expr><name>je</name></expr></argument>)</argument_list></call></expr>;</throw>
        </block_content>}</block></catch></try>
        <expr_stmt><expr><call><name><name>updateList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>bundleJob</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
     </block_content>}</block></function>
 </block_content>}</block></if></if_stmt>
<expr_stmt><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>bundle</name><operator>/</operator><name><name>BundleStatusUpdateXCommand</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>bundle</name><operator>/</operator><name><name>BundleStatusUpdateXCommand</name><operator>.</operator><name>java</name></name>
<name>index</name> <name>dd46eb0fc</name><operator>..</operator><literal type="number">8383a1ed1</literal> <literal type="number">100644</literal>
<operator>--</operator> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>bundle</name><operator>/</operator><name><name>BundleStatusUpdateXCommand</name><operator>.</operator><name>java</name></name>
<operator>++</operator> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>bundle</name><operator>/</operator><name><name>BundleStatusUpdateXCommand</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">20</literal></expr><operator>,</operator><expr><literal type="number">7</literal> <operator>+</operator><literal type="number">20</literal></expr><operator>,</operator><expr><literal type="number">6</literal> @@</expr></expr_stmt> <package>package <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>bundle</name></name>;</package>
 <import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>Date</name></name>;</import>
 
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>BundleActionBean</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>BundleJobBean</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>CoordinatorJobBean</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>ErrorCode</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>XException</name></name>;</import>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">31</literal></expr><operator>,</operator><expr><literal type="number">8</literal> <operator>+</operator><literal type="number">30</literal></expr><operator>,</operator><expr><literal type="number">6</literal> @@</expr></expr_stmt> <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>PreconditionException</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>StatusUpdateXCommand</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>BundleActionGetJPAExecutor</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>BundleActionUpdateJPAExecutor</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>BundleJobGetJPAExecutor</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>BundleJobUpdateJPAExecutor</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>JPAExecutorException</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>JPAService</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>Services</name></name>;</import>
<expr_stmt><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>bundle</name><operator>/</operator><name><name>BundleSubmitXCommand</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>bundle</name><operator>/</operator><name><name>BundleSubmitXCommand</name><operator>.</operator><name>java</name></name>
<name>index</name> <literal type="number">72ad17a69</literal><operator>..</operator><literal type="number">8fcdc49d8</literal> <literal type="number">100644</literal>
<operator>--</operator> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>bundle</name><operator>/</operator><name><name>BundleSubmitXCommand</name><operator>.</operator><name>java</name></name>
<operator>++</operator> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>bundle</name><operator>/</operator><name><name>BundleSubmitXCommand</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">521</literal></expr><operator>,</operator><expr><literal type="number">4</literal> <operator>+</operator><literal type="number">521</literal></expr><operator>,</operator><expr><literal type="number">8</literal> @@ <specifier>public</specifier> <name>class</name> <name>BundleSubmitXCommand</name> extends <name>SubmitTransitionXCommand</name> <block>{
     @<expr><name>Override</name>
     <specifier>public</specifier> <name>void</name> <call><name>updateJob</name><argument_list>()</argument_list></call> <throws>throws <argument><expr><name>CommandException</name> <block>{
     }</block>

    <annotation>@<name>Override</name></annotation>
    <specifier>public</specifier> <name>void</name> <call><name>performWrites</name><argument_list>()</argument_list></call></expr></argument></throws> <throws>throws <argument><expr><name>CommandException</name> <block>{
    }</block></expr></argument></throws></expr>
 }</block>
<name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>bundle</name><operator>/</operator><name><name>BundleUnpauseXCommand</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>bundle</name><operator>/</operator><name><name>BundleUnpauseXCommand</name><operator>.</operator><name>java</name></name>
<name>index</name> <name>fcd8c3f49</name><operator>..</operator><literal type="number">0c74fff1d</literal> <literal type="number">100644</literal>
<operator>--</operator> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>bundle</name><operator>/</operator><name><name>BundleUnpauseXCommand</name><operator>.</operator><name>java</name></name>
<operator>++</operator> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>bundle</name><operator>/</operator><name><name>BundleUnpauseXCommand</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">116</literal></expr><operator>,</operator><expr><literal type="number">4</literal> <operator>+</operator><literal type="number">116</literal></expr><operator>,</operator><expr><literal type="number">8</literal> @@ <specifier>public</specifier> <name>class</name> <name>BundleUnpauseXCommand</name> extends <name>UnpauseTransitionXCommand</name> <block>{
 
     }</block>
 
    @<name>Override</name>
    <specifier>public</specifier> <name>void</name> <call><name>performWrites</name><argument_list>()</argument_list></call> <throws>throws <argument><expr><name>CommandException</name> <block>{
    }</block></expr></argument>

 }
<argument><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>coord</name><operator>/</operator><name><name>CoordActionCheckXCommand</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>coord</name><operator>/</operator><name><name>CoordActionCheckXCommand</name><operator>.</operator><name>java</name></name>
<name>index</name> <literal type="number">543a28c39</literal><operator>..</operator><name>f5ed9b34d</name> <literal type="number">100644</literal>
<operator>--</operator> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>coord</name><operator>/</operator><name><name>CoordActionCheckXCommand</name><operator>.</operator><name>java</name></name>
<operator>++</operator> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>coord</name><operator>/</operator><name><name>CoordActionCheckXCommand</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">18</literal></expr></argument>,<argument><expr><literal type="number">10</literal> <operator>+</operator><literal type="number">18</literal></expr></argument>,<argument><expr><literal type="number">13</literal> @@</expr></argument></throws></expr></expr_stmt>
 <package>package <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>coord</name></name>;</package>
 
 <import>import <name><name>java</name><operator>.</operator><name>sql</name><operator>.</operator><name>Timestamp</name></name>;</import>
<import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>ArrayList</name></name>;</import>
 <import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>Date</name></name>;</import>
<import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>List</name></name>;</import>
 
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>CoordinatorActionBean</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>ErrorCode</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>SLAEventBean</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>WorkflowJobBean</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>XException</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>JPAService</name></name>;</import>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">34</literal></expr><operator>,</operator><expr><literal type="number">8</literal> <operator>+</operator><literal type="number">37</literal></expr><operator>,</operator><expr><literal type="number">10</literal> @@</expr></expr_stmt> <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>CoordinatorAction</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>WorkflowJob</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>SLAEvent</name><operator>.</operator><name>SlaAppType</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>SLAEvent</name><operator>.</operator><name>Status</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>rest</name><operator>.</operator><name>JsonBean</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>CommandException</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>PreconditionException</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>BulkUpdateInsertForCoordActionStatusJPAExecutor</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>CoordActionGetForCheckJPAExecutor</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>WorkflowJobGetJPAExecutor</name></name>;</import>
 
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">47</literal></expr><operator>,</operator><expr><literal type="number">6</literal> <operator>+</operator><literal type="number">52</literal></expr><operator>,</operator><expr><literal type="number">8</literal> @@ <specifier>public</specifier> <name>class</name> <name>CoordActionCheckXCommand</name> extends <name><name>CoordinatorXCommand</name><argument_list type="generic">&lt;<argument><name>Void</name></argument>&gt;</argument_list></name> <block>{
     <expr><specifier>private</specifier> <name>int</name> <name>actionCheckDelay</name></expr>;
     <specifier>private</specifier> <name>CoordinatorActionBean</name> <name>coordAction</name> <operator>=</operator> <literal type="null">null</literal></block></expr>;</expr_stmt>
     <decl_stmt><decl><type><specifier>private</specifier> <name>JPAService</name></type> <name>jpaService</name> <init>= <expr><literal type="null">null</literal></expr></init></decl>;</decl_stmt>
    <decl_stmt><decl><type><specifier>private</specifier> <name><name>List</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name></type> <name>updateList</name> <init>= <expr><operator>new</operator> <call><name><name>ArrayList</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
    <decl_stmt><decl><type><specifier>private</specifier> <name><name>List</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name></type> <name>insertList</name> <init>= <expr><operator>new</operator> <call><name><name>ArrayList</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
 
     <constructor><specifier>public</specifier> <name>CoordActionCheckXCommand</name><parameter_list>(<parameter><decl><type><name>String</name></type> <name>actionId</name></decl></parameter>, <parameter><decl><type><name>int</name></type> <name>actionCheckDelay</name></decl></parameter>)</parameter_list> <block>{<block_content>
         <expr_stmt><expr><call><name>super</name><argument_list>(<argument><expr><literal type="string">"coord_action_check"</literal></expr></argument>, <argument><expr><literal type="string">"coord_action_check"</literal></expr></argument>, <argument><expr><literal type="number">0</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">88</literal></expr><operator>,</operator><expr><literal type="number">7</literal> <operator>+</operator><literal type="number">95</literal></expr><operator>,</operator><expr><literal type="number">8</literal> @@ <specifier>public</specifier> <name>class</name> <name>CoordActionCheckXCommand</name> extends <name><name>CoordinatorXCommand</name><argument_list type="generic">&lt;<argument><name>Void</name></argument>&gt;</argument_list></name> <block>{
                     <if_stmt><else>else <block>{<block_content>
                         <expr_stmt><expr><call><name><name>LOG</name><operator>.</operator><name>warn</name></name><argument_list>(<argument><expr><literal type="string">"Unexpected workflow "</literal> <operator>+</operator> <call><name><name>wf</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call> <operator>+</operator> <literal type="string">" STATUS "</literal> <operator>+</operator> <call><name><name>wf</name><operator>.</operator><name>getStatus</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                         <expr_stmt><expr><call><name><name>coordAction</name><operator>.</operator><name>setLastModifiedTime</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>Date</name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                        <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>CoordActionUpdateStatusJPAExecutor</name></name><argument_list>(<argument><expr><name>coordAction</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                        <expr_stmt><expr><call><name><name>updateList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>coordAction</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                        <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>BulkUpdateInsertForCoordActionStatusJPAExecutor</name><argument_list>(<argument><expr><name>updateList</name></expr></argument>, <argument><expr><literal type="null">null</literal></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                         <return>return <expr><literal type="null">null</literal></expr>;</return>
                     <expr_stmt/></block_content></block></else></if_stmt>}</block></expr></expr_stmt>
                 </block_content>}</block></constructor>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">97</literal></expr><operator>,</operator><expr><literal type="number">12</literal> <operator>+</operator><literal type="number">105</literal></expr><operator>,</operator><expr><literal type="number">17</literal> @@ <specifier>public</specifier> <name>class</name> <name>CoordActionCheckXCommand</name> extends <name><name>CoordinatorXCommand</name><argument_list type="generic">&lt;<argument><name>Void</name></argument>&gt;</argument_list></name> <block>{
             <expr><call><name><name>LOG</name><operator>.</operator><name>debug</name></name><argument_list>(<argument><expr><literal type="string">"Updating Coordintaor actionId :"</literal> <operator>+</operator> <call><name><name>coordAction</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call> <operator>+</operator> <literal type="string">"status to ="</literal>
                             <operator>+</operator> <call><name><name>coordAction</name><operator>.</operator><name>getStatus</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;
             <call><name><name>coordAction</name><operator>.</operator><name>setLastModifiedTime</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>Date</name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></block></expr>;</expr_stmt>
            <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>CoordActionUpdateStatusJPAExecutor</name></name><argument_list>(<argument><expr><name>coordAction</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name><name>updateList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>coordAction</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
 
             <if_stmt><if>if <condition>(<expr><name>slaStatus</name> <operator>!=</operator> <literal type="null">null</literal></expr>)</condition> <block>{<block_content>
                <expr_stmt><expr><call><name><name>SLADbOperations</name><operator>.</operator><name>writeStausEvent</name></name><argument_list>(<argument><expr><call><name><name>coordAction</name><operator>.</operator><name>getSlaXml</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><call><name><name>coordAction</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><name>slaStatus</name></expr></argument>,
                <argument><expr><name>SLAEventBean</name> <name>slaEvent</name> <operator>=</operator> <call><name><name>SLADbOperations</name><operator>.</operator><name>createStatusEvent</name></name><argument_list>(<argument><expr><call><name><name>coordAction</name><operator>.</operator><name>getSlaXml</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><call><name><name>coordAction</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><name>slaStatus</name></expr></argument>,
                         <argument><expr><name><name>SlaAppType</name><operator>.</operator><name>COORDINATOR_ACTION</name></name></expr></argument>, <argument><expr><name>LOG</name></expr></argument>)</argument_list></call></expr></argument>;</argument_list></call></expr></expr_stmt>
                <if_stmt><if>if<condition>(<expr><name>slaEvent</name> <operator>!=</operator> <literal type="null">null</literal></expr>)</condition> <block>{<block_content>
                    <expr_stmt><expr><call><name><name>insertList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>slaEvent</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                </block_content>}</block></if></if_stmt>
             </block_content>}</block></if></if_stmt>

            <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>BulkUpdateInsertForCoordActionStatusJPAExecutor</name><argument_list>(<argument><expr><name>updateList</name></expr></argument>, <argument><expr><name>insertList</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
         </block_content>}</block></if></if_stmt>
         <catch>catch <parameter_list>(<parameter><decl><type><name>XException</name></type> <name>ex</name></decl></parameter>)</parameter_list> <block>{<block_content>
             <expr_stmt><expr><call><name><name>LOG</name><operator>.</operator><name>warn</name></name><argument_list>(<argument><expr><literal type="string">"CoordActionCheckCommand Failed "</literal></expr></argument>, <argument><expr><name>ex</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
<expr_stmt><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>coord</name><operator>/</operator><name><name>CoordActionMaterializeCommand</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>coord</name><operator>/</operator><name><name>CoordActionMaterializeCommand</name><operator>.</operator><name>java</name></name>
<name>index</name> <literal type="number">8a2668d80</literal><operator>..</operator><literal type="number">8ab952bae</literal> <literal type="number">100644</literal>
<operator>--</operator> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>coord</name><operator>/</operator><name><name>CoordActionMaterializeCommand</name><operator>.</operator><name>java</name></name>
<operator>++</operator> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>coord</name><operator>/</operator><name><name>CoordActionMaterializeCommand</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">19</literal></expr><operator>,</operator><expr><literal type="number">18</literal> <operator>+</operator><literal type="number">19</literal></expr><operator>,</operator><expr><literal type="number">26</literal> @@</expr></expr_stmt> <package>package <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>coord</name></name>;</package>
 
 <import>import <name><name>java</name><operator>.</operator><name>io</name><operator>.</operator><name>IOException</name></name>;</import>
 <import>import <name><name>java</name><operator>.</operator><name>io</name><operator>.</operator><name>StringReader</name></name>;</import>
<import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>ArrayList</name></name>;</import>
 <import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>Calendar</name></name>;</import>
 <import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>Date</name></name>;</import>
<import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>List</name></name>;</import>
 <import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>TimeZone</name></name>;</import>
 
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>hadoop</name><operator>.</operator><name>conf</name><operator>.</operator><name>Configuration</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>CoordinatorActionBean</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>CoordinatorJobBean</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>ErrorCode</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>SLAEventBean</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>CoordinatorJob</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>SLAEvent</name><operator>.</operator><name>SlaAppType</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>rest</name><operator>.</operator><name>JsonBean</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>CommandException</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>coord</name><operator>.</operator><name>TimeUnit</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>BulkUpdateInsertJPAExecutor</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>CoordJobGetJPAExecutor</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>JPAExecutorException</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>JPAService</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>Service</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>Services</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>store</name><operator>.</operator><name>CoordinatorStore</name></name>;</import>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">52</literal></expr><operator>,</operator><expr><literal type="number">22</literal> <operator>+</operator><literal type="number">60</literal></expr><operator>,</operator><expr><literal type="number">31</literal> @@ <specifier>public</specifier> <name>class</name> <name>CoordActionMaterializeCommand</name> extends <name><name>CoordinatorCommand</name><argument_list type="generic">&lt;<argument><name>Void</name></argument>&gt;</argument_list></name> <block>{
     <expr><specifier>private</specifier> <name>final</name> <name>XLog</name> <name>log</name> <operator>=</operator> <call><name><name>XLog</name><operator>.</operator><name>getLog</name></name><argument_list>(<argument><expr><call><name>getClass</name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;
     <expr><specifier>private</specifier> <name>String</name> <name>user</name></expr>;
     <expr><specifier>private</specifier> <name>String</name> <name>group</name></expr>;
    <expr><specifier>private</specifier> <name><name>List</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name> <name>insertList</name> <operator>=</operator> <operator>new</operator> <call><name><name>ArrayList</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name><argument_list>()</argument_list></call></expr>;
    <expr><specifier>private</specifier> <name><name>List</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name> <name>updateList</name> <operator>=</operator> <operator>new</operator> <call><name><name>ArrayList</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name><argument_list>()</argument_list></call></expr>;

     <comment type="block" format="javadoc">/**
      * Default timeout for catchup jobs, in minutes, after which coordinator input check will timeout
      */</comment>
     <expr><specifier>public</specifier> <specifier>static</specifier> <name>final</name> <name>String</name> <name>CONF_DEFAULT_TIMEOUT_CATCHUP</name> <operator>=</operator> <name><name>Service</name><operator>.</operator><name>CONF_PREFIX</name></name> <operator>+</operator> <literal type="string">"coord.catchup.default.timeout"</literal></expr>;
 
     <expr><specifier>public</specifier> <call><name>CoordActionMaterializeCommand</name><argument_list>(<argument><expr><name>String</name> <name>jobId</name></expr></argument>, <argument><expr><name>Date</name> <name>startTime</name></expr></argument>, <argument><expr><name>Date</name> <name>endTime</name></expr></argument>)</argument_list></call> <block>{
        <expr><call><name>super</name><argument_list>(<argument><expr><literal type="string">"coord_action_mater"</literal></expr></argument>, <argument><expr><literal type="string">"coord_action_mater"</literal></expr></argument>, <argument><expr><literal type="number">1</literal></expr></argument>, <argument><expr><name><name>XLog</name><operator>.</operator><name>STD</name></name></expr></argument>)</argument_list></call></expr>;
        <expr><call><name>super</name><argument_list>(<argument><expr><literal type="string">"coord_action_mater"</literal></expr></argument>, <argument><expr><literal type="string">"coord_action_mater"</literal></expr></argument>, <argument><expr><literal type="number">1</literal></expr></argument>, <argument><expr><name><name>XLog</name><operator>.</operator><name>STD</name></name></expr></argument>, <argument><expr><literal type="boolean">false</literal></expr></argument>)</argument_list></call></expr>;
         <expr><name><name>this</name><operator>.</operator><name>jobId</name></name> <operator>=</operator> <name>jobId</name></expr>;
         <expr><name><name>this</name><operator>.</operator><name>startTime</name></name> <operator>=</operator> <name>startTime</name></expr>;
         <expr><name><name>this</name><operator>.</operator><name>endTime</name></name> <operator>=</operator> <name>endTime</name></expr>;
     }</block>
 
     @<name>Override</name>
    <specifier>protected</specifier> <name>Void</name> <call><name>call</name><argument_list>(<argument><expr><name>CoordinatorStore</name> <name>store</name></expr></argument>)</argument_list></call> <throws>throws <argument><expr><name>StoreException</name></expr></argument>, <argument><expr><name>CommandException</name> <block>{
        <comment type="line">// CoordinatorJobBean job = store.getCoordinatorJob(jobId, true);</comment>
        <expr><name>CoordinatorJobBean</name> <name>job</name> <operator>=</operator> <call><name><name>store</name><operator>.</operator><name>getEntityManager</name></name><argument_list>()</argument_list></call><operator>.</operator><call><name>find</name><argument_list>(<argument><expr><name><name>CoordinatorJobBean</name><operator>.</operator><name>class</name></name></expr></argument>, <argument><expr><name>jobId</name></expr></argument>)</argument_list></call></expr></block></expr></argument></throws></expr>;
    <expr><specifier>protected</specifier> <name>Void</name> <call><name>call</name><argument_list>(<argument><expr><name>CoordinatorStore</name> <name>store</name></expr></argument>)</argument_list></call> <throws>throws <argument><expr><name>CommandException</name> <block>{
        <expr><name>CoordJobGetJPAExecutor</name> <name>getCoordJob</name> <operator>=</operator> <operator>new</operator> <call><name>CoordJobGetJPAExecutor</name><argument_list>(<argument><expr><name>jobId</name></expr></argument>)</argument_list></call></expr></block></expr></argument></throws></expr>;
        <expr><name>CoordinatorJobBean</name> <name>job</name></expr>;
        <try>try <block>{<block_content>
            <expr_stmt><expr><name>job</name> <operator>=</operator> <call><name><name>Services</name><operator>.</operator><name>get</name></name><argument_list>()</argument_list></call><operator>.</operator><call><name>get</name><argument_list>(<argument><expr><name><name>JPAService</name><operator>.</operator><name>class</name></name></expr></argument>)</argument_list></call><operator>.</operator><call><name>execute</name><argument_list>(<argument><expr><name>getCoordJob</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt/></block_content></block></try>}</block></expr></expr_stmt>
        <catch>catch <parameter_list>(<parameter><decl><type><name>JPAExecutorException</name></type> <name>jex</name></decl></parameter>)</parameter_list> <block>{<block_content>
            <throw>throw <expr><operator>new</operator> <call><name>CommandException</name><argument_list>(<argument><expr><name>jex</name></expr></argument>)</argument_list></call></expr>;</throw>
        </block_content>}</block></catch>
         <expr_stmt><expr><call><name>setLogInfo</name><argument_list>(<argument><expr><name>job</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
         <if_stmt><if>if <condition>(<expr><call><name><name>job</name><operator>.</operator><name>getLastActionTime</name></name><argument_list>()</argument_list></call> <operator>!=</operator> <literal type="null">null</literal> <operator>&amp;&amp;</operator> <call><name><name>job</name><operator>.</operator><name>getLastActionTime</name></name><argument_list>()</argument_list></call><operator>.</operator><call><name>compareTo</name><argument_list>(<argument><expr><name>endTime</name></expr></argument>)</argument_list></call> <operator>&gt;=</operator> <literal type="number">0</literal></expr>)</condition> <block>{<block_content>
             <expr_stmt><expr><call><name><name>log</name><operator>.</operator><name>info</name></name><argument_list>(<argument><expr><literal type="string">"ENDED Coordinator materialization for jobId = "</literal> <operator>+</operator> <name>jobId</name>
@@ <operator>-</operator><literal type="number">88</literal></expr></argument>,<argument><expr><literal type="number">7</literal> <operator>+</operator><literal type="number">105</literal></expr></argument>,<argument><expr><literal type="number">7</literal> @@ <specifier>public</specifier> class <name>CoordActionMaterializeCommand</name> extends <name><name>CoordinatorCommand</name><argument_list type="generic">&lt;<argument><name>Void</name></argument>&gt;</argument_list></name> <block>{
             <if_stmt><if>if <condition>(<expr><call><name><name>job</name><operator>.</operator><name>getStatus</name></name><argument_list>()</argument_list></call> <operator>==</operator> <name><name>CoordinatorJob</name><operator>.</operator><name>Status</name><operator>.</operator><name>PREMATER</name></name></expr>)</condition> <block>{<block_content>
                 <expr_stmt><expr><call><name><name>job</name><operator>.</operator><name>setStatus</name></name><argument_list>(<argument><expr><name><name>CoordinatorJob</name><operator>.</operator><name>Status</name><operator>.</operator><name>RUNNING</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
             </block_content>}</block></if></if_stmt>
            <call><name><name>store</name><operator>.</operator><name>updateCoordinatorJob</name></name><argument_list>(<argument><expr><name>job</name></expr></argument>)</argument_list></call></block></expr></argument>;</argument_list></call></expr></expr_stmt>
            <expr_stmt><expr><call><name><name>updateList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>job</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
             <return>return <expr><literal type="null">null</literal></expr>;</return>
         </block_content>}</block></if></if_stmt>
 
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">115</literal></expr><operator>,</operator><expr><literal type="number">7</literal> <operator>+</operator><literal type="number">132</literal></expr><operator>,</operator><expr><literal type="number">7</literal> @@ <specifier>public</specifier> <name>class</name> <name>CoordActionMaterializeCommand</name> extends <name><name>CoordinatorCommand</name><argument_list type="generic">&lt;<argument><name>Void</name></argument>&gt;</argument_list></name> <block>{
             <catch>catch <parameter_list>(<parameter><decl><type><name>CommandException</name></type> <name>ex</name></decl></parameter>)</parameter_list> <block>{<block_content>
                 <expr_stmt><expr><call><name><name>log</name><operator>.</operator><name>warn</name></name><argument_list>(<argument><expr><literal type="string">"Exception occurs:"</literal> <operator>+</operator> <name>ex</name> <operator>+</operator> <literal type="string">" Making the job failed "</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                 <expr_stmt><expr><call><name><name>job</name><operator>.</operator><name>setStatus</name></name><argument_list>(<argument><expr><name><name>CoordinatorJobBean</name><operator>.</operator><name>Status</name><operator>.</operator><name>FAILED</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                <expr_stmt><expr><call><name><name>store</name><operator>.</operator><name>updateCoordinatorJob</name></name><argument_list>(<argument><expr><name>job</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                <expr_stmt><expr><call><name><name>updateList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>job</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
             <expr_stmt/></block_content></block></catch>}</block></expr></expr_stmt>
             <catch>catch <parameter_list>(<parameter><decl><type><name>Exception</name></type> <name>e</name></decl></parameter>)</parameter_list> <block>{<block_content>
                 <expr_stmt><expr><call><name><name>log</name><operator>.</operator><name>error</name></name><argument_list>(<argument><expr><literal type="string">"Excepion thrown :"</literal></expr></argument>, <argument><expr><name>e</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">234</literal></expr><operator>,</operator><expr><literal type="number">8</literal> <operator>+</operator><literal type="number">251</literal></expr><operator>,</operator><expr><literal type="number">8</literal> @@ <specifier>public</specifier> <name>class</name> <name>CoordActionMaterializeCommand</name> extends <name><name>CoordinatorCommand</name><argument_list type="generic">&lt;<argument><name>Void</name></argument>&gt;</argument_list></name> <block>{
     <expr><specifier>private</specifier> <name>void</name> <call><name>storeToDB</name><argument_list>(<argument><expr><name>CoordinatorActionBean</name> <name>actionBean</name></expr></argument>, <argument><expr><name>String</name> <name>actionXml</name></expr></argument>, <argument><expr><name>CoordinatorStore</name> <name>store</name></expr></argument>)</argument_list></call> <throws>throws <argument><expr><name>Exception</name> <block>{
         <expr><call><name><name>log</name><operator>.</operator><name>debug</name></name><argument_list>(<argument><expr><literal type="string">"In storeToDB() action Id "</literal> <operator>+</operator> <call><name><name>actionBean</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call> <operator>+</operator> <literal type="string">" Size of actionXml "</literal> <operator>+</operator> <call><name><name>actionXml</name><operator>.</operator><name>length</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr></block></expr></argument></throws></expr>;
         <expr><call><name><name>actionBean</name><operator>.</operator><name>setActionXml</name></name><argument_list>(<argument><expr><name>actionXml</name></expr></argument>)</argument_list></call></expr>;
        <expr><call><name><name>store</name><operator>.</operator><name>insertCoordinatorAction</name></name><argument_list>(<argument><expr><name>actionBean</name></expr></argument>)</argument_list></call></expr>;
        <expr><call><name>writeActionRegistration</name><argument_list>(<argument><expr><name>actionXml</name></expr></argument>, <argument><expr><name>actionBean</name></expr></argument>, <argument><expr><name>store</name></expr></argument>)</argument_list></call></expr>;
        <expr><call><name><name>insertList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>actionBean</name></expr></argument>)</argument_list></call></expr>;
        <expr><call><name>createActionRegistration</name><argument_list>(<argument><expr><name>actionXml</name></expr></argument>, <argument><expr><name>actionBean</name></expr></argument>, <argument><expr><name>store</name></expr></argument>)</argument_list></call></expr>;
 
         <comment type="line">// TODO: time 100s should be configurable</comment>
         <expr><call><name>queueCallable</name><argument_list>(<argument><expr><operator>new</operator> <call><name>CoordActionNotificationXCommand</name><argument_list>(<argument><expr><name>actionBean</name></expr></argument>)</argument_list></call></expr></argument>, <argument><expr><literal type="number">100</literal></expr></argument>)</argument_list></call></expr>;
@@ <expr><operator>-</operator><literal type="number">248</literal></expr>,<expr><literal type="number">12</literal> <operator>+</operator><literal type="number">265</literal></expr>,<expr><literal type="number">15</literal> @@ <specifier>public</specifier> <name>class</name> <name>CoordActionMaterializeCommand</name> extends <name><name>CoordinatorCommand</name><argument_list type="generic">&lt;<argument><name>Void</name></argument>&gt;</argument_list></name> <block>{
      <expr><operator>*</operator> @<name>param</name> <name>store</name>
      <operator>*</operator> @<throws>throws <argument><expr><name>Exception</name>
      <operator>*</operator><operator>/</operator>
    <specifier>private</specifier> <name>void</name> <call><name>writeActionRegistration</name><argument_list>(<argument><expr><name>String</name> <name>actionXml</name></expr></argument>, <argument><expr><name>CoordinatorActionBean</name> <name>actionBean</name></expr></argument>, <argument><expr><name>CoordinatorStore</name> <name>store</name></expr></argument>)</argument_list></call>
    <specifier>private</specifier> <name>void</name> <call><name>createActionRegistration</name><argument_list>(<argument><expr><name>String</name> <name>actionXml</name></expr></argument>, <argument><expr><name>CoordinatorActionBean</name> <name>actionBean</name></expr></argument>, <argument><expr><name>CoordinatorStore</name> <name>store</name></expr></argument>)</argument_list></call></expr></argument></throws>
             <throws>throws <argument><expr><name>Exception</name> <block>{
         <expr><name>Element</name> <name>eAction</name> <operator>=</operator> <call><name><name>XmlUtils</name><operator>.</operator><name>parseXml</name></name><argument_list>(<argument><expr><name>actionXml</name></expr></argument>)</argument_list></call></expr></block></expr></argument></throws></expr>;
         <expr><name>Element</name> <name>eSla</name> <operator>=</operator> <call><name><name>eAction</name><operator>.</operator><name>getChild</name></name><argument_list>(<argument><expr><literal type="string">"action"</literal></expr></argument>, <argument><expr><call><name><name>eAction</name><operator>.</operator><name>getNamespace</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call><operator>.</operator><call><name>getChild</name><argument_list>(<argument><expr><literal type="string">"info"</literal></expr></argument>, <argument><expr><call><name><name>eAction</name><operator>.</operator><name>getNamespace</name></name><argument_list>(<argument><expr><literal type="string">"sla"</literal></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;
        <expr><call><name><name>SLADbOperations</name><operator>.</operator><name>writeSlaRegistrationEvent</name></name><argument_list>(<argument><expr><name>eSla</name></expr></argument>, <argument><expr><name>store</name></expr></argument>, <argument><expr><call><name><name>actionBean</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><name><name>SlaAppType</name><operator>.</operator><name>COORDINATOR_ACTION</name></name></expr></argument>, <argument><expr><name>user</name></expr></argument>,
                                                  <argument><expr><name>group</name></expr></argument>)</argument_list></call></expr>;
        <expr><name>SLAEventBean</name> <name>slaEvent</name> <operator>=</operator> <call><name><name>SLADbOperations</name><operator>.</operator><name>createSlaRegistrationEvent</name></name><argument_list>(<argument><expr><name>eSla</name></expr></argument>, <argument><expr><name>store</name></expr></argument>, <argument><expr><call><name><name>actionBean</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>,
                <argument><expr><name><name>SlaAppType</name><operator>.</operator><name>COORDINATOR_ACTION</name></name></expr></argument>, <argument><expr><name>user</name></expr></argument>, <argument><expr><name>group</name></expr></argument>)</argument_list></call></expr>;
        <if_stmt><if>if<condition>(<expr><name>slaEvent</name> <operator>!=</operator> <literal type="null">null</literal></expr>)</condition> <block>{<block_content>
            <expr_stmt><expr><call><name><name>insertList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>slaEvent</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt/></block_content></block></if></if_stmt>}</block></expr>
     }</block>
 
     <comment type="block" format="javadoc">/**
@@ -261,7 +281,7 @@ public class CoordActionMaterializeCommand extends CoordinatorCommand&lt;Void&gt; {
      * @param store
      * @throws StoreException
      */</comment>
    <specifier>private</specifier> <name>void</name> <call><name>updateJobTable</name><argument_list>(<argument><expr><name>CoordinatorJobBean</name> <name>job</name></expr></argument>, <argument><expr><name>CoordinatorStore</name> <name>store</name></expr></argument>)</argument_list></call> <throws>throws <argument><expr><name>StoreException</name> <block>{
    <expr><specifier>private</specifier> <name>void</name> <call><name>updateJobTable</name><argument_list>(<argument><expr><name>CoordinatorJobBean</name> <name>job</name></expr></argument>, <argument><expr><name>CoordinatorStore</name> <name>store</name></expr></argument>)</argument_list></call> <block>{
         <comment type="line">// TODO: why do we need this? Isn't lastMatTime enough???</comment>
         <expr><call><name><name>job</name><operator>.</operator><name>setLastActionTime</name></name><argument_list>(<argument><expr><name>endTime</name></expr></argument>)</argument_list></call></expr></block></expr></block></expr></argument></throws></expr>;</expr_stmt>
         <expr_stmt><expr><call><name><name>job</name><operator>.</operator><name>setLastActionNumber</name></name><argument_list>(<argument><expr><name>lastActionNumber</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">278</literal></expr><operator>,</operator><expr><literal type="number">7</literal> <operator>+</operator><literal type="number">298</literal></expr><operator>,</operator><expr><literal type="number">7</literal> @@ <specifier>public</specifier> <name>class</name> <name>CoordActionMaterializeCommand</name> extends <name><name>CoordinatorCommand</name><argument_list type="generic">&lt;<argument><name>Void</name></argument>&gt;</argument_list></name> <block>{
             <expr><call><name><name>log</name><operator>.</operator><name>info</name></name><argument_list>(<argument><expr><literal type="string">"["</literal> <operator>+</operator> <call><name><name>job</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call> <operator>+</operator> <literal type="string">"]: Update status from PREMATER to RUNNING"</literal></expr></argument>)</argument_list></call></expr>;
         }</block>
         <call><name><name>job</name><operator>.</operator><name>setNextMaterializedTime</name></name><argument_list>(<argument><expr><name>endTime</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>store</name><operator>.</operator><name>updateCoordinatorJob</name></name><argument_list>(<argument><expr><name>job</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>updateList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>job</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
     </block_content>}</block></catch>
 
     <annotation>@<name>Override</name></annotation>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">288</literal></expr><operator>,</operator><expr><literal type="number">6</literal> <operator>+</operator><literal type="number">308</literal></expr><operator>,</operator><expr><literal type="number">18</literal> @@ <specifier>public</specifier> <name>class</name> <name>CoordActionMaterializeCommand</name> extends <name><name>CoordinatorCommand</name><argument_list type="generic">&lt;<argument><name>Void</name></argument>&gt;</argument_list></name> <block>{
         <try>try <block>{<block_content>
             <if_stmt><if>if <condition>(<expr><call><name>lock</name><argument_list>(<argument><expr><name>jobId</name></expr></argument>)</argument_list></call></expr>)</condition> <block>{<block_content>
                 <expr_stmt><expr><call><name>call</name><argument_list>(<argument><expr><name>store</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                <decl_stmt><decl><type><name>JPAService</name></type> <name>jpaService</name> <init>= <expr><call><name><name>Services</name><operator>.</operator><name>get</name></name><argument_list>()</argument_list></call><operator>.</operator><call><name>get</name><argument_list>(<argument><expr><name><name>JPAService</name><operator>.</operator><name>class</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
                <if_stmt><if>if <condition>(<expr><name>jpaService</name> <operator>!=</operator> <literal type="null">null</literal></expr>)</condition> <block>{<block_content>
                    <try>try <block>{<block_content>
                        <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>BulkUpdateInsertJPAExecutor</name><argument_list>(<argument><expr><name>updateList</name></expr></argument>, <argument><expr><name>insertList</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                    <expr_stmt/></block_content></block></try></block_content></block></if></if_stmt></block_content></block></if></if_stmt></block_content></block></try>}</block></expr></expr_stmt>
                    <catch>catch <parameter_list>(<parameter><decl><type><name>JPAExecutorException</name></type> <name>je</name></decl></parameter>)</parameter_list> <block>{<block_content>
                        <throw>throw <expr><operator>new</operator> <call><name>CommandException</name><argument_list>(<argument><expr><name>je</name></expr></argument>)</argument_list></call></expr>;</throw>
                    </block_content>}</block></catch>
                </block_content>}</block></catch>
                <if_stmt><else>else <block>{<block_content>
                    <throw>throw <expr><operator>new</operator> <call><name>CommandException</name><argument_list>(<argument><expr><name><name>ErrorCode</name><operator>.</operator><name>E0610</name></name></expr></argument>)</argument_list></call></expr>;</throw>
                </block_content>}</block></else></if_stmt>
             </block_content>}</block></try>
             <if_stmt><else>else <block>{<block_content>
                 <expr_stmt><expr><call><name>queueCallable</name><argument_list>(<argument><expr><operator>new</operator> <call><name>CoordActionMaterializeCommand</name><argument_list>(<argument><expr><name>jobId</name></expr></argument>, <argument><expr><name>startTime</name></expr></argument>, <argument><expr><name>endTime</name></expr></argument>)</argument_list></call></expr></argument>,
<argument><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>coord</name><operator>/</operator><name><name>CoordActionStartXCommand</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>coord</name><operator>/</operator><name><name>CoordActionStartXCommand</name><operator>.</operator><name>java</name></name>
<name>index</name> <literal type="number">3c2922e31</literal><operator>..</operator><literal type="number">999957c54</literal> <literal type="number">100644</literal>
<operator>--</operator> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>coord</name><operator>/</operator><name><name>CoordActionStartXCommand</name><operator>.</operator><name>java</name></name>
<operator>++</operator> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>coord</name><operator>/</operator><name><name>CoordActionStartXCommand</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">25</literal></expr></argument>,<argument><expr><literal type="number">6</literal> <operator>+</operator><literal type="number">25</literal></expr></argument>,<argument><expr><literal type="number">7</literal> @@</expr></argument></argument_list></call></expr></expr_stmt> <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>CoordinatorActionBean</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>DagEngineException</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>DagEngine</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>ErrorCode</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>SLAEventBean</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>WorkflowJobBean</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>CommandException</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>PreconditionException</name></name>;</import>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">40</literal></expr><operator>,</operator><expr><literal type="number">15</literal> <operator>+</operator><literal type="number">41</literal></expr><operator>,</operator><expr><literal type="number">18</literal> @@</expr></expr_stmt> <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>util</name><operator>.</operator><name>XConfiguration</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>util</name><operator>.</operator><name>db</name><operator>.</operator><name>SLADbOperations</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>SLAEvent</name><operator>.</operator><name>SlaAppType</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>SLAEvent</name><operator>.</operator><name>Status</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>rest</name><operator>.</operator><name>JsonBean</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>BulkUpdateInsertForCoordActionStartJPAExecutor</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>JPAExecutorException</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>WorkflowJobGetJPAExecutor</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>WorkflowJobUpdateJPAExecutor</name></name>;</import>

 <import>import <name><name>org</name><operator>.</operator><name>jdom</name><operator>.</operator><name>Element</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>jdom</name><operator>.</operator><name>JDOMException</name></name>;</import>
 
 <import>import <name><name>java</name><operator>.</operator><name>io</name><operator>.</operator><name>IOException</name></name>;</import>
 <import>import <name><name>java</name><operator>.</operator><name>io</name><operator>.</operator><name>StringReader</name></name>;</import>
<import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>ArrayList</name></name>;</import>
<import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>Date</name></name>;</import>
<import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>List</name></name>;</import>
 
 <class><specifier>public</specifier> class <name>CoordActionStartXCommand</name> <super_list><extends>extends <super><name><name>CoordinatorXCommand</name><argument_list type="generic">&lt;<argument><name>Void</name></argument>&gt;</argument_list></name></super></extends></super_list> <block>{
 
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">65</literal></expr><operator>,</operator><expr><literal type="number">6</literal> <operator>+</operator><literal type="number">69</literal></expr><operator>,</operator><expr><literal type="number">8</literal> @@ <specifier>public</specifier> <name>class</name> <name>CoordActionStartXCommand</name> extends <name><name>CoordinatorXCommand</name><argument_list type="generic">&lt;<argument><name>Void</name></argument>&gt;</argument_list></name> <block>{
     <expr><specifier>private</specifier> <name>CoordinatorActionBean</name> <name>coordAction</name> <operator>=</operator> <literal type="null">null</literal></expr>;
     <specifier>private</specifier> <name>JPAService</name> <name>jpaService</name> <operator>=</operator> <literal type="null">null</literal></block></expr>;</expr_stmt>
     <decl_stmt><decl><type><specifier>private</specifier> <name>String</name></type> <name>jobId</name> <init>= <expr><literal type="null">null</literal></expr></init></decl>;</decl_stmt>
    <decl_stmt><decl><type><specifier>private</specifier> <name><name>List</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name></type> <name>updateList</name> <init>= <expr><operator>new</operator> <call><name><name>ArrayList</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
    <decl_stmt><decl><type><specifier>private</specifier> <name><name>List</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name></type> <name>insertList</name> <init>= <expr><operator>new</operator> <call><name><name>ArrayList</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
 
     <constructor><specifier>public</specifier> <name>CoordActionStartXCommand</name><parameter_list>(<parameter><decl><type><name>String</name></type> <name>id</name></decl></parameter>, <parameter><decl><type><name>String</name></type> <name>user</name></decl></parameter>, <parameter><decl><type><name>String</name></type> <name>token</name></decl></parameter>, <parameter><decl><type><name>String</name></type> <name>jobId</name></decl></parameter>)</parameter_list> <block>{<block_content>
         <comment type="line">//super("coord_action_start", "coord_action_start", 1, XLog.OPS);</comment>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">160</literal></expr><operator>,</operator><expr><literal type="number">8</literal> <operator>+</operator><literal type="number">166</literal></expr><operator>,</operator><expr><literal type="number">11</literal> @@ <specifier>public</specifier> <name>class</name> <name>CoordActionStartXCommand</name> extends <name><name>CoordinatorXCommand</name><argument_list type="generic">&lt;<argument><name>Void</name></argument>&gt;</argument_list></name> <block>{
             <try>try <block>{<block_content>
                 <decl_stmt><decl><type><name>boolean</name></type> <name>startJob</name> <init>= <expr><literal type="boolean">true</literal></expr></init></decl>;</decl_stmt>
                 <decl_stmt><decl><type><name>Configuration</name></type> <name>conf</name> <init>= <expr><operator>new</operator> <call><name>XConfiguration</name><argument_list>(<argument><expr><operator>new</operator> <call><name>StringReader</name><argument_list>(<argument><expr><call><name><name>coordAction</name><operator>.</operator><name>getRunConf</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
                <expr_stmt><expr><call><name><name>SLADbOperations</name><operator>.</operator><name>writeStausEvent</name></name><argument_list>(<argument><expr><call><name><name>coordAction</name><operator>.</operator><name>getSlaXml</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><call><name><name>coordAction</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><name><name>Status</name><operator>.</operator><name>STARTED</name></name></expr></argument>,
                                                <argument><expr><name><name>SlaAppType</name><operator>.</operator><name>COORDINATOR_ACTION</name></name></expr></argument>, <argument><expr><name>log</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                <decl_stmt><decl><type><name>SLAEventBean</name></type> <name>slaEvent</name> <init>= <expr><call><name><name>SLADbOperations</name><operator>.</operator><name>createStatusEvent</name></name><argument_list>(<argument><expr><call><name><name>coordAction</name><operator>.</operator><name>getSlaXml</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><call><name><name>coordAction</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><name><name>Status</name><operator>.</operator><name>STARTED</name></name></expr></argument>,
                        <argument><expr><name><name>SlaAppType</name><operator>.</operator><name>COORDINATOR_ACTION</name></name></expr></argument>, <argument><expr><name>log</name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
                <if_stmt><if>if<condition>(<expr><name>slaEvent</name> <operator>!=</operator> <literal type="null">null</literal></expr>)</condition> <block>{<block_content>
                    <expr_stmt><expr><call><name><name>insertList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>slaEvent</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                </block_content>}</block></if></if_stmt>
 
                 <comment type="line">// Normalize workflow appPath here;</comment>
                 <expr_stmt><expr><call><name><name>JobUtils</name><operator>.</operator><name>normalizeAppPath</name></name><argument_list>(<argument><expr><call><name><name>conf</name><operator>.</operator><name>get</name></name><argument_list>(<argument><expr><name><name>OozieClient</name><operator>.</operator><name>USER_NAME</name></name></expr></argument>)</argument_list></call></expr></argument>, <argument><expr><call><name><name>conf</name><operator>.</operator><name>get</name></name><argument_list>(<argument><expr><name><name>OozieClient</name><operator>.</operator><name>GROUP_NAME</name></name></expr></argument>)</argument_list></call></expr></argument>, <argument><expr><name>conf</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">176</literal></expr><operator>,</operator><expr><literal type="number">8</literal> <operator>+</operator><literal type="number">185</literal></expr><operator>,</operator><expr><literal type="number">15</literal> @@ <specifier>public</specifier> <name>class</name> <name>CoordActionStartXCommand</name> extends <name><name>CoordinatorXCommand</name><argument_list type="generic">&lt;<argument><name>Void</name></argument>&gt;</argument_list></name> <block>{
                     <expr><call><name><name>log</name><operator>.</operator><name>debug</name></name><argument_list>(<argument><expr><literal type="string">"Updating WF record for WFID :"</literal> <operator>+</operator> <name>wfId</name> <operator>+</operator> <literal type="string">" with parent id: "</literal> <operator>+</operator> <name>actionId</name></expr></argument>)</argument_list></call></expr>;
                     <name>WorkflowJobBean</name> <name>wfJob</name> <operator>=</operator> <call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>WorkflowJobGetJPAExecutor</name><argument_list>(<argument><expr><name>wfId</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></block></expr>;</expr_stmt>
                     <expr_stmt><expr><call><name><name>wfJob</name><operator>.</operator><name>setParentId</name></name><argument_list>(<argument><expr><name>actionId</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                    <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>WorkflowJobUpdateJPAExecutor</name><argument_list>(<argument><expr><name>wfJob</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                    <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>CoordActionUpdateForStartJPAExecutor</name></name><argument_list>(<argument><expr><name>coordAction</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                    <expr_stmt><expr><call><name><name>wfJob</name><operator>.</operator><name>setLastModifiedTime</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>Date</name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                    <expr_stmt><expr><call><name><name>updateList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>wfJob</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                    <expr_stmt><expr><call><name><name>updateList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>coordAction</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                    <try>try <block>{<block_content>
                        <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>BulkUpdateInsertForCoordActionStartJPAExecutor</name><argument_list>(<argument><expr><name>updateList</name></expr></argument>, <argument><expr><name>insertList</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                    </block_content>}</block>
                    <catch>catch <parameter_list>(<parameter><decl><type><name>JPAExecutorException</name></type> <name>je</name></decl></parameter>)</parameter_list> <block>{<block_content>
                        <throw>throw <expr><operator>new</operator> <call><name>CommandException</name><argument_list>(<argument><expr><name>je</name></expr></argument>)</argument_list></call></expr>;</throw>
                    </block_content>}</block></catch></try>
                 </block_content>}</block></try></block></expr></expr_stmt>
                 <if_stmt><else>else <block>{<block_content>
                     <expr_stmt><expr><call><name><name>log</name><operator>.</operator><name>error</name></name><argument_list>(<argument><expr><name><name>ErrorCode</name><operator>.</operator><name>E0610</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">215</literal></expr><operator>,</operator><expr><literal type="number">20</literal> <operator>+</operator><literal type="number">231</literal></expr><operator>,</operator><expr><literal type="number">22</literal> @@ <specifier>public</specifier> <name>class</name> <name>CoordActionStartXCommand</name> extends <name><name>CoordinatorXCommand</name><argument_list type="generic">&lt;<argument><name>Void</name></argument>&gt;</argument_list></name> <block>{
                     <expr><call><name><name>coordAction</name><operator>.</operator><name>setErrorMessage</name></name><argument_list>(<argument><expr><name>errMsg</name></expr></argument>)</argument_list></call></expr>;
                     <call><name><name>coordAction</name><operator>.</operator><name>setErrorCode</name></name><argument_list>(<argument><expr><name>errCode</name></expr></argument>)</argument_list></call></block></expr>;</expr_stmt>
 
                    <decl_stmt><decl><type><name>JPAService</name></type> <name>jpaService</name> <init>= <expr><call><name><name>Services</name><operator>.</operator><name>get</name></name><argument_list>()</argument_list></call><operator>.</operator><call><name>get</name><argument_list>(<argument><expr><name><name>JPAService</name><operator>.</operator><name>class</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
                    <if_stmt><if>if <condition>(<expr><name>jpaService</name> <operator>!=</operator> <literal type="null">null</literal></expr>)</condition> <block>{<block_content>
                        <try>try <block>{<block_content>
                            <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>CoordActionUpdateForStartJPAExecutor</name></name><argument_list>(<argument><expr><name>coordAction</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                        </block_content>}</block>
                        <catch>catch <parameter_list>(<parameter><decl><type><name>JPAExecutorException</name></type> <name>je</name></decl></parameter>)</parameter_list> <block>{<block_content>
                            <throw>throw <expr><operator>new</operator> <call><name>CommandException</name><argument_list>(<argument><expr><name>je</name></expr></argument>)</argument_list></call></expr>;</throw>
                        </block_content>}</block></catch></try>
                    <expr_stmt><expr><name>updateList</name> <operator>=</operator> <operator>new</operator> <call><name><name>ArrayList</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
                    <expr_stmt><expr><call><name><name>updateList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>coordAction</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                    <expr_stmt><expr><name>insertList</name> <operator>=</operator> <operator>new</operator> <call><name><name>ArrayList</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name><argument_list>()</argument_list></call></expr>;</expr_stmt>

                    <decl_stmt><decl><type><name>SLAEventBean</name></type> <name>slaEvent</name> <init>= <expr><call><name><name>SLADbOperations</name><operator>.</operator><name>createStatusEvent</name></name><argument_list>(<argument><expr><call><name><name>coordAction</name><operator>.</operator><name>getSlaXml</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><call><name><name>coordAction</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><name><name>Status</name><operator>.</operator><name>FAILED</name></name></expr></argument>,
                            <argument><expr><name><name>SlaAppType</name><operator>.</operator><name>COORDINATOR_ACTION</name></name></expr></argument>, <argument><expr><name>log</name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
                    <if_stmt><if>if<condition>(<expr><name>slaEvent</name> <operator>!=</operator> <literal type="null">null</literal></expr>)</condition> <block>{<block_content>
                        <expr_stmt><expr><call><name><name>insertList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>slaEvent</name></expr></argument>)</argument_list></call></expr>;</expr_stmt> <comment type="line">//Update SLA events</comment>
                    </block_content>}</block></if></if_stmt>
                    <try>try <block>{<block_content>
                        <comment type="line">// call JPAExecutor to do the bulk writes</comment>
                        <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>BulkUpdateInsertForCoordActionStartJPAExecutor</name><argument_list>(<argument><expr><name>updateList</name></expr></argument>, <argument><expr><name>insertList</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                     </block_content>}</block></try>
                    <if_stmt><else>else <block>{<block_content>
                        <expr_stmt><expr><call><name><name>log</name><operator>.</operator><name>error</name></name><argument_list>(<argument><expr><name><name>ErrorCode</name><operator>.</operator><name>E0610</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                    <catch>catch <parameter_list>(<parameter><decl><type><name>JPAExecutorException</name></type> <name>je</name></decl></parameter>)</parameter_list> <block>{<block_content>
                        <throw>throw <expr><operator>new</operator> <call><name>CommandException</name><argument_list>(<argument><expr><name>je</name></expr></argument>)</argument_list></call></expr>;</throw>
                     </block_content>}</block></catch>
                    <expr_stmt><expr><call><name><name>SLADbOperations</name><operator>.</operator><name>writeStausEvent</name></name><argument_list>(<argument><expr><call><name><name>coordAction</name><operator>.</operator><name>getSlaXml</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><call><name><name>coordAction</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><name><name>Status</name><operator>.</operator><name>FAILED</name></name></expr></argument>,
                            <argument><expr><name><name>SlaAppType</name><operator>.</operator><name>COORDINATOR_ACTION</name></name></expr></argument>, <argument><expr><name>log</name></expr></argument>)</argument_list></call></expr>;</expr_stmt> <comment type="line">//Update SLA events</comment>
                     <expr_stmt><expr><call><name>queue</name><argument_list>(<argument><expr><operator>new</operator> <call><name>CoordActionReadyXCommand</name><argument_list>(<argument><expr><call><name><name>coordAction</name><operator>.</operator><name>getJobId</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                 </block_content>}</block></else></if_stmt>
             </block_content>}</block></if></if_stmt>
<expr_stmt><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>coord</name><operator>/</operator><name><name>CoordActionUpdateXCommand</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>coord</name><operator>/</operator><name><name>CoordActionUpdateXCommand</name><operator>.</operator><name>java</name></name>
<name>index</name> <literal type="number">1235afe3a</literal><operator>..</operator><literal type="number">6e3591fa7</literal> <literal type="number">100644</literal>
<operator>--</operator> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>coord</name><operator>/</operator><name><name>CoordActionUpdateXCommand</name><operator>.</operator><name>java</name></name>
<operator>++</operator> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>coord</name><operator>/</operator><name><name>CoordActionUpdateXCommand</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">17</literal></expr><operator>,</operator><expr><literal type="number">11</literal> <operator>+</operator><literal type="number">17</literal></expr><operator>,</operator><expr><literal type="number">13</literal> @@
  <operator>*</operator><operator>/</operator></expr></expr_stmt>
 <package>package <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>coord</name></name>;</package>
 
<import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>ArrayList</name></name>;</import>
 <import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>Date</name></name>;</import>
<import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>List</name></name>;</import>
 
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>CoordinatorActionBean</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>CoordinatorJobBean</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>ErrorCode</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>SLAEventBean</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>WorkflowJobBean</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>XException</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>JPAService</name></name>;</import>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">32</literal></expr><operator>,</operator><expr><literal type="number">13</literal> <operator>+</operator><literal type="number">34</literal></expr><operator>,</operator><expr><literal type="number">11</literal> @@</expr></expr_stmt> <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>CoordinatorAction</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>WorkflowJob</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>SLAEvent</name><operator>.</operator><name>SlaAppType</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>SLAEvent</name><operator>.</operator><name>Status</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>rest</name><operator>.</operator><name>JsonBean</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>CommandException</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>PreconditionException</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>BulkUpdateInsertForCoordActionStatusJPAExecutor</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>CoordActionGetForExternalIdJPAExecutor</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>CoordActionUpdateJPAExecutor</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>CoordActionUpdateStatusJPAExecutor</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>CoordJobGetJPAExecutor</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>CoordJobUpdateJPAExecutor</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>JPAExecutorException</name></name>;</import>
 
 <class><specifier>public</specifier> class <name>CoordActionUpdateXCommand</name> <super_list><extends>extends <super><name><name>CoordinatorXCommand</name><argument_list type="generic">&lt;<argument><name>Void</name></argument>&gt;</argument_list></name></super></extends></super_list> <block>{
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">46</literal></expr><operator>,</operator><expr><literal type="number">6</literal> <operator>+</operator><literal type="number">46</literal></expr><operator>,</operator><expr><literal type="number">8</literal> @@ <specifier>public</specifier> <name>class</name> <name>CoordActionUpdateXCommand</name> extends <name><name>CoordinatorXCommand</name><argument_list type="generic">&lt;<argument><name>Void</name></argument>&gt;</argument_list></name> <block>{
     <expr><specifier>private</specifier> <name>CoordinatorActionBean</name> <name>coordAction</name> <operator>=</operator> <literal type="null">null</literal></expr>;
     <specifier>private</specifier> <name>JPAService</name> <name>jpaService</name> <operator>=</operator> <literal type="null">null</literal></block></expr>;</expr_stmt>
     <decl_stmt><decl><type><specifier>private</specifier> <name>int</name></type> <name>maxRetries</name> <init>= <expr><literal type="number">1</literal></expr></init></decl>;</decl_stmt>
    <decl_stmt><decl><type><specifier>private</specifier> <name><name>List</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name></type> <name>updateList</name> <init>= <expr><operator>new</operator> <call><name><name>ArrayList</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
    <decl_stmt><decl><type><specifier>private</specifier> <name><name>List</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name></type> <name>insertList</name> <init>= <expr><operator>new</operator> <call><name><name>ArrayList</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
 
     <constructor><specifier>public</specifier> <name>CoordActionUpdateXCommand</name><parameter_list>(<parameter><decl><type><name>WorkflowJobBean</name></type> <name>workflow</name></decl></parameter>)</parameter_list> <block>{<block_content>
         <expr_stmt><expr><call><name>super</name><argument_list>(<argument><expr><literal type="string">"coord-action-update"</literal></expr></argument>, <argument><expr><literal type="string">"coord-action-update"</literal></expr></argument>, <argument><expr><literal type="number">1</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">93</literal></expr><operator>,</operator><expr><literal type="number">7</literal> <operator>+</operator><literal type="number">95</literal></expr><operator>,</operator><expr><literal type="number">8</literal> @@ <specifier>public</specifier> <name>class</name> <name>CoordActionUpdateXCommand</name> extends <name><name>CoordinatorXCommand</name><argument_list type="generic">&lt;<argument><name>Void</name></argument>&gt;</argument_list></name> <block>{
                 <expr><call><name><name>LOG</name><operator>.</operator><name>warn</name></name><argument_list>(<argument><expr><literal type="string">"Unexpected workflow "</literal> <operator>+</operator> <call><name><name>workflow</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call> <operator>+</operator> <literal type="string">" STATUS "</literal> <operator>+</operator> <call><name><name>workflow</name><operator>.</operator><name>getStatus</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;
                 <comment type="line">// update lastModifiedTime</comment>
                 <call><name><name>coordAction</name><operator>.</operator><name>setLastModifiedTime</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>Date</name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></block></expr>;</expr_stmt>
                <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>CoordActionUpdateStatusJPAExecutor</name><argument_list>(<argument><expr><name>coordAction</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                <expr_stmt><expr><call><name><name>updateList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>coordAction</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>BulkUpdateInsertForCoordActionStatusJPAExecutor</name><argument_list>(<argument><expr><name>updateList</name></expr></argument>, <argument><expr><literal type="null">null</literal></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                 <comment type="line">// TODO - Uncomment this when bottom up rerun can change terminal state</comment>
                 <comment type="block">/* CoordinatorJobBean coordJob = jpaService.execute(new CoordJobGetJPAExecutor(coordAction.getJobId()));
                 if (!coordJob.isPending()) {
@@ -107,7 +110,7 @@ public class CoordActionUpdateXCommand extends CoordinatorXCommand&lt;Void&gt; {
                     + " to " + coordAction.getStatus() + ", pending = " + coordAction.getPending());
 
             coordAction.setLastModifiedTime(new Date());
            jpaService.execute(new CoordActionUpdateStatusJPAExecutor(coordAction));
            updateList.add(coordAction);
             // TODO - Uncomment this when bottom up rerun can change terminal state
             /*CoordinatorJobBean coordJob = jpaService.execute(new CoordJobGetJPAExecutor(coordAction.getJobId()));
             if (!coordJob.isPending()) {
@@ -116,13 +119,19 @@ public class CoordActionUpdateXCommand extends CoordinatorXCommand&lt;Void&gt; {
                 LOG.info("Updating Coordinator job "+ coordJob.getId() + "pending to true");
             }*/</comment>
             <if_stmt><if>if <condition>(<expr><name>slaStatus</name> <operator>!=</operator> <literal type="null">null</literal></expr>)</condition> <block>{<block_content>
                <expr_stmt><expr><call><name><name>SLADbOperations</name><operator>.</operator><name>writeStausEvent</name></name><argument_list>(<argument><expr><call><name><name>coordAction</name><operator>.</operator><name>getSlaXml</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><call><name><name>coordAction</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><name>slaStatus</name></expr></argument>,
                <argument><expr><name>SLAEventBean</name> <name>slaEvent</name> <operator>=</operator> <call><name><name>SLADbOperations</name><operator>.</operator><name>createStatusEvent</name></name><argument_list>(<argument><expr><call><name><name>coordAction</name><operator>.</operator><name>getSlaXml</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><call><name><name>coordAction</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><name>slaStatus</name></expr></argument>,
                         <argument><expr><name><name>SlaAppType</name><operator>.</operator><name>COORDINATOR_ACTION</name></name></expr></argument>, <argument><expr><name>LOG</name></expr></argument>)</argument_list></call></expr></argument>;</argument_list></call></expr></expr_stmt>
                <if_stmt><if>if<condition>(<expr><name>slaEvent</name> <operator>!=</operator> <literal type="null">null</literal></expr>)</condition> <block>{<block_content>
                    <expr_stmt><expr><call><name><name>insertList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>slaEvent</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                </block_content>}</block></if></if_stmt>
             </block_content>}</block></if></if_stmt>
             <if_stmt><if>if <condition>(<expr><call><name><name>workflow</name><operator>.</operator><name>getStatus</name></name><argument_list>()</argument_list></call> <operator>!=</operator> <name><name>WorkflowJob</name><operator>.</operator><name>Status</name><operator>.</operator><name>SUSPENDED</name></name>
                     <operator>&amp;&amp;</operator> <call><name><name>workflow</name><operator>.</operator><name>getStatus</name></name><argument_list>()</argument_list></call> <operator>!=</operator> <name><name>WorkflowJob</name><operator>.</operator><name>Status</name><operator>.</operator><name>RUNNING</name></name></expr>)</condition> <block>{<block_content>
                 <expr_stmt><expr><call><name>queue</name><argument_list>(<argument><expr><operator>new</operator> <call><name>CoordActionReadyXCommand</name><argument_list>(<argument><expr><call><name><name>coordAction</name><operator>.</operator><name>getJobId</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
             </block_content>}</block></if></if_stmt>

            <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>BulkUpdateInsertForCoordActionStatusJPAExecutor</name><argument_list>(<argument><expr><name>updateList</name></expr></argument>, <argument><expr><name>insertList</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>

             <expr_stmt><expr><call><name><name>LOG</name><operator>.</operator><name>debug</name></name><argument_list>(<argument><expr><literal type="string">"ENDED CoordActionUpdateXCommand for wfId="</literal> <operator>+</operator> <call><name><name>workflow</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
         </block_content>}</block></constructor>
         <catch>catch <parameter_list>(<parameter><decl><type><name>XException</name></type> <name>ex</name></decl></parameter>)</parameter_list> <block>{<block_content>
<expr_stmt><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>coord</name><operator>/</operator><name><name>CoordChangeXCommand</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>coord</name><operator>/</operator><name><name>CoordChangeXCommand</name><operator>.</operator><name>java</name></name>
<name>index</name> <literal type="number">8c7a35823</literal><operator>..</operator><literal type="number">1e88c7be6</literal> <literal type="number">100644</literal>
<operator>--</operator> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>coord</name><operator>/</operator><name><name>CoordChangeXCommand</name><operator>.</operator><name>java</name></name>
<operator>++</operator> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>coord</name><operator>/</operator><name><name>CoordChangeXCommand</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">17</literal></expr><operator>,</operator><expr><literal type="number">27</literal> <operator>+</operator><literal type="number">17</literal></expr><operator>,</operator><expr><literal type="number">31</literal> @@
  <operator>*</operator><operator>/</operator></expr></expr_stmt>
 <package>package <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>coord</name></name>;</package>
 
<import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>ArrayList</name></name>;</import>
 <import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>Calendar</name></name>;</import>
 <import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>Date</name></name>;</import>
 <import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>HashSet</name></name>;</import>
<import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>List</name></name>;</import>
 <import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>Map</name></name>;</import>
 <import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>Map</name><operator>.</operator><name>Entry</name></name>;</import>
 <import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>Set</name></name>;</import>
 
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>CoordinatorActionBean</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>CoordinatorJobBean</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>ErrorCode</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>XException</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>CoordinatorJob</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>Job</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>OozieClient</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>rest</name><operator>.</operator><name>JsonBean</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>CommandException</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>PreconditionException</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>bundle</name><operator>.</operator><name>BundleStatusUpdateXCommand</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>coord</name><operator>.</operator><name>TimeUnit</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>CoordActionRemoveJPAExecutor</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>BulkUpdateDeleteJPAExecutor</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>CoordActionGetJPAExecutor</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>CoordJobGetActionByActionNumberJPAExecutor</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>CoordJobGetJPAExecutor</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>CoordJobUpdateJPAExecutor</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>JPAExecutorException</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>JPAService</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>Services</name></name>;</import>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">57</literal></expr><operator>,</operator><expr><literal type="number">6</literal> <operator>+</operator><literal type="number">61</literal></expr><operator>,</operator><expr><literal type="number">8</literal> @@ <specifier>public</specifier> <name>class</name> <name>CoordChangeXCommand</name> extends <name><name>CoordinatorXCommand</name><argument_list type="generic">&lt;<argument><name>Void</name></argument>&gt;</argument_list></name> <block>{
     <expr><specifier>private</specifier> <name>CoordinatorJobBean</name> <name>coordJob</name></expr>;
     <specifier>private</specifier> <name>JPAService</name> <name>jpaService</name> <operator>=</operator> <literal type="null">null</literal></block></expr>;</expr_stmt>
     <decl_stmt><decl><type><specifier>private</specifier> <name><name>Job</name><operator>.</operator><name>Status</name></name></type> <name>prevStatus</name></decl>;</decl_stmt>
    <decl_stmt><decl><type><specifier>private</specifier> <name><name>List</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name></type> <name>updateList</name> <init>= <expr><operator>new</operator> <call><name><name>ArrayList</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
    <decl_stmt><decl><type><specifier>private</specifier> <name><name>List</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name></type> <name>deleteList</name> <init>= <expr><operator>new</operator> <call><name><name>ArrayList</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
 
     <decl_stmt><decl><type><specifier>private</specifier> <specifier>static</specifier> <specifier>final</specifier> <name><name>Set</name><argument_list type="generic">&lt;<argument><name>String</name></argument>&gt;</argument_list></name></type> <name>ALLOWED_CHANGE_OPTIONS</name> <init>= <expr><operator>new</operator> <call><name><name>HashSet</name><argument_list type="generic">&lt;<argument><name>String</name></argument>&gt;</argument_list></name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
     <static>static <block>{<block_content>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">250</literal></expr><operator>,</operator><expr><literal type="number">7</literal> <operator>+</operator><literal type="number">256</literal></expr><operator>,</operator><expr><literal type="number">8</literal> @@ <specifier>public</specifier> <name>class</name> <name>CoordChangeXCommand</name> extends <name><name>CoordinatorXCommand</name><argument_list type="generic">&lt;<argument><name>Void</name></argument>&gt;</argument_list></name> <block>{
     <expr><specifier>private</specifier> <name>void</name> <call><name>deleteAction</name><argument_list>(<argument><expr><name>int</name> <name>actionNum</name></expr></argument>)</argument_list></call> <throws>throws <argument><expr><name>CommandException</name> <block>{</block></expr></argument></throws></expr>
         <try>try <block>{<block_content>
             <decl_stmt><decl><type><name>String</name></type> <name>actionId</name> <init>= <expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>CoordJobGetActionByActionNumberJPAExecutor</name><argument_list>(<argument><expr><name>jobId</name></expr></argument>, <argument><expr><name>actionNum</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
            <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>CoordActionRemoveJPAExecutor</name><argument_list>(<argument><expr><name>actionId</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <decl_stmt><decl><type><name>CoordinatorActionBean</name></type> <name>bean</name> <init>= <expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>CoordActionGetJPAExecutor</name><argument_list>(<argument><expr><name>actionId</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
            <expr_stmt><expr><call><name><name>deleteList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>bean</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
         </block_content>}</block> <catch>catch <parameter_list>(<parameter><decl><type><name>JPAExecutorException</name></type> <name>e</name></decl></parameter>)</parameter_list> <block>{<block_content>
             <throw>throw <expr><operator>new</operator> <call><name>CommandException</name><argument_list>(<argument><expr><name>e</name></expr></argument>)</argument_list></call></expr>;</throw>
         </block_content>}</block></catch></try>
@@ <operator>-</operator><literal type="number">340</literal><operator>,</operator><literal type="number">7</literal> <operator>+</operator><literal type="number">347</literal><operator>,</operator><literal type="number">8</literal> @@ <specifier>public</specifier> <name>class</name> <name>CoordChangeXCommand</name> extends <name><name>CoordinatorXCommand</name><argument_list type="generic">&lt;<argument><name>Void</name></argument>&gt;</argument_list></name> <block>{
                 <expr><call><name><name>coordJob</name><operator>.</operator><name>setDoneMaterialization</name></name><argument_list>()</argument_list></call></expr>;
             }</block>
 
            <call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>CoordJobUpdateJPAExecutor</name><argument_list>(<argument><expr><name><name>this</name><operator>.</operator><name>coordJob</name></name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></block></expr>;</expr_stmt>
            <expr_stmt><expr><call><name><name>updateList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>coordJob</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>BulkUpdateDeleteJPAExecutor</name><argument_list>(<argument><expr><name>updateList</name></expr></argument>, <argument><expr><name>deleteList</name></expr></argument>, <argument><expr><literal type="boolean">false</literal></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
 
             <return>return <expr><literal type="null">null</literal></expr>;</return>
         </block_content>}</block></static>
<expr_stmt><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>coord</name><operator>/</operator><name><name>CoordKillXCommand</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>coord</name><operator>/</operator><name><name>CoordKillXCommand</name><operator>.</operator><name>java</name></name>
<name>index</name> <name>e3da88c7d</name><operator>..</operator><literal type="number">7ce4dfcd6</literal> <literal type="number">100644</literal>
<operator>--</operator> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>coord</name><operator>/</operator><name><name>CoordKillXCommand</name><operator>.</operator><name>java</name></name>
<operator>++</operator> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>coord</name><operator>/</operator><name><name>CoordKillXCommand</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">28</literal></expr><operator>,</operator><expr><literal type="number">10</literal> <operator>+</operator><literal type="number">28</literal></expr><operator>,</operator><expr><literal type="number">9</literal> @@</expr></expr_stmt> <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>wf</name><operator>.</operator><name>KillXCommand</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>CommandException</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>KillTransitionXCommand</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>PreconditionException</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>CoordActionUpdateStatusJPAExecutor</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>BulkUpdateInsertJPAExecutor</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>CoordJobGetActionsNotCompletedJPAExecutor</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>CoordJobGetJPAExecutor</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>CoordJobUpdateJPAExecutor</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>JPAExecutorException</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>JPAService</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>Services</name></name>;</import>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">102</literal></expr><operator>,</operator><expr><literal type="number">7</literal> <operator>+</operator><literal type="number">101</literal></expr><operator>,</operator><expr><literal type="number">7</literal> @@ <specifier>public</specifier> <name>class</name> <name>CoordKillXCommand</name> extends <name>KillTransitionXCommand</name> <block>{
         }</block></expr></expr_stmt>
     </block_content>}</block></catch>
 
    <function><type><specifier>private</specifier> <name>void</name></type> <name>updateCoordAction</name><parameter_list>(<parameter><decl><type><name>CoordinatorActionBean</name></type> <name>action</name></decl></parameter>, <parameter><decl><type><name>boolean</name></type> <name>makePending</name></decl></parameter>)</parameter_list> <throws>throws <argument><expr><name>CommandException</name></expr></argument></throws> <block>{<block_content>
    <function><type><specifier>private</specifier> <name>void</name></type> <name>updateCoordAction</name><parameter_list>(<parameter><decl><type><name>CoordinatorActionBean</name></type> <name>action</name></decl></parameter>, <parameter><decl><type><name>boolean</name></type> <name>makePending</name></decl></parameter>)</parameter_list> <block>{<block_content>
         <expr_stmt><expr><call><name><name>action</name><operator>.</operator><name>setStatus</name></name><argument_list>(<argument><expr><name><name>CoordinatorActionBean</name><operator>.</operator><name>Status</name><operator>.</operator><name>KILLED</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
         <if_stmt><if>if <condition>(<expr><name>makePending</name></expr>)</condition> <block>{<block_content>
             <expr_stmt><expr><call><name><name>action</name><operator>.</operator><name>incrementAndGetPending</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">111</literal></expr><operator>,</operator><expr><literal type="number">43</literal> <operator>+</operator><literal type="number">110</literal></expr><operator>,</operator><expr><literal type="number">34</literal> @@ <specifier>public</specifier> <name>class</name> <name>CoordKillXCommand</name> extends <name>KillTransitionXCommand</name> <block>{
             <expr><call><name><name>action</name><operator>.</operator><name>setPending</name></name><argument_list>(<argument><expr><literal type="number">0</literal></expr></argument>)</argument_list></call></expr>;
         }</block></expr></expr_stmt>
         <expr_stmt><expr><call><name><name>action</name><operator>.</operator><name>setLastModifiedTime</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>Date</name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <try>try <block>{<block_content>
            <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>CoordActionUpdateStatusJPAExecutor</name><argument_list>(<argument><expr><name>action</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        </block_content>}</block> <catch>catch <parameter_list>(<parameter><decl><type><name>JPAExecutorException</name></type> <name>e</name></decl></parameter>)</parameter_list> <block>{<block_content>
            <throw>throw <expr><operator>new</operator> <call><name>CommandException</name><argument_list>(<argument><expr><name>e</name></expr></argument>)</argument_list></call></expr>;</throw>
        </block_content>}</block></catch></try>
        <expr_stmt><expr><call><name><name>updateList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>action</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
     </block_content>}</block></if></if_stmt>
 
     <function><annotation>@<name>Override</name></annotation>
     <type><specifier>public</specifier> <name>void</name></type> <name>killChildren</name><parameter_list>()</parameter_list> <throws>throws <argument><expr><name>CommandException</name></expr></argument></throws> <block>{<block_content>
        <try>try <block>{<block_content>
            <if_stmt><if>if <condition>(<expr><name>actionList</name> <operator>!=</operator> <literal type="null">null</literal></expr>)</condition> <block>{<block_content>
                <for>for <control>(<init><decl><type><name>CoordinatorActionBean</name></type> <name>action</name> <range>: <expr><name>actionList</name></expr></range></decl></init>)</control> <block>{<block_content>
                    <comment type="line">// queue a WorkflowKillXCommand to delete the workflow job and actions</comment>
                    <if_stmt><if>if <condition>(<expr><call><name><name>action</name><operator>.</operator><name>getExternalId</name></name><argument_list>()</argument_list></call> <operator>!=</operator> <literal type="null">null</literal></expr>)</condition> <block>{<block_content>
                        <expr_stmt><expr><call><name>queue</name><argument_list>(<argument><expr><operator>new</operator> <call><name>KillXCommand</name><argument_list>(<argument><expr><call><name><name>action</name><operator>.</operator><name>getExternalId</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                        <comment type="line">// As the kill command for children is queued, set pending flag for coord action to be true</comment>
                        <expr_stmt><expr><call><name>updateCoordAction</name><argument_list>(<argument><expr><name>action</name></expr></argument>, <argument><expr><literal type="boolean">true</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                        <expr_stmt><expr><call><name><name>LOG</name><operator>.</operator><name>debug</name></name><argument_list>(
                                <argument><expr><literal type="string">"Killed coord action = [{0}], new status = [{1}], pending = [{2}] and queue KillXCommand for [{3}]"</literal></expr></argument>,
                                <argument><expr><call><name><name>action</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><call><name><name>action</name><operator>.</operator><name>getStatus</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><call><name><name>action</name><operator>.</operator><name>getPending</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><call><name><name>action</name><operator>.</operator><name>getExternalId</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                    </block_content>}</block></if>
                    <else>else <block>{<block_content>
                        <comment type="line">// As killing children is not required, set pending flag for coord action to be false</comment>
                        <expr_stmt><expr><call><name>updateCoordAction</name><argument_list>(<argument><expr><name>action</name></expr></argument>, <argument><expr><literal type="boolean">false</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                        <expr_stmt><expr><call><name><name>LOG</name><operator>.</operator><name>debug</name></name><argument_list>(<argument><expr><literal type="string">"Killed coord action = [{0}], current status = [{1}], pending = [{2}]"</literal></expr></argument>,
                                <argument><expr><call><name><name>action</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><call><name><name>action</name><operator>.</operator><name>getStatus</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><call><name><name>action</name><operator>.</operator><name>getPending</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                    </block_content>}</block></else></if_stmt>
        <if_stmt><if>if <condition>(<expr><name>actionList</name> <operator>!=</operator> <literal type="null">null</literal></expr>)</condition> <block>{<block_content>
            <for>for <control>(<init><decl><type><name>CoordinatorActionBean</name></type> <name>action</name> <range>: <expr><name>actionList</name></expr></range></decl></init>)</control> <block>{<block_content>
                <comment type="line">// queue a WorkflowKillXCommand to delete the workflow job and actions</comment>
                <if_stmt><if>if <condition>(<expr><call><name><name>action</name><operator>.</operator><name>getExternalId</name></name><argument_list>()</argument_list></call> <operator>!=</operator> <literal type="null">null</literal></expr>)</condition> <block>{<block_content>
                    <expr_stmt><expr><call><name>queue</name><argument_list>(<argument><expr><operator>new</operator> <call><name>KillXCommand</name><argument_list>(<argument><expr><call><name><name>action</name><operator>.</operator><name>getExternalId</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                    <comment type="line">// As the kill command for children is queued, set pending flag for coord action to be true</comment>
                    <expr_stmt><expr><call><name>updateCoordAction</name><argument_list>(<argument><expr><name>action</name></expr></argument>, <argument><expr><literal type="boolean">true</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                    <expr_stmt><expr><call><name><name>LOG</name><operator>.</operator><name>debug</name></name><argument_list>(
                            <argument><expr><literal type="string">"Killed coord action = [{0}], new status = [{1}], pending = [{2}] and queue KillXCommand for [{3}]"</literal></expr></argument>,
                            <argument><expr><call><name><name>action</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><call><name><name>action</name><operator>.</operator><name>getStatus</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><call><name><name>action</name><operator>.</operator><name>getPending</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><call><name><name>action</name><operator>.</operator><name>getExternalId</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                </block_content>}</block></if>
                <else>else <block>{<block_content>
                    <comment type="line">// As killing children is not required, set pending flag for coord action to be false</comment>
                    <expr_stmt><expr><call><name>updateCoordAction</name><argument_list>(<argument><expr><name>action</name></expr></argument>, <argument><expr><literal type="boolean">false</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                    <expr_stmt><expr><call><name><name>LOG</name><operator>.</operator><name>debug</name></name><argument_list>(<argument><expr><literal type="string">"Killed coord action = [{0}], current status = [{1}], pending = [{2}]"</literal></expr></argument>,
                            <argument><expr><call><name><name>action</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><call><name><name>action</name><operator>.</operator><name>getStatus</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><call><name><name>action</name><operator>.</operator><name>getPending</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                 </block_content>}</block></else></if_stmt>
             </block_content>}</block></for>
        </block_content>}</block></if></if_stmt>
 
            <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>CoordJobUpdateJPAExecutor</name><argument_list>(<argument><expr><name>coordJob</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>updateList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>coordJob</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
 
            <expr_stmt><expr><call><name><name>LOG</name><operator>.</operator><name>debug</name></name><argument_list>(<argument><expr><literal type="string">"Killed coord actions for the coordinator=[{0}]"</literal></expr></argument>, <argument><expr><name>jobId</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        </block_content>}</block></for>
        <catch>catch <parameter_list>(<parameter><decl><type><name>JPAExecutorException</name></type> <name>ex</name></decl></parameter>)</parameter_list> <block>{<block_content>
            <throw>throw <expr><operator>new</operator> <call><name>CommandException</name><argument_list>(<argument><expr><name>ex</name></expr></argument>)</argument_list></call></expr>;</throw>
        </block_content>}</block></catch>
        <expr_stmt><expr><call><name><name>LOG</name><operator>.</operator><name>debug</name></name><argument_list>(<argument><expr><literal type="string">"Killed coord actions for the coordinator=[{0}]"</literal></expr></argument>, <argument><expr><name>jobId</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
     </block_content>}</block></if></if_stmt>
 
     <annotation>@<name>Override</name></annotation>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">161</literal></expr><operator>,</operator><expr><literal type="number">11</literal> <operator>+</operator><literal type="number">151</literal></expr><operator>,</operator><expr><literal type="number">19</literal> @@ <specifier>public</specifier> <name>class</name> <name>CoordKillXCommand</name> extends <name>KillTransitionXCommand</name> <block>{
 
     @<expr><name>Override</name>
     <specifier>public</specifier> <name>void</name> <call><name>updateJob</name><argument_list>()</argument_list></call> <throws>throws <argument><expr><name>CommandException</name> <block>{
        <expr><call><name><name>updateList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>coordJob</name></expr></argument>)</argument_list></call></expr></block></expr></argument></throws></expr>;
    }</block></expr></expr_stmt>

    <comment type="block">/* (non-Javadoc)
     * @see org.apache.oozie.command.KillTransitionXCommand#performWrites()
     */</comment>
    <function><annotation>@<name>Override</name></annotation>
    <type><specifier>public</specifier> <name>void</name></type> <name>performWrites</name><parameter_list>()</parameter_list> <throws>throws <argument><expr><name>CommandException</name></expr></argument></throws> <block>{<block_content>
         <try>try <block>{<block_content>
            <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>CoordJobUpdateJPAExecutor</name><argument_list>(<argument><expr><name>coordJob</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>BulkUpdateInsertJPAExecutor</name><argument_list>(<argument><expr><name>updateList</name></expr></argument>, <argument><expr><literal type="null">null</literal></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
         </block_content>}</block>
        <catch>catch <parameter_list>(<parameter><decl><type><name>JPAExecutorException</name></type> <name>ex</name></decl></parameter>)</parameter_list> <block>{<block_content>
            <throw>throw <expr><operator>new</operator> <call><name>CommandException</name><argument_list>(<argument><expr><name>ex</name></expr></argument>)</argument_list></call></expr>;</throw>
        <catch>catch <parameter_list>(<parameter><decl><type><name>JPAExecutorException</name></type> <name>e</name></decl></parameter>)</parameter_list> <block>{<block_content>
            <throw>throw <expr><operator>new</operator> <call><name>CommandException</name><argument_list>(<argument><expr><name>e</name></expr></argument>)</argument_list></call></expr>;</throw>
         </block_content>}</block></catch>
     </block_content>}</block></catch></try>
 
<expr_stmt><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>coord</name><operator>/</operator><name><name>CoordMaterializeTransitionXCommand</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>coord</name><operator>/</operator><name><name>CoordMaterializeTransitionXCommand</name><operator>.</operator><name>java</name></name>
<name>index</name> <literal type="number">9f8d1f14f</literal><operator>..</operator><name>ec90eb640</name> <literal type="number">100644</literal>
<operator>--</operator> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>coord</name><operator>/</operator><name><name>CoordMaterializeTransitionXCommand</name><operator>.</operator><name>java</name></name>
<operator>++</operator> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>coord</name><operator>/</operator><name><name>CoordMaterializeTransitionXCommand</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">28</literal></expr><operator>,</operator><expr><literal type="number">6</literal> <operator>+</operator><literal type="number">28</literal></expr><operator>,</operator><expr><literal type="number">7</literal> @@</expr></expr_stmt> <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>hadoop</name><operator>.</operator><name>conf</name><operator>.</operator><name>Configuration</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>CoordinatorActionBean</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>CoordinatorJobBean</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>ErrorCode</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>SLAEventBean</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>CoordinatorJob</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>Job</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>SLAEvent</name><operator>.</operator><name>SlaAppType</name></name>;</import>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">36</literal></expr><operator>,</operator><expr><literal type="number">10</literal> <operator>+</operator><literal type="number">37</literal></expr><operator>,</operator><expr><literal type="number">9</literal> @@</expr></expr_stmt> <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>MaterializeTransitionXCommand</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>PreconditionException</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>bundle</name><operator>.</operator><name>BundleStatusUpdateXCommand</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>coord</name><operator>.</operator><name>TimeUnit</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>CoordActionInsertJPAExecutor</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>BulkUpdateInsertJPAExecutor</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>CoordActionsActiveCountJPAExecutor</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>CoordJobGetJPAExecutor</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>CoordJobUpdateJPAExecutor</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>JPAExecutorException</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>JPAService</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>Service</name></name>;</import>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">96</literal></expr><operator>,</operator><expr><literal type="number">8</literal> <operator>+</operator><literal type="number">96</literal></expr><operator>,</operator><expr><literal type="number">16</literal> @@ <specifier>public</specifier> <name>class</name> <name>CoordMaterializeTransitionXCommand</name> extends <name>MaterializeTransitionXCo</name>
      <operator>*</operator><operator>/</operator>
     @<name>Override</name>
     <specifier>public</specifier> <name>void</name> <call><name>updateJob</name><argument_list>()</argument_list></call> <throws>throws <argument><expr><name>CommandException</name> <block>{
        <expr><call><name><name>updateList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>coordJob</name></expr></argument>)</argument_list></call></expr></block></expr></argument></throws></expr>;</expr_stmt>
    </block_content>}</block></function>

    <comment type="block">/* (non-Javadoc)
     * @see org.apache.oozie.command.MaterializeTransitionXCommand#performWrites()
     */</comment>
    <function><annotation>@<name>Override</name></annotation>
    <type><specifier>public</specifier> <name>void</name></type> <name>performWrites</name><parameter_list>()</parameter_list> <throws>throws <argument><expr><name>CommandException</name></expr></argument></throws> <block>{<block_content>
         <try>try <block>{<block_content>
            <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>CoordJobUpdateJPAExecutor</name><argument_list>(<argument><expr><name>coordJob</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>BulkUpdateInsertJPAExecutor</name><argument_list>(<argument><expr><name>updateList</name></expr></argument>, <argument><expr><name>insertList</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
         </block_content>}</block>
         <catch>catch <parameter_list>(<parameter><decl><type><name>JPAExecutorException</name></type> <name>jex</name></decl></parameter>)</parameter_list> <block>{<block_content>
             <throw>throw <expr><operator>new</operator> <call><name>CommandException</name><argument_list>(<argument><expr><name>jex</name></expr></argument>)</argument_list></call></expr>;</throw>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">345</literal></expr><operator>,</operator><expr><literal type="number">7</literal> <operator>+</operator><literal type="number">353</literal></expr><operator>,</operator><expr><literal type="number">7</literal> @@ <specifier>public</specifier> <name>class</name> <name>CoordMaterializeTransitionXCommand</name> extends <name>MaterializeTransitionXCo</name>
                 <operator>+</operator> <call><name><name>actionXml</name><operator>.</operator><name>length</name></name><argument_list>()</argument_list></call></expr></expr_stmt>)</block_content></block><empty_stmt>;</empty_stmt></catch></try>
         <expr_stmt><expr><call><name><name>actionBean</name><operator>.</operator><name>setActionXml</name></name><argument_list>(<argument><expr><name>actionXml</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
 
        <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>CoordActionInsertJPAExecutor</name><argument_list>(<argument><expr><name>actionBean</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>insertList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>actionBean</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
         <expr_stmt><expr><call><name>writeActionRegistration</name><argument_list>(<argument><expr><name>actionXml</name></expr></argument>, <argument><expr><name>actionBean</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
 
         <comment type="line">// TODO: time 100s should be configurable</comment>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">356</literal></expr><operator>,</operator><expr><literal type="number">8</literal> <operator>+</operator><literal type="number">364</literal></expr><operator>,</operator><expr><literal type="number">11</literal> @@ <specifier>public</specifier> <name>class</name> <name>CoordMaterializeTransitionXCommand</name> extends <name>MaterializeTransitionXCo</name>
     <specifier>private</specifier> <name>void</name> <call><name>writeActionRegistration</name><argument_list>(<argument><expr><name>String</name> <name>actionXml</name></expr></argument>, <argument><expr><name>CoordinatorActionBean</name> <name>actionBean</name></expr></argument>)</argument_list></call> <throws>throws <argument><expr><name>Exception</name> <block>{
         <expr><name>Element</name> <name>eAction</name> <operator>=</operator> <call><name><name>XmlUtils</name><operator>.</operator><name>parseXml</name></name><argument_list>(<argument><expr><name>actionXml</name></expr></argument>)</argument_list></call></expr></block></expr></argument></throws></expr>;</expr_stmt>
         <decl_stmt><decl><type><name>Element</name></type> <name>eSla</name> <init>= <expr><call><name><name>eAction</name><operator>.</operator><name>getChild</name></name><argument_list>(<argument><expr><literal type="string">"action"</literal></expr></argument>, <argument><expr><call><name><name>eAction</name><operator>.</operator><name>getNamespace</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call><operator>.</operator><call><name>getChild</name><argument_list>(<argument><expr><literal type="string">"info"</literal></expr></argument>, <argument><expr><call><name><name>eAction</name><operator>.</operator><name>getNamespace</name></name><argument_list>(<argument><expr><literal type="string">"sla"</literal></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name><name>SLADbOperations</name><operator>.</operator><name>writeSlaRegistrationEvent</name></name><argument_list>(<argument><expr><name>eSla</name></expr></argument>, <argument><expr><call><name><name>actionBean</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><name><name>SlaAppType</name><operator>.</operator><name>COORDINATOR_ACTION</name></name></expr></argument>, <argument><expr><name>coordJob</name>
        <name>SLAEventBean</name> <name>slaEvent</name> <operator>=</operator> <call><name><name>SLADbOperations</name><operator>.</operator><name>createSlaRegistrationEvent</name></name><argument_list>(<argument><expr><name>eSla</name></expr></argument>, <argument><expr><call><name><name>actionBean</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><name><name>SlaAppType</name><operator>.</operator><name>COORDINATOR_ACTION</name></name></expr></argument>, <argument><expr><call><name><name>coordJob</name>
                 <operator>.</operator><name>getUser</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><call><name><name>coordJob</name><operator>.</operator><name>getGroup</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><name>LOG</name></expr></argument>)</argument_list></call></expr></argument>;</argument_list></call></expr></expr_stmt>
        <if_stmt><if>if<condition>(<expr><name>slaEvent</name> <operator>!=</operator> <literal type="null">null</literal></expr>)</condition> <block>{<block_content>
            <expr_stmt><expr><call><name><name>insertList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>slaEvent</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        </block_content>}</block></if></if_stmt>
     </block_content>}</block></function>
 
     <function><type><specifier>private</specifier> <name>void</name></type> <name>updateJobMaterializeInfo</name><parameter_list>(<parameter><decl><type><name>CoordinatorJobBean</name></type> <name>job</name></decl></parameter>)</parameter_list> <throws>throws <argument><expr><name>CommandException</name></expr></argument></throws> <block>{<block_content>
<expr_stmt><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>coord</name><operator>/</operator><name><name>CoordPauseXCommand</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>coord</name><operator>/</operator><name><name>CoordPauseXCommand</name><operator>.</operator><name>java</name></name>
<name>index</name> <name>ffa4b1ca1</name><operator>..</operator><literal type="number">34e41fe86</literal> <literal type="number">100644</literal>
<operator>--</operator> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>coord</name><operator>/</operator><name><name>CoordPauseXCommand</name><operator>.</operator><name>java</name></name>
<operator>++</operator> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>coord</name><operator>/</operator><name><name>CoordPauseXCommand</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">111</literal></expr><operator>,</operator><expr><literal type="number">4</literal> <operator>+</operator><literal type="number">111</literal></expr><operator>,</operator><expr><literal type="number">8</literal> @@ <specifier>public</specifier> <name>class</name> <name>CoordPauseXCommand</name> extends <name>PauseTransitionXCommand</name> <block>{
 
     }</block>
 
    @<name>Override</name>
    <specifier>public</specifier> <name>void</name> <call><name>performWrites</name><argument_list>()</argument_list></call> <throws>throws <argument><expr><name>CommandException</name> <block>{
    }</block></expr></argument>

 }
<argument><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>coord</name><operator>/</operator><name><name>CoordPurgeXCommand</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>coord</name><operator>/</operator><name><name>CoordPurgeXCommand</name><operator>.</operator><name>java</name></name>
<name>index</name> <literal type="number">6cb514e1e</literal><operator>..</operator><name>ea9ed76ba</name> <literal type="number">100644</literal>
<operator>--</operator> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>coord</name><operator>/</operator><name><name>CoordPurgeXCommand</name><operator>.</operator><name>java</name></name>
<operator>++</operator> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>coord</name><operator>/</operator><name><name>CoordPurgeXCommand</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">17</literal></expr></argument>,<argument><expr><literal type="number">15</literal> <operator>+</operator><literal type="number">17</literal></expr></argument>,<argument><expr><literal type="number">15</literal> @@
  <operator>*</operator><operator>/</operator></expr></argument></throws></expr></expr_stmt>
 <package>package <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>coord</name></name>;</package>
 
<import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>Collection</name></name>;</import>
 <import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>List</name></name>;</import>
 
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>CoordinatorJobBean</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>ErrorCode</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>XException</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>rest</name><operator>.</operator><name>JsonBean</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>CommandException</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>PreconditionException</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>CoordActionsDeleteForPurgeJPAExecutor</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>CoordJobDeleteJPAExecutor</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>BulkDeleteForPurgeJPAExecutor</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>CoordJobsGetForPurgeJPAExecutor</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>JPAExecutorException</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>JPAService</name></name>;</import>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">38</literal></expr><operator>,</operator><expr><literal type="number">7</literal> <operator>+</operator><literal type="number">38</literal></expr><operator>,</operator><expr><literal type="number">7</literal> @@ <specifier>public</specifier> <name>class</name> <name>CoordPurgeXCommand</name> extends <name><name>CoordinatorXCommand</name><argument_list type="generic">&lt;<argument><name>Void</name></argument>&gt;</argument_list></name> <block>{
     <expr><specifier>private</specifier> <name>JPAService</name> <name>jpaService</name> <operator>=</operator> <literal type="null">null</literal></expr>;
     <specifier>private</specifier> <name>final</name> <name>int</name> <name>olderThan</name></block></expr>;</expr_stmt>
     <decl_stmt><decl><type><specifier>private</specifier> <specifier>final</specifier> <name>int</name></type> <name>limit</name></decl>;</decl_stmt>
    <decl_stmt><decl><type><specifier>private</specifier> <name><name>List</name><argument_list type="generic">&lt;<argument><name>CoordinatorJobBean</name></argument>&gt;</argument_list></name></type> <name>jobList</name> <init>= <expr><literal type="null">null</literal></expr></init></decl>;</decl_stmt>
    <decl_stmt><decl><type><specifier>private</specifier> <name><name>List</name><argument_list type="generic">&lt;<argument><name>?</name> <extends>extends <name>JsonBean</name></extends></argument>&gt;</argument_list></name></type> <name>jobList</name> <init>= <expr><literal type="null">null</literal></expr></init></decl>;</decl_stmt>
 
     <constructor><specifier>public</specifier> <name>CoordPurgeXCommand</name><parameter_list>(<parameter><decl><type><name>int</name></type> <name>olderThan</name></decl></parameter>, <parameter><decl><type><name>int</name></type> <name>limit</name></decl></parameter>)</parameter_list> <block>{<block_content>
         <expr_stmt><expr><call><name>super</name><argument_list>(<argument><expr><literal type="string">"coord_purge"</literal></expr></argument>, <argument><expr><literal type="string">"coord_purge"</literal></expr></argument>, <argument><expr><literal type="number">0</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">55</literal></expr><operator>,</operator><expr><literal type="number">15</literal> <operator>+</operator><literal type="number">55</literal></expr><operator>,</operator><expr><literal type="number">11</literal> @@ <specifier>public</specifier> <name>class</name> <name>CoordPurgeXCommand</name> extends <name><name>CoordinatorXCommand</name><argument_list type="generic">&lt;<argument><name>Void</name></argument>&gt;</argument_list></name> <block>{
 
         <expr><name>int</name> <name>actionDeleted</name> <operator>=</operator> <literal type="number">0</literal></expr>;</block></expr></expr_stmt>
         <if_stmt><if>if <condition>(<expr><name>jobList</name> <operator>!=</operator> <literal type="null">null</literal> <operator>&amp;&amp;</operator> <call><name><name>jobList</name><operator>.</operator><name>size</name></name><argument_list>()</argument_list></call> <operator>!=</operator> <literal type="number">0</literal></expr>)</condition> <block>{<block_content>
            <for>for <control>(<init><decl><type><name>CoordinatorJobBean</name></type> <name>coord</name> <range>: <expr><name>jobList</name></expr></range></decl></init>)</control> <block>{<block_content>
                <decl_stmt><decl><type><name>String</name></type> <name>jobId</name> <init>= <expr><call><name><name>coord</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
                <try>try <block>{<block_content>
                    <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>CoordJobDeleteJPAExecutor</name><argument_list>(<argument><expr><name>jobId</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                    <expr_stmt><expr><name>actionDeleted</name> <operator>+=</operator> <call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>CoordActionsDeleteForPurgeJPAExecutor</name><argument_list>(<argument><expr><name>jobId</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                </block_content>}</block>
                <catch>catch <parameter_list>(<parameter><decl><type><name>JPAExecutorException</name></type> <name>e</name></decl></parameter>)</parameter_list> <block>{<block_content>
                    <throw>throw <expr><operator>new</operator> <call><name>CommandException</name><argument_list>(<argument><expr><name>e</name></expr></argument>)</argument_list></call></expr>;</throw>
                </block_content>}</block></catch></try>
            <try>try <block>{<block_content>
                <expr_stmt><expr><name>actionDeleted</name> <operator>=</operator> <call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>BulkDeleteForPurgeJPAExecutor</name><argument_list>(<argument><expr><operator>(</operator><name><name>Collection</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name><operator>)</operator> <name>jobList</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            </block_content>}</block>
            <catch>catch <parameter_list>(<parameter><decl><type><name>JPAExecutorException</name></type> <name>je</name></decl></parameter>)</parameter_list> <block>{<block_content>
                <throw>throw <expr><operator>new</operator> <call><name>CommandException</name><argument_list>(<argument><expr><name>je</name></expr></argument>)</argument_list></call></expr>;</throw>
             </block_content>}</block></catch></try>
             <expr_stmt><expr><call><name><name>LOG</name><operator>.</operator><name>debug</name></name><argument_list>(<argument><expr><literal type="string">"ENDED Coord-Purge deleted jobs :"</literal> <operator>+</operator> <call><name><name>jobList</name><operator>.</operator><name>size</name></name><argument_list>()</argument_list></call> <operator>+</operator> <literal type="string">" and actions "</literal> <operator>+</operator> <name>actionDeleted</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
         </block_content>}</block></for>
<expr_stmt><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>coord</name><operator>/</operator><name><name>CoordRerunXCommand</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>coord</name><operator>/</operator><name><name>CoordRerunXCommand</name><operator>.</operator><name>java</name></name>
<name>index</name> <name>ce1fff34b</name><operator>..</operator><name>b445e9c1f</name> <literal type="number">100644</literal>
<operator>--</operator> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>coord</name><operator>/</operator><name><name>CoordRerunXCommand</name><operator>.</operator><name>java</name></name>
<operator>++</operator> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>coord</name><operator>/</operator><name><name>CoordRerunXCommand</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">19</literal></expr><operator>,</operator><expr><literal type="number">18</literal> <operator>+</operator><literal type="number">19</literal></expr><operator>,</operator><expr><literal type="number">15</literal> @@</expr></expr_stmt> <package>package <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>coord</name></name>;</package>
 
 <import>import <name><name>java</name><operator>.</operator><name>io</name><operator>.</operator><name>IOException</name></name>;</import>
 <import>import <name><name>java</name><operator>.</operator><name>io</name><operator>.</operator><name>StringReader</name></name>;</import>
<import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>ArrayList</name></name>;</import>
 <import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>Date</name></name>;</import>
<import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>HashSet</name></name>;</import>
 <import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>List</name></name>;</import>
<import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>Set</name></name>;</import>

 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>hadoop</name><operator>.</operator><name>conf</name><operator>.</operator><name>Configuration</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>hadoop</name><operator>.</operator><name>fs</name><operator>.</operator><name>Path</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>CoordinatorActionBean</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>CoordinatorActionInfo</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>CoordinatorJobBean</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>ErrorCode</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>SLAEventBean</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>XException</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>action</name><operator>.</operator><name>ActionExecutorException</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>action</name><operator>.</operator><name>hadoop</name><operator>.</operator><name>FsActionExecutor</name></name>;</import>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">45</literal></expr><operator>,</operator><expr><literal type="number">15</literal> <operator>+</operator><literal type="number">42</literal></expr><operator>,</operator><expr><literal type="number">11</literal> @@</expr></expr_stmt> <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>RerunTransitionXCommand</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>bundle</name><operator>.</operator><name>BundleStatusUpdateXCommand</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>coord</name><operator>.</operator><name>CoordELFunctions</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>coord</name><operator>.</operator><name>CoordUtils</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>CoordActionGetJPAExecutor</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>CoordJobGetActionForNominalTimeJPAExecutor</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>CoordJobGetActionsForDatesJPAExecutor</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>BulkUpdateInsertJPAExecutor</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>CoordJobGetJPAExecutor</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>CoordJobUpdateJPAExecutor</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>JPAExecutorException</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>JPAService</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>Services</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>util</name><operator>.</operator><name>DateUtils</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>util</name><operator>.</operator><name>InstrumentUtils</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>util</name><operator>.</operator><name>LogUtils</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>util</name><operator>.</operator><name>ParamChecker</name></name>;</import>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">224</literal></expr><operator>,</operator><expr><literal type="number">7</literal> <operator>+</operator><literal type="number">217</literal></expr><operator>,</operator><expr><literal type="number">7</literal> @@ <specifier>public</specifier> <name>class</name> <name>CoordRerunXCommand</name> extends <name>RerunTransitionXCommand</name><operator>&lt;</operator><name>CoordinatorActio</name>
         <call><name><name>coordAction</name><operator>.</operator><name>setExternalStatus</name></name><argument_list>(<argument><expr><literal type="string">""</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
         <expr_stmt><expr><call><name><name>coordAction</name><operator>.</operator><name>setRerunTime</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>Date</name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
         <expr_stmt><expr><call><name><name>coordAction</name><operator>.</operator><name>setLastModifiedTime</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>Date</name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>CoordActionUpdateJPAExecutor</name></name><argument_list>(<argument><expr><name>coordAction</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>updateList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>coordAction</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
         <expr_stmt><expr><call><name>writeActionRegistration</name><argument_list>(<argument><expr><call><name><name>coordAction</name><operator>.</operator><name>getActionXml</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><name>coordAction</name></expr></argument>, <argument><expr><call><name><name>coordJob</name><operator>.</operator><name>getUser</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><call><name><name>coordJob</name><operator>.</operator><name>getGroup</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
     </block_content>}</block></if></if_stmt>
 
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">241</literal></expr><operator>,</operator><expr><literal type="number">8</literal> <operator>+</operator><literal type="number">234</literal></expr><operator>,</operator><expr><literal type="number">11</literal> @@ <specifier>public</specifier> <name>class</name> <name>CoordRerunXCommand</name> extends <name>RerunTransitionXCommand</name><operator>&lt;</operator><name>CoordinatorActio</name>
             <throws>throws <argument><expr><name>Exception</name> <block>{
         <expr><name>Element</name> <name>eAction</name> <operator>=</operator> <call><name><name>XmlUtils</name><operator>.</operator><name>parseXml</name></name><argument_list>(<argument><expr><name>actionXml</name></expr></argument>)</argument_list></call></expr></block></expr></argument></throws></expr>;</expr_stmt>
         <decl_stmt><decl><type><name>Element</name></type> <name>eSla</name> <init>= <expr><call><name><name>eAction</name><operator>.</operator><name>getChild</name></name><argument_list>(<argument><expr><literal type="string">"action"</literal></expr></argument>, <argument><expr><call><name><name>eAction</name><operator>.</operator><name>getNamespace</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call><operator>.</operator><call><name>getChild</name><argument_list>(<argument><expr><literal type="string">"info"</literal></expr></argument>, <argument><expr><call><name><name>eAction</name><operator>.</operator><name>getNamespace</name></name><argument_list>(<argument><expr><literal type="string">"sla"</literal></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name><name>SLADbOperations</name><operator>.</operator><name>writeSlaRegistrationEvent</name></name><argument_list>(<argument><expr><name>eSla</name></expr></argument>, <argument><expr><call><name><name>actionBean</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><name><name>SlaAppType</name><operator>.</operator><name>COORDINATOR_ACTION</name></name></expr></argument>, <argument><expr><name>user</name></expr></argument>, <argument><expr><name>group</name></expr></argument>,
                <argument><expr><name>LOG</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <decl_stmt><decl><type><name>SLAEventBean</name></type> <name>slaEvent</name> <init>= <expr><call><name><name>SLADbOperations</name><operator>.</operator><name>createSlaRegistrationEvent</name></name><argument_list>(<argument><expr><name>eSla</name></expr></argument>, <argument><expr><call><name><name>actionBean</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>,
                <argument><expr><name><name>SlaAppType</name><operator>.</operator><name>COORDINATOR_ACTION</name></name></expr></argument>, <argument><expr><name>user</name></expr></argument>, <argument><expr><name>group</name></expr></argument>, <argument><expr><name>LOG</name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <if_stmt><if>if<condition>(<expr><name>slaEvent</name> <operator>!=</operator> <literal type="null">null</literal></expr>)</condition> <block>{<block_content>
            <expr_stmt><expr><call><name><name>insertList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>slaEvent</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        </block_content>}</block></if></if_stmt>
     </block_content>}</block></constructor>
 
     <comment type="block">/* (non-Javadoc)
@@ -374,26 +370,32 @@ public class CoordRerunXCommand extends RerunTransitionXCommand&lt;CoordinatorActio
     }
 
     @Override
    public void updateJob() throws CommandException {
        try {
            // rerun a paused coordinator job will keep job status at paused and pending at previous pending

            if (getPrevStatus()!= null){
                Job.Status coordJobStatus = getPrevStatus();
                if(coordJobStatus.equals(Job.Status.PAUSED) || coordJobStatus.equals(Job.Status.PAUSEDWITHERROR)) {
                    coordJob.setStatus(coordJobStatus);
                }
                if (prevPending) {
                    coordJob.setPending();
                } else {
                    coordJob.resetPending();
                }
    public void updateJob() {
        if (getPrevStatus()!= null){
            Job.Status coordJobStatus = getPrevStatus();
            if(coordJobStatus.equals(Job.Status.PAUSED) || coordJobStatus.equals(Job.Status.PAUSEDWITHERROR)) {
                coordJob.setStatus(coordJobStatus);
             }
            if (prevPending) {
                coordJob.setPending();
            } else {
                coordJob.resetPending();
            }
        }
 
            jpaService.execute(new CoordJobUpdateJPAExecutor(coordJob));
        updateList.add(coordJob);
    }

    /* (non-Javadoc)
     * @see org.apache.oozie.command.RerunTransitionXCommand#performWrites()
     */</comment>
    <function><annotation>@<name>Override</name></annotation>
    <type><specifier>public</specifier> <name>void</name></type> <name>performWrites</name><parameter_list>()</parameter_list> <throws>throws <argument><expr><name>CommandException</name></expr></argument></throws> <block>{<block_content>
        <try>try <block>{<block_content>
            <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>BulkUpdateInsertJPAExecutor</name><argument_list>(<argument><expr><name>updateList</name></expr></argument>, <argument><expr><name>insertList</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
         </block_content>}</block>
        <catch>catch <parameter_list>(<parameter><decl><type><name>JPAExecutorException</name></type> <name>je</name></decl></parameter>)</parameter_list> <block>{<block_content>
            <throw>throw <expr><operator>new</operator> <call><name>CommandException</name><argument_list>(<argument><expr><name>je</name></expr></argument>)</argument_list></call></expr>;</throw>
        <catch>catch <parameter_list>(<parameter><decl><type><name>JPAExecutorException</name></type> <name>e</name></decl></parameter>)</parameter_list> <block>{<block_content>
            <throw>throw <expr><operator>new</operator> <call><name>CommandException</name><argument_list>(<argument><expr><name>e</name></expr></argument>)</argument_list></call></expr>;</throw>
         </block_content>}</block></catch>
     </block_content>}</block></catch></try>
 
<expr_stmt><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>coord</name><operator>/</operator><name><name>CoordResumeXCommand</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>coord</name><operator>/</operator><name><name>CoordResumeXCommand</name><operator>.</operator><name>java</name></name>
<name>index</name> <name>a684bc969</name><operator>..</operator><name>da00389e3</name> <literal type="number">100644</literal>
<operator>--</operator> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>coord</name><operator>/</operator><name><name>CoordResumeXCommand</name><operator>.</operator><name>java</name></name>
<operator>++</operator> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>coord</name><operator>/</operator><name><name>CoordResumeXCommand</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">31</literal></expr><operator>,</operator><expr><literal type="number">10</literal> <operator>+</operator><literal type="number">31</literal></expr><operator>,</operator><expr><literal type="number">9</literal> @@</expr></expr_stmt> <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>PreconditionException</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>ResumeTransitionXCommand</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>bundle</name><operator>.</operator><name>BundleStatusUpdateXCommand</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>wf</name><operator>.</operator><name>ResumeXCommand</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>CoordActionUpdateStatusJPAExecutor</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>BulkUpdateInsertForCoordActionStatusJPAExecutor</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>CoordJobGetActionsSuspendedJPAExecutor</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>CoordJobGetJPAExecutor</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>CoordJobUpdateJPAExecutor</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>JPAExecutorException</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>JPAService</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>Services</name></name>;</import>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">109</literal></expr><operator>,</operator><expr><literal type="number">18</literal> <operator>+</operator><literal type="number">108</literal></expr><operator>,</operator><expr><literal type="number">13</literal> @@ <specifier>public</specifier> <name>class</name> <name>CoordResumeXCommand</name> extends <name>ResumeTransitionXCommand</name> <block>{
      <expr><operator>*</operator> @<name>see</name> <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>TransitionXCommand</name></name><operator>#</operator><call><name>updateJob</name><argument_list>()</argument_list></call>
      <operator>*</operator><operator>/</operator>
     @<name>Override</name>
    <specifier>public</specifier> <name>void</name> <call><name>updateJob</name><argument_list>()</argument_list></call> <throws>throws <argument><expr><name>CommandException</name> <block>{
    <expr><specifier>public</specifier> <name>void</name> <call><name>updateJob</name><argument_list>()</argument_list></call> <block>{
         <expr><call><name><name>InstrumentUtils</name><operator>.</operator><name>incrJobCounter</name></name><argument_list>(<argument><expr><call><name>getName</name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><literal type="number">1</literal></expr></argument>, <argument><expr><call><name>getInstrumentation</name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr></block></expr></block></expr></argument></throws></expr>;
         <call><name><name>coordJob</name><operator>.</operator><name>setSuspendedTime</name></name><argument_list>(<argument><expr><literal type="null">null</literal></expr></argument>)</argument_list></call></block></expr>;</expr_stmt>
         <expr_stmt><expr><call><name><name>coordJob</name><operator>.</operator><name>setLastModifiedTime</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>Date</name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
         <expr_stmt><expr><call><name><name>LOG</name><operator>.</operator><name>debug</name></name><argument_list>(<argument><expr><literal type="string">"Resume coordinator job id = "</literal> <operator>+</operator> <name>jobId</name> <operator>+</operator> <literal type="string">", status = "</literal> <operator>+</operator> <call><name><name>coordJob</name><operator>.</operator><name>getStatus</name></name><argument_list>()</argument_list></call> <operator>+</operator> <literal type="string">", pending = "</literal>
                 <operator>+</operator> <call><name><name>coordJob</name><operator>.</operator><name>isPending</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <try>try <block>{<block_content>
            <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>CoordJobUpdateJPAExecutor</name><argument_list>(<argument><expr><name>coordJob</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        </block_content>}</block>
        <catch>catch <parameter_list>(<parameter><decl><type><name>JPAExecutorException</name></type> <name>e</name></decl></parameter>)</parameter_list> <block>{<block_content>
            <throw>throw <expr><operator>new</operator> <call><name>CommandException</name><argument_list>(<argument><expr><name>e</name></expr></argument>)</argument_list></call></expr>;</throw>
        </block_content>}</block></catch></try>
        <expr_stmt><expr><call><name><name>updateList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>coordJob</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
     </block_content>}</block></function>
 
     <comment type="block">/* (non-Javadoc)
@@ -161,12 +155,7 @@ public class CoordResumeXCommand extends ResumeTransitionXCommand {
                 coordJob.resetPending();
                 LOG.warn("Resume children failed so fail coordinator, coordinator job id = " + jobId + ", status = "
                         + coordJob.getStatus());
                try {
                    jpaService.execute(new CoordJobUpdateJPAExecutor(coordJob));
                }
                catch (JPAExecutorException je) {
                    LOG.error("Failed to update coordinator job : " + jobId, je);
                }
                updateList.add(coordJob);
             }
         }
     }
@@ -183,18 +172,26 @@ public class CoordResumeXCommand extends ResumeTransitionXCommand {
         }
     }
 
    private void updateCoordAction(CoordinatorActionBean action) throws CommandException {
        action.setStatus(CoordinatorActionBean.Status.RUNNING);
        action.incrementAndGetPending();
        action.setLastModifiedTime(new Date());
    /* (non-Javadoc)
     * @see org.apache.oozie.command.ResumeTransitionXCommand#performWrites()
     */</comment>
    <function><annotation>@<name>Override</name></annotation>
    <type><specifier>public</specifier> <name>void</name></type> <name>performWrites</name><parameter_list>()</parameter_list> <throws>throws <argument><expr><name>CommandException</name></expr></argument></throws> <block>{<block_content>
         <try>try <block>{<block_content>
            <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>CoordActionUpdateStatusJPAExecutor</name><argument_list>(<argument><expr><name>action</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>BulkUpdateInsertForCoordActionStatusJPAExecutor</name><argument_list>(<argument><expr><name>updateList</name></expr></argument>, <argument><expr><literal type="null">null</literal></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
         </block_content>}</block>
         <catch>catch <parameter_list>(<parameter><decl><type><name>JPAExecutorException</name></type> <name>e</name></decl></parameter>)</parameter_list> <block>{<block_content>
             <throw>throw <expr><operator>new</operator> <call><name>CommandException</name><argument_list>(<argument><expr><name>e</name></expr></argument>)</argument_list></call></expr>;</throw>
         </block_content>}</block></catch></try>
     </block_content>}</block></function>
 
    <function><type><specifier>private</specifier> <name>void</name></type> <name>updateCoordAction</name><parameter_list>(<parameter><decl><type><name>CoordinatorActionBean</name></type> <name>action</name></decl></parameter>)</parameter_list> <block>{<block_content>
        <expr_stmt><expr><call><name><name>action</name><operator>.</operator><name>setStatus</name></name><argument_list>(<argument><expr><name><name>CoordinatorActionBean</name><operator>.</operator><name>Status</name><operator>.</operator><name>RUNNING</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>action</name><operator>.</operator><name>incrementAndGetPending</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>action</name><operator>.</operator><name>setLastModifiedTime</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>Date</name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>updateList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>action</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    </block_content>}</block></function>

     <comment type="block">/* (non-Javadoc)
      * @see org.apache.oozie.command.TransitionXCommand#getJob()
      */</comment>
<expr_stmt><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>coord</name><operator>/</operator><name><name>CoordSubmitXCommand</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>coord</name><operator>/</operator><name><name>CoordSubmitXCommand</name><operator>.</operator><name>java</name></name>
<name>index</name> <name>bfcc19e5a</name><operator>..</operator><literal type="number">7aa5471a5</literal> <literal type="number">100644</literal>
<operator>--</operator> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>coord</name><operator>/</operator><name><name>CoordSubmitXCommand</name><operator>.</operator><name>java</name></name>
<operator>++</operator> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>coord</name><operator>/</operator><name><name>CoordSubmitXCommand</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">1205</literal></expr><operator>,</operator><expr><literal type="number">4</literal> <operator>+</operator><literal type="number">1205</literal></expr><operator>,</operator><expr><literal type="number">8</literal> @@ <specifier>public</specifier> <name>class</name> <name>CoordSubmitXCommand</name> extends <name>SubmitTransitionXCommand</name> <block>{
     <expr><specifier>public</specifier> <name>Job</name> <call><name>getJob</name><argument_list>()</argument_list></call> <block>{
         <return>return <expr><name>coordJob</name></expr>;</return></block></expr>
     }</block>

    @<name>Override</name>
    <specifier>public</specifier> <name>void</name> <call><name>performWrites</name><argument_list>()</argument_list></call> <throws>throws <argument><expr><name>CommandException</name> <block>{
    }</block></expr></argument>
 }
<argument><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>coord</name><operator>/</operator><name><name>CoordSuspendXCommand</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>coord</name><operator>/</operator><name><name>CoordSuspendXCommand</name><operator>.</operator><name>java</name></name>
<name>index</name> <literal type="number">101dfaab8</literal><operator>..</operator><literal type="number">44d368a55</literal> <literal type="number">100644</literal>
<operator>--</operator> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>coord</name><operator>/</operator><name><name>CoordSuspendXCommand</name><operator>.</operator><name>java</name></name>
<operator>++</operator> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>coord</name><operator>/</operator><name><name>CoordSuspendXCommand</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">31</literal></expr></argument>,<argument><expr><literal type="number">10</literal> <operator>+</operator><literal type="number">31</literal></expr></argument>,<argument><expr><literal type="number">9</literal> @@</expr></argument></throws></expr></expr_stmt> <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>PreconditionException</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>SuspendTransitionXCommand</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>bundle</name><operator>.</operator><name>BundleStatusUpdateXCommand</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>wf</name><operator>.</operator><name>SuspendXCommand</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>CoordActionUpdateStatusJPAExecutor</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>BulkUpdateInsertForCoordActionStatusJPAExecutor</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>CoordJobGetActionsRunningJPAExecutor</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>CoordJobGetJPAExecutor</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>CoordJobUpdateJPAExecutor</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>JPAExecutorException</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>JPAService</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>Services</name></name>;</import>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">150</literal></expr><operator>,</operator><expr><literal type="number">12</literal> <operator>+</operator><literal type="number">149</literal></expr><operator>,</operator><expr><literal type="number">7</literal> @@ <specifier>public</specifier> <name>class</name> <name>CoordSuspendXCommand</name> extends <name>SuspendTransitionXCommand</name> <block>{
                 <expr><call><name><name>coordJob</name><operator>.</operator><name>resetPending</name></name><argument_list>()</argument_list></call></expr>;
                 <call><name><name>LOG</name><operator>.</operator><name>debug</name></name><argument_list>(<argument><expr><literal type="string">"Exception happened, fail coordinator job id = "</literal> <operator>+</operator> <name>jobId</name> <operator>+</operator> <literal type="string">", status = "</literal>
                         <operator>+</operator> <call><name><name>coordJob</name><operator>.</operator><name>getStatus</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></block></expr>;</expr_stmt>
                <try>try <block>{<block_content>
                    <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>CoordJobUpdateJPAExecutor</name><argument_list>(<argument><expr><name>coordJob</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                </block_content>}</block>
                <catch>catch <parameter_list>(<parameter><decl><type><name>JPAExecutorException</name></type> <name>je</name></decl></parameter>)</parameter_list> <block>{<block_content>
                    <expr_stmt><expr><call><name><name>LOG</name><operator>.</operator><name>error</name></name><argument_list>(<argument><expr><literal type="string">"Failed to update coordinator job : "</literal> <operator>+</operator> <name>jobId</name></expr></argument>, <argument><expr><name>je</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                </block_content>}</block></catch></try>
                <expr_stmt><expr><call><name><name>updateList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>coordJob</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
             </block_content>}</block></function>
         </block_content>}</block></try>
     </block_content>}</block></function>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">176</literal></expr><operator>,</operator><expr><literal type="number">29</literal> <operator>+</operator><literal type="number">170</literal></expr><operator>,</operator><expr><literal type="number">32</literal> @@ <specifier>public</specifier> <name>class</name> <name>CoordSuspendXCommand</name> extends <name>SuspendTransitionXCommand</name> <block>{
      <expr><operator>*</operator> @<name>see</name> <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>TransitionXCommand</name></name><operator>#</operator><call><name>updateJob</name><argument_list>()</argument_list></call>
      <operator>*</operator><operator>/</operator>
     @<name>Override</name>
    <specifier>public</specifier> <name>void</name> <call><name>updateJob</name><argument_list>()</argument_list></call> <throws>throws <argument><expr><name>CommandException</name> <block>{
    <expr><specifier>public</specifier> <name>void</name> <call><name>updateJob</name><argument_list>()</argument_list></call> <block>{
         <expr><call><name><name>InstrumentUtils</name><operator>.</operator><name>incrJobCounter</name></name><argument_list>(<argument><expr><call><name>getName</name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><literal type="number">1</literal></expr></argument>, <argument><expr><call><name>getInstrumentation</name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr></block></expr></block></expr></argument></throws></expr>;
         <call><name><name>coordJob</name><operator>.</operator><name>setLastModifiedTime</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>Date</name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></block></expr>;</expr_stmt>
         <expr_stmt><expr><call><name><name>coordJob</name><operator>.</operator><name>setSuspendedTime</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>Date</name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
         <expr_stmt><expr><call><name><name>LOG</name><operator>.</operator><name>debug</name></name><argument_list>(<argument><expr><literal type="string">"Suspend coordinator job id = "</literal> <operator>+</operator> <name>jobId</name> <operator>+</operator> <literal type="string">", status = "</literal> <operator>+</operator> <call><name><name>coordJob</name><operator>.</operator><name>getStatus</name></name><argument_list>()</argument_list></call> <operator>+</operator> <literal type="string">", pending = "</literal> <operator>+</operator> <call><name><name>coordJob</name><operator>.</operator><name>isPending</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>updateList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>coordJob</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    </block_content>}</block></function>

    <comment type="block">/* (non-Javadoc)
     * @see org.apache.oozie.command.SuspendTransitionXCommand#performWrites()
     */</comment>
    <function><annotation>@<name>Override</name></annotation>
    <type><specifier>public</specifier> <name>void</name></type> <name>performWrites</name><parameter_list>()</parameter_list> <throws>throws <argument><expr><name>CommandException</name></expr></argument></throws> <block>{<block_content>
         <try>try <block>{<block_content>
            <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>CoordJobUpdateJPAExecutor</name><argument_list>(<argument><expr><name>coordJob</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>BulkUpdateInsertForCoordActionStatusJPAExecutor</name><argument_list>(<argument><expr><name>updateList</name></expr></argument>, <argument><expr><literal type="null">null</literal></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
         </block_content>}</block>
        <catch>catch <parameter_list>(<parameter><decl><type><name>JPAExecutorException</name></type> <name>e</name></decl></parameter>)</parameter_list> <block>{<block_content>
            <throw>throw <expr><operator>new</operator> <call><name>CommandException</name><argument_list>(<argument><expr><name>e</name></expr></argument>)</argument_list></call></expr>;</throw>
        <catch>catch <parameter_list>(<parameter><decl><type><name>JPAExecutorException</name></type> <name>jex</name></decl></parameter>)</parameter_list> <block>{<block_content>
            <throw>throw <expr><operator>new</operator> <call><name>CommandException</name><argument_list>(<argument><expr><name>jex</name></expr></argument>)</argument_list></call></expr>;</throw>
         </block_content>}</block></catch>
     </block_content>}</block></catch></try>
 
    <function><type><specifier>private</specifier> <name>void</name></type> <name>updateCoordAction</name><parameter_list>(<parameter><decl><type><name>CoordinatorActionBean</name></type> <name>action</name></decl></parameter>)</parameter_list> <throws>throws <argument><expr><name>CommandException</name></expr></argument></throws> <block>{<block_content>
    <function><type><specifier>private</specifier> <name>void</name></type> <name>updateCoordAction</name><parameter_list>(<parameter><decl><type><name>CoordinatorActionBean</name></type> <name>action</name></decl></parameter>)</parameter_list> <block>{<block_content>
         <expr_stmt><expr><call><name><name>action</name><operator>.</operator><name>setStatus</name></name><argument_list>(<argument><expr><name><name>CoordinatorActionBean</name><operator>.</operator><name>Status</name><operator>.</operator><name>SUSPENDED</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
         <expr_stmt><expr><call><name><name>action</name><operator>.</operator><name>incrementAndGetPending</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
         <expr_stmt><expr><call><name><name>action</name><operator>.</operator><name>setLastModifiedTime</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>Date</name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <try>try <block>{<block_content>
            <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>CoordActionUpdateStatusJPAExecutor</name><argument_list>(<argument><expr><name>action</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        </block_content>}</block>
        <catch>catch <parameter_list>(<parameter><decl><type><name>JPAExecutorException</name></type> <name>e</name></decl></parameter>)</parameter_list> <block>{<block_content>
            <throw>throw <expr><operator>new</operator> <call><name>CommandException</name><argument_list>(<argument><expr><name>e</name></expr></argument>)</argument_list></call></expr>;</throw>
        </block_content>}</block></catch></try>
        <expr_stmt><expr><call><name><name>updateList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>action</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
     </block_content>}</block></function>
 
     <comment type="block">/* (non-Javadoc)
diff --git a/core/src/main/java/org/apache/oozie/command/coord/CoordUnpauseXCommand.java b/core/src/main/java/org/apache/oozie/command/coord/CoordUnpauseXCommand.java
index a208c9dee..c1501ba0e 100644
-- a/core/src/main/java/org/apache/oozie/command/coord/CoordUnpauseXCommand.java
++ b/core/src/main/java/org/apache/oozie/command/coord/CoordUnpauseXCommand.java
@@ -126,4 +126,8 @@ public class CoordUnpauseXCommand extends UnpauseTransitionXCommand {
 
     }
 
    @Override
    public void performWrites() throws CommandException {
    }

 }
diff --git a/core/src/main/java/org/apache/oozie/command/coord/CoordinatorCommand.java b/core/src/main/java/org/apache/oozie/command/coord/CoordinatorCommand.java
index 5bc2b00a0..c70e171e8 100644
-- a/core/src/main/java/org/apache/oozie/command/coord/CoordinatorCommand.java
++ b/core/src/main/java/org/apache/oozie/command/coord/CoordinatorCommand.java
@@ -17,17 +17,10 @@
  */</comment>
 <package>package <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>coord</name></name>;</package>
 
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>CoordinatorJobBean</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>WorkflowJobBean</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>Command</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>CommandException</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>DagXLogInfoService</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>XLogService</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>store</name><operator>.</operator><name>CoordinatorStore</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>store</name><operator>.</operator><name>Store</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>store</name><operator>.</operator><name>StoreException</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>store</name><operator>.</operator><name>WorkflowStore</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>util</name><operator>.</operator><name>XLog</name></name>;</import>
 
 <class><specifier>public</specifier> <specifier>abstract</specifier> class <name><name>CoordinatorCommand</name><parameter_list>&lt;<parameter><name>T</name></parameter>&gt;</parameter_list></name> <super_list><extends>extends <super><name><name>Command</name><argument_list type="generic">&lt;<argument><name>T</name></argument>, <argument><name>CoordinatorStore</name></argument>&gt;</argument_list></name></super></extends></super_list> <block>{
 
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">35</literal></expr><operator>,</operator><expr><literal type="number">9</literal> <operator>+</operator><literal type="number">28</literal></expr><operator>,</operator><expr><literal type="number">12</literal> @@ <specifier>public</specifier> <specifier>abstract</specifier> <name>class</name> <name><name>CoordinatorCommand</name><argument_list type="generic">&lt;<argument><name>T</name></argument>&gt;</argument_list></name> extends <name><name>Command</name><argument_list type="generic">&lt;<argument><name>T</name></argument>, <argument><name>CoordinatorStore</name></argument>&gt;</argument_list></name>
         <call><name>super</name><argument_list>(<argument><expr><name>name</name></expr></argument>, <argument><expr><name>type</name></expr></argument>, <argument><expr><name>priority</name></expr></argument>, <argument><expr><name>logMask</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
     }</block></class>
 
    <constructor><specifier>public</specifier> <name>CoordinatorCommand</name><parameter_list>(<parameter><decl><type><name>String</name></type> <name>name</name></decl></parameter>, <parameter><decl><type><name>String</name></type> <name>type</name></decl></parameter>, <parameter><decl><type><name>int</name></type> <name>priority</name></decl></parameter>, <parameter><decl><type><name>int</name></type> <name>logMask</name></decl></parameter>,
                              <parameter><decl><type><name>boolean</name></type> <name>dryrun</name></decl></parameter>)</parameter_list> <block>{<block_content>
        <expr_stmt><expr><call><name>super</name><argument_list>(<argument><expr><name>name</name></expr></argument>, <argument><expr><name>type</name></expr></argument>, <argument><expr><name>priority</name></expr></argument>, <argument><expr><name>logMask</name></expr></argument>, <argument><expr><ternary><condition><expr><operator>(</operator><name>dryrun</name><operator>)</operator></expr> ?</condition><then> <expr><literal type="boolean">false</literal></expr> </then><else>: <expr><literal type="boolean">true</literal></expr></else></ternary></expr></argument>, <argument><expr><name>dryrun</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    <constructor><specifier>public</specifier> <name>CoordinatorCommand</name><parameter_list>(<parameter><decl><type><name>String</name></type> <name>name</name></decl></parameter>, <parameter><decl><type><name>String</name></type> <name>type</name></decl></parameter>, <parameter><decl><type><name>int</name></type> <name>priority</name></decl></parameter>, <parameter><decl><type><name>int</name></type> <name>logMask</name></decl></parameter>, <parameter><decl><type><name>boolean</name></type> <name>withStore</name></decl></parameter>)</parameter_list> <block>{<block_content>
        <expr_stmt><expr><call><name>super</name><argument_list>(<argument><expr><name>name</name></expr></argument>, <argument><expr><name>type</name></expr></argument>, <argument><expr><name>priority</name></expr></argument>, <argument><expr><name>logMask</name></expr></argument>, <argument><expr><name>withStore</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    </block_content>}</block></constructor>

    <constructor><specifier>public</specifier> <name>CoordinatorCommand</name><parameter_list>(<parameter><decl><type><name>String</name></type> <name>name</name></decl></parameter>, <parameter><decl><type><name>String</name></type> <name>type</name></decl></parameter>, <parameter><decl><type><name>int</name></type> <name>priority</name></decl></parameter>, <parameter><decl><type><name>int</name></type> <name>logMask</name></decl></parameter>, <parameter><decl><type><name>boolean</name></type> <name>withStore</name></decl></parameter>, <parameter><decl><type><name>boolean</name></type> <name>dryrun</name></decl></parameter>)</parameter_list> <block>{<block_content>
        <expr_stmt><expr><call><name>super</name><argument_list>(<argument><expr><name>name</name></expr></argument>, <argument><expr><name>type</name></expr></argument>, <argument><expr><name>priority</name></expr></argument>, <argument><expr><name>logMask</name></expr></argument>, <argument><expr><ternary><condition><expr><operator>(</operator><name>dryrun</name><operator>)</operator></expr> ?</condition><then> <expr><literal type="boolean">false</literal></expr> </then><else>: <expr><name>withStore</name></expr></else></ternary></expr></argument>, <argument><expr><name>dryrun</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
     </block_content>}</block></constructor>
 
     <comment type="block" format="javadoc">/**
diff --git a/core/src/main/java/org/apache/oozie/command/wf/ActionCheckXCommand.java b/core/src/main/java/org/apache/oozie/command/wf/ActionCheckXCommand.java
index 9ff247317..25ab1aa87 100644
-- a/core/src/main/java/org/apache/oozie/command/wf/ActionCheckXCommand.java
++ b/core/src/main/java/org/apache/oozie/command/wf/ActionCheckXCommand.java
@@ -18,7 +18,10 @@
 package org.apache.oozie.command.wf;
 
 import java.sql.Timestamp;
import java.util.ArrayList;
 import java.util.Date;
import java.util.List;

 import org.apache.oozie.ErrorCode;
 import org.apache.oozie.WorkflowActionBean;
 import org.apache.oozie.WorkflowJobBean;
@@ -27,13 +30,14 @@ import org.apache.oozie.action.ActionExecutor;
 import org.apache.oozie.action.ActionExecutorException;
 import org.apache.oozie.client.WorkflowJob;
 import org.apache.oozie.client.WorkflowAction.Status;
import org.apache.oozie.client.rest.JsonBean;
 import org.apache.oozie.command.CommandException;
 import org.apache.oozie.command.PreconditionException;
import org.apache.oozie.executor.jpa.BulkUpdateInsertJPAExecutor;
 import org.apache.oozie.executor.jpa.JPAExecutorException;
 import org.apache.oozie.executor.jpa.WorkflowActionGetJPAExecutor;
 import org.apache.oozie.executor.jpa.WorkflowActionUpdateJPAExecutor;
 import org.apache.oozie.executor.jpa.WorkflowJobGetJPAExecutor;
import org.apache.oozie.executor.jpa.WorkflowJobUpdateJPAExecutor;
 import org.apache.oozie.service.ActionService;
 import org.apache.oozie.service.JPAService;
 import org.apache.oozie.service.Services;
@@ -57,6 +61,7 @@ public class ActionCheckXCommand extends ActionXCommand&lt;Void&gt; {
     private WorkflowActionBean wfAction = null;
     private JPAService jpaService = null;
     private ActionExecutor executor = null;
    private List&lt;JsonBean&gt; updateList = new ArrayList&lt;JsonBean&gt;();
 
     public ActionCheckXCommand(String actionId) {
         this(actionId, -1);
@@ -170,17 +175,15 @@ public class ActionCheckXCommand extends ActionXCommand&lt;Void&gt; {
                     wfAction.setErrorInfo(EXEC_DATA_MISSING,
                             "Execution Complete, but Execution Data Missing from Action");
                     failJob(context);
                    wfAction.setLastCheckTime(new Date());
                    jpaService.execute(new WorkflowActionUpdateJPAExecutor(wfAction));
                    jpaService.execute(new WorkflowJobUpdateJPAExecutor(wfJob));
                    return null;
                } else {
                    wfAction.setPending();
                    queue(new ActionEndXCommand(wfAction.getId(), wfAction.getType()));
                 }
                wfAction.setPending();
                queue(new ActionEndXCommand(wfAction.getId(), wfAction.getType()));
             }
             wfAction.setLastCheckTime(new Date());
            jpaService.execute(new WorkflowActionUpdateJPAExecutor(wfAction));
            jpaService.execute(new WorkflowJobUpdateJPAExecutor(wfJob));
            updateList.add(wfAction);
            wfJob.setLastModifiedTime(new Date());
            updateList.add(wfJob);
         }
         catch (ActionExecutorException ex) {
             LOG.warn("Exception while executing check(). Error Code [{0}], Message[{1}]", ex.getErrorCode(), ex
@@ -197,17 +200,18 @@ public class ActionCheckXCommand extends ActionXCommand&lt;Void&gt; {
                     break;
             }
             wfAction.setLastCheckTime(new Date());
            updateList = new ArrayList&lt;JsonBean&gt;();
            updateList.add(wfAction);
            wfJob.setLastModifiedTime(new Date());
            updateList.add(wfJob);
        }
        finally {
             try {
                jpaService.execute(new WorkflowActionUpdateJPAExecutor(wfAction));
                jpaService.execute(new WorkflowJobUpdateJPAExecutor(wfJob));
                jpaService.execute(new BulkUpdateInsertJPAExecutor(updateList, null));
             }
             catch (JPAExecutorException e) {
                 throw new CommandException(e);
             }
            return null;
        }
        catch (JPAExecutorException e) {
            throw new CommandException(e);
         }
 
         LOG.debug("ENDED ActionCheckXCommand for wf actionId=" + actionId + ", jobId=" + jobId);
diff --git a/core/src/main/java/org/apache/oozie/command/wf/ActionEndXCommand.java b/core/src/main/java/org/apache/oozie/command/wf/ActionEndXCommand.java
index 396e33c8f..cc63198fa 100644
-- a/core/src/main/java/org/apache/oozie/command/wf/ActionEndXCommand.java
++ b/core/src/main/java/org/apache/oozie/command/wf/ActionEndXCommand.java
@@ -17,11 +17,14 @@
  */</comment>
 <package>package <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>wf</name></name>;</package>
 
<import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>ArrayList</name></name>;</import>
 <import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>Date</name></name>;</import>
<import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>List</name></name>;</import>
 
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>hadoop</name><operator>.</operator><name>conf</name><operator>.</operator><name>Configuration</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>DagELFunctions</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>ErrorCode</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>SLAEventBean</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>WorkflowActionBean</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>WorkflowJobBean</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>XException</name></name>;</import>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">33</literal></expr><operator>,</operator><expr><literal type="number">13</literal> <operator>+</operator><literal type="number">36</literal></expr><operator>,</operator><expr><literal type="number">13</literal> @@</expr></expr_stmt> <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>WorkflowAction</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>WorkflowJob</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>SLAEvent</name><operator>.</operator><name>SlaAppType</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>SLAEvent</name><operator>.</operator><name>Status</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>rest</name><operator>.</operator><name>JsonBean</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>CommandException</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>PreconditionException</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>BulkUpdateInsertJPAExecutor</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>JPAExecutorException</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>WorkflowActionGetJPAExecutor</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>WorkflowActionUpdateJPAExecutor</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>WorkflowJobGetJPAExecutor</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>WorkflowJobUpdateJPAExecutor</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>ActionService</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>JPAService</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>Services</name></name>;</import>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">60</literal></expr><operator>,</operator><expr><literal type="number">6</literal> <operator>+</operator><literal type="number">63</literal></expr><operator>,</operator><expr><literal type="number">8</literal> @@ <specifier>public</specifier> <name>class</name> <name>ActionEndXCommand</name> extends <name><name>ActionXCommand</name><argument_list type="generic">&lt;<argument><name>Void</name></argument>&gt;</argument_list></name> <block>{
     <expr><specifier>private</specifier> <name>WorkflowActionBean</name> <name>wfAction</name> <operator>=</operator> <literal type="null">null</literal></expr>;
     <specifier>private</specifier> <name>JPAService</name> <name>jpaService</name> <operator>=</operator> <literal type="null">null</literal></block></expr>;</expr_stmt>
     <decl_stmt><decl><type><specifier>private</specifier> <name>ActionExecutor</name></type> <name>executor</name> <init>= <expr><literal type="null">null</literal></expr></init></decl>;</decl_stmt>
    <decl_stmt><decl><type><specifier>private</specifier> <name><name>List</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name></type> <name>updateList</name> <init>= <expr><operator>new</operator> <call><name><name>ArrayList</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
    <decl_stmt><decl><type><specifier>private</specifier> <name><name>List</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name></type> <name>insertList</name> <init>= <expr><operator>new</operator> <call><name><name>ArrayList</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
 
     <constructor><specifier>public</specifier> <name>ActionEndXCommand</name><parameter_list>(<parameter><decl><type><name>String</name></type> <name>actionId</name></decl></parameter>, <parameter><decl><type><name>String</name></type> <name>type</name></decl></parameter>)</parameter_list> <block>{<block_content>
         <expr_stmt><expr><call><name>super</name><argument_list>(<argument><expr><literal type="string">"action.end"</literal></expr></argument>, <argument><expr><name>type</name></expr></argument>, <argument><expr><literal type="number">0</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">169</literal></expr><operator>,</operator><expr><literal type="number">46</literal> <operator>+</operator><literal type="number">174</literal></expr><operator>,</operator><expr><literal type="number">46</literal> @@ <specifier>public</specifier> <name>class</name> <name>ActionEndXCommand</name> extends <name><name>ActionXCommand</name><argument_list type="generic">&lt;<argument><name>Void</name></argument>&gt;</argument_list></name> <block>{
                         <expr><call><name><name>executor</name><operator>.</operator><name>getType</name></name><argument_list>()</argument_list></call></expr>)</block></expr>;</expr_stmt>
                 <expr_stmt><expr><call><name><name>wfAction</name><operator>.</operator><name>setErrorInfo</name></name><argument_list>(<argument><expr><name>END_DATA_MISSING</name></expr></argument>, <argument><expr><literal type="string">"Execution Ended, but End Data Missing from Action"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                 <expr_stmt><expr><call><name>failJob</name><argument_list>(<argument><expr><name>context</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>WorkflowActionUpdateJPAExecutor</name><argument_list>(<argument><expr><name>wfAction</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>WorkflowJobUpdateJPAExecutor</name><argument_list>(<argument><expr><name>wfJob</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                <return>return <expr><literal type="null">null</literal></expr>;</return>
            </block_content>}</block></constructor>
            <expr_stmt><expr><call><name><name>wfAction</name><operator>.</operator><name>setRetries</name></name><argument_list>(<argument><expr><literal type="number">0</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name><name>wfAction</name><operator>.</operator><name>setEndTime</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>Date</name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>

            <decl_stmt><decl><type><name>boolean</name></type> <name>shouldHandleUserRetry</name> <init>= <expr><literal type="boolean">false</literal></expr></init></decl>;</decl_stmt>
            <decl_stmt><decl><type><name>Status</name></type> <name>slaStatus</name> <init>= <expr><literal type="null">null</literal></expr></init></decl>;</decl_stmt>
            <switch>switch <condition>(<expr><call><name><name>wfAction</name><operator>.</operator><name>getStatus</name></name><argument_list>()</argument_list></call></expr>)</condition> <block>{<block_content>
                <case>case <expr><name>OK</name></expr>:</case>
                    <expr_stmt><expr><name>slaStatus</name> <operator>=</operator> <name><name>Status</name><operator>.</operator><name>SUCCEEDED</name></name></expr>;</expr_stmt>
                    <break>break;</break>
                <case>case <expr><name>KILLED</name></expr>:</case>
                    <expr_stmt><expr><name>slaStatus</name> <operator>=</operator> <name><name>Status</name><operator>.</operator><name>KILLED</name></name></expr>;</expr_stmt>
                    <break>break;</break>
                <case>case <expr><name>FAILED</name></expr>:</case>
                    <expr_stmt><expr><name>slaStatus</name> <operator>=</operator> <name><name>Status</name><operator>.</operator><name>FAILED</name></name></expr>;</expr_stmt>
                    <expr_stmt><expr><name>shouldHandleUserRetry</name> <operator>=</operator> <literal type="boolean">true</literal></expr>;</expr_stmt>
                    <break>break;</break>
                <case>case <expr><name>ERROR</name></expr>:</case>
                    <expr_stmt><expr><call><name><name>LOG</name><operator>.</operator><name>info</name></name><argument_list>(<argument><expr><literal type="string">"ERROR is considered as FAILED for SLA"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                    <expr_stmt><expr><name>slaStatus</name> <operator>=</operator> <name><name>Status</name><operator>.</operator><name>KILLED</name></name></expr>;</expr_stmt>
                    <expr_stmt><expr><name>shouldHandleUserRetry</name> <operator>=</operator> <literal type="boolean">true</literal></expr>;</expr_stmt>
                    <break>break;</break>
                <default>default:</default>
                    <expr_stmt><expr><name>slaStatus</name> <operator>=</operator> <name><name>Status</name><operator>.</operator><name>FAILED</name></name></expr>;</expr_stmt>
                    <expr_stmt><expr><name>shouldHandleUserRetry</name> <operator>=</operator> <literal type="boolean">true</literal></expr>;</expr_stmt>
                    <break>break;</break>
            </block_content>}</block></switch>
            <if_stmt><if>if <condition>(<expr><operator>!</operator><name>shouldHandleUserRetry</name> <operator>||</operator> <operator>!</operator><call><name>handleUserRetry</name><argument_list>(<argument><expr><name>wfAction</name></expr></argument>)</argument_list></call></expr>)</condition> <block>{<block_content>
                <expr_stmt><expr><call><name><name>SLADbXOperations</name><operator>.</operator><name>writeStausEvent</name></name><argument_list>(<argument><expr><call><name><name>wfAction</name><operator>.</operator><name>getSlaXml</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><call><name><name>wfAction</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><name>slaStatus</name></expr></argument>, <argument><expr><name><name>SlaAppType</name><operator>.</operator><name>WORKFLOW_ACTION</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                <expr_stmt><expr><call><name><name>LOG</name><operator>.</operator><name>debug</name></name><argument_list>(
                        <argument><expr><literal type="string">"Queuing commands for action="</literal> <operator>+</operator> <name>actionId</name> <operator>+</operator> <literal type="string">", status="</literal> <operator>+</operator> <call><name><name>wfAction</name><operator>.</operator><name>getStatus</name></name><argument_list>()</argument_list></call>
                        <operator>+</operator> <literal type="string">", Set pending="</literal> <operator>+</operator> <call><name><name>wfAction</name><operator>.</operator><name>getPending</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                <expr_stmt><expr><call><name>queue</name><argument_list>(<argument><expr><operator>new</operator> <call><name>SignalXCommand</name><argument_list>(<argument><expr><name>jobId</name></expr></argument>, <argument><expr><name>actionId</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            </block_content>}</block></if> <else>else <block>{<block_content>
                <expr_stmt><expr><call><name><name>wfAction</name><operator>.</operator><name>setRetries</name></name><argument_list>(<argument><expr><literal type="number">0</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                <expr_stmt><expr><call><name><name>wfAction</name><operator>.</operator><name>setEndTime</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>Date</name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    
                <decl_stmt><decl><type><name>boolean</name></type> <name>shouldHandleUserRetry</name> <init>= <expr><literal type="boolean">false</literal></expr></init></decl>;</decl_stmt>
                <decl_stmt><decl><type><name>Status</name></type> <name>slaStatus</name> <init>= <expr><literal type="null">null</literal></expr></init></decl>;</decl_stmt>
                <switch>switch <condition>(<expr><call><name><name>wfAction</name><operator>.</operator><name>getStatus</name></name><argument_list>()</argument_list></call></expr>)</condition> <block>{<block_content>
                    <case>case <expr><name>OK</name></expr>:</case>
                        <expr_stmt><expr><name>slaStatus</name> <operator>=</operator> <name><name>Status</name><operator>.</operator><name>SUCCEEDED</name></name></expr>;</expr_stmt>
                        <break>break;</break>
                    <case>case <expr><name>KILLED</name></expr>:</case>
                        <expr_stmt><expr><name>slaStatus</name> <operator>=</operator> <name><name>Status</name><operator>.</operator><name>KILLED</name></name></expr>;</expr_stmt>
                        <break>break;</break>
                    <case>case <expr><name>FAILED</name></expr>:</case>
                        <expr_stmt><expr><name>slaStatus</name> <operator>=</operator> <name><name>Status</name><operator>.</operator><name>FAILED</name></name></expr>;</expr_stmt>
                        <expr_stmt><expr><name>shouldHandleUserRetry</name> <operator>=</operator> <literal type="boolean">true</literal></expr>;</expr_stmt>
                        <break>break;</break>
                    <case>case <expr><name>ERROR</name></expr>:</case>
                        <expr_stmt><expr><call><name><name>LOG</name><operator>.</operator><name>info</name></name><argument_list>(<argument><expr><literal type="string">"ERROR is considered as FAILED for SLA"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                        <expr_stmt><expr><name>slaStatus</name> <operator>=</operator> <name><name>Status</name><operator>.</operator><name>KILLED</name></name></expr>;</expr_stmt>
                        <expr_stmt><expr><name>shouldHandleUserRetry</name> <operator>=</operator> <literal type="boolean">true</literal></expr>;</expr_stmt>
                        <break>break;</break>
                    <default>default:</default>
                        <expr_stmt><expr><name>slaStatus</name> <operator>=</operator> <name><name>Status</name><operator>.</operator><name>FAILED</name></name></expr>;</expr_stmt>
                        <expr_stmt><expr><name>shouldHandleUserRetry</name> <operator>=</operator> <literal type="boolean">true</literal></expr>;</expr_stmt>
                        <break>break;</break>
                </block_content>}</block></switch>
                <if_stmt><if>if <condition>(<expr><operator>!</operator><name>shouldHandleUserRetry</name> <operator>||</operator> <operator>!</operator><call><name>handleUserRetry</name><argument_list>(<argument><expr><name>wfAction</name></expr></argument>)</argument_list></call></expr>)</condition> <block>{<block_content>
                    <decl_stmt><decl><type><name>SLAEventBean</name></type> <name>slaEvent</name> <init>= <expr><call><name><name>SLADbXOperations</name><operator>.</operator><name>createStatusEvent</name></name><argument_list>(<argument><expr><call><name><name>wfAction</name><operator>.</operator><name>getSlaXml</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><call><name><name>wfAction</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><name>slaStatus</name></expr></argument>, <argument><expr><name><name>SlaAppType</name><operator>.</operator><name>WORKFLOW_ACTION</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
                    <expr_stmt><expr><call><name><name>LOG</name><operator>.</operator><name>debug</name></name><argument_list>(<argument><expr><literal type="string">"Queuing commands for action="</literal> <operator>+</operator> <name>actionId</name> <operator>+</operator> <literal type="string">", status="</literal> <operator>+</operator> <call><name><name>wfAction</name><operator>.</operator><name>getStatus</name></name><argument_list>()</argument_list></call>
                            <operator>+</operator> <literal type="string">", Set pending="</literal> <operator>+</operator> <call><name><name>wfAction</name><operator>.</operator><name>getPending</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                    <if_stmt><if>if<condition>(<expr><name>slaEvent</name> <operator>!=</operator> <literal type="null">null</literal></expr>)</condition> <block>{<block_content>
                        <expr_stmt><expr><call><name><name>insertList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>slaEvent</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                    </block_content>}</block></if></if_stmt>
                    <expr_stmt><expr><call><name>queue</name><argument_list>(<argument><expr><operator>new</operator> <call><name>SignalXCommand</name><argument_list>(<argument><expr><name>jobId</name></expr></argument>, <argument><expr><name>actionId</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                </block_content>}</block></if></if_stmt>
             </block_content>}</block></else></if_stmt>

            <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>WorkflowActionUpdateJPAExecutor</name><argument_list>(<argument><expr><name>wfAction</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>WorkflowJobUpdateJPAExecutor</name><argument_list>(<argument><expr><name>wfJob</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name><name>updateList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>wfAction</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name><name>wfJob</name><operator>.</operator><name>setLastModifiedTime</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>Date</name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name><name>updateList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>wfJob</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
         </block_content>}</block></constructor>
         <catch>catch <parameter_list>(<parameter><decl><type><name>ActionExecutorException</name></type> <name>ex</name></decl></parameter>)</parameter_list> <block>{<block_content>
             <expr_stmt><expr><call><name><name>LOG</name><operator>.</operator><name>warn</name></name><argument_list>(
<argument>@@ <expr><operator>-</operator><literal type="number">243</literal></expr></argument>,<argument><expr><literal type="number">19</literal> <operator>+</operator><literal type="number">248</literal></expr></argument>,<argument><expr><literal type="number">18</literal> @@ <specifier>public</specifier> class <name>ActionEndXCommand</name> extends <name><name>ActionXCommand</name><argument_list type="generic">&lt;<argument><name>Void</name></argument>&gt;</argument_list></name> <block>{
             <expr><call><name><name>DagELFunctions</name><operator>.</operator><name>setActionInfo</name></name><argument_list>(<argument><expr><name>wfInstance</name></expr></argument>, <argument><expr><name>wfAction</name></expr></argument>)</argument_list></call></expr>;
             <call><name><name>wfJob</name><operator>.</operator><name>setWorkflowInstance</name></name><argument_list>(<argument><expr><name>wfInstance</name></expr></argument>)</argument_list></call></block></expr></argument>;</argument_list></call></expr></expr_stmt>
 
            <expr_stmt><expr><call><name><name>updateList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>wfAction</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name><name>wfJob</name><operator>.</operator><name>setLastModifiedTime</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>Date</name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name><name>updateList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>wfJob</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        </block_content>}</block></catch>
        <finally>finally <block>{<block_content>
             <try>try <block>{<block_content>
                <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>WorkflowActionUpdateJPAExecutor</name><argument_list>(<argument><expr><name>wfAction</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>WorkflowJobUpdateJPAExecutor</name><argument_list>(<argument><expr><name>wfJob</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>BulkUpdateInsertJPAExecutor</name><argument_list>(<argument><expr><name>updateList</name></expr></argument>, <argument><expr><name>insertList</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
             </block_content>}</block>
            <catch>catch <parameter_list>(<parameter><decl><type><name>JPAExecutorException</name></type> <name>je</name></decl></parameter>)</parameter_list> <block>{<block_content>
                <throw>throw <expr><operator>new</operator> <call><name>CommandException</name><argument_list>(<argument><expr><name>je</name></expr></argument>)</argument_list></call></expr>;</throw>
            <catch>catch <parameter_list>(<parameter><decl><type><name>JPAExecutorException</name></type> <name>e</name></decl></parameter>)</parameter_list> <block>{<block_content>
                <throw>throw <expr><operator>new</operator> <call><name>CommandException</name><argument_list>(<argument><expr><name>e</name></expr></argument>)</argument_list></call></expr>;</throw>
             </block_content>}</block></catch>

         </block_content>}</block></catch>
        <catch>catch <parameter_list>(<parameter><decl><type><name>JPAExecutorException</name></type> <name>je</name></decl></parameter>)</parameter_list> <block>{<block_content>
            <throw>throw <expr><operator>new</operator> <call><name>CommandException</name><argument_list>(<argument><expr><name>je</name></expr></argument>)</argument_list></call></expr>;</throw>
        </block_content>}</block></catch></try>

 
         <expr_stmt><expr><call><name><name>LOG</name><operator>.</operator><name>debug</name></name><argument_list>(<argument><expr><literal type="string">"ENDED ActionEndXCommand for action "</literal> <operator>+</operator> <name>actionId</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
         <return>return <expr><literal type="null">null</literal></expr>;</return>
<expr_stmt><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>wf</name><operator>/</operator><name><name>ActionKillXCommand</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>wf</name><operator>/</operator><name><name>ActionKillXCommand</name><operator>.</operator><name>java</name></name>
<name>index</name> <name>fb7ada1f9</name><operator>..</operator><literal type="number">7aec8efa9</literal> <literal type="number">100644</literal>
<operator>--</operator> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>wf</name><operator>/</operator><name><name>ActionKillXCommand</name><operator>.</operator><name>java</name></name>
<operator>++</operator> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>wf</name><operator>/</operator><name><name>ActionKillXCommand</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">6</literal></expr><operator>,</operator><expr><literal type="number">9</literal> <operator>+</operator><literal type="number">6</literal></expr><operator>,</operator><expr><literal type="number">9</literal> @@
  <operator>*</operator> <name>to</name> <name>you</name> <name>under</name> <name>the</name> <name>Apache</name> <name>License</name></expr><operator>,</operator> <expr><name>Version</name> <literal type="number">2.0</literal> <operator>(</operator><name>the</name>
  <operator>*</operator> <literal type="string">"License"</literal><operator>)</operator></expr>;</expr_stmt> <expr_stmt><expr><name>you</name> <name>may</name> <name>not</name> <name>use</name> <name>this</name> <name>file</name> <name>except</name> <name>in</name> <name>compliance</name>
  <operator>*</operator> <name>with</name> <name>the</name> <name><name>License</name><operator>.</operator>  <name>You</name></name> <name>may</name> <name>obtain</name> <name>a</name> <name>copy</name> <name>of</name> <name>the</name> <name>License</name> <name>at</name>
 <operator>*</operator> 
 <operator>*</operator>
  <operator>*</operator>      <name>http</name><operator>:</operator><comment type="line">//www.apache.org/licenses/LICENSE-2.0</comment>
 <operator>*</operator> 
 <operator>*</operator>
  <operator>*</operator> <name>Unless</name> <name>required</name> <name>by</name> <name>applicable</name> <name>law</name> <name>or</name> <name>agreed</name> <name>to</name> <name>in</name> <name>writing</name></expr><operator>,</operator> <expr><name>software</name>
  <operator>*</operator> <name>distributed</name> <name>under</name> <name>the</name> <name>License</name> <name>is</name> <name>distributed</name> <name>on</name> <name>an</name> <literal type="string">"AS IS"</literal> <name>BASIS</name></expr><operator>,</operator>
  <expr><operator>*</operator> <name>WITHOUT</name> <name>WARRANTIES</name> <name>OR</name> <name>CONDITIONS</name> <name>OF</name> <name>ANY</name> <name>KIND</name></expr><operator>,</operator> <expr><name>either</name> <name>express</name> <name>or</name> <name><name>implied</name><operator>.</operator></name>
@@ <operator>-</operator><literal type="number">17</literal></expr><operator>,</operator><expr><literal type="number">19</literal> <operator>+</operator><literal type="number">17</literal></expr><operator>,</operator><expr><literal type="number">24</literal> @@
  <operator>*</operator><operator>/</operator></expr></expr_stmt>
 <package>package <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>wf</name></name>;</package>
 
<import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>ArrayList</name></name>;</import>
<import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>Date</name></name>;</import>
<import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>List</name></name>;</import>

 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>ErrorCode</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>SLAEventBean</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>WorkflowActionBean</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>WorkflowJobBean</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>XException</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>SLAEvent</name><operator>.</operator><name>SlaAppType</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>SLAEvent</name><operator>.</operator><name>Status</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>rest</name><operator>.</operator><name>JsonBean</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>CommandException</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>PreconditionException</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>BulkUpdateInsertJPAExecutor</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>JPAExecutorException</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>WorkflowActionGetJPAExecutor</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>WorkflowActionUpdateJPAExecutor</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>WorkflowJobGetJPAExecutor</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>WorkflowJobUpdateJPAExecutor</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>action</name><operator>.</operator><name>ActionExecutor</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>action</name><operator>.</operator><name>ActionExecutorException</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>ActionService</name></name>;</import>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">50</literal></expr><operator>,</operator><expr><literal type="number">6</literal> <operator>+</operator><literal type="number">55</literal></expr><operator>,</operator><expr><literal type="number">8</literal> @@ <specifier>public</specifier> <name>class</name> <name>ActionKillXCommand</name> extends <name><name>ActionXCommand</name><argument_list type="generic">&lt;<argument><name>Void</name></argument>&gt;</argument_list></name> <block>{
     <expr><specifier>private</specifier> <name>WorkflowJobBean</name> <name>wfJob</name></expr>;
     <specifier>private</specifier> <name>WorkflowActionBean</name> <name>wfAction</name></block></expr>;</expr_stmt>
     <decl_stmt><decl><type><specifier>private</specifier> <name>JPAService</name></type> <name>jpaService</name> <init>= <expr><literal type="null">null</literal></expr></init></decl>;</decl_stmt>
    <decl_stmt><decl><type><specifier>private</specifier> <name><name>List</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name></type> <name>updateList</name> <init>= <expr><operator>new</operator> <call><name><name>ArrayList</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
    <decl_stmt><decl><type><specifier>private</specifier> <name><name>List</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name></type> <name>insertList</name> <init>= <expr><operator>new</operator> <call><name><name>ArrayList</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
 
     <constructor><specifier>public</specifier> <name>ActionKillXCommand</name><parameter_list>(<parameter><decl><type><name>String</name></type> <name>actionId</name></decl></parameter>, <parameter><decl><type><name>String</name></type> <name>type</name></decl></parameter>)</parameter_list> <block>{<block_content>
         <expr_stmt><expr><call><name>super</name><argument_list>(<argument><expr><literal type="string">"action.kill"</literal></expr></argument>, <argument><expr><name>type</name></expr></argument>, <argument><expr><literal type="number">0</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">121</literal></expr><operator>,</operator><expr><literal type="number">11</literal> <operator>+</operator><literal type="number">128</literal></expr><operator>,</operator><expr><literal type="number">15</literal> @@ <specifier>public</specifier> <name>class</name> <name>ActionKillXCommand</name> extends <name><name>ActionXCommand</name><argument_list type="generic">&lt;<argument><name>Void</name></argument>&gt;</argument_list></name> <block>{
                     <expr><call><name><name>wfAction</name><operator>.</operator><name>resetPending</name></name><argument_list>()</argument_list></call></expr>;
                     <call><name><name>wfAction</name><operator>.</operator><name>setStatus</name></name><argument_list>(<argument><expr><name><name>WorkflowActionBean</name><operator>.</operator><name>Status</name><operator>.</operator><name>KILLED</name></name></expr></argument>)</argument_list></call></block></expr>;</expr_stmt>
 
                    <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>WorkflowActionUpdateJPAExecutor</name><argument_list>(<argument><expr><name>wfAction</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                    <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>WorkflowJobUpdateJPAExecutor</name><argument_list>(<argument><expr><name>wfJob</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                    <expr_stmt><expr><call><name><name>updateList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>wfAction</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                    <expr_stmt><expr><call><name><name>wfJob</name><operator>.</operator><name>setLastModifiedTime</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>Date</name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                    <expr_stmt><expr><call><name><name>updateList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>wfJob</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                     <comment type="line">// Add SLA status event (KILLED) for WF_ACTION</comment>
                    <expr_stmt><expr><call><name><name>SLADbXOperations</name><operator>.</operator><name>writeStausEvent</name></name><argument_list>(<argument><expr><call><name><name>wfAction</name><operator>.</operator><name>getSlaXml</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><call><name><name>wfAction</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><name><name>Status</name><operator>.</operator><name>KILLED</name></name></expr></argument>,
                    <argument><expr><name>SLAEventBean</name> <name>slaEvent</name> <operator>=</operator> <call><name><name>SLADbXOperations</name><operator>.</operator><name>createStatusEvent</name></name><argument_list>(<argument><expr><call><name><name>wfAction</name><operator>.</operator><name>getSlaXml</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><call><name><name>wfAction</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><name><name>Status</name><operator>.</operator><name>KILLED</name></name></expr></argument>,
                             <argument><expr><name><name>SlaAppType</name><operator>.</operator><name>WORKFLOW_ACTION</name></name></expr></argument>)</argument_list></call></expr></argument>;</argument_list></call></expr></expr_stmt>
                    <if_stmt><if>if<condition>(<expr><name>slaEvent</name> <operator>!=</operator> <literal type="null">null</literal></expr>)</condition> <block>{<block_content>
                        <expr_stmt><expr><call><name><name>insertList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>slaEvent</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                    </block_content>}</block></if></if_stmt>
                     <expr_stmt><expr><call><name>queue</name><argument_list>(<argument><expr><operator>new</operator> <call><name>NotificationXCommand</name><argument_list>(<argument><expr><name>wfJob</name></expr></argument>, <argument><expr><name>wfAction</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                 </block_content>}</block></constructor>
                 <catch>catch <parameter_list>(<parameter><decl><type><name>ActionExecutorException</name></type> <name>ex</name></decl></parameter>)</parameter_list> <block>{<block_content>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">134</literal></expr><operator>,</operator><expr><literal type="number">21</literal> <operator>+</operator><literal type="number">145</literal></expr><operator>,</operator><expr><literal type="number">25</literal> @@ <specifier>public</specifier> <name>class</name> <name>ActionKillXCommand</name> extends <name><name>ActionXCommand</name><argument_list type="generic">&lt;<argument><name>Void</name></argument>&gt;</argument_list></name> <block>{
                     <expr><call><name><name>wfAction</name><operator>.</operator><name>setErrorInfo</name></name><argument_list>(<argument><expr><call><name><name>ex</name><operator>.</operator><name>getErrorCode</name></name><argument_list>()</argument_list></call><operator>.</operator><call><name>toString</name><argument_list>()</argument_list></call></expr></argument>,
                             <argument><expr><literal type="string">"KILL COMMAND FAILED - exception while executing job kill"</literal></expr></argument>)</argument_list></call></expr>;
                     <call><name><name>wfJob</name><operator>.</operator><name>setStatus</name></name><argument_list>(<argument><expr><name><name>WorkflowJobBean</name><operator>.</operator><name>Status</name><operator>.</operator><name>KILLED</name></name></expr></argument>)</argument_list></call></block></expr>;</expr_stmt>
                    <try>try <block>{<block_content>
                        <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>WorkflowActionUpdateJPAExecutor</name><argument_list>(<argument><expr><name>wfAction</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                        <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>WorkflowJobUpdateJPAExecutor</name><argument_list>(<argument><expr><name>wfJob</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                    </block_content>}</block>
                    <catch>catch <parameter_list>(<parameter><decl><type><name>JPAExecutorException</name></type> <name>je</name></decl></parameter>)</parameter_list> <block>{<block_content>
                        <throw>throw <expr><operator>new</operator> <call><name>CommandException</name><argument_list>(<argument><expr><name>je</name></expr></argument>)</argument_list></call></expr>;</throw>
                    </block_content>}</block></catch></try>
                    <expr_stmt><expr><call><name><name>updateList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>wfAction</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                    <expr_stmt><expr><call><name><name>wfJob</name><operator>.</operator><name>setLastModifiedTime</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>Date</name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                    <expr_stmt><expr><call><name><name>updateList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>wfJob</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                     <comment type="line">// What will happen to WF and COORD_ACTION, NOTIFICATION?</comment>
                    <expr_stmt><expr><call><name><name>SLADbXOperations</name><operator>.</operator><name>writeStausEvent</name></name><argument_list>(<argument><expr><call><name><name>wfAction</name><operator>.</operator><name>getSlaXml</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><call><name><name>wfAction</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><name><name>Status</name><operator>.</operator><name>FAILED</name></name></expr></argument>,
                    <argument><expr><name>SLAEventBean</name> <name>slaEvent</name> <operator>=</operator> <call><name><name>SLADbXOperations</name><operator>.</operator><name>createStatusEvent</name></name><argument_list>(<argument><expr><call><name><name>wfAction</name><operator>.</operator><name>getSlaXml</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><call><name><name>wfAction</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><name><name>Status</name><operator>.</operator><name>FAILED</name></name></expr></argument>,
                             <argument><expr><name><name>SlaAppType</name><operator>.</operator><name>WORKFLOW_ACTION</name></name></expr></argument>)</argument_list></call></expr></argument>;</argument_list></call></expr></expr_stmt>
                    <if_stmt><if>if<condition>(<expr><name>slaEvent</name> <operator>!=</operator> <literal type="null">null</literal></expr>)</condition> <block>{<block_content>
                        <expr_stmt><expr><call><name><name>insertList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>slaEvent</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                    </block_content>}</block></if></if_stmt>
                     <expr_stmt><expr><call><name><name>LOG</name><operator>.</operator><name>warn</name></name><argument_list>(<argument><expr><literal type="string">"Exception while executing kill(). Error Code [{0}], Message[{1}]"</literal></expr></argument>,
                             <argument><expr><call><name><name>ex</name><operator>.</operator><name>getErrorCode</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><call><name><name>ex</name><operator>.</operator><name>getMessage</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><name>ex</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                 </block_content>}</block></catch>
                <catch>catch <parameter_list>(<parameter><decl><type><name>JPAExecutorException</name></type> <name>je</name></decl></parameter>)</parameter_list> <block>{<block_content>
                    <throw>throw <expr><operator>new</operator> <call><name>CommandException</name><argument_list>(<argument><expr><name>je</name></expr></argument>)</argument_list></call></expr>;</throw>
                <finally>finally <block>{<block_content>
                    <try>try <block>{<block_content>
                        <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>BulkUpdateInsertJPAExecutor</name><argument_list>(<argument><expr><name>updateList</name></expr></argument>, <argument><expr><name>insertList</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                    </block_content>}</block>
                    <catch>catch <parameter_list>(<parameter><decl><type><name>JPAExecutorException</name></type> <name>e</name></decl></parameter>)</parameter_list> <block>{<block_content>
                        <throw>throw <expr><operator>new</operator> <call><name>CommandException</name><argument_list>(<argument><expr><name>e</name></expr></argument>)</argument_list></call></expr>;</throw>
                    </block_content>}</block></catch></try>
                 </block_content>}</block></finally>
             </block_content>}</block></catch>
         </block_content>}</block></finally>
<expr_stmt><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>wf</name><operator>/</operator><name><name>ActionStartXCommand</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>wf</name><operator>/</operator><name><name>ActionStartXCommand</name><operator>.</operator><name>java</name></name>
<name>index</name> <literal type="number">78b61dadc</literal><operator>..</operator><literal type="number">4b2c6e9d8</literal> <literal type="number">100644</literal>
<operator>--</operator> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>wf</name><operator>/</operator><name><name>ActionStartXCommand</name><operator>.</operator><name>java</name></name>
<operator>++</operator> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>wf</name><operator>/</operator><name><name>ActionStartXCommand</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">17</literal></expr><operator>,</operator><expr><literal type="number">12</literal> <operator>+</operator><literal type="number">17</literal></expr><operator>,</operator><expr><literal type="number">15</literal> @@
  <operator>*</operator><operator>/</operator></expr></expr_stmt>
 <package>package <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>wf</name></name>;</package>
 
<import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>ArrayList</name></name>;</import>
 <import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>Date</name></name>;</import>
<import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>List</name></name>;</import>
 
 <import>import <name><name>javax</name><operator>.</operator><name>servlet</name><operator>.</operator><name>jsp</name><operator>.</operator><name>el</name><operator>.</operator><name>ELException</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>hadoop</name><operator>.</operator><name>conf</name><operator>.</operator><name>Configuration</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>ErrorCode</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>FaultInjection</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>SLAEventBean</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>WorkflowActionBean</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>WorkflowJobBean</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>XException</name></name>;</import>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">34</literal></expr><operator>,</operator><expr><literal type="number">14</literal> <operator>+</operator><literal type="number">37</literal></expr><operator>,</operator><expr><literal type="number">14</literal> @@</expr></expr_stmt> <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>WorkflowAction</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>WorkflowJob</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>SLAEvent</name><operator>.</operator><name>SlaAppType</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>SLAEvent</name><operator>.</operator><name>Status</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>rest</name><operator>.</operator><name>JsonBean</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>CommandException</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>PreconditionException</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>coord</name><operator>.</operator><name>CoordActionUpdateXCommand</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>BulkUpdateInsertJPAExecutor</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>JPAExecutorException</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>WorkflowActionGetJPAExecutor</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>WorkflowActionUpdateJPAExecutor</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>WorkflowJobGetJPAExecutor</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>WorkflowJobUpdateJPAExecutor</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>ActionService</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>JPAService</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>Services</name></name>;</import>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">66</literal></expr><operator>,</operator><expr><literal type="number">6</literal> <operator>+</operator><literal type="number">69</literal></expr><operator>,</operator><expr><literal type="number">8</literal> @@ <specifier>public</specifier> <name>class</name> <name>ActionStartXCommand</name> extends <name><name>ActionXCommand</name><argument_list type="generic">&lt;<argument><name>Void</name></argument>&gt;</argument_list></name> <block>{
     <expr><specifier>private</specifier> <name>WorkflowActionBean</name> <name>wfAction</name> <operator>=</operator> <literal type="null">null</literal></expr>;
     <specifier>private</specifier> <name>JPAService</name> <name>jpaService</name> <operator>=</operator> <literal type="null">null</literal></block></expr>;</expr_stmt>
     <decl_stmt><decl><type><specifier>private</specifier> <name>ActionExecutor</name></type> <name>executor</name> <init>= <expr><literal type="null">null</literal></expr></init></decl>;</decl_stmt>
    <decl_stmt><decl><type><specifier>private</specifier> <name><name>List</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name></type> <name>updateList</name> <init>= <expr><operator>new</operator> <call><name><name>ArrayList</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
    <decl_stmt><decl><type><specifier>private</specifier> <name><name>List</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name></type> <name>insertList</name> <init>= <expr><operator>new</operator> <call><name><name>ArrayList</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
 
     <constructor><specifier>public</specifier> <name>ActionStartXCommand</name><parameter_list>(<parameter><decl><type><name>String</name></type> <name>actionId</name></decl></parameter>, <parameter><decl><type><name>String</name></type> <name>type</name></decl></parameter>)</parameter_list> <block>{<block_content>
         <expr_stmt><expr><call><name>super</name><argument_list>(<argument><expr><literal type="string">"action.start"</literal></expr></argument>, <argument><expr><name>type</name></expr></argument>, <argument><expr><literal type="number">0</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">159</literal></expr><operator>,</operator><expr><literal type="number">6</literal> <operator>+</operator><literal type="number">164</literal></expr><operator>,</operator><expr><literal type="number">7</literal> @@ <specifier>public</specifier> <name>class</name> <name>ActionStartXCommand</name> extends <name><name>ActionXCommand</name><argument_list type="generic">&lt;<argument><name>Void</name></argument>&gt;</argument_list></name> <block>{
                 <expr><name>isUserRetry</name> <operator>=</operator> <literal type="boolean">true</literal></expr>;
             }</block></expr></expr_stmt>
             <expr_stmt><expr><name>context</name> <operator>=</operator> <operator>new</operator> <call><name><name>ActionXCommand</name><operator>.</operator><name>ActionExecutorContext</name></name><argument_list>(<argument><expr><name>wfJob</name></expr></argument>, <argument><expr><name>wfAction</name></expr></argument>, <argument><expr><name>isRetry</name></expr></argument>, <argument><expr><name>isUserRetry</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <decl_stmt><decl><type><name>boolean</name></type> <name>caught</name> <init>= <expr><literal type="boolean">false</literal></expr></init></decl>;</decl_stmt>
             <try>try <block>{<block_content>
                 <if_stmt><if>if <condition>(<expr><operator>!</operator><operator>(</operator><name>executor</name> <operator>instanceof</operator> <name>ControlNodeActionExecutor</name><operator>)</operator></expr>)</condition> <block>{<block_content>
                     <decl_stmt><decl><type><name>String</name></type> <name>tmpActionConf</name> <init>= <expr><call><name><name>XmlUtils</name><operator>.</operator><name>removeComments</name></name><argument_list>(<argument><expr><call><name><name>wfAction</name><operator>.</operator><name>getConf</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">169</literal></expr><operator>,</operator><expr><literal type="number">79</literal> <operator>+</operator><literal type="number">175</literal></expr><operator>,</operator><expr><literal type="number">81</literal> @@ <specifier>public</specifier> <name>class</name> <name>ActionStartXCommand</name> extends <name><name>ActionXCommand</name><argument_list type="generic">&lt;<argument><name>Void</name></argument>&gt;</argument_list></name> <block>{
                 }</block></expr></expr_stmt>
             </block_content>}</block></if></if_stmt>
             <catch>catch <parameter_list>(<parameter><decl><type><name>ELEvaluationException</name></type> <name>ex</name></decl></parameter>)</parameter_list> <block>{<block_content>
                <expr_stmt><expr><name>caught</name> <operator>=</operator> <literal type="boolean">true</literal></expr>;</expr_stmt>
                 <throw>throw <expr><operator>new</operator> <call><name>ActionExecutorException</name><argument_list>(<argument><expr><name><name>ActionExecutorException</name><operator>.</operator><name>ErrorType</name><operator>.</operator><name>TRANSIENT</name></name></expr></argument>, <argument><expr><name>EL_EVAL_ERROR</name></expr></argument>, <argument><expr><call><name><name>ex</name>
                         <operator>.</operator><name>getMessage</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><name>ex</name></expr></argument>)</argument_list></call></expr>;</throw>
             </block_content>}</block></catch>
             <catch>catch <parameter_list>(<parameter><decl><type><name>ELException</name></type> <name>ex</name></decl></parameter>)</parameter_list> <block>{<block_content>
                <expr_stmt><expr><name>caught</name> <operator>=</operator> <literal type="boolean">true</literal></expr>;</expr_stmt>
                 <expr_stmt><expr><call><name><name>context</name><operator>.</operator><name>setErrorInfo</name></name><argument_list>(<argument><expr><name>EL_ERROR</name></expr></argument>, <argument><expr><call><name><name>ex</name><operator>.</operator><name>getMessage</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                 <expr_stmt><expr><call><name><name>LOG</name><operator>.</operator><name>warn</name></name><argument_list>(<argument><expr><literal type="string">"ELException in ActionStartXCommand "</literal></expr></argument>, <argument><expr><call><name><name>ex</name><operator>.</operator><name>getMessage</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><name>ex</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                 <expr_stmt><expr><call><name>handleError</name><argument_list>(<argument><expr><name>context</name></expr></argument>, <argument><expr><name>wfJob</name></expr></argument>, <argument><expr><name>wfAction</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                <return>return <expr><literal type="null">null</literal></expr>;</return>
             </block_content>}</block></catch>
             <catch>catch <parameter_list>(<parameter><decl><type><name><name>org</name><operator>.</operator><name>jdom</name><operator>.</operator><name>JDOMException</name></name></type> <name>je</name></decl></parameter>)</parameter_list> <block>{<block_content>
                <expr_stmt><expr><name>caught</name> <operator>=</operator> <literal type="boolean">true</literal></expr>;</expr_stmt>
                 <expr_stmt><expr><call><name><name>context</name><operator>.</operator><name>setErrorInfo</name></name><argument_list>(<argument><expr><literal type="string">"ParsingError"</literal></expr></argument>, <argument><expr><call><name><name>je</name><operator>.</operator><name>getMessage</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                 <expr_stmt><expr><call><name><name>LOG</name><operator>.</operator><name>warn</name></name><argument_list>(<argument><expr><literal type="string">"JDOMException in ActionStartXCommand "</literal></expr></argument>, <argument><expr><call><name><name>je</name><operator>.</operator><name>getMessage</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><name>je</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                 <expr_stmt><expr><call><name>handleError</name><argument_list>(<argument><expr><name>context</name></expr></argument>, <argument><expr><name>wfJob</name></expr></argument>, <argument><expr><name>wfAction</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                <return>return <expr><literal type="null">null</literal></expr>;</return>
             </block_content>}</block></catch>
             <catch>catch <parameter_list>(<parameter><decl><type><name>Exception</name></type> <name>ex</name></decl></parameter>)</parameter_list> <block>{<block_content>
                <expr_stmt><expr><name>caught</name> <operator>=</operator> <literal type="boolean">true</literal></expr>;</expr_stmt>
                 <expr_stmt><expr><call><name><name>context</name><operator>.</operator><name>setErrorInfo</name></name><argument_list>(<argument><expr><name>EL_ERROR</name></expr></argument>, <argument><expr><call><name><name>ex</name><operator>.</operator><name>getMessage</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                 <expr_stmt><expr><call><name><name>LOG</name><operator>.</operator><name>warn</name></name><argument_list>(<argument><expr><literal type="string">"Exception in ActionStartXCommand "</literal></expr></argument>, <argument><expr><call><name><name>ex</name><operator>.</operator><name>getMessage</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><name>ex</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                 <expr_stmt><expr><call><name>handleError</name><argument_list>(<argument><expr><name>context</name></expr></argument>, <argument><expr><name>wfJob</name></expr></argument>, <argument><expr><name>wfAction</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                <return>return <expr><literal type="null">null</literal></expr>;</return>
             </block_content>}</block></catch>
            <expr_stmt><expr><call><name><name>wfAction</name><operator>.</operator><name>setErrorInfo</name></name><argument_list>(<argument><expr><literal type="null">null</literal></expr></argument>, <argument><expr><literal type="null">null</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name>incrActionCounter</name><argument_list>(<argument><expr><call><name><name>wfAction</name><operator>.</operator><name>getType</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><literal type="number">1</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <if_stmt><if>if<condition>(<expr><operator>!</operator><name>caught</name></expr>)</condition> <block>{<block_content>
                <expr_stmt><expr><call><name><name>wfAction</name><operator>.</operator><name>setErrorInfo</name></name><argument_list>(<argument><expr><literal type="null">null</literal></expr></argument>, <argument><expr><literal type="null">null</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                <expr_stmt><expr><call><name>incrActionCounter</name><argument_list>(<argument><expr><call><name><name>wfAction</name><operator>.</operator><name>getType</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><literal type="number">1</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
 
            <expr_stmt><expr><call><name><name>LOG</name><operator>.</operator><name>info</name></name><argument_list>(<argument><expr><literal type="string">"Start action [{0}] with user-retry state : userRetryCount [{1}], userRetryMax [{2}], userRetryInterval [{3}]"</literal></expr></argument>,
                            <argument><expr><call><name><name>wfAction</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><call><name><name>wfAction</name><operator>.</operator><name>getUserRetryCount</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><call><name><name>wfAction</name><operator>.</operator><name>getUserRetryMax</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><call><name><name>wfAction</name>
                                    <operator>.</operator><name>getUserRetryInterval</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                <expr_stmt><expr><call><name><name>LOG</name><operator>.</operator><name>info</name></name><argument_list>(<argument><expr><literal type="string">"Start action [{0}] with user-retry state : userRetryCount [{1}], userRetryMax [{2}], userRetryInterval [{3}]"</literal></expr></argument>,
                                <argument><expr><call><name><name>wfAction</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><call><name><name>wfAction</name><operator>.</operator><name>getUserRetryCount</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><call><name><name>wfAction</name><operator>.</operator><name>getUserRetryMax</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><call><name><name>wfAction</name>
                                        <operator>.</operator><name>getUserRetryInterval</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
 
            <decl_stmt><decl><type><name><name>Instrumentation</name><operator>.</operator><name>Cron</name></name></type> <name>cron</name> <init>= <expr><operator>new</operator> <call><name><name>Instrumentation</name><operator>.</operator><name>Cron</name></name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
            <expr_stmt><expr><call><name><name>cron</name><operator>.</operator><name>start</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name><name>context</name><operator>.</operator><name>setStartTime</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name><name>executor</name><operator>.</operator><name>start</name></name><argument_list>(<argument><expr><name>context</name></expr></argument>, <argument><expr><name>wfAction</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name><name>cron</name><operator>.</operator><name>stop</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name><name>FaultInjection</name><operator>.</operator><name>activate</name></name><argument_list>(<argument><expr><literal type="string">"org.apache.oozie.command.SkipCommitFaultInjection"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name>addActionCron</name><argument_list>(<argument><expr><call><name><name>wfAction</name><operator>.</operator><name>getType</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><name>cron</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                <decl_stmt><decl><type><name><name>Instrumentation</name><operator>.</operator><name>Cron</name></name></type> <name>cron</name> <init>= <expr><operator>new</operator> <call><name><name>Instrumentation</name><operator>.</operator><name>Cron</name></name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
                <expr_stmt><expr><call><name><name>cron</name><operator>.</operator><name>start</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
                <expr_stmt><expr><call><name><name>context</name><operator>.</operator><name>setStartTime</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
                <expr_stmt><expr><call><name><name>executor</name><operator>.</operator><name>start</name></name><argument_list>(<argument><expr><name>context</name></expr></argument>, <argument><expr><name>wfAction</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                <expr_stmt><expr><call><name><name>cron</name><operator>.</operator><name>stop</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
                <expr_stmt><expr><call><name><name>FaultInjection</name><operator>.</operator><name>activate</name></name><argument_list>(<argument><expr><literal type="string">"org.apache.oozie.command.SkipCommitFaultInjection"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                <expr_stmt><expr><call><name>addActionCron</name><argument_list>(<argument><expr><call><name><name>wfAction</name><operator>.</operator><name>getType</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><name>cron</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
 
            <expr_stmt><expr><call><name><name>wfAction</name><operator>.</operator><name>setRetries</name></name><argument_list>(<argument><expr><literal type="number">0</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <if_stmt><if>if <condition>(<expr><call><name><name>wfAction</name><operator>.</operator><name>isExecutionComplete</name></name><argument_list>()</argument_list></call></expr>)</condition> <block>{<block_content>
                <if_stmt><if>if <condition>(<expr><operator>!</operator><call><name><name>context</name><operator>.</operator><name>isExecuted</name></name><argument_list>()</argument_list></call></expr>)</condition> <block>{<block_content>
                    <expr_stmt><expr><call><name><name>LOG</name><operator>.</operator><name>warn</name></name><argument_list>(<argument><expr><name><name>XLog</name><operator>.</operator><name>OPS</name></name></expr></argument>, <argument><expr><literal type="string">"Action Completed, ActionExecutor [{0}] must call setExecutionData()"</literal></expr></argument>, <argument><expr><call><name><name>executor</name>
                            <operator>.</operator><name>getType</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                    <expr_stmt><expr><call><name><name>wfAction</name><operator>.</operator><name>setErrorInfo</name></name><argument_list>(<argument><expr><name>EXEC_DATA_MISSING</name></expr></argument>,
                            <argument><expr><literal type="string">"Execution Complete, but Execution Data Missing from Action"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                    <expr_stmt><expr><call><name>failJob</name><argument_list>(<argument><expr><name>context</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                    <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>WorkflowActionUpdateJPAExecutor</name><argument_list>(<argument><expr><name>wfAction</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                    <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>WorkflowJobUpdateJPAExecutor</name><argument_list>(<argument><expr><name>wfJob</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                    <return>return <expr><literal type="null">null</literal></expr>;</return>
                <expr_stmt><expr><call><name><name>wfAction</name><operator>.</operator><name>setRetries</name></name><argument_list>(<argument><expr><literal type="number">0</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                <if_stmt><if>if <condition>(<expr><call><name><name>wfAction</name><operator>.</operator><name>isExecutionComplete</name></name><argument_list>()</argument_list></call></expr>)</condition> <block>{<block_content>
                    <if_stmt><if>if <condition>(<expr><operator>!</operator><call><name><name>context</name><operator>.</operator><name>isExecuted</name></name><argument_list>()</argument_list></call></expr>)</condition> <block>{<block_content>
                        <expr_stmt><expr><call><name><name>LOG</name><operator>.</operator><name>warn</name></name><argument_list>(<argument><expr><name><name>XLog</name><operator>.</operator><name>OPS</name></name></expr></argument>, <argument><expr><literal type="string">"Action Completed, ActionExecutor [{0}] must call setExecutionData()"</literal></expr></argument>, <argument><expr><call><name><name>executor</name>
                                <operator>.</operator><name>getType</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                        <expr_stmt><expr><call><name><name>wfAction</name><operator>.</operator><name>setErrorInfo</name></name><argument_list>(<argument><expr><name>EXEC_DATA_MISSING</name></expr></argument>,
                                <argument><expr><literal type="string">"Execution Complete, but Execution Data Missing from Action"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                        <expr_stmt><expr><call><name>failJob</name><argument_list>(<argument><expr><name>context</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                    </block_content>}</block></if> <else>else <block>{<block_content>
                        <expr_stmt><expr><call><name><name>wfAction</name><operator>.</operator><name>setPending</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
                        <expr_stmt><expr><call><name>queue</name><argument_list>(<argument><expr><operator>new</operator> <call><name>ActionEndXCommand</name><argument_list>(<argument><expr><call><name><name>wfAction</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><call><name><name>wfAction</name><operator>.</operator><name>getType</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                    </block_content>}</block></else></if_stmt>
                 </block_content>}</block></if></if_stmt>
                <expr_stmt><expr><call><name><name>wfAction</name><operator>.</operator><name>setPending</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
                <expr_stmt><expr><call><name>queue</name><argument_list>(<argument><expr><operator>new</operator> <call><name>ActionEndXCommand</name><argument_list>(<argument><expr><call><name><name>wfAction</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><call><name><name>wfAction</name><operator>.</operator><name>getType</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            </block_content>}</block></if>
            <else>else <block>{<block_content>
                <if_stmt><if>if <condition>(<expr><operator>!</operator><call><name><name>context</name><operator>.</operator><name>isStarted</name></name><argument_list>()</argument_list></call></expr>)</condition> <block>{<block_content>
                    <expr_stmt><expr><call><name><name>LOG</name><operator>.</operator><name>warn</name></name><argument_list>(<argument><expr><name><name>XLog</name><operator>.</operator><name>OPS</name></name></expr></argument>, <argument><expr><literal type="string">"Action Started, ActionExecutor [{0}] must call setStartData()"</literal></expr></argument>, <argument><expr><call><name><name>executor</name>
                            <operator>.</operator><name>getType</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                    <expr_stmt><expr><call><name><name>wfAction</name><operator>.</operator><name>setErrorInfo</name></name><argument_list>(<argument><expr><name>START_DATA_MISSING</name></expr></argument>, <argument><expr><literal type="string">"Execution Started, but Start Data Missing from Action"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                    <expr_stmt><expr><call><name>failJob</name><argument_list>(<argument><expr><name>context</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                    <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>WorkflowActionUpdateJPAExecutor</name><argument_list>(<argument><expr><name>wfAction</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                    <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>WorkflowJobUpdateJPAExecutor</name><argument_list>(<argument><expr><name>wfJob</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                    <return>return <expr><literal type="null">null</literal></expr>;</return>
                <if_stmt><else>else <block>{<block_content>
                    <if_stmt><if>if <condition>(<expr><operator>!</operator><call><name><name>context</name><operator>.</operator><name>isStarted</name></name><argument_list>()</argument_list></call></expr>)</condition> <block>{<block_content>
                        <expr_stmt><expr><call><name><name>LOG</name><operator>.</operator><name>warn</name></name><argument_list>(<argument><expr><name><name>XLog</name><operator>.</operator><name>OPS</name></name></expr></argument>, <argument><expr><literal type="string">"Action Started, ActionExecutor [{0}] must call setStartData()"</literal></expr></argument>, <argument><expr><call><name><name>executor</name>
                                <operator>.</operator><name>getType</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                        <expr_stmt><expr><call><name><name>wfAction</name><operator>.</operator><name>setErrorInfo</name></name><argument_list>(<argument><expr><name>START_DATA_MISSING</name></expr></argument>, <argument><expr><literal type="string">"Execution Started, but Start Data Missing from Action"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                        <expr_stmt><expr><call><name>failJob</name><argument_list>(<argument><expr><name>context</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                    </block_content>}</block></if> <else>else <block>{<block_content>
                        <expr_stmt><expr><call><name>queue</name><argument_list>(<argument><expr><operator>new</operator> <call><name>NotificationXCommand</name><argument_list>(<argument><expr><name>wfJob</name></expr></argument>, <argument><expr><name>wfAction</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                    </block_content>}</block></else></if_stmt>
                 </block_content>}</block></else></if_stmt>
                <expr_stmt><expr><call><name>queue</name><argument_list>(<argument><expr><operator>new</operator> <call><name>NotificationXCommand</name><argument_list>(<argument><expr><name>wfJob</name></expr></argument>, <argument><expr><name>wfAction</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            </block_content>}</block></if></if_stmt>
 
            <expr_stmt><expr><call><name><name>LOG</name><operator>.</operator><name>warn</name></name><argument_list>(<argument><expr><name><name>XLog</name><operator>.</operator><name>STD</name></name></expr></argument>, <argument><expr><literal type="string">"[***"</literal> <operator>+</operator> <call><name><name>wfAction</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call> <operator>+</operator> <literal type="string">"***]"</literal> <operator>+</operator> <literal type="string">"Action status="</literal> <operator>+</operator> <call><name><name>wfAction</name><operator>.</operator><name>getStatusStr</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>

            <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>WorkflowActionUpdateJPAExecutor</name><argument_list>(<argument><expr><name>wfAction</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>WorkflowJobUpdateJPAExecutor</name><argument_list>(<argument><expr><name>wfJob</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <comment type="line">// Add SLA status event (STARTED) for WF_ACTION</comment>
            <expr_stmt><expr><call><name><name>SLADbXOperations</name><operator>.</operator><name>writeStausEvent</name></name><argument_list>(<argument><expr><call><name><name>wfAction</name><operator>.</operator><name>getSlaXml</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><call><name><name>wfAction</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><name><name>Status</name><operator>.</operator><name>STARTED</name></name></expr></argument>,
                    <argument><expr><name><name>SlaAppType</name><operator>.</operator><name>WORKFLOW_ACTION</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name><name>LOG</name><operator>.</operator><name>warn</name></name><argument_list>(<argument><expr><name><name>XLog</name><operator>.</operator><name>STD</name></name></expr></argument>, <argument><expr><literal type="string">"[***"</literal> <operator>+</operator> <call><name><name>wfAction</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call> <operator>+</operator> <literal type="string">"***]"</literal> <operator>+</operator> <literal type="string">"Action updated in DB!"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                <expr_stmt><expr><call><name><name>LOG</name><operator>.</operator><name>warn</name></name><argument_list>(<argument><expr><name><name>XLog</name><operator>.</operator><name>STD</name></name></expr></argument>, <argument><expr><literal type="string">"[***"</literal> <operator>+</operator> <call><name><name>wfAction</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call> <operator>+</operator> <literal type="string">"***]"</literal> <operator>+</operator> <literal type="string">"Action status="</literal> <operator>+</operator> <call><name><name>wfAction</name><operator>.</operator><name>getStatusStr</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
 
                <expr_stmt><expr><call><name><name>updateList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>wfAction</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                <expr_stmt><expr><call><name><name>wfJob</name><operator>.</operator><name>setLastModifiedTime</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>Date</name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                <expr_stmt><expr><call><name><name>updateList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>wfJob</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                <comment type="line">// Add SLA status event (STARTED) for WF_ACTION</comment>
                <decl_stmt><decl><type><name>SLAEventBean</name></type> <name>slaEvent</name> <init>= <expr><call><name><name>SLADbXOperations</name><operator>.</operator><name>createStatusEvent</name></name><argument_list>(<argument><expr><call><name><name>wfAction</name><operator>.</operator><name>getSlaXml</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><call><name><name>wfAction</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><name><name>Status</name><operator>.</operator><name>STARTED</name></name></expr></argument>,
                        <argument><expr><name><name>SlaAppType</name><operator>.</operator><name>WORKFLOW_ACTION</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
                <if_stmt><if>if<condition>(<expr><name>slaEvent</name> <operator>!=</operator> <literal type="null">null</literal></expr>)</condition> <block>{<block_content>
                    <expr_stmt><expr><call><name><name>insertList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>slaEvent</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                </block_content>}</block></if></if_stmt>
                <expr_stmt><expr><call><name><name>LOG</name><operator>.</operator><name>warn</name></name><argument_list>(<argument><expr><name><name>XLog</name><operator>.</operator><name>STD</name></name></expr></argument>, <argument><expr><literal type="string">"[***"</literal> <operator>+</operator> <call><name><name>wfAction</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call> <operator>+</operator> <literal type="string">"***]"</literal> <operator>+</operator> <literal type="string">"Action updated in DB!"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            </block_content>}</block></else></if_stmt>
         </block_content>}</block></if></if_stmt>
         <catch>catch <parameter_list>(<parameter><decl><type><name>ActionExecutorException</name></type> <name>ex</name></decl></parameter>)</parameter_list> <block>{<block_content>
             <expr_stmt><expr><call><name><name>LOG</name><operator>.</operator><name>warn</name></name><argument_list>(<argument><expr><literal type="string">"Error starting action [{0}]. ErrorType [{1}], ErrorCode [{2}], Message [{3}]"</literal></expr></argument>,
<argument>@@ <expr><operator>-</operator><literal type="number">269</literal></expr></argument>,<argument><expr><literal type="number">27</literal> <operator>+</operator><literal type="number">277</literal></expr></argument>,<argument><expr><literal type="number">34</literal> @@ <specifier>public</specifier> class <name>ActionStartXCommand</name> extends <name><name>ActionXCommand</name><argument_list type="generic">&lt;<argument><name>Void</name></argument>&gt;</argument_list></name> <block>{
                         <comment type="line">// update coordinator action</comment>
                         <expr><operator>new</operator> <call><name>CoordActionUpdateXCommand</name><argument_list>(<argument><expr><name>wfJob</name></expr></argument>, <argument><expr><literal type="number">3</literal></expr></argument>)</argument_list></call><operator>.</operator><call><name>call</name><argument_list>()</argument_list></call></expr>;
                         <operator>new</operator> <call><name>WfEndXCommand</name><argument_list>(<argument><expr><name>wfJob</name></expr></argument>)</argument_list></call><operator>.</operator><call><name>call</name><argument_list>()</argument_list></call></block></expr></argument>;</argument_list></call></expr></expr_stmt> <comment type="line">// To delete the WF temp dir</comment>
                        <expr_stmt><expr><call><name><name>SLADbXOperations</name><operator>.</operator><name>writeStausEvent</name></name><argument_list>(<argument><expr><call><name><name>wfAction</name><operator>.</operator><name>getSlaXml</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><call><name><name>wfAction</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><name><name>Status</name><operator>.</operator><name>FAILED</name></name></expr></argument>,
                        <argument><expr><name>SLAEventBean</name> <name>slaEvent1</name> <operator>=</operator> <call><name><name>SLADbXOperations</name><operator>.</operator><name>createStatusEvent</name></name><argument_list>(<argument><expr><call><name><name>wfAction</name><operator>.</operator><name>getSlaXml</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><call><name><name>wfAction</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><name><name>Status</name><operator>.</operator><name>FAILED</name></name></expr></argument>,
                                 <argument><expr><name><name>SlaAppType</name><operator>.</operator><name>WORKFLOW_ACTION</name></name></expr></argument>)</argument_list></call></expr></argument>;</argument_list></call></expr></expr_stmt>
                        <expr_stmt><expr><call><name><name>SLADbXOperations</name><operator>.</operator><name>writeStausEvent</name></name><argument_list>(<argument><expr><call><name><name>wfJob</name><operator>.</operator><name>getSlaXml</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><call><name><name>wfJob</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><name><name>Status</name><operator>.</operator><name>FAILED</name></name></expr></argument>,
                        if<argument><expr><operator>(</operator><name>slaEvent1</name> <operator>!=</operator> <literal type="null">null</literal><operator>)</operator> <block>{
                            <expr><call><name><name>insertList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>slaEvent1</name></expr></argument>)</argument_list></call></expr>;
                        }</block></expr></argument></argument_list></call></expr></expr_stmt>
                        <decl_stmt><decl><type><name>SLAEventBean</name></type> <name>slaEvent2</name> <init>= <expr><call><name><name>SLADbXOperations</name><operator>.</operator><name>createStatusEvent</name></name><argument_list>(<argument><expr><call><name><name>wfJob</name><operator>.</operator><name>getSlaXml</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><call><name><name>wfJob</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><name><name>Status</name><operator>.</operator><name>FAILED</name></name></expr></argument>,
                                 <argument><expr><name><name>SlaAppType</name><operator>.</operator><name>WORKFLOW_JOB</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
                        <if_stmt><if>if<condition>(<expr><name>slaEvent2</name> <operator>!=</operator> <literal type="null">null</literal></expr>)</condition> <block>{<block_content>
                            <expr_stmt><expr><call><name><name>insertList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>slaEvent2</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                        </block_content>}</block></if></if_stmt>
                     </block_content>}</block></catch>
                     <catch>catch <parameter_list>(<parameter><decl><type><name>XException</name></type> <name>x</name></decl></parameter>)</parameter_list> <block>{<block_content>
                         <expr_stmt><expr><call><name><name>LOG</name><operator>.</operator><name>warn</name></name><argument_list>(<argument><expr><literal type="string">"ActionStartXCommand - case:FAILED "</literal></expr></argument>, <argument><expr><call><name><name>x</name><operator>.</operator><name>getMessage</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                     </block_content>}</block></catch>
                     <break>break;</break>
             </block_content>}</block></if></if_stmt>
            <expr_stmt><expr><call><name><name>updateList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>wfAction</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name><name>wfJob</name><operator>.</operator><name>setLastModifiedTime</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>Date</name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name><name>updateList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>wfJob</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        </block_content>}</block>
        <finally>finally <block>{<block_content>
             <try>try <block>{<block_content>
                <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>WorkflowActionUpdateJPAExecutor</name><argument_list>(<argument><expr><name>wfAction</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>WorkflowJobUpdateJPAExecutor</name><argument_list>(<argument><expr><name>wfJob</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>BulkUpdateInsertJPAExecutor</name><argument_list>(<argument><expr><name>updateList</name></expr></argument>, <argument><expr><name>insertList</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
             </block_content>}</block>
            <catch>catch <parameter_list>(<parameter><decl><type><name>JPAExecutorException</name></type> <name>je</name></decl></parameter>)</parameter_list> <block>{<block_content>
                <throw>throw <expr><operator>new</operator> <call><name>CommandException</name><argument_list>(<argument><expr><name>je</name></expr></argument>)</argument_list></call></expr>;</throw>
            <catch>catch <parameter_list>(<parameter><decl><type><name>JPAExecutorException</name></type> <name>e</name></decl></parameter>)</parameter_list> <block>{<block_content>
                <throw>throw <expr><operator>new</operator> <call><name>CommandException</name><argument_list>(<argument><expr><name>e</name></expr></argument>)</argument_list></call></expr>;</throw>
             </block_content>}</block></catch>
         </block_content>}</block></catch>
        <catch>catch <parameter_list>(<parameter><decl><type><name>JPAExecutorException</name></type> <name>je</name></decl></parameter>)</parameter_list> <block>{<block_content>
            <throw>throw <expr><operator>new</operator> <call><name>CommandException</name><argument_list>(<argument><expr><name>je</name></expr></argument>)</argument_list></call></expr>;</throw>
        </block_content>}</block></catch></try>
 
         <expr_stmt><expr><call><name><name>LOG</name><operator>.</operator><name>debug</name></name><argument_list>(<argument><expr><literal type="string">"ENDED ActionStartXCommand for wf actionId="</literal> <operator>+</operator> <name>actionId</name> <operator>+</operator> <literal type="string">", jobId="</literal> <operator>+</operator> <name>jobId</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
 
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">299</literal></expr><operator>,</operator><expr><literal type="number">15</literal> <operator>+</operator><literal type="number">314</literal></expr><operator>,</operator><expr><literal type="number">19</literal> @@ <specifier>public</specifier> <name>class</name> <name>ActionStartXCommand</name> extends <name><name>ActionXCommand</name><argument_list type="generic">&lt;<argument><name>Void</name></argument>&gt;</argument_list></name> <block>{
     <expr><specifier>private</specifier> <name>void</name> <call><name>handleError</name><argument_list>(<argument><expr><name>ActionExecutorContext</name> <name>context</name></expr></argument>, <argument><expr><name>WorkflowJobBean</name> <name>workflow</name></expr></argument>, <argument><expr><name>WorkflowActionBean</name> <name>action</name></expr></argument>)</argument_list></call>
             <throws>throws <argument><expr><name>CommandException</name> <block>{
         <expr><call><name>failJob</name><argument_list>(<argument><expr><name>context</name></expr></argument>)</argument_list></call></expr></block></expr></argument></throws></expr>;</block></expr></expr_stmt>
        <try>try <block>{<block_content>
            <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>WorkflowActionUpdateJPAExecutor</name><argument_list>(<argument><expr><name>action</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>WorkflowJobUpdateJPAExecutor</name><argument_list>(<argument><expr><name>workflow</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>updateList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>wfAction</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>wfJob</name><operator>.</operator><name>setLastModifiedTime</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>Date</name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>updateList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>wfJob</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <decl_stmt><decl><type><name>SLAEventBean</name></type> <name>slaEvent1</name> <init>= <expr><call><name><name>SLADbXOperations</name><operator>.</operator><name>createStatusEvent</name></name><argument_list>(<argument><expr><call><name><name>action</name><operator>.</operator><name>getSlaXml</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><call><name><name>action</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>,
                <argument><expr><name><name>Status</name><operator>.</operator><name>FAILED</name></name></expr></argument>, <argument><expr><name><name>SlaAppType</name><operator>.</operator><name>WORKFLOW_ACTION</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <if_stmt><if>if<condition>(<expr><name>slaEvent1</name> <operator>!=</operator> <literal type="null">null</literal></expr>)</condition> <block>{<block_content>
            <expr_stmt><expr><call><name><name>insertList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>slaEvent1</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
         </block_content>}</block></if></if_stmt>
        <catch>catch <parameter_list>(<parameter><decl><type><name>JPAExecutorException</name></type> <name>je</name></decl></parameter>)</parameter_list> <block>{<block_content>
            <throw>throw <expr><operator>new</operator> <call><name>CommandException</name><argument_list>(<argument><expr><name>je</name></expr></argument>)</argument_list></call></expr>;</throw>
        <decl_stmt><decl><type><name>SLAEventBean</name></type> <name>slaEvent2</name> <init>= <expr><call><name><name>SLADbXOperations</name><operator>.</operator><name>createStatusEvent</name></name><argument_list>(<argument><expr><call><name><name>workflow</name><operator>.</operator><name>getSlaXml</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><call><name><name>workflow</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>,
                <argument><expr><name><name>Status</name><operator>.</operator><name>FAILED</name></name></expr></argument>, <argument><expr><name><name>SlaAppType</name><operator>.</operator><name>WORKFLOW_JOB</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <if_stmt><if>if<condition>(<expr><name>slaEvent2</name> <operator>!=</operator> <literal type="null">null</literal></expr>)</condition> <block>{<block_content>
            <expr_stmt><expr><call><name><name>insertList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>slaEvent2</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
         </block_content>}</block></if></if_stmt>
        <expr_stmt><expr><call><name><name>SLADbXOperations</name><operator>.</operator><name>writeStausEvent</name></name><argument_list>(<argument><expr><call><name><name>action</name><operator>.</operator><name>getSlaXml</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><call><name><name>action</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><name><name>Status</name><operator>.</operator><name>FAILED</name></name></expr></argument>, <argument><expr><name><name>SlaAppType</name><operator>.</operator><name>WORKFLOW_ACTION</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>SLADbXOperations</name><operator>.</operator><name>writeStausEvent</name></name><argument_list>(<argument><expr><call><name><name>workflow</name><operator>.</operator><name>getSlaXml</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><call><name><name>workflow</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><name><name>Status</name><operator>.</operator><name>FAILED</name></name></expr></argument>, <argument><expr><name><name>SlaAppType</name><operator>.</operator><name>WORKFLOW_JOB</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
         <comment type="line">// update coordinator action</comment>
         <expr_stmt><expr><operator>new</operator> <call><name>CoordActionUpdateXCommand</name><argument_list>(<argument><expr><name>workflow</name></expr></argument>, <argument><expr><literal type="number">3</literal></expr></argument>)</argument_list></call><operator>.</operator><call><name>call</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
         <expr_stmt><expr><operator>new</operator> <call><name>WfEndXCommand</name><argument_list>(<argument><expr><name>wfJob</name></expr></argument>)</argument_list></call><operator>.</operator><call><name>call</name><argument_list>()</argument_list></call></expr>;</expr_stmt> <comment type="line">//To delete the WF temp dir</comment>
<expr_stmt><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>wf</name><operator>/</operator><name><name>KillXCommand</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>wf</name><operator>/</operator><name><name>KillXCommand</name><operator>.</operator><name>java</name></name>
<name>index</name> <literal type="number">7412dd053</literal><operator>..</operator><name>fb13bf9d8</name> <literal type="number">100644</literal>
<operator>--</operator> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>wf</name><operator>/</operator><name><name>KillXCommand</name><operator>.</operator><name>java</name></name>
<operator>++</operator> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>wf</name><operator>/</operator><name><name>KillXCommand</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">20</literal></expr><operator>,</operator><expr><literal type="number">18</literal> <operator>+</operator><literal type="number">20</literal></expr><operator>,</operator><expr><literal type="number">19</literal> @@</expr></expr_stmt> <package>package <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>wf</name></name>;</package>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>WorkflowJob</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>SLAEvent</name><operator>.</operator><name>SlaAppType</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>SLAEvent</name><operator>.</operator><name>Status</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>rest</name><operator>.</operator><name>JsonBean</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>ErrorCode</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>SLAEventBean</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>WorkflowActionBean</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>WorkflowJobBean</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>XException</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>CommandException</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>PreconditionException</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>coord</name><operator>.</operator><name>CoordActionUpdateXCommand</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>BulkUpdateInsertJPAExecutor</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>JPAExecutorException</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>WorkflowActionUpdateJPAExecutor</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>WorkflowActionsGetForJobJPAExecutor</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>WorkflowJobGetJPAExecutor</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>WorkflowJobUpdateJPAExecutor</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>JPAService</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>Services</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>workflow</name><operator>.</operator><name>WorkflowException</name></name>;</import>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">42</literal></expr><operator>,</operator><expr><literal type="number">6</literal> <operator>+</operator><literal type="number">43</literal></expr><operator>,</operator><expr><literal type="number">7</literal> @@</expr></expr_stmt> <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>util</name><operator>.</operator><name>LogUtils</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>util</name><operator>.</operator><name>ParamChecker</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>util</name><operator>.</operator><name>db</name><operator>.</operator><name>SLADbXOperations</name></name>;</import>
 
<import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>ArrayList</name></name>;</import>
 <import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>Date</name></name>;</import>
 <import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>List</name></name>;</import>
 
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">55</literal></expr><operator>,</operator><expr><literal type="number">6</literal> <operator>+</operator><literal type="number">57</literal></expr><operator>,</operator><expr><literal type="number">8</literal> @@ <specifier>public</specifier> <name>class</name> <name>KillXCommand</name> extends <name><name>WorkflowXCommand</name><argument_list type="generic">&lt;<argument><name>Void</name></argument>&gt;</argument_list></name> <block>{
     <expr><specifier>private</specifier> <name>WorkflowJobBean</name> <name>wfJob</name></expr>;
     <specifier>private</specifier> <name><name>List</name><argument_list type="generic">&lt;<argument><name>WorkflowActionBean</name></argument>&gt;</argument_list></name> <name>actionList</name></block></expr>;</expr_stmt>
     <decl_stmt><decl><type><specifier>private</specifier> <name>JPAService</name></type> <name>jpaService</name> <init>= <expr><literal type="null">null</literal></expr></init></decl>;</decl_stmt>
    <decl_stmt><decl><type><specifier>private</specifier> <name><name>List</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name></type> <name>updateList</name> <init>= <expr><operator>new</operator> <call><name><name>ArrayList</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
    <decl_stmt><decl><type><specifier>private</specifier> <name><name>List</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name></type> <name>insertList</name> <init>= <expr><operator>new</operator> <call><name><name>ArrayList</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
 
     <constructor><specifier>public</specifier> <name>KillXCommand</name><parameter_list>(<parameter><decl><type><name>String</name></type> <name>wfId</name></decl></parameter>)</parameter_list> <block>{<block_content>
         <expr_stmt><expr><call><name>super</name><argument_list>(<argument><expr><literal type="string">"kill"</literal></expr></argument>, <argument><expr><literal type="string">"kill"</literal></expr></argument>, <argument><expr><literal type="number">1</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">106</literal></expr><operator>,</operator><expr><literal type="number">7</literal> <operator>+</operator><literal type="number">110</literal></expr><operator>,</operator><expr><literal type="number">11</literal> @@ <specifier>public</specifier> <name>class</name> <name>KillXCommand</name> extends <name><name>WorkflowXCommand</name><argument_list type="generic">&lt;<argument><name>Void</name></argument>&gt;</argument_list></name> <block>{
         <if_stmt><if>if <condition>(<expr><call><name><name>wfJob</name><operator>.</operator><name>getStatus</name></name><argument_list>()</argument_list></call> <operator>!=</operator> <name><name>WorkflowJob</name><operator>.</operator><name>Status</name><operator>.</operator><name>FAILED</name></name></expr>)</condition> <block>{<block_content>
             <expr_stmt><expr><call><name><name>InstrumentUtils</name><operator>.</operator><name>incrJobCounter</name></name><argument_list>(<argument><expr><call><name>getName</name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><literal type="number">1</literal></expr></argument>, <argument><expr><call><name>getInstrumentation</name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
             <expr_stmt><expr><call><name><name>wfJob</name><operator>.</operator><name>setStatus</name></name><argument_list>(<argument><expr><name><name>WorkflowJob</name><operator>.</operator><name>Status</name><operator>.</operator><name>KILLED</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name><name>SLADbXOperations</name><operator>.</operator><name>writeStausEvent</name></name><argument_list>(<argument><expr><call><name><name>wfJob</name><operator>.</operator><name>getSlaXml</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><call><name><name>wfJob</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><name><name>Status</name><operator>.</operator><name>KILLED</name></name></expr></argument>, <argument><expr><name><name>SlaAppType</name><operator>.</operator><name>WORKFLOW_JOB</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <decl_stmt><decl><type><name>SLAEventBean</name></type> <name>slaEvent</name> <init>= <expr><call><name><name>SLADbXOperations</name><operator>.</operator><name>createStatusEvent</name></name><argument_list>(<argument><expr><call><name><name>wfJob</name><operator>.</operator><name>getSlaXml</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><call><name><name>wfJob</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>,
                    <argument><expr><name><name>Status</name><operator>.</operator><name>KILLED</name></name></expr></argument>, <argument><expr><name><name>SlaAppType</name><operator>.</operator><name>WORKFLOW_JOB</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
            <if_stmt><if>if<condition>(<expr><name>slaEvent</name> <operator>!=</operator> <literal type="null">null</literal></expr>)</condition> <block>{<block_content>
                <expr_stmt><expr><call><name><name>insertList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>slaEvent</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            </block_content>}</block></if></if_stmt>
             <try>try <block>{<block_content>
                 <expr_stmt><expr><call><name><name>wfJob</name><operator>.</operator><name>getWorkflowInstance</name></name><argument_list>()</argument_list></call><operator>.</operator><call><name>kill</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
             </block_content>}</block></try>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">124</literal></expr><operator>,</operator><expr><literal type="number">7</literal> <operator>+</operator><literal type="number">132</literal></expr><operator>,</operator><expr><literal type="number">7</literal> @@ <specifier>public</specifier> <name>class</name> <name>KillXCommand</name> extends <name><name>WorkflowXCommand</name><argument_list type="generic">&lt;<argument><name>Void</name></argument>&gt;</argument_list></name> <block>{
                     <expr><call><name><name>action</name><operator>.</operator><name>setPending</name></name><argument_list>()</argument_list></call></expr>;
                     <call><name><name>action</name><operator>.</operator><name>setStatus</name></name><argument_list>(<argument><expr><name><name>WorkflowActionBean</name><operator>.</operator><name>Status</name><operator>.</operator><name>KILLED</name></name></expr></argument>)</argument_list></call></block></expr>;</expr_stmt>
 
                    <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>WorkflowActionUpdateJPAExecutor</name><argument_list>(<argument><expr><name>action</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                    <expr_stmt><expr><call><name><name>updateList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>action</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
 
                     <expr_stmt><expr><call><name>queue</name><argument_list>(<argument><expr><operator>new</operator> <call><name>ActionKillXCommand</name><argument_list>(<argument><expr><call><name><name>action</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><call><name><name>action</name><operator>.</operator><name>getType</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                 </block_content>}</block></if></if_stmt>
@@ <operator>-</operator><literal type="number">136</literal><operator>,</operator><literal type="number">16</literal> <operator>+</operator><literal type="number">144</literal><operator>,</operator><literal type="number">21</literal> @@ <specifier>public</specifier> <name>class</name> <name>KillXCommand</name> extends <name><name>WorkflowXCommand</name><argument_list type="generic">&lt;<argument><name>Void</name></argument>&gt;</argument_list></name> <block>{
 
                     <expr><call><name><name>action</name><operator>.</operator><name>setStatus</name></name><argument_list>(<argument><expr><name><name>WorkflowActionBean</name><operator>.</operator><name>Status</name><operator>.</operator><name>KILLED</name></name></expr></argument>)</argument_list></call></expr>;
                     <call><name><name>action</name><operator>.</operator><name>resetPending</name></name><argument_list>()</argument_list></call></block></block></expr>;</expr_stmt>
                    <expr_stmt><expr><call><name><name>SLADbXOperations</name><operator>.</operator><name>writeStausEvent</name></name><argument_list>(<argument><expr><call><name><name>action</name><operator>.</operator><name>getSlaXml</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><call><name><name>action</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><name><name>Status</name><operator>.</operator><name>KILLED</name></name></expr></argument>,
                            <argument><expr><name><name>SlaAppType</name><operator>.</operator><name>WORKFLOW_ACTION</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                    <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>WorkflowActionUpdateJPAExecutor</name><argument_list>(<argument><expr><name>action</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                    <decl_stmt><decl><type><name>SLAEventBean</name></type> <name>slaEvent</name> <init>= <expr><call><name><name>SLADbXOperations</name><operator>.</operator><name>createStatusEvent</name></name><argument_list>(<argument><expr><call><name><name>action</name><operator>.</operator><name>getSlaXml</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><call><name><name>action</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>,
                            <argument><expr><name><name>Status</name><operator>.</operator><name>KILLED</name></name></expr></argument>, <argument><expr><name><name>SlaAppType</name><operator>.</operator><name>WORKFLOW_ACTION</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
                    <if_stmt><if>if<condition>(<expr><name>slaEvent</name> <operator>!=</operator> <literal type="null">null</literal></expr>)</condition> <block>{<block_content>
                        <expr_stmt><expr><call><name><name>insertList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>slaEvent</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                    </block_content>}</block></if></if_stmt>
                    <expr_stmt><expr><call><name><name>updateList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>action</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                 </block_content>}</block></constructor>
             </block_content>}</block></catch>
            <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>WorkflowJobUpdateJPAExecutor</name><argument_list>(<argument><expr><name>wfJob</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name><name>wfJob</name><operator>.</operator><name>setLastModifiedTime</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>Date</name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name><name>updateList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>wfJob</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>BulkUpdateInsertJPAExecutor</name><argument_list>(<argument><expr><name>updateList</name></expr></argument>, <argument><expr><name>insertList</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
             <expr_stmt><expr><call><name>queue</name><argument_list>(<argument><expr><operator>new</operator> <call><name>NotificationXCommand</name><argument_list>(<argument><expr><name>wfJob</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
         </block_content>}</block>
        <catch>catch <parameter_list>(<parameter><decl><type><name>JPAExecutorException</name></type> <name>je</name></decl></parameter>)</parameter_list> <block>{<block_content>
            <throw>throw <expr><operator>new</operator> <call><name>CommandException</name><argument_list>(<argument><expr><name>je</name></expr></argument>)</argument_list></call></expr>;</throw>
        <catch>catch <parameter_list>(<parameter><decl><type><name>JPAExecutorException</name></type> <name>e</name></decl></parameter>)</parameter_list> <block>{<block_content>
            <throw>throw <expr><operator>new</operator> <call><name>CommandException</name><argument_list>(<argument><expr><name>e</name></expr></argument>)</argument_list></call></expr>;</throw>
         </block_content>}</block></catch>
         <finally>finally <block>{<block_content>
             <if_stmt><if>if<condition>(<expr><call><name><name>wfJob</name><operator>.</operator><name>getStatus</name></name><argument_list>()</argument_list></call> <operator>==</operator> <name><name>WorkflowJob</name><operator>.</operator><name>Status</name><operator>.</operator><name>KILLED</name></name></expr>)</condition> <block>{<block_content>
<expr_stmt><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>wf</name><operator>/</operator><name><name>PurgeXCommand</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>wf</name><operator>/</operator><name><name>PurgeXCommand</name><operator>.</operator><name>java</name></name>
<name>index</name> <literal type="number">413cdc1c6</literal><operator>..</operator><literal type="number">85deb212c</literal> <literal type="number">100644</literal>
<operator>--</operator> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>wf</name><operator>/</operator><name><name>PurgeXCommand</name><operator>.</operator><name>java</name></name>
<operator>++</operator> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>wf</name><operator>/</operator><name><name>PurgeXCommand</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">17</literal></expr><operator>,</operator><expr><literal type="number">25</literal> <operator>+</operator><literal type="number">17</literal></expr><operator>,</operator><expr><literal type="number">25</literal> @@
  <operator>*</operator><operator>/</operator></expr></expr_stmt>
 <package>package <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>wf</name></name>;</package>
 
<import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>Collection</name></name>;</import>
 <import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>List</name></name>;</import>
 
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>ErrorCode</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>WorkflowJobBean</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>XException</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>JPAService</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>Services</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>rest</name><operator>.</operator><name>JsonBean</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>CommandException</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>PreconditionException</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>BulkDeleteForPurgeJPAExecutor</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>JPAExecutorException</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>WorkflowActionsDeleteForPurgeJPAExecutor</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>WorkflowJobDeleteJPAExecutor</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>WorkflowJobsGetForPurgeJPAExecutor</name></name>;</import>
 
 <class><specifier>public</specifier> class <name>PurgeXCommand</name> <super_list><extends>extends <super><name><name>WorkflowXCommand</name><argument_list type="generic">&lt;<argument><name>Void</name></argument>&gt;</argument_list></name></super></extends></super_list> <block>{
     <decl_stmt><decl><type><specifier>private</specifier> <name>JPAService</name></type> <name>jpaService</name> <init>= <expr><literal type="null">null</literal></expr></init></decl>;</decl_stmt>
     <decl_stmt><decl><type><specifier>private</specifier> <name>int</name></type> <name>olderThan</name></decl>;</decl_stmt>
     <decl_stmt><decl><type><specifier>private</specifier> <name>int</name></type> <name>limit</name></decl>;</decl_stmt>
    <decl_stmt><decl><type><specifier>private</specifier> <name><name>List</name><argument_list type="generic">&lt;<argument><name>WorkflowJobBean</name></argument>&gt;</argument_list></name></type> <name>jobList</name> <init>= <expr><literal type="null">null</literal></expr></init></decl>;</decl_stmt>
    <decl_stmt><decl><type><specifier>private</specifier> <name><name>List</name><argument_list type="generic">&lt;<argument><name>?</name> <extends>extends <name>JsonBean</name></extends></argument>&gt;</argument_list></name></type> <name>jobList</name> <init>= <expr><literal type="null">null</literal></expr></init></decl>;</decl_stmt>
 
     <constructor><specifier>public</specifier> <name>PurgeXCommand</name><parameter_list>(<parameter><decl><type><name>int</name></type> <name>olderThan</name></decl></parameter>, <parameter><decl><type><name>int</name></type> <name>limit</name></decl></parameter>)</parameter_list> <block>{<block_content>
         <expr_stmt><expr><call><name>super</name><argument_list>(<argument><expr><literal type="string">"purge"</literal></expr></argument>, <argument><expr><literal type="string">"purge"</literal></expr></argument>, <argument><expr><literal type="number">0</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">49</literal></expr><operator>,</operator><expr><literal type="number">15</literal> <operator>+</operator><literal type="number">49</literal></expr><operator>,</operator><expr><literal type="number">11</literal> @@ <specifier>public</specifier> <name>class</name> <name>PurgeXCommand</name> extends <name><name>WorkflowXCommand</name><argument_list type="generic">&lt;<argument><name>Void</name></argument>&gt;</argument_list></name> <block>{
 
         <expr><name>int</name> <name>actionDeleted</name> <operator>=</operator> <literal type="number">0</literal></expr>;</block></expr></expr_stmt>
         <if_stmt><if>if <condition>(<expr><name>jobList</name> <operator>!=</operator> <literal type="null">null</literal> <operator>&amp;&amp;</operator> <call><name><name>jobList</name><operator>.</operator><name>size</name></name><argument_list>()</argument_list></call> <operator>!=</operator> <literal type="number">0</literal></expr>)</condition> <block>{<block_content>
            <for>for <control>(<init><decl><type><name>WorkflowJobBean</name></type> <name>w</name> <range>: <expr><name>jobList</name></expr></range></decl></init>)</control> <block>{<block_content>
                <decl_stmt><decl><type><name>String</name></type> <name>wfId</name> <init>= <expr><call><name><name>w</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
                <try>try <block>{<block_content>
                    <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>WorkflowJobDeleteJPAExecutor</name><argument_list>(<argument><expr><name>wfId</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                    <expr_stmt><expr><name>actionDeleted</name> <operator>+=</operator> <call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>WorkflowActionsDeleteForPurgeJPAExecutor</name><argument_list>(<argument><expr><name>wfId</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                </block_content>}</block>
                <catch>catch <parameter_list>(<parameter><decl><type><name>JPAExecutorException</name></type> <name>e</name></decl></parameter>)</parameter_list> <block>{<block_content>
                    <throw>throw <expr><operator>new</operator> <call><name>CommandException</name><argument_list>(<argument><expr><name>e</name></expr></argument>)</argument_list></call></expr>;</throw>
                </block_content>}</block></catch></try>
            <try>try <block>{<block_content>
                <expr_stmt><expr><name>actionDeleted</name> <operator>=</operator> <call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>BulkDeleteForPurgeJPAExecutor</name><argument_list>(<argument><expr><operator>(</operator><name><name>Collection</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name><operator>)</operator> <name>jobList</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            </block_content>}</block>
            <catch>catch <parameter_list>(<parameter><decl><type><name>JPAExecutorException</name></type> <name>je</name></decl></parameter>)</parameter_list> <block>{<block_content>
                <throw>throw <expr><operator>new</operator> <call><name>CommandException</name><argument_list>(<argument><expr><name>je</name></expr></argument>)</argument_list></call></expr>;</throw>
             </block_content>}</block></catch></try>
             <expr_stmt><expr><call><name><name>LOG</name><operator>.</operator><name>debug</name></name><argument_list>(<argument><expr><literal type="string">"ENDED Workflow-Purge deleted jobs :"</literal> <operator>+</operator> <call><name><name>jobList</name><operator>.</operator><name>size</name></name><argument_list>()</argument_list></call> <operator>+</operator> <literal type="string">" and actions "</literal> <operator>+</operator> <name>actionDeleted</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
         </block_content>}</block></for>
<expr_stmt><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>wf</name><operator>/</operator><name><name>ReRunXCommand</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>wf</name><operator>/</operator><name><name>ReRunXCommand</name><operator>.</operator><name>java</name></name>
<name>index</name> <literal type="number">8a2185ed0</literal><operator>..</operator><literal type="number">81efd998c</literal> <literal type="number">100644</literal>
<operator>--</operator> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>wf</name><operator>/</operator><name><name>ReRunXCommand</name><operator>.</operator><name>java</name></name>
<operator>++</operator> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>wf</name><operator>/</operator><name><name>ReRunXCommand</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">20</literal></expr><operator>,</operator><expr><literal type="number">7</literal> <operator>+</operator><literal type="number">20</literal></expr><operator>,</operator><expr><literal type="number">9</literal> @@</expr></expr_stmt> <package>package <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>wf</name></name>;</package>
 <import>import <name><name>java</name><operator>.</operator><name>io</name><operator>.</operator><name>IOException</name></name>;</import>
 <import>import <name><name>java</name><operator>.</operator><name>net</name><operator>.</operator><name>URI</name></name>;</import>
 <import>import <name><name>java</name><operator>.</operator><name>net</name><operator>.</operator><name>URISyntaxException</name></name>;</import>
<import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>ArrayList</name></name>;</import>
 <import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>Collection</name></name>;</import>
<import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>Date</name></name>;</import>
 <import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>HashMap</name></name>;</import>
 <import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>HashSet</name></name>;</import>
 <import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>List</name></name>;</import>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">36</literal></expr><operator>,</operator><expr><literal type="number">13</literal> <operator>+</operator><literal type="number">38</literal></expr><operator>,</operator><expr><literal type="number">13</literal> @@</expr></expr_stmt> <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>WorkflowJobBean</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>OozieClient</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>WorkflowAction</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>WorkflowJob</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>rest</name><operator>.</operator><name>JsonBean</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>CommandException</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>PreconditionException</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>BulkUpdateDeleteJPAExecutor</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>JPAExecutorException</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>WorkflowActionDeleteJPAExecutor</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>WorkflowActionsGetForJobJPAExecutor</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>WorkflowJobGetJPAExecutor</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>WorkflowJobUpdateJPAExecutor</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>DagXLogInfoService</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>HadoopAccessorException</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>HadoopAccessorService</name></name>;</import>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">77</literal></expr><operator>,</operator><expr><literal type="number">6</literal> <operator>+</operator><literal type="number">79</literal></expr><operator>,</operator><expr><literal type="number">8</literal> @@ <specifier>public</specifier> <name>class</name> <name>ReRunXCommand</name> extends <name><name>WorkflowXCommand</name><argument_list type="generic">&lt;<argument><name>Void</name></argument>&gt;</argument_list></name> <block>{
     <expr><specifier>private</specifier> <name>WorkflowJobBean</name> <name>wfBean</name></expr>;
     <specifier>private</specifier> <name><name>List</name><argument_list type="generic">&lt;<argument><name>WorkflowActionBean</name></argument>&gt;</argument_list></name> <name>actions</name></block></expr>;</expr_stmt>
     <decl_stmt><decl><type><specifier>private</specifier> <name>JPAService</name></type> <name>jpaService</name></decl>;</decl_stmt>
    <decl_stmt><decl><type><specifier>private</specifier> <name><name>List</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name></type> <name>updateList</name> <init>= <expr><operator>new</operator> <call><name><name>ArrayList</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
    <decl_stmt><decl><type><specifier>private</specifier> <name><name>List</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name></type> <name>deleteList</name> <init>= <expr><operator>new</operator> <call><name><name>ArrayList</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
 
     <decl_stmt><decl><type><specifier>private</specifier> <specifier>static</specifier> <specifier>final</specifier> <name><name>Set</name><argument_list type="generic">&lt;<argument><name>String</name></argument>&gt;</argument_list></name></type> <name>DISALLOWED_DEFAULT_PROPERTIES</name> <init>= <expr><operator>new</operator> <call><name><name>HashSet</name><argument_list type="generic">&lt;<argument><name>String</name></argument>&gt;</argument_list></name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
     <decl_stmt><decl><type><specifier>private</specifier> <specifier>static</specifier> <specifier>final</specifier> <name><name>Set</name><argument_list type="generic">&lt;<argument><name>String</name></argument>&gt;</argument_list></name></type> <name>DISALLOWED_USER_PROPERTIES</name> <init>= <expr><operator>new</operator> <call><name><name>HashSet</name><argument_list type="generic">&lt;<argument><name>String</name></argument>&gt;</argument_list></name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">166</literal></expr><operator>,</operator><expr><literal type="number">32</literal> <operator>+</operator><literal type="number">170</literal></expr><operator>,</operator><expr><literal type="number">36</literal> @@ <specifier>public</specifier> <name>class</name> <name>ReRunXCommand</name> extends <name><name>WorkflowXCommand</name><argument_list type="generic">&lt;<argument><name>Void</name></argument>&gt;</argument_list></name> <block>{
             <throw>throw <argument_list>new <argument><expr><call><name>CommandException</name><argument_list>(<argument><expr><name><name>ErrorCode</name><operator>.</operator><name>E0711</name></name></expr></argument>, <argument><expr><call><name><name>ex</name><operator>.</operator><name>getMessage</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><name>ex</name></expr></argument>)</argument_list></call></expr></argument></argument_list></throw>;
         }</block></expr></expr_stmt>
 
        <try>try <block>{<block_content>
            <for>for <control>(<init><decl><type><name>int</name></type> <name>i</name> <init>= <expr><literal type="number">0</literal></expr></init></decl>;</init> <condition><expr><name>i</name> <operator>&lt;</operator> <call><name><name>actions</name><operator>.</operator><name>size</name></name><argument_list>()</argument_list></call></expr>;</condition> <incr><expr><name>i</name><operator>++</operator></expr></incr>)</control> <block>{<block_content>
                <if_stmt><if>if <condition>(<expr><operator>!</operator><call><name><name>nodesToSkip</name><operator>.</operator><name>contains</name></name><argument_list>(<argument><expr><call><name><name>actions</name><operator>.</operator><name>get</name></name><argument_list>(<argument><expr><name>i</name></expr></argument>)</argument_list></call><operator>.</operator><call><name>getName</name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>)</condition> <block>{<block_content>
                    <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>WorkflowActionDeleteJPAExecutor</name><argument_list>(<argument><expr><call><name><name>actions</name><operator>.</operator><name>get</name></name><argument_list>(<argument><expr><name>i</name></expr></argument>)</argument_list></call><operator>.</operator><call><name>getId</name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                    <expr_stmt><expr><call><name><name>LOG</name><operator>.</operator><name>info</name></name><argument_list>(<argument><expr><literal type="string">"Deleting Action[{0}] for re-run"</literal></expr></argument>, <argument><expr><call><name><name>actions</name><operator>.</operator><name>get</name></name><argument_list>(<argument><expr><name>i</name></expr></argument>)</argument_list></call><operator>.</operator><call><name>getId</name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                </block_content>}</block></if>
                <else>else <block>{<block_content>
                    <expr_stmt><expr><call><name>copyActionData</name><argument_list>(<argument><expr><name>newWfInstance</name></expr></argument>, <argument><expr><name>oldWfInstance</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                </block_content>}</block></else></if_stmt>
        <for>for <control>(<init><decl><type><name>int</name></type> <name>i</name> <init>= <expr><literal type="number">0</literal></expr></init></decl>;</init> <condition><expr><name>i</name> <operator>&lt;</operator> <call><name><name>actions</name><operator>.</operator><name>size</name></name><argument_list>()</argument_list></call></expr>;</condition> <incr><expr><name>i</name><operator>++</operator></expr></incr>)</control> <block>{<block_content>
            <if_stmt><if>if <condition>(<expr><operator>!</operator><call><name><name>nodesToSkip</name><operator>.</operator><name>contains</name></name><argument_list>(<argument><expr><call><name><name>actions</name><operator>.</operator><name>get</name></name><argument_list>(<argument><expr><name>i</name></expr></argument>)</argument_list></call><operator>.</operator><call><name>getName</name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>)</condition> <block>{<block_content>
                <expr_stmt><expr><call><name><name>deleteList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><call><name><name>actions</name><operator>.</operator><name>get</name></name><argument_list>(<argument><expr><name>i</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                <expr_stmt><expr><call><name><name>LOG</name><operator>.</operator><name>info</name></name><argument_list>(<argument><expr><literal type="string">"Deleting Action[{0}] for re-run"</literal></expr></argument>, <argument><expr><call><name><name>actions</name><operator>.</operator><name>get</name></name><argument_list>(<argument><expr><name>i</name></expr></argument>)</argument_list></call><operator>.</operator><call><name>getId</name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
             </block_content>}</block></if>
            <else>else <block>{<block_content>
                <expr_stmt><expr><call><name>copyActionData</name><argument_list>(<argument><expr><name>newWfInstance</name></expr></argument>, <argument><expr><name>oldWfInstance</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            </block_content>}</block></else></if_stmt>
        </block_content>}</block></for>
 
            <expr_stmt><expr><call><name><name>wfBean</name><operator>.</operator><name>setAppPath</name></name><argument_list>(<argument><expr><call><name><name>conf</name><operator>.</operator><name>get</name></name><argument_list>(<argument><expr><name><name>OozieClient</name><operator>.</operator><name>APP_PATH</name></name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name><name>wfBean</name><operator>.</operator><name>setConf</name></name><argument_list>(<argument><expr><call><name><name>XmlUtils</name><operator>.</operator><name>prettyPrint</name></name><argument_list>(<argument><expr><name>conf</name></expr></argument>)</argument_list></call><operator>.</operator><call><name>toString</name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name><name>wfBean</name><operator>.</operator><name>setLogToken</name></name><argument_list>(<argument><expr><call><name><name>conf</name><operator>.</operator><name>get</name></name><argument_list>(<argument><expr><name><name>OozieClient</name><operator>.</operator><name>LOG_TOKEN</name></name></expr></argument>, <argument><expr><literal type="string">""</literal></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name><name>wfBean</name><operator>.</operator><name>setUser</name></name><argument_list>(<argument><expr><call><name><name>conf</name><operator>.</operator><name>get</name></name><argument_list>(<argument><expr><name><name>OozieClient</name><operator>.</operator><name>USER_NAME</name></name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <decl_stmt><decl><type><name>String</name></type> <name>group</name> <init>= <expr><call><name><name>ConfigUtils</name><operator>.</operator><name>getWithDeprecatedCheck</name></name><argument_list>(<argument><expr><name>conf</name></expr></argument>, <argument><expr><name><name>OozieClient</name><operator>.</operator><name>JOB_ACL</name></name></expr></argument>, <argument><expr><name><name>OozieClient</name><operator>.</operator><name>GROUP_NAME</name></name></expr></argument>, <argument><expr><literal type="null">null</literal></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
            <expr_stmt><expr><call><name><name>wfBean</name><operator>.</operator><name>setGroup</name></name><argument_list>(<argument><expr><name>group</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name><name>wfBean</name><operator>.</operator><name>setExternalId</name></name><argument_list>(<argument><expr><call><name><name>conf</name><operator>.</operator><name>get</name></name><argument_list>(<argument><expr><name><name>OozieClient</name><operator>.</operator><name>EXTERNAL_ID</name></name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name><name>wfBean</name><operator>.</operator><name>setEndTime</name></name><argument_list>(<argument><expr><literal type="null">null</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name><name>wfBean</name><operator>.</operator><name>setRun</name></name><argument_list>(<argument><expr><call><name><name>wfBean</name><operator>.</operator><name>getRun</name></name><argument_list>()</argument_list></call> <operator>+</operator> <literal type="number">1</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name><name>wfBean</name><operator>.</operator><name>setStatus</name></name><argument_list>(<argument><expr><name><name>WorkflowJob</name><operator>.</operator><name>Status</name><operator>.</operator><name>PREP</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name><name>wfBean</name><operator>.</operator><name>setWorkflowInstance</name></name><argument_list>(<argument><expr><name>newWfInstance</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>WorkflowJobUpdateJPAExecutor</name><argument_list>(<argument><expr><name>wfBean</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>wfBean</name><operator>.</operator><name>setAppPath</name></name><argument_list>(<argument><expr><call><name><name>conf</name><operator>.</operator><name>get</name></name><argument_list>(<argument><expr><name><name>OozieClient</name><operator>.</operator><name>APP_PATH</name></name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>wfBean</name><operator>.</operator><name>setConf</name></name><argument_list>(<argument><expr><call><name><name>XmlUtils</name><operator>.</operator><name>prettyPrint</name></name><argument_list>(<argument><expr><name>conf</name></expr></argument>)</argument_list></call><operator>.</operator><call><name>toString</name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>wfBean</name><operator>.</operator><name>setLogToken</name></name><argument_list>(<argument><expr><call><name><name>conf</name><operator>.</operator><name>get</name></name><argument_list>(<argument><expr><name><name>OozieClient</name><operator>.</operator><name>LOG_TOKEN</name></name></expr></argument>, <argument><expr><literal type="string">""</literal></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>wfBean</name><operator>.</operator><name>setUser</name></name><argument_list>(<argument><expr><call><name><name>conf</name><operator>.</operator><name>get</name></name><argument_list>(<argument><expr><name><name>OozieClient</name><operator>.</operator><name>USER_NAME</name></name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <decl_stmt><decl><type><name>String</name></type> <name>group</name> <init>= <expr><call><name><name>ConfigUtils</name><operator>.</operator><name>getWithDeprecatedCheck</name></name><argument_list>(<argument><expr><name>conf</name></expr></argument>, <argument><expr><name><name>OozieClient</name><operator>.</operator><name>JOB_ACL</name></name></expr></argument>, <argument><expr><name><name>OozieClient</name><operator>.</operator><name>GROUP_NAME</name></name></expr></argument>, <argument><expr><literal type="null">null</literal></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name><name>wfBean</name><operator>.</operator><name>setGroup</name></name><argument_list>(<argument><expr><name>group</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>wfBean</name><operator>.</operator><name>setExternalId</name></name><argument_list>(<argument><expr><call><name><name>conf</name><operator>.</operator><name>get</name></name><argument_list>(<argument><expr><name><name>OozieClient</name><operator>.</operator><name>EXTERNAL_ID</name></name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>wfBean</name><operator>.</operator><name>setEndTime</name></name><argument_list>(<argument><expr><literal type="null">null</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>wfBean</name><operator>.</operator><name>setRun</name></name><argument_list>(<argument><expr><call><name><name>wfBean</name><operator>.</operator><name>getRun</name></name><argument_list>()</argument_list></call> <operator>+</operator> <literal type="number">1</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>wfBean</name><operator>.</operator><name>setStatus</name></name><argument_list>(<argument><expr><name><name>WorkflowJob</name><operator>.</operator><name>Status</name><operator>.</operator><name>PREP</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>wfBean</name><operator>.</operator><name>setWorkflowInstance</name></name><argument_list>(<argument><expr><name>newWfInstance</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <try>try <block>{<block_content>
            <expr_stmt><expr><call><name><name>wfBean</name><operator>.</operator><name>setLastModifiedTime</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>Date</name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name><name>updateList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>wfBean</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <comment type="line">// call JPAExecutor to do the bulk writes</comment>
            <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>BulkUpdateDeleteJPAExecutor</name><argument_list>(<argument><expr><name>updateList</name></expr></argument>, <argument><expr><name>deleteList</name></expr></argument>, <argument><expr><literal type="boolean">true</literal></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
         </block_content>}</block>
        <catch>catch <parameter_list>(<parameter><decl><type><name>JPAExecutorException</name></type> <name>e</name></decl></parameter>)</parameter_list> <block>{<block_content>
            <throw>throw <expr><operator>new</operator> <call><name>CommandException</name><argument_list>(<argument><expr><name>e</name></expr></argument>)</argument_list></call></expr>;</throw>
        <catch>catch <parameter_list>(<parameter><decl><type><name>JPAExecutorException</name></type> <name>je</name></decl></parameter>)</parameter_list> <block>{<block_content>
            <throw>throw <expr><operator>new</operator> <call><name>CommandException</name><argument_list>(<argument><expr><name>je</name></expr></argument>)</argument_list></call></expr>;</throw>
         </block_content>}</block></catch>
 
         <return>return <expr><literal type="null">null</literal></expr>;</return>
<expr_stmt><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>wf</name><operator>/</operator><name><name>ResumeXCommand</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>wf</name><operator>/</operator><name><name>ResumeXCommand</name><operator>.</operator><name>java</name></name>
<name>index</name> <literal type="number">72fc2ef1f</literal><operator>..</operator><name>a07b6ca4e</name> <literal type="number">100644</literal>
<operator>--</operator> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>wf</name><operator>/</operator><name><name>ResumeXCommand</name><operator>.</operator><name>java</name></name>
<operator>++</operator> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>wf</name><operator>/</operator><name><name>ResumeXCommand</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">17</literal></expr><operator>,</operator><expr><literal type="number">20</literal> <operator>+</operator><literal type="number">17</literal></expr><operator>,</operator><expr><literal type="number">22</literal> @@
  <operator>*</operator><operator>/</operator></expr></expr_stmt>
 <package>package <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>wf</name></name>;</package>
 
<import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>ArrayList</name></name>;</import>
 <import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>Date</name></name>;</import>
<import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>List</name></name>;</import>
 
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>ErrorCode</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>WorkflowActionBean</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>WorkflowJobBean</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>WorkflowJob</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>rest</name><operator>.</operator><name>JsonBean</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>CommandException</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>PreconditionException</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>coord</name><operator>.</operator><name>CoordActionUpdateXCommand</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>BulkUpdateInsertJPAExecutor</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>JPAExecutorException</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>WorkflowActionUpdateJPAExecutor</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>WorkflowJobGetActionsJPAExecutor</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>WorkflowJobGetJPAExecutor</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>WorkflowJobUpdateJPAExecutor</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>JPAService</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>Services</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>util</name><operator>.</operator><name>InstrumentUtils</name></name>;</import>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">45</literal></expr><operator>,</operator><expr><literal type="number">6</literal> <operator>+</operator><literal type="number">47</literal></expr><operator>,</operator><expr><literal type="number">7</literal> @@ <specifier>public</specifier> <name>class</name> <name>ResumeXCommand</name> extends <name><name>WorkflowXCommand</name><argument_list type="generic">&lt;<argument><name>Void</name></argument>&gt;</argument_list></name> <block>{
     <expr><specifier>private</specifier> <name>String</name> <name>id</name></expr>;
     <specifier>private</specifier> <name>JPAService</name> <name>jpaService</name> <operator>=</operator> <literal type="null">null</literal></block></expr>;</expr_stmt>
     <decl_stmt><decl><type><specifier>private</specifier> <name>WorkflowJobBean</name></type> <name>workflow</name> <init>= <expr><literal type="null">null</literal></expr></init></decl>;</decl_stmt>
    <decl_stmt><decl><type><specifier>private</specifier> <name><name>List</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name></type> <name>updateList</name> <init>= <expr><operator>new</operator> <call><name><name>ArrayList</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
 
     <constructor><specifier>public</specifier> <name>ResumeXCommand</name><parameter_list>(<parameter><decl><type><name>String</name></type> <name>id</name></decl></parameter>)</parameter_list> <block>{<block_content>
         <expr_stmt><expr><call><name>super</name><argument_list>(<argument><expr><literal type="string">"resume"</literal></expr></argument>, <argument><expr><literal type="string">"resume"</literal></expr></argument>, <argument><expr><literal type="number">1</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">70</literal></expr><operator>,</operator><expr><literal type="number">7</literal> <operator>+</operator><literal type="number">73</literal></expr><operator>,</operator><expr><literal type="number">7</literal> @@ <specifier>public</specifier> <name>class</name> <name>ResumeXCommand</name> extends <name><name>WorkflowXCommand</name><argument_list type="generic">&lt;<argument><name>Void</name></argument>&gt;</argument_list></name> <block>{
                     <comment type="line">// START_MANUAL or END_RETRY or END_MANUAL</comment>
                     <if_stmt><if>if <condition>(<expr><call><name><name>action</name><operator>.</operator><name>isRetryOrManual</name></name><argument_list>()</argument_list></call></expr>)</condition> <block>{<block_content>
                         <expr_stmt><expr><call><name><name>action</name><operator>.</operator><name>setPendingOnly</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
                        <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>WorkflowActionUpdateJPAExecutor</name><argument_list>(<argument><expr><name>action</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                        <expr_stmt><expr><call><name><name>updateList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>action</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                     </block_content>}</block></if></if_stmt></block></expr></expr_stmt>
 
                     <if_stmt><if>if <condition>(<expr><call><name><name>action</name><operator>.</operator><name>isPending</name></name><argument_list>()</argument_list></call></expr>)</condition> <block>{<block_content>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">102</literal></expr><operator>,</operator><expr><literal type="number">7</literal> <operator>+</operator><literal type="number">105</literal></expr><operator>,</operator><expr><literal type="number">9</literal> @@ <specifier>public</specifier> <name>class</name> <name>ResumeXCommand</name> extends <name><name>WorkflowXCommand</name><argument_list type="generic">&lt;<argument><name>Void</name></argument>&gt;</argument_list></name> <block>{
                     }</block></expr></expr_stmt>
                 </block_content>}</block></if></if_stmt>
 
                <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>WorkflowJobUpdateJPAExecutor</name><argument_list>(<argument><expr><name>workflow</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                <expr_stmt><expr><call><name><name>workflow</name><operator>.</operator><name>setLastModifiedTime</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>Date</name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                <expr_stmt><expr><call><name><name>updateList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>workflow</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>BulkUpdateInsertJPAExecutor</name><argument_list>(<argument><expr><name>updateList</name></expr></argument>, <argument><expr><literal type="null">null</literal></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                 <expr_stmt><expr><call><name>queue</name><argument_list>(<argument><expr><operator>new</operator> <call><name>NotificationXCommand</name><argument_list>(<argument><expr><name>workflow</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
             </block_content>}</block></constructor>
             <return>return <expr><literal type="null">null</literal></expr>;</return>
<expr_stmt><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>wf</name><operator>/</operator><name><name>SignalXCommand</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>wf</name><operator>/</operator><name><name>SignalXCommand</name><operator>.</operator><name>java</name></name>
<name>index</name> <literal type="number">0475b0cb0</literal><operator>..</operator><name>da7340107</name> <literal type="number">100644</literal>
<operator>--</operator> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>wf</name><operator>/</operator><name><name>SignalXCommand</name><operator>.</operator><name>java</name></name>
<operator>++</operator> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>wf</name><operator>/</operator><name><name>SignalXCommand</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">22</literal></expr><operator>,</operator><expr><literal type="number">6</literal> <operator>+</operator><literal type="number">22</literal></expr><operator>,</operator><expr><literal type="number">7</literal> @@</expr></expr_stmt> <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>WorkflowJob</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>SLAEvent</name><operator>.</operator><name>SlaAppType</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>SLAEvent</name><operator>.</operator><name>Status</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>rest</name><operator>.</operator><name>JsonBean</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>SLAEventBean</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>WorkflowActionBean</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>WorkflowJobBean</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>ErrorCode</name></name>;</import>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">145</literal></expr><operator>,</operator><expr><literal type="number">9</literal> <operator>+</operator><literal type="number">146</literal></expr><operator>,</operator><expr><literal type="number">13</literal> @@ <specifier>public</specifier> <name>class</name> <name>SignalXCommand</name> extends <name><name>WorkflowXCommand</name><argument_list type="generic">&lt;<argument><name>Void</name></argument>&gt;</argument_list></name> <block>{
                 <expr><call><name><name>wfJob</name><operator>.</operator><name>setStartTime</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>Date</name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;
                 <call><name><name>wfJob</name><operator>.</operator><name>setWorkflowInstance</name></name><argument_list>(<argument><expr><name>workflowInstance</name></expr></argument>)</argument_list></call></block></expr>;</expr_stmt>
                 <comment type="line">// 1. Add SLA status event for WF-JOB with status STARTED</comment>
                <decl_stmt><decl><type><name>SLAEventBean</name></type> <name>slaEvent</name> <init>= <expr><call><name><name>SLADbXOperations</name><operator>.</operator><name>createStatusEvent</name></name><argument_list>(<argument><expr><call><name><name>wfJob</name><operator>.</operator><name>getSlaXml</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><name>jobId</name></expr></argument>,
                        <argument><expr><name><name>Status</name><operator>.</operator><name>STARTED</name></name></expr></argument>, <argument><expr><name><name>SlaAppType</name><operator>.</operator><name>WORKFLOW_JOB</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
                <if_stmt><if>if<condition>(<expr><name>slaEvent</name> <operator>!=</operator> <literal type="null">null</literal></expr>)</condition> <block>{<block_content>
                    <expr_stmt><expr><call><name><name>insertList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>slaEvent</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                </block_content>}</block></if></if_stmt>
                 <comment type="line">// 2. Add SLA registration events for all WF_ACTIONS</comment>
                <expr_stmt><expr><call><name><name>SLADbXOperations</name><operator>.</operator><name>writeStausEvent</name></name><argument_list>(<argument><expr><call><name><name>wfJob</name><operator>.</operator><name>getSlaXml</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><name>jobId</name></expr></argument>, <argument><expr><name><name>Status</name><operator>.</operator><name>STARTED</name></name></expr></argument>, <argument><expr><name><name>SlaAppType</name><operator>.</operator><name>WORKFLOW_JOB</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                <expr_stmt><expr><call><name>writeSLARegistrationForAllActions</name><argument_list>(<argument><expr><call><name><name>workflowInstance</name><operator>.</operator><name>getApp</name></name><argument_list>()</argument_list></call><operator>.</operator><call><name>getDefinition</name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><call><name><name>wfJob</name><operator>.</operator><name>getUser</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><name>wfJob</name>
                <call><name>createSLARegistrationForAllActions</name><argument_list>(<argument><expr><call><name><name>workflowInstance</name><operator>.</operator><name>getApp</name></name><argument_list>()</argument_list></call><operator>.</operator><call><name>getDefinition</name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><call><name><name>wfJob</name><operator>.</operator><name>getUser</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><call><name><name>wfJob</name>
                         <operator>.</operator><name>getGroup</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><call><name><name>wfJob</name><operator>.</operator><name>getConf</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr></argument>;</argument_list></call></expr></expr_stmt>
                 <expr_stmt><expr><call><name>queue</name><argument_list>(<argument><expr><operator>new</operator> <call><name>NotificationXCommand</name><argument_list>(<argument><expr><name>wfJob</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
             </block_content>}</block></catch></try>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">195</literal></expr><operator>,</operator><expr><literal type="number">8</literal> <operator>+</operator><literal type="number">200</literal></expr><operator>,</operator><expr><literal type="number">11</literal> @@ <specifier>public</specifier> <name>class</name> <name>SignalXCommand</name> extends <name><name>WorkflowXCommand</name><argument_list type="generic">&lt;<argument><name>Void</name></argument>&gt;</argument_list></name> <block>{
                     <expr><call><name><name>actionToFail</name><operator>.</operator><name>resetPending</name></name><argument_list>()</argument_list></call></expr>;
                     <call><name><name>actionToFail</name><operator>.</operator><name>setStatus</name></name><argument_list>(<argument><expr><name><name>WorkflowActionBean</name><operator>.</operator><name>Status</name><operator>.</operator><name>FAILED</name></name></expr></argument>)</argument_list></call></block></expr>;</expr_stmt>
                     <expr_stmt><expr><call><name>queue</name><argument_list>(<argument><expr><operator>new</operator> <call><name>NotificationXCommand</name><argument_list>(<argument><expr><name>wfJob</name></expr></argument>, <argument><expr><name>actionToFail</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                    <expr_stmt><expr><call><name><name>SLADbXOperations</name><operator>.</operator><name>writeStausEvent</name></name><argument_list>(<argument><expr><call><name><name>wfAction</name><operator>.</operator><name>getSlaXml</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><call><name><name>wfAction</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><name><name>Status</name><operator>.</operator><name>FAILED</name></name></expr></argument>,
                            <argument><expr><name><name>SlaAppType</name><operator>.</operator><name>WORKFLOW_ACTION</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                    <decl_stmt><decl><type><name>SLAEventBean</name></type> <name>slaEvent</name> <init>= <expr><call><name><name>SLADbXOperations</name><operator>.</operator><name>createStatusEvent</name></name><argument_list>(<argument><expr><call><name><name>wfAction</name><operator>.</operator><name>getSlaXml</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><call><name><name>wfAction</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>,
                            <argument><expr><name><name>Status</name><operator>.</operator><name>FAILED</name></name></expr></argument>, <argument><expr><name><name>SlaAppType</name><operator>.</operator><name>WORKFLOW_ACTION</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
                    <if_stmt><if>if<condition>(<expr><name>slaEvent</name> <operator>!=</operator> <literal type="null">null</literal></expr>)</condition> <block>{<block_content>
                        <expr_stmt><expr><call><name><name>insertList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>slaEvent</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                    </block_content>}</block></if></if_stmt>
                     <expr_stmt><expr><call><name><name>updateList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>actionToFail</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                 </block_content>}</block></for>
             </block_content>}</block></try>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">221</literal></expr><operator>,</operator><expr><literal type="number">7</literal> <operator>+</operator><literal type="number">229</literal></expr><operator>,</operator><expr><literal type="number">11</literal> @@ <specifier>public</specifier> <name>class</name> <name>SignalXCommand</name> extends <name><name>WorkflowXCommand</name><argument_list type="generic">&lt;<argument><name>Void</name></argument>&gt;</argument_list></name> <block>{
                 <expr>default<operator>:</operator></expr> <comment type="line">// TODO SUSPENDED</comment>
                     <break>break;</break>
             }</block></expr></expr_stmt>
            <expr_stmt><expr><call><name><name>SLADbXOperations</name><operator>.</operator><name>writeStausEvent</name></name><argument_list>(<argument><expr><call><name><name>wfJob</name><operator>.</operator><name>getSlaXml</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><name>jobId</name></expr></argument>, <argument><expr><name>slaStatus</name></expr></argument>, <argument><expr><name><name>SlaAppType</name><operator>.</operator><name>WORKFLOW_JOB</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <decl_stmt><decl><type><name>SLAEventBean</name></type> <name>slaEvent</name> <init>= <expr><call><name><name>SLADbXOperations</name><operator>.</operator><name>createStatusEvent</name></name><argument_list>(<argument><expr><call><name><name>wfJob</name><operator>.</operator><name>getSlaXml</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><name>jobId</name></expr></argument>,
                    <argument><expr><name>slaStatus</name></expr></argument>, <argument><expr><name><name>SlaAppType</name><operator>.</operator><name>WORKFLOW_JOB</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
            <if_stmt><if>if<condition>(<expr><name>slaEvent</name> <operator>!=</operator> <literal type="null">null</literal></expr>)</condition> <block>{<block_content>
                <expr_stmt><expr><call><name><name>insertList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>slaEvent</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            </block_content>}</block></if></if_stmt>
             <expr_stmt><expr><call><name>queue</name><argument_list>(<argument><expr><operator>new</operator> <call><name>NotificationXCommand</name><argument_list>(<argument><expr><name>wfJob</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
             <if_stmt><if>if <condition>(<expr><call><name><name>wfJob</name><operator>.</operator><name>getStatus</name></name><argument_list>()</argument_list></call> <operator>==</operator> <name><name>WorkflowJob</name><operator>.</operator><name>Status</name><operator>.</operator><name>SUCCEEDED</name></name></expr>)</condition> <block>{<block_content>
                 <expr_stmt><expr><call><name><name>InstrumentUtils</name><operator>.</operator><name>incrJobCounter</name></name><argument_list>(<argument><expr><name>INSTR_SUCCEEDED_JOBS_COUNTER_NAME</name></expr></argument>, <argument><expr><literal type="number">1</literal></expr></argument>, <argument><expr><call><name>getInstrumentation</name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">354</literal></expr><operator>,</operator><expr><literal type="number">7</literal> <operator>+</operator><literal type="number">366</literal></expr><operator>,</operator><expr><literal type="number">7</literal> @@ <specifier>public</specifier> <name>class</name> <name>SignalXCommand</name> extends <name><name>WorkflowXCommand</name><argument_list type="generic">&lt;<argument><name>Void</name></argument>&gt;</argument_list></name> <block>{
     }</block>
 
     @<call><name>SuppressWarnings</name><argument_list>(<argument><expr><literal type="string">"unchecked"</literal></expr></argument>)</argument_list></call>
    <specifier>private</specifier> <name>void</name> <call><name>writeSLARegistrationForAllActions</name><argument_list>(<argument><expr><name>String</name> <name>wfXml</name></expr></argument>, <argument><expr><name>String</name> <name>user</name></expr></argument>, <argument><expr><name>String</name> <name>group</name></expr></argument>, <argument><expr><name>String</name> <name>strConf</name></expr></argument>)</argument_list></call>
    <specifier>private</specifier> <name>void</name> <call><name>createSLARegistrationForAllActions</name><argument_list>(<argument><expr><name>String</name> <name>wfXml</name></expr></argument>, <argument><expr><name>String</name> <name>user</name></expr></argument>, <argument><expr><name>String</name> <name>group</name></expr></argument>, <argument><expr><name>String</name> <name>strConf</name></expr></argument>)</argument_list></call>
             <throws>throws <argument><expr><name>CommandException</name> <block>{</block></expr></argument></throws></expr></expr_stmt>
         <try>try <block>{<block_content>
             <decl_stmt><decl><type><name>Element</name></type> <name>eWfJob</name> <init>= <expr><call><name><name>XmlUtils</name><operator>.</operator><name>parseXml</name></name><argument_list>(<argument><expr><name>wfXml</name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">366</literal></expr><operator>,</operator><expr><literal type="number">7</literal> <operator>+</operator><literal type="number">378</literal></expr><operator>,</operator><expr><literal type="number">11</literal> @@ <specifier>public</specifier> <name>class</name> <name>SignalXCommand</name> extends <name><name>WorkflowXCommand</name><argument_list type="generic">&lt;<argument><name>Void</name></argument>&gt;</argument_list></name> <block>{
                     <expr><name>eSla</name> <operator>=</operator> <call><name><name>XmlUtils</name><operator>.</operator><name>parseXml</name></name><argument_list>(<argument><expr><name>slaXml</name></expr></argument>)</argument_list></call></expr>;
                     <name>String</name> <name>actionId</name> <operator>=</operator> <call><name><name>Services</name><operator>.</operator><name>get</name></name><argument_list>()</argument_list></call><operator>.</operator><call><name>get</name><argument_list>(<argument><expr><name><name>UUIDService</name><operator>.</operator><name>class</name></name></expr></argument>)</argument_list></call><operator>.</operator><call><name>generateChildId</name><argument_list>(<argument><expr><name>jobId</name></expr></argument>,
                             <argument><expr><call><name><name>action</name><operator>.</operator><name>getAttributeValue</name></name><argument_list>(<argument><expr><literal type="string">"name"</literal></expr></argument>)</argument_list></call> <operator>+</operator> <literal type="string">""</literal></expr></argument>)</argument_list></call></block></expr>;</expr_stmt>
                    <expr_stmt><expr><call><name><name>SLADbXOperations</name><operator>.</operator><name>writeSlaRegistrationEvent</name></name><argument_list>(<argument><expr><name>eSla</name></expr></argument>, <argument><expr><name>actionId</name></expr></argument>, <argument><expr><name><name>SlaAppType</name><operator>.</operator><name>WORKFLOW_ACTION</name></name></expr></argument>, <argument><expr><name>user</name></expr></argument>, <argument><expr><name>group</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                    <decl_stmt><decl><type><name>SLAEventBean</name></type> <name>slaEvent</name> <init>= <expr><call><name><name>SLADbXOperations</name><operator>.</operator><name>createSlaRegistrationEvent</name></name><argument_list>(<argument><expr><name>eSla</name></expr></argument>, <argument><expr><name>actionId</name></expr></argument>,
                            <argument><expr><name><name>SlaAppType</name><operator>.</operator><name>WORKFLOW_ACTION</name></name></expr></argument>, <argument><expr><name>user</name></expr></argument>, <argument><expr><name>group</name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
                    <if_stmt><if>if<condition>(<expr><name>slaEvent</name> <operator>!=</operator> <literal type="null">null</literal></expr>)</condition> <block>{<block_content>
                        <expr_stmt><expr><call><name><name>insertList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>slaEvent</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                    </block_content>}</block></if></if_stmt>
                 </block_content>}</block></try>
             </block_content>}</block></if></if_stmt>
         </block_content>}</block></if></if_stmt>
<expr_stmt><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>wf</name><operator>/</operator><name><name>SubmitXCommand</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>wf</name><operator>/</operator><name><name>SubmitXCommand</name><operator>.</operator><name>java</name></name>
<name>index</name> <name>ac777e0c0</name><operator>..</operator><literal type="number">3c36c76ed</literal> <literal type="number">100644</literal>
<operator>--</operator> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>wf</name><operator>/</operator><name><name>SubmitXCommand</name><operator>.</operator><name>java</name></name>
<operator>++</operator> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>wf</name><operator>/</operator><name><name>SubmitXCommand</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">20</literal></expr><operator>,</operator><expr><literal type="number">6</literal> <operator>+</operator><literal type="number">20</literal></expr><operator>,</operator><expr><literal type="number">7</literal> @@</expr></expr_stmt> <package>package <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>wf</name></name>;</package>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>hadoop</name><operator>.</operator><name>conf</name><operator>.</operator><name>Configuration</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>hadoop</name><operator>.</operator><name>fs</name><operator>.</operator><name>Path</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>hadoop</name><operator>.</operator><name>fs</name><operator>.</operator><name>FileSystem</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>SLAEventBean</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>WorkflowJobBean</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>ErrorCode</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>HadoopAccessorException</name></name>;</import>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">37</literal></expr><operator>,</operator><expr><literal type="number">7</literal> <operator>+</operator><literal type="number">38</literal></expr><operator>,</operator><expr><literal type="number">8</literal> @@</expr></expr_stmt> <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>util</name><operator>.</operator><name>ParamChecker</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>util</name><operator>.</operator><name>XConfiguration</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>util</name><operator>.</operator><name>XmlUtils</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>CommandException</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>WorkflowJobInsertJPAExecutor</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>BulkUpdateInsertJPAExecutor</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>JPAExecutorException</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>ELService</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>SchemaService</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>store</name><operator>.</operator><name>StoreException</name></name>;</import>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">53</literal></expr><operator>,</operator><expr><literal type="number">9</literal> <operator>+</operator><literal type="number">55</literal></expr><operator>,</operator><expr><literal type="number">11</literal> @@</expr></expr_stmt> <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>SchemaService</name><operator>.</operator><name>SchemaName</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>OozieClient</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>WorkflowJob</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>SLAEvent</name><operator>.</operator><name>SlaAppType</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>rest</name><operator>.</operator><name>JsonBean</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>jdom</name><operator>.</operator><name>Element</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>jdom</name><operator>.</operator><name>Namespace</name></name>;</import>
 
<import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>ArrayList</name></name>;</import>
 <import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>Date</name></name>;</import>
 <import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>List</name></name>;</import>
 <import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>Map</name></name>;</import>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">69</literal></expr><operator>,</operator><expr><literal type="number">6</literal> <operator>+</operator><literal type="number">73</literal></expr><operator>,</operator><expr><literal type="number">7</literal> @@ <specifier>public</specifier> <name>class</name> <name>SubmitXCommand</name> extends <name><name>WorkflowXCommand</name><argument_list type="generic">&lt;<argument><name>String</name></argument>&gt;</argument_list></name> <block>{
 
     <expr><specifier>private</specifier> <name>Configuration</name> <name>conf</name></expr>;
     <specifier>private</specifier> <name>String</name> <name>authToken</name></block></expr>;</expr_stmt>
    <decl_stmt><decl><type><specifier>private</specifier> <name><name>List</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name></type> <name>insertList</name> <init>= <expr><operator>new</operator> <call><name><name>ArrayList</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
 
     <constructor><specifier>public</specifier> <name>SubmitXCommand</name><parameter_list>(<parameter><decl><type><name>Configuration</name></type> <name>conf</name></decl></parameter>, <parameter><decl><type><name>String</name></type> <name>authToken</name></decl></parameter>)</parameter_list> <block>{<block_content>
         <expr_stmt><expr><call><name>super</name><argument_list>(<argument><expr><literal type="string">"submit"</literal></expr></argument>, <argument><expr><literal type="string">"submit"</literal></expr></argument>, <argument><expr><literal type="number">1</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">178</literal></expr><operator>,</operator><expr><literal type="number">9</literal> <operator>+</operator><literal type="number">183</literal></expr><operator>,</operator><expr><literal type="number">15</literal> @@ <specifier>public</specifier> <name>class</name> <name>SubmitXCommand</name> extends <name><name>WorkflowXCommand</name><argument_list type="generic">&lt;<argument><name>String</name></argument>&gt;</argument_list></name> <block>{
             <comment type="line">// System.out.println("SlaXml :"+ slaXml);</comment>
 
             <comment type="line">//store.insertWorkflow(workflow);</comment>
            <expr><call><name><name>insertList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>workflow</name></expr></argument>)</argument_list></call></expr>;
             <name>JPAService</name> <name>jpaService</name> <operator>=</operator> <call><name><name>Services</name><operator>.</operator><name>get</name></name><argument_list>()</argument_list></call><operator>.</operator><call><name>get</name><argument_list>(<argument><expr><name><name>JPAService</name><operator>.</operator><name>class</name></name></expr></argument>)</argument_list></call></block></expr>;</expr_stmt>
             <if_stmt><if>if <condition>(<expr><name>jpaService</name> <operator>!=</operator> <literal type="null">null</literal></expr>)</condition> <block>{<block_content>
                <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>WorkflowJobInsertJPAExecutor</name><argument_list>(<argument><expr><name>workflow</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                <try>try <block>{<block_content>
                    <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>BulkUpdateInsertJPAExecutor</name><argument_list>(<argument><expr><literal type="null">null</literal></expr></argument>, <argument><expr><name>insertList</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                </block_content>}</block>
                <catch>catch <parameter_list>(<parameter><decl><type><name>JPAExecutorException</name></type> <name>je</name></decl></parameter>)</parameter_list> <block>{<block_content>
                    <throw>throw <expr><operator>new</operator> <call><name>CommandException</name><argument_list>(<argument><expr><name>je</name></expr></argument>)</argument_list></call></expr>;</throw>
                </block_content>}</block></catch></try>
             </block_content>}</block></if>
             <else>else <block>{<block_content>
                 <expr_stmt><expr><call><name><name>LOG</name><operator>.</operator><name>error</name></name><argument_list>(<argument><expr><name><name>ErrorCode</name><operator>.</operator><name>E0610</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">223</literal></expr><operator>,</operator><expr><literal type="number">7</literal> <operator>+</operator><literal type="number">234</literal></expr><operator>,</operator><expr><literal type="number">11</literal> @@ <specifier>public</specifier> <name>class</name> <name>SubmitXCommand</name> extends <name><name>WorkflowXCommand</name><argument_list type="generic">&lt;<argument><name>String</name></argument>&gt;</argument_list></name> <block>{
         <try>try <block>{<block_content>
             <if_stmt><if>if <condition>(<expr><name>slaXml</name> <operator>!=</operator> <literal type="null">null</literal> <operator>&amp;&amp;</operator> <call><name><name>slaXml</name><operator>.</operator><name>length</name></name><argument_list>()</argument_list></call> <operator>&gt;</operator> <literal type="number">0</literal></expr>)</condition> <block>{<block_content>
                 <decl_stmt><decl><type><name>Element</name></type> <name>eSla</name> <init>= <expr><call><name><name>XmlUtils</name><operator>.</operator><name>parseXml</name></name><argument_list>(<argument><expr><name>slaXml</name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
                <expr_stmt><expr><call><name><name>SLADbOperations</name><operator>.</operator><name>writeSlaRegistrationEvent</name></name><argument_list>(<argument><expr><name>eSla</name></expr></argument>, <argument><expr><name>id</name></expr></argument>, <argument><expr><name><name>SlaAppType</name><operator>.</operator><name>WORKFLOW_JOB</name></name></expr></argument>, <argument><expr><name>user</name></expr></argument>, <argument><expr><name>group</name></expr></argument>, <argument><expr><name>log</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                <decl_stmt><decl><type><name>SLAEventBean</name></type> <name>slaEvent</name> <init>= <expr><call><name><name>SLADbOperations</name><operator>.</operator><name>createSlaRegistrationEvent</name></name><argument_list>(<argument><expr><name>eSla</name></expr></argument>, <argument><expr><name>id</name></expr></argument>,
                        <argument><expr><name><name>SlaAppType</name><operator>.</operator><name>WORKFLOW_JOB</name></name></expr></argument>, <argument><expr><name>user</name></expr></argument>, <argument><expr><name>group</name></expr></argument>, <argument><expr><name>log</name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
                <if_stmt><if>if<condition>(<expr><name>slaEvent</name> <operator>!=</operator> <literal type="null">null</literal></expr>)</condition> <block>{<block_content>
                    <expr_stmt><expr><call><name><name>insertList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>slaEvent</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                </block_content>}</block></if></if_stmt>
             </block_content>}</block></if></if_stmt>
         </block_content>}</block>
         <catch>catch <parameter_list>(<parameter><decl><type><name>Exception</name></type> <name>e</name></decl></parameter>)</parameter_list> <block>{<block_content>
<expr_stmt><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>wf</name><operator>/</operator><name><name>SuspendXCommand</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>wf</name><operator>/</operator><name><name>SuspendXCommand</name><operator>.</operator><name>java</name></name>
<name>index</name> <literal type="number">7b49fc961</literal><operator>..</operator><literal type="number">30b4f00c5</literal> <literal type="number">100644</literal>
<operator>--</operator> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>wf</name><operator>/</operator><name><name>SuspendXCommand</name><operator>.</operator><name>java</name></name>
<operator>++</operator> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>wf</name><operator>/</operator><name><name>SuspendXCommand</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">17</literal></expr><operator>,</operator><expr><literal type="number">20</literal> <operator>+</operator><literal type="number">17</literal></expr><operator>,</operator><expr><literal type="number">22</literal> @@
  <operator>*</operator><operator>/</operator></expr></expr_stmt>
 <package>package <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>wf</name></name>;</package>
 
<import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>ArrayList</name></name>;</import>
<import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>Date</name></name>;</import>
 <import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>List</name></name>;</import>
 
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>ErrorCode</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>WorkflowActionBean</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>WorkflowJobBean</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>WorkflowJob</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>rest</name><operator>.</operator><name>JsonBean</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>CommandException</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>PreconditionException</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>coord</name><operator>.</operator><name>CoordActionUpdateXCommand</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>BulkUpdateInsertJPAExecutor</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>JPAExecutorException</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>WorkflowActionRetryManualGetJPAExecutor</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>WorkflowActionUpdateJPAExecutor</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>WorkflowJobGetJPAExecutor</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>WorkflowJobUpdateJPAExecutor</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>JPAService</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>Services</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>util</name><operator>.</operator><name>InstrumentUtils</name></name>;</import>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">44</literal></expr><operator>,</operator><expr><literal type="number">6</literal> <operator>+</operator><literal type="number">46</literal></expr><operator>,</operator><expr><literal type="number">7</literal> @@ <specifier>public</specifier> <name>class</name> <name>SuspendXCommand</name> extends <name><name>WorkflowXCommand</name><argument_list type="generic">&lt;<argument><name>Void</name></argument>&gt;</argument_list></name> <block>{
     <expr><specifier>private</specifier> <name>final</name> <name>String</name> <name>wfid</name></expr>;
     <specifier>private</specifier> <name>WorkflowJobBean</name> <name>wfJobBean</name></block></expr>;</expr_stmt>
     <decl_stmt><decl><type><specifier>private</specifier> <name>JPAService</name></type> <name>jpaService</name></decl>;</decl_stmt>
    <decl_stmt><decl><type><specifier>private</specifier> <specifier>static</specifier> <name><name>List</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name></type> <name>updateList</name> <init>= <expr><operator>new</operator> <call><name><name>ArrayList</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
 
     <constructor><specifier>public</specifier> <name>SuspendXCommand</name><parameter_list>(<parameter><decl><type><name>String</name></type> <name>id</name></decl></parameter>)</parameter_list> <block>{<block_content>
         <expr_stmt><expr><call><name>super</name><argument_list>(<argument><expr><literal type="string">"suspend"</literal></expr></argument>, <argument><expr><literal type="string">"suspend"</literal></expr></argument>, <argument><expr><literal type="number">1</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">58</literal></expr><operator>,</operator><expr><literal type="number">7</literal> <operator>+</operator><literal type="number">61</literal></expr><operator>,</operator><expr><literal type="number">9</literal> @@ <specifier>public</specifier> <name>class</name> <name>SuspendXCommand</name> extends <name><name>WorkflowXCommand</name><argument_list type="generic">&lt;<argument><name>Void</name></argument>&gt;</argument_list></name> <block>{
         <expr><call><name><name>InstrumentUtils</name><operator>.</operator><name>incrJobCounter</name></name><argument_list>(<argument><expr><call><name>getName</name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><literal type="number">1</literal></expr></argument>, <argument><expr><call><name>getInstrumentation</name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</block></expr></expr_stmt>
         <try>try <block>{<block_content>
             <expr_stmt><expr><call><name>suspendJob</name><argument_list>(<argument><expr><name><name>this</name><operator>.</operator><name>jpaService</name></name></expr></argument>, <argument><expr><name><name>this</name><operator>.</operator><name>wfJobBean</name></name></expr></argument>, <argument><expr><name><name>this</name><operator>.</operator><name>wfid</name></name></expr></argument>, <argument><expr><literal type="null">null</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>WorkflowJobUpdateJPAExecutor</name><argument_list>(<argument><expr><name><name>this</name><operator>.</operator><name>wfJobBean</name></name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name><name>this</name><operator>.</operator><name>wfJobBean</name><operator>.</operator><name>setLastModifiedTime</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>Date</name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name><name>updateList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name><name>this</name><operator>.</operator><name>wfJobBean</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>BulkUpdateInsertJPAExecutor</name><argument_list>(<argument><expr><name>updateList</name></expr></argument>, <argument><expr><literal type="null">null</literal></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
             <expr_stmt><expr><call><name>queue</name><argument_list>(<argument><expr><operator>new</operator> <call><name>NotificationXCommand</name><argument_list>(<argument><expr><name><name>this</name><operator>.</operator><name>wfJobBean</name></name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
         </block_content>}</block>
         <catch>catch <parameter_list>(<parameter><decl><type><name>WorkflowException</name></type> <name>e</name></decl></parameter>)</parameter_list> <block>{<block_content>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">121</literal></expr><operator>,</operator><expr><literal type="number">7</literal> <operator>+</operator><literal type="number">126</literal></expr><operator>,</operator><expr><literal type="number">7</literal> @@ <specifier>public</specifier> <name>class</name> <name>SuspendXCommand</name> extends <name><name>WorkflowXCommand</name><argument_list type="generic">&lt;<argument><name>Void</name></argument>&gt;</argument_list></name> <block>{
                 <if_stmt><else>else <block>{<block_content>
                     <expr_stmt><expr><call><name><name>action</name><operator>.</operator><name>resetPendingOnly</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
                 <expr_stmt/></block_content></block></else></if_stmt>}</block>
                <call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>WorkflowActionUpdateJPAExecutor</name><argument_list>(<argument><expr><name>action</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                <expr_stmt><expr><call><name><name>updateList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>action</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
 
             </block_content>}</block></catch></try>
         </block_content>}</block></constructor>
<expr_stmt><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>executor</name><operator>/</operator><name>jpa</name><operator>/</operator><name><name>BulkDeleteForPurgeJPAExecutor</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>executor</name><operator>/</operator><name>jpa</name><operator>/</operator><name><name>BulkDeleteForPurgeJPAExecutor</name><operator>.</operator><name>java</name></name>
<operator>new</operator> <name>file</name> <name>mode</name> <literal type="number">100644</literal>
<name>index</name> <literal type="number">000000000..905922eec</literal>
<operator>--</operator> <operator>/</operator><name>dev</name><operator>/</operator><literal type="null">null</literal>
<operator>++</operator> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>executor</name><operator>/</operator><name>jpa</name><operator>/</operator><name><name>BulkDeleteForPurgeJPAExecutor</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">0</literal></expr><operator>,</operator><expr><literal type="number">0</literal> <operator>+</operator><literal type="number">1</literal></expr><operator>,</operator><expr><literal type="number">113</literal> @@</expr></expr_stmt>
<comment type="block" format="javadoc">/**
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */</comment>
<package>package <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name></name>;</package>

<import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>Collection</name></name>;</import>
<import>import <name><name>javax</name><operator>.</operator><name>persistence</name><operator>.</operator><name>EntityManager</name></name>;</import>
<import>import <name><name>javax</name><operator>.</operator><name>persistence</name><operator>.</operator><name>Query</name></name>;</import>

<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>BundleJobBean</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>CoordinatorJobBean</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>ErrorCode</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>FaultInjection</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>WorkflowJobBean</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>rest</name><operator>.</operator><name>JsonBean</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>util</name><operator>.</operator><name>ParamChecker</name></name>;</import>

<comment type="block" format="javadoc">/**
 * Delete job, its list of actions and return the number of
 * actions been deleted.
 */</comment>
<class><specifier>public</specifier> class <name>BulkDeleteForPurgeJPAExecutor</name> <super_list><implements>implements <super><name><name>JPAExecutor</name><argument_list type="generic">&lt;<argument><name>Integer</name></argument>&gt;</argument_list></name></super></implements></super_list> <block>{

    <decl_stmt><decl><type><specifier>private</specifier> <name><name>Collection</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name></type> <name>deleteList</name></decl>;</decl_stmt>

    <comment type="block" format="javadoc">/**
     * Initialize the JPAExecutor using the delete list of JSON beans
     * @param deleteList
     */</comment>
    <constructor><specifier>public</specifier> <name>BulkDeleteForPurgeJPAExecutor</name><parameter_list>(<parameter><decl><type><name><name>Collection</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name></type> <name>deleteList</name></decl></parameter>)</parameter_list> <block>{<block_content>
        <expr_stmt><expr><name><name>this</name><operator>.</operator><name>deleteList</name></name> <operator>=</operator> <name>deleteList</name></expr>;</expr_stmt>
    </block_content>}</block></constructor>

    <constructor><specifier>public</specifier> <name>BulkDeleteForPurgeJPAExecutor</name><parameter_list>()</parameter_list> <block>{<block_content>
    </block_content>}</block></constructor>

    <comment type="block" format="javadoc">/**
     * Sets the delete list for JSON bean
     *
     * @param deleteList
     */</comment>
    <function><type><specifier>public</specifier> <name>void</name></type> <name>setDeleteList</name><parameter_list>(<parameter><decl><type><name><name>Collection</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name></type> <name>deleteList</name></decl></parameter>)</parameter_list> <block>{<block_content>
        <expr_stmt><expr><name><name>this</name><operator>.</operator><name>deleteList</name></name> <operator>=</operator> <name>deleteList</name></expr>;</expr_stmt>
    </block_content>}</block></function>

    <comment type="block">/*
     * (non-Javadoc)
     *
     * @see org.apache.oozie.executor.jpa.JPAExecutor#getName()
     */</comment>
    <function><annotation>@<name>Override</name></annotation>
    <type><specifier>public</specifier> <name>String</name></type> <name>getName</name><parameter_list>()</parameter_list> <block>{<block_content>
        <return>return <expr><literal type="string">"BulkDeleteForPurgeJPAExecutor"</literal></expr>;</return>
    </block_content>}</block></function>

    <comment type="block">/*
     * (non-Javadoc)
     *
     * @see org.apache.oozie.executor.jpa.JPAExecutor#execute(javax.persistence.
     * EntityManager)
     */</comment>
    <function><annotation>@<name>Override</name></annotation>
    <type><specifier>public</specifier> <name>Integer</name></type> <name>execute</name><parameter_list>(<parameter><decl><type><name>EntityManager</name></type> <name>em</name></decl></parameter>)</parameter_list> <throws>throws <argument><expr><name>JPAExecutorException</name></expr></argument></throws> <block>{<block_content>
        <decl_stmt><decl><type><name>int</name></type> <name>actionsDeleted</name> <init>= <expr><literal type="number">0</literal></expr></init></decl>;</decl_stmt>
        <try>try <block>{<block_content>
            <comment type="line">// Only used by test cases to check for rollback of transaction</comment>
            <expr_stmt><expr><call><name><name>FaultInjection</name><operator>.</operator><name>activate</name></name><argument_list>(<argument><expr><literal type="string">"org.apache.oozie.command.SkipCommitFaultInjection"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <if_stmt><if>if <condition>(<expr><name>deleteList</name> <operator>!=</operator> <literal type="null">null</literal></expr>)</condition> <block>{<block_content>
                <for>for <control>(<init><decl><type><name>JsonBean</name></type> <name>entity</name> <range>: <expr><name>deleteList</name></expr></range></decl></init>)</control> <block>{<block_content>
                    <expr_stmt><expr><call><name><name>ParamChecker</name><operator>.</operator><name>notNull</name></name><argument_list>(<argument><expr><name>entity</name></expr></argument>, <argument><expr><literal type="string">"JsonBean"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                    <comment type="line">// deleting the job (wf/coord/bundle)</comment>
                    <expr_stmt><expr><call><name><name>em</name><operator>.</operator><name>remove</name></name><argument_list>(<argument><expr><call><name><name>em</name><operator>.</operator><name>merge</name></name><argument_list>(<argument><expr><name>entity</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                    <if_stmt><if>if <condition>(<expr><name>entity</name> <operator>instanceof</operator> <name>WorkflowJobBean</name></expr>)</condition> <block>{<block_content>
                        <comment type="line">// deleting the workflow actions for this job</comment>
                        <decl_stmt><decl><type><name>Query</name></type> <name>g</name> <init>= <expr><call><name><name>em</name><operator>.</operator><name>createNamedQuery</name></name><argument_list>(<argument><expr><literal type="string">"DELETE_ACTIONS_FOR_WORKFLOW"</literal></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
                        <expr_stmt><expr><call><name><name>g</name><operator>.</operator><name>setParameter</name></name><argument_list>(<argument><expr><literal type="string">"wfId"</literal></expr></argument>, <argument><expr><operator>(</operator><operator>(</operator><name>WorkflowJobBean</name><operator>)</operator> <name>entity</name><operator>)</operator><operator>.</operator><call><name>getId</name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                        <expr_stmt><expr><name>actionsDeleted</name> <operator>=</operator> <call><name><name>g</name><operator>.</operator><name>executeUpdate</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
                    </block_content>}</block></if>
                    <if type="elseif">else if <condition>(<expr><name>entity</name> <operator>instanceof</operator> <name>CoordinatorJobBean</name></expr>)</condition> <block>{<block_content>
                        <comment type="line">// deleting the coord actions for this job</comment>
                        <decl_stmt><decl><type><name>Query</name></type> <name>g</name> <init>= <expr><call><name><name>em</name><operator>.</operator><name>createNamedQuery</name></name><argument_list>(<argument><expr><literal type="string">"DELETE_COMPLETED_ACTIONS_FOR_COORDINATOR"</literal></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
                        <expr_stmt><expr><call><name><name>g</name><operator>.</operator><name>setParameter</name></name><argument_list>(<argument><expr><literal type="string">"jobId"</literal></expr></argument>, <argument><expr><operator>(</operator><operator>(</operator><name>CoordinatorJobBean</name><operator>)</operator> <name>entity</name><operator>)</operator><operator>.</operator><call><name>getId</name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                        <expr_stmt><expr><name>actionsDeleted</name> <operator>=</operator> <call><name><name>g</name><operator>.</operator><name>executeUpdate</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
                    </block_content>}</block></if>
                    <if type="elseif">else if <condition>(<expr><name>entity</name> <operator>instanceof</operator> <name>BundleJobBean</name></expr>)</condition> <block>{<block_content>
                        <comment type="line">// deleting the bundle actions for this job</comment>
                        <decl_stmt><decl><type><name>Query</name></type> <name>g</name> <init>= <expr><call><name><name>em</name><operator>.</operator><name>createNamedQuery</name></name><argument_list>(<argument><expr><literal type="string">"DELETE_COMPLETED_ACTIONS_FOR_BUNDLE"</literal></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
                        <expr_stmt><expr><call><name><name>g</name><operator>.</operator><name>setParameter</name></name><argument_list>(<argument><expr><literal type="string">"bundleId"</literal></expr></argument>, <argument><expr><operator>(</operator><operator>(</operator><name>BundleJobBean</name><operator>)</operator> <name>entity</name><operator>)</operator><operator>.</operator><call><name>getId</name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                        <expr_stmt><expr><name>actionsDeleted</name> <operator>=</operator> <call><name><name>g</name><operator>.</operator><name>executeUpdate</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
                    </block_content>}</block></if></if_stmt>
                </block_content>}</block></for>
            </block_content>}</block></if></if_stmt>
        </block_content>}</block>
        <catch>catch <parameter_list>(<parameter><decl><type><name>Exception</name></type> <name>e</name></decl></parameter>)</parameter_list> <block>{<block_content>
            <throw>throw <expr><operator>new</operator> <call><name>JPAExecutorException</name><argument_list>(<argument><expr><name><name>ErrorCode</name><operator>.</operator><name>E0603</name></name></expr></argument>, <argument><expr><name>e</name></expr></argument>)</argument_list></call></expr>;</throw>
        </block_content>}</block></catch></try>
        <return>return <expr><name>actionsDeleted</name></expr>;</return>
    </block_content>}</block></function>
}</block></class>
<expr_stmt><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>executor</name><operator>/</operator><name>jpa</name><operator>/</operator><name><name>BulkUpdateDeleteJPAExecutor</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>executor</name><operator>/</operator><name>jpa</name><operator>/</operator><name><name>BulkUpdateDeleteJPAExecutor</name><operator>.</operator><name>java</name></name>
<operator>new</operator> <name>file</name> <name>mode</name> <literal type="number">100644</literal>
<name>index</name> <literal type="number">000000000..03638c780</literal>
<operator>--</operator> <operator>/</operator><name>dev</name><operator>/</operator><literal type="null">null</literal>
<operator>++</operator> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>executor</name><operator>/</operator><name>jpa</name><operator>/</operator><name><name>BulkUpdateDeleteJPAExecutor</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">0</literal></expr><operator>,</operator><expr><literal type="number">0</literal> <operator>+</operator><literal type="number">1</literal></expr><operator>,</operator><expr><literal type="number">133</literal> @@</expr></expr_stmt>
<comment type="block" format="javadoc">/**
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */</comment>
<package>package <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name></name>;</package>

<import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>Collection</name></name>;</import>
<import>import <name><name>javax</name><operator>.</operator><name>persistence</name><operator>.</operator><name>EntityManager</name></name>;</import>
<import>import <name><name>javax</name><operator>.</operator><name>persistence</name><operator>.</operator><name>Query</name></name>;</import>

<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>CoordinatorActionBean</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>ErrorCode</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>FaultInjection</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>rest</name><operator>.</operator><name>JsonBean</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>util</name><operator>.</operator><name>ParamChecker</name></name>;</import>

<comment type="block" format="javadoc">/**
 * Class for updating and deleting beans in bulk
 */</comment>
<class><specifier>public</specifier> class <name>BulkUpdateDeleteJPAExecutor</name> <super_list><implements>implements <super><name><name>JPAExecutor</name><argument_list type="generic">&lt;<argument><name>Void</name></argument>&gt;</argument_list></name></super></implements></super_list> <block>{

    <decl_stmt><decl><type><specifier>private</specifier> <name><name>Collection</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name></type> <name>updateList</name></decl>;</decl_stmt>
    <decl_stmt><decl><type><specifier>private</specifier> <name><name>Collection</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name></type> <name>deleteList</name></decl>;</decl_stmt>
    <decl_stmt><decl><type><specifier>private</specifier> <name>boolean</name></type> <name>forRerun</name> <init>= <expr><literal type="boolean">true</literal></expr></init></decl>;</decl_stmt>

    <comment type="block" format="javadoc">/**
     * Initialize the JPAExecutor using the update and delete list of JSON beans
     * @param deleteList
     * @param updateList
     */</comment>
    <constructor><specifier>public</specifier> <name>BulkUpdateDeleteJPAExecutor</name><parameter_list>(<parameter><decl><type><name><name>Collection</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name></type> <name>updateList</name></decl></parameter>, <parameter><decl><type><name><name>Collection</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name></type> <name>deleteList</name></decl></parameter>,
            <parameter><decl><type><name>boolean</name></type> <name>forRerun</name></decl></parameter>)</parameter_list> <block>{<block_content>
        <expr_stmt><expr><name><name>this</name><operator>.</operator><name>updateList</name></name> <operator>=</operator> <name>updateList</name></expr>;</expr_stmt>
        <expr_stmt><expr><name><name>this</name><operator>.</operator><name>deleteList</name></name> <operator>=</operator> <name>deleteList</name></expr>;</expr_stmt>
        <expr_stmt><expr><name><name>this</name><operator>.</operator><name>forRerun</name></name> <operator>=</operator> <name>forRerun</name></expr>;</expr_stmt>
    </block_content>}</block></constructor>

    <constructor><specifier>public</specifier> <name>BulkUpdateDeleteJPAExecutor</name><parameter_list>()</parameter_list> <block>{<block_content>
    </block_content>}</block></constructor>

    <comment type="block" format="javadoc">/**
     * Sets the update list for JSON bean
     *
     * @param updateList
     */</comment>
    <function><type><specifier>public</specifier> <name>void</name></type> <name>setUpdateList</name><parameter_list>(<parameter><decl><type><name><name>Collection</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name></type> <name>updateList</name></decl></parameter>)</parameter_list> <block>{<block_content>
        <expr_stmt><expr><name><name>this</name><operator>.</operator><name>updateList</name></name> <operator>=</operator> <name>updateList</name></expr>;</expr_stmt>
    </block_content>}</block></function>

    <comment type="block" format="javadoc">/**
     * Sets the delete list for JSON bean
     *
     * @param deleteList
     */</comment>
    <function><type><specifier>public</specifier> <name>void</name></type> <name>setDeleteList</name><parameter_list>(<parameter><decl><type><name><name>Collection</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name></type> <name>deleteList</name></decl></parameter>)</parameter_list> <block>{<block_content>
        <expr_stmt><expr><name><name>this</name><operator>.</operator><name>deleteList</name></name> <operator>=</operator> <name>deleteList</name></expr>;</expr_stmt>
    </block_content>}</block></function>

    <comment type="block" format="javadoc">/**
     * Sets whether for RerunX command or no. Else it'd be for ChangeX
     *
     * @param forRerun
     */</comment>
    <function><type><specifier>public</specifier> <name>void</name></type> <name>setForRerun</name><parameter_list>(<parameter><decl><type><name>boolean</name></type> <name>forRerun</name></decl></parameter>)</parameter_list> <block>{<block_content>
        <expr_stmt><expr><name><name>this</name><operator>.</operator><name>forRerun</name></name> <operator>=</operator> <name>forRerun</name></expr>;</expr_stmt>
    </block_content>}</block></function>

    <comment type="block">/*
     * (non-Javadoc)
     *
     * @see org.apache.oozie.executor.jpa.JPAExecutor#getName()
     */</comment>
    <function><annotation>@<name>Override</name></annotation>
    <type><specifier>public</specifier> <name>String</name></type> <name>getName</name><parameter_list>()</parameter_list> <block>{<block_content>
        <return>return <expr><literal type="string">"BulkUpdateDeleteJPAExecutor"</literal></expr>;</return>
    </block_content>}</block></function>

    <comment type="block">/*
     * (non-Javadoc)
     *
     * @see org.apache.oozie.executor.jpa.JPAExecutor#execute(javax.persistence.
     * EntityManager)
     */</comment>
    <function><annotation>@<name>Override</name></annotation>
    <type><specifier>public</specifier> <name>Void</name></type> <name>execute</name><parameter_list>(<parameter><decl><type><name>EntityManager</name></type> <name>em</name></decl></parameter>)</parameter_list> <throws>throws <argument><expr><name>JPAExecutorException</name></expr></argument></throws> <block>{<block_content>
        <try>try <block>{<block_content>
            <if_stmt><if>if <condition>(<expr><name>updateList</name> <operator>!=</operator> <literal type="null">null</literal></expr>)</condition> <block>{<block_content>
                <for>for <control>(<init><decl><type><name>JsonBean</name></type> <name>entity</name> <range>: <expr><name>updateList</name></expr></range></decl></init>)</control> <block>{<block_content>
                    <expr_stmt><expr><call><name><name>ParamChecker</name><operator>.</operator><name>notNull</name></name><argument_list>(<argument><expr><name>entity</name></expr></argument>, <argument><expr><literal type="string">"JsonBean"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                    <expr_stmt><expr><call><name><name>em</name><operator>.</operator><name>merge</name></name><argument_list>(<argument><expr><name>entity</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                </block_content>}</block></for>
            </block_content>}</block></if></if_stmt>
            <comment type="line">// Only used by test cases to check for rollback of transaction</comment>
            <expr_stmt><expr><call><name><name>FaultInjection</name><operator>.</operator><name>activate</name></name><argument_list>(<argument><expr><literal type="string">"org.apache.oozie.command.SkipCommitFaultInjection"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <if_stmt><if>if <condition>(<expr><name>deleteList</name> <operator>!=</operator> <literal type="null">null</literal></expr>)</condition> <block>{<block_content>
                <for>for <control>(<init><decl><type><name>JsonBean</name></type> <name>entity</name> <range>: <expr><name>deleteList</name></expr></range></decl></init>)</control> <block>{<block_content>
                    <expr_stmt><expr><call><name><name>ParamChecker</name><operator>.</operator><name>notNull</name></name><argument_list>(<argument><expr><name>entity</name></expr></argument>, <argument><expr><literal type="string">"JsonBean"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                    <if_stmt><if>if <condition>(<expr><name>forRerun</name></expr>)</condition> <block>{<block_content>
                        <expr_stmt><expr><call><name><name>em</name><operator>.</operator><name>remove</name></name><argument_list>(<argument><expr><call><name><name>em</name><operator>.</operator><name>merge</name></name><argument_list>(<argument><expr><name>entity</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                    </block_content>}</block></if>
                    <else>else <block>{<block_content>
                        <decl_stmt><decl><type><name>Query</name></type> <name>g</name> <init>= <expr><call><name><name>em</name><operator>.</operator><name>createNamedQuery</name></name><argument_list>(<argument><expr><literal type="string">"DELETE_UNSCHEDULED_ACTION"</literal></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
                        <decl_stmt><decl><type><name>String</name></type> <name>coordActionId</name> <init>= <expr><operator>(</operator><operator>(</operator><name>CoordinatorActionBean</name><operator>)</operator> <name>entity</name><operator>)</operator><operator>.</operator><call><name>getId</name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
                        <expr_stmt><expr><call><name><name>g</name><operator>.</operator><name>setParameter</name></name><argument_list>(<argument><expr><literal type="string">"id"</literal></expr></argument>, <argument><expr><name>coordActionId</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                        <decl_stmt><decl><type><name>int</name></type> <name>actionsDeleted</name> <init>= <expr><call><name><name>g</name><operator>.</operator><name>executeUpdate</name></name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
                        <if_stmt><if>if <condition>(<expr><name>actionsDeleted</name> <operator>==</operator> <literal type="number">0</literal></expr>)</condition><block type="pseudo"><block_content>
                            <throw>throw <expr><operator>new</operator> <call><name>JPAExecutorException</name><argument_list>(<argument><expr><name><name>ErrorCode</name><operator>.</operator><name>E1022</name></name></expr></argument>, <argument><expr><name>coordActionId</name></expr></argument>)</argument_list></call></expr>;</throw></block_content></block></if></if_stmt>
                    </block_content>}</block></else></if_stmt>
                </block_content>}</block></for>
            </block_content>}</block></if></if_stmt>
            <return>return <expr><literal type="null">null</literal></expr>;</return>
        </block_content>}</block>
        <catch>catch <parameter_list>(<parameter><decl><type><name>JPAExecutorException</name></type> <name>je</name></decl></parameter>)</parameter_list> <block>{<block_content>
            <throw>throw <expr><name>je</name></expr>;</throw>
        </block_content>}</block></catch>
        <catch>catch <parameter_list>(<parameter><decl><type><name>Exception</name></type> <name>e</name></decl></parameter>)</parameter_list> <block>{<block_content>
            <throw>throw <expr><operator>new</operator> <call><name>JPAExecutorException</name><argument_list>(<argument><expr><name><name>ErrorCode</name><operator>.</operator><name>E0603</name></name></expr></argument>, <argument><expr><name>e</name></expr></argument>)</argument_list></call></expr>;</throw>
        </block_content>}</block></catch></try>
    </block_content>}</block></function>
}</block></class>
<expr_stmt><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>executor</name><operator>/</operator><name>jpa</name><operator>/</operator><name><name>BulkUpdateInsertForCoordActionStartJPAExecutor</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>executor</name><operator>/</operator><name>jpa</name><operator>/</operator><name><name>BulkUpdateInsertForCoordActionStartJPAExecutor</name><operator>.</operator><name>java</name></name>
<operator>new</operator> <name>file</name> <name>mode</name> <literal type="number">100644</literal>
<name>index</name> <literal type="number">000000000..7ca09fa51</literal>
<operator>--</operator> <operator>/</operator><name>dev</name><operator>/</operator><literal type="null">null</literal>
<operator>++</operator> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>executor</name><operator>/</operator><name>jpa</name><operator>/</operator><name><name>BulkUpdateInsertForCoordActionStartJPAExecutor</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">0</literal></expr><operator>,</operator><expr><literal type="number">0</literal> <operator>+</operator><literal type="number">1</literal></expr><operator>,</operator><expr><literal type="number">127</literal> @@</expr></expr_stmt>
<comment type="block" format="javadoc">/**
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */</comment>
<package>package <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name></name>;</package>

<import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>Collection</name></name>;</import>
<import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>Date</name></name>;</import>

<import>import <name><name>javax</name><operator>.</operator><name>persistence</name><operator>.</operator><name>EntityManager</name></name>;</import>
<import>import <name><name>javax</name><operator>.</operator><name>persistence</name><operator>.</operator><name>Query</name></name>;</import>

<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>CoordinatorActionBean</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>ErrorCode</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>FaultInjection</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>rest</name><operator>.</operator><name>JsonBean</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>util</name><operator>.</operator><name>ParamChecker</name></name>;</import>

<comment type="block" format="javadoc">/**
 * Class for inserting and updating beans in bulk
 *
 */</comment>
<class><specifier>public</specifier> class <name>BulkUpdateInsertForCoordActionStartJPAExecutor</name> <super_list><implements>implements <super><name><name>JPAExecutor</name><argument_list type="generic">&lt;<argument><name>Void</name></argument>&gt;</argument_list></name></super></implements></super_list> <block>{

    <decl_stmt><decl><type><specifier>private</specifier> <name><name>Collection</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name></type> <name>updateList</name></decl>;</decl_stmt>
    <decl_stmt><decl><type><specifier>private</specifier> <name><name>Collection</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name></type> <name>insertList</name></decl>;</decl_stmt>

    <comment type="block" format="javadoc">/**
     * Initialize the JPAExecutor using the update and insert list of JSON beans
     *
     * @param updateList
     * @param insertList
     */</comment>
    <constructor><specifier>public</specifier> <name>BulkUpdateInsertForCoordActionStartJPAExecutor</name><parameter_list>(<parameter><decl><type><name><name>Collection</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name></type> <name>updateList</name></decl></parameter>,
            <parameter><decl><type><name><name>Collection</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name></type> <name>insertList</name></decl></parameter>)</parameter_list> <block>{<block_content>
        <expr_stmt><expr><name><name>this</name><operator>.</operator><name>updateList</name></name> <operator>=</operator> <name>updateList</name></expr>;</expr_stmt>
        <expr_stmt><expr><name><name>this</name><operator>.</operator><name>insertList</name></name> <operator>=</operator> <name>insertList</name></expr>;</expr_stmt>
    </block_content>}</block></constructor>

    <constructor><specifier>public</specifier> <name>BulkUpdateInsertForCoordActionStartJPAExecutor</name><parameter_list>()</parameter_list> <block>{<block_content>
    </block_content>}</block></constructor>

    <comment type="block" format="javadoc">/**
     * Sets the update list for JSON bean
     *
     * @param updateList
     */</comment>
    <function><type><specifier>public</specifier> <name>void</name></type> <name>setUpdateList</name><parameter_list>(<parameter><decl><type><name><name>Collection</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name></type> <name>updateList</name></decl></parameter>)</parameter_list> <block>{<block_content>
        <expr_stmt><expr><name><name>this</name><operator>.</operator><name>updateList</name></name> <operator>=</operator> <name>updateList</name></expr>;</expr_stmt>
    </block_content>}</block></function>

    <comment type="block" format="javadoc">/**
     * Sets the insert list for JSON bean
     *
     * @param insertList
     */</comment>
    <function><type><specifier>public</specifier> <name>void</name></type> <name>setInsertList</name><parameter_list>(<parameter><decl><type><name><name>Collection</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name></type> <name>insertList</name></decl></parameter>)</parameter_list> <block>{<block_content>
        <expr_stmt><expr><name><name>this</name><operator>.</operator><name>insertList</name></name> <operator>=</operator> <name>insertList</name></expr>;</expr_stmt>
    </block_content>}</block></function>

    <comment type="block">/*
     * (non-Javadoc)
     *
     * @see org.apache.oozie.executor.jpa.JPAExecutor#getName()
     */</comment>
    <function><annotation>@<name>Override</name></annotation>
    <type><specifier>public</specifier> <name>String</name></type> <name>getName</name><parameter_list>()</parameter_list> <block>{<block_content>
        <return>return <expr><literal type="string">"BulkUpdateInsertForCoordActionStartJPAExecutor"</literal></expr>;</return>
    </block_content>}</block></function>

    <comment type="block">/*
     * (non-Javadoc)
     *
     * @see org.apache.oozie.executor.jpa.JPAExecutor#execute(javax.persistence.
     * EntityManager)
     */</comment>
    <function><annotation>@<name>Override</name></annotation>
    <type><specifier>public</specifier> <name>Void</name></type> <name>execute</name><parameter_list>(<parameter><decl><type><name>EntityManager</name></type> <name>em</name></decl></parameter>)</parameter_list> <throws>throws <argument><expr><name>JPAExecutorException</name></expr></argument></throws> <block>{<block_content>
        <try>try <block>{<block_content>
            <if_stmt><if>if <condition>(<expr><name>insertList</name> <operator>!=</operator> <literal type="null">null</literal></expr>)</condition> <block>{<block_content>
                <for>for <control>(<init><decl><type><name>JsonBean</name></type> <name>entity</name> <range>: <expr><name>insertList</name></expr></range></decl></init>)</control> <block>{<block_content>
                    <expr_stmt><expr><call><name><name>ParamChecker</name><operator>.</operator><name>notNull</name></name><argument_list>(<argument><expr><name>entity</name></expr></argument>, <argument><expr><literal type="string">"JsonBean"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                    <expr_stmt><expr><call><name><name>em</name><operator>.</operator><name>persist</name></name><argument_list>(<argument><expr><name>entity</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                </block_content>}</block></for>
            </block_content>}</block></if></if_stmt>
            <comment type="line">// Only used by test cases to check for rollback of transaction</comment>
            <expr_stmt><expr><call><name><name>FaultInjection</name><operator>.</operator><name>activate</name></name><argument_list>(<argument><expr><literal type="string">"org.apache.oozie.command.SkipCommitFaultInjection"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <if_stmt><if>if <condition>(<expr><name>updateList</name> <operator>!=</operator> <literal type="null">null</literal></expr>)</condition> <block>{<block_content>
                <for>for <control>(<init><decl><type><name>JsonBean</name></type> <name>entity</name> <range>: <expr><name>updateList</name></expr></range></decl></init>)</control> <block>{<block_content>
                    <expr_stmt><expr><call><name><name>ParamChecker</name><operator>.</operator><name>notNull</name></name><argument_list>(<argument><expr><name>entity</name></expr></argument>, <argument><expr><literal type="string">"JsonBean"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                    <if_stmt><if>if <condition>(<expr><name>entity</name> <operator>instanceof</operator> <name>CoordinatorActionBean</name></expr>)</condition> <block>{<block_content>
                        <decl_stmt><decl><type><name>CoordinatorActionBean</name></type> <name>action</name> <init>= <expr><operator>(</operator><name>CoordinatorActionBean</name><operator>)</operator> <name>entity</name></expr></init></decl>;</decl_stmt>
                        <decl_stmt><decl><type><name>Query</name></type> <name>q</name> <init>= <expr><call><name><name>em</name><operator>.</operator><name>createNamedQuery</name></name><argument_list>(<argument><expr><literal type="string">"UPDATE_COORD_ACTION_FOR_START"</literal></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
                        <expr_stmt><expr><call><name><name>q</name><operator>.</operator><name>setParameter</name></name><argument_list>(<argument><expr><literal type="string">"id"</literal></expr></argument>, <argument><expr><call><name><name>action</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                        <expr_stmt><expr><call><name><name>q</name><operator>.</operator><name>setParameter</name></name><argument_list>(<argument><expr><literal type="string">"status"</literal></expr></argument>, <argument><expr><call><name><name>action</name><operator>.</operator><name>getStatus</name></name><argument_list>()</argument_list></call><operator>.</operator><call><name>toString</name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                        <expr_stmt><expr><call><name><name>q</name><operator>.</operator><name>setParameter</name></name><argument_list>(<argument><expr><literal type="string">"lastModifiedTime"</literal></expr></argument>, <argument><expr><operator>new</operator> <call><name>Date</name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                        <expr_stmt><expr><call><name><name>q</name><operator>.</operator><name>setParameter</name></name><argument_list>(<argument><expr><literal type="string">"runConf"</literal></expr></argument>, <argument><expr><call><name><name>action</name><operator>.</operator><name>getRunConf</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                        <expr_stmt><expr><call><name><name>q</name><operator>.</operator><name>setParameter</name></name><argument_list>(<argument><expr><literal type="string">"externalId"</literal></expr></argument>, <argument><expr><call><name><name>action</name><operator>.</operator><name>getExternalId</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                        <expr_stmt><expr><call><name><name>q</name><operator>.</operator><name>setParameter</name></name><argument_list>(<argument><expr><literal type="string">"pending"</literal></expr></argument>, <argument><expr><call><name><name>action</name><operator>.</operator><name>getPending</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                        <expr_stmt><expr><call><name><name>q</name><operator>.</operator><name>executeUpdate</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
                    </block_content>}</block></if>
                    <else>else <block>{<block_content>
                        <expr_stmt><expr><call><name><name>em</name><operator>.</operator><name>merge</name></name><argument_list>(<argument><expr><name>entity</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                    </block_content>}</block></else></if_stmt>
                </block_content>}</block></for>
            </block_content>}</block></if></if_stmt>
            <comment type="line">// Since the return type is Void, we have to return null</comment>
            <return>return <expr><literal type="null">null</literal></expr>;</return>
        </block_content>}</block>
        <catch>catch <parameter_list>(<parameter><decl><type><name>Exception</name></type> <name>e</name></decl></parameter>)</parameter_list> <block>{<block_content>
            <throw>throw <expr><operator>new</operator> <call><name>JPAExecutorException</name><argument_list>(<argument><expr><name><name>ErrorCode</name><operator>.</operator><name>E0603</name></name></expr></argument>, <argument><expr><name>e</name></expr></argument>)</argument_list></call></expr>;</throw>
        </block_content>}</block></catch></try>
    </block_content>}</block></function>
}</block></class>
<expr_stmt><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>executor</name><operator>/</operator><name>jpa</name><operator>/</operator><name><name>BulkUpdateInsertForCoordActionStatusJPAExecutor</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>executor</name><operator>/</operator><name>jpa</name><operator>/</operator><name><name>BulkUpdateInsertForCoordActionStatusJPAExecutor</name><operator>.</operator><name>java</name></name>
<operator>new</operator> <name>file</name> <name>mode</name> <literal type="number">100644</literal>
<name>index</name> <literal type="number">000000000..ac21ad47d</literal>
<operator>--</operator> <operator>/</operator><name>dev</name><operator>/</operator><literal type="null">null</literal>
<operator>++</operator> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>executor</name><operator>/</operator><name>jpa</name><operator>/</operator><name><name>BulkUpdateInsertForCoordActionStatusJPAExecutor</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">0</literal></expr><operator>,</operator><expr><literal type="number">0</literal> <operator>+</operator><literal type="number">1</literal></expr><operator>,</operator><expr><literal type="number">124</literal> @@</expr></expr_stmt>
<comment type="block" format="javadoc">/**
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */</comment>
<package>package <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name></name>;</package>

<import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>Collection</name></name>;</import>
<import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>Date</name></name>;</import>

<import>import <name><name>javax</name><operator>.</operator><name>persistence</name><operator>.</operator><name>EntityManager</name></name>;</import>
<import>import <name><name>javax</name><operator>.</operator><name>persistence</name><operator>.</operator><name>Query</name></name>;</import>

<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>CoordinatorActionBean</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>ErrorCode</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>FaultInjection</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>rest</name><operator>.</operator><name>JsonBean</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>util</name><operator>.</operator><name>ParamChecker</name></name>;</import>

<comment type="block" format="javadoc">/**
 * Class for inserting and updating beans in bulk
 *
 */</comment>
<class><specifier>public</specifier> class <name>BulkUpdateInsertForCoordActionStatusJPAExecutor</name> <super_list><implements>implements <super><name><name>JPAExecutor</name><argument_list type="generic">&lt;<argument><name>Void</name></argument>&gt;</argument_list></name></super></implements></super_list> <block>{

    <decl_stmt><decl><type><specifier>private</specifier> <name><name>Collection</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name></type> <name>updateList</name></decl>;</decl_stmt>
    <decl_stmt><decl><type><specifier>private</specifier> <name><name>Collection</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name></type> <name>insertList</name></decl>;</decl_stmt>

    <comment type="block" format="javadoc">/**
     * Initialize the JPAExecutor using the update and insert list of JSON beans
     *
     * @param updateList
     */</comment>
    <constructor><specifier>public</specifier> <name>BulkUpdateInsertForCoordActionStatusJPAExecutor</name><parameter_list>(<parameter><decl><type><name><name>Collection</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name></type> <name>updateList</name></decl></parameter>,
            <parameter><decl><type><name><name>Collection</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name></type> <name>insertList</name></decl></parameter>)</parameter_list> <block>{<block_content>
        <expr_stmt><expr><name><name>this</name><operator>.</operator><name>updateList</name></name> <operator>=</operator> <name>updateList</name></expr>;</expr_stmt>
        <expr_stmt><expr><name><name>this</name><operator>.</operator><name>insertList</name></name> <operator>=</operator> <name>insertList</name></expr>;</expr_stmt>
    </block_content>}</block></constructor>

    <constructor><specifier>public</specifier> <name>BulkUpdateInsertForCoordActionStatusJPAExecutor</name><parameter_list>()</parameter_list> <block>{<block_content>
    </block_content>}</block></constructor>

    <comment type="block" format="javadoc">/**
     * Sets the update list for JSON bean
     *
     * @param updateList
     */</comment>
    <function><type><specifier>public</specifier> <name>void</name></type> <name>setUpdateList</name><parameter_list>(<parameter><decl><type><name><name>Collection</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name></type> <name>updateList</name></decl></parameter>)</parameter_list> <block>{<block_content>
        <expr_stmt><expr><name><name>this</name><operator>.</operator><name>updateList</name></name> <operator>=</operator> <name>updateList</name></expr>;</expr_stmt>
    </block_content>}</block></function>

    <comment type="block" format="javadoc">/**
     * Sets the insert list for JSON bean
     *
     * @param insertList
     */</comment>
    <function><type><specifier>public</specifier> <name>void</name></type> <name>setInsertList</name><parameter_list>(<parameter><decl><type><name><name>Collection</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name></type> <name>insertList</name></decl></parameter>)</parameter_list> <block>{<block_content>
        <expr_stmt><expr><name><name>this</name><operator>.</operator><name>insertList</name></name> <operator>=</operator> <name>insertList</name></expr>;</expr_stmt>
    </block_content>}</block></function>

    <comment type="block">/*
     * (non-Javadoc)
     *
     * @see org.apache.oozie.executor.jpa.JPAExecutor#getName()
     */</comment>
    <function><annotation>@<name>Override</name></annotation>
    <type><specifier>public</specifier> <name>String</name></type> <name>getName</name><parameter_list>()</parameter_list> <block>{<block_content>
        <return>return <expr><literal type="string">"BulkUpdateInsertForCoordActionStatusJPAExecutor"</literal></expr>;</return>
    </block_content>}</block></function>

    <comment type="block">/*
     * (non-Javadoc)
     *
     * @see org.apache.oozie.executor.jpa.JPAExecutor#execute(javax.persistence.
     * EntityManager)
     */</comment>
    <function><annotation>@<name>Override</name></annotation>
    <type><specifier>public</specifier> <name>Void</name></type> <name>execute</name><parameter_list>(<parameter><decl><type><name>EntityManager</name></type> <name>em</name></decl></parameter>)</parameter_list> <throws>throws <argument><expr><name>JPAExecutorException</name></expr></argument></throws> <block>{<block_content>
        <try>try <block>{<block_content>
            <if_stmt><if>if <condition>(<expr><name>insertList</name> <operator>!=</operator> <literal type="null">null</literal></expr>)</condition> <block>{<block_content>
                <for>for <control>(<init><decl><type><name>JsonBean</name></type> <name>entity</name> <range>: <expr><name>insertList</name></expr></range></decl></init>)</control> <block>{<block_content>
                    <expr_stmt><expr><call><name><name>ParamChecker</name><operator>.</operator><name>notNull</name></name><argument_list>(<argument><expr><name>entity</name></expr></argument>, <argument><expr><literal type="string">"JsonBean"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                    <expr_stmt><expr><call><name><name>em</name><operator>.</operator><name>persist</name></name><argument_list>(<argument><expr><name>entity</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                </block_content>}</block></for>
            </block_content>}</block></if></if_stmt>
            <comment type="line">// Only used by test cases to check for rollback of transaction</comment>
            <expr_stmt><expr><call><name><name>FaultInjection</name><operator>.</operator><name>activate</name></name><argument_list>(<argument><expr><literal type="string">"org.apache.oozie.command.SkipCommitFaultInjection"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <if_stmt><if>if <condition>(<expr><name>updateList</name> <operator>!=</operator> <literal type="null">null</literal></expr>)</condition> <block>{<block_content>
                <for>for <control>(<init><decl><type><name>JsonBean</name></type> <name>entity</name> <range>: <expr><name>updateList</name></expr></range></decl></init>)</control> <block>{<block_content>
                    <expr_stmt><expr><call><name><name>ParamChecker</name><operator>.</operator><name>notNull</name></name><argument_list>(<argument><expr><name>entity</name></expr></argument>, <argument><expr><literal type="string">"JsonBean"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                    <if_stmt><if>if <condition>(<expr><name>entity</name> <operator>instanceof</operator> <name>CoordinatorActionBean</name></expr>)</condition> <block>{<block_content>
                        <decl_stmt><decl><type><name>CoordinatorActionBean</name></type> <name>action</name> <init>= <expr><operator>(</operator><name>CoordinatorActionBean</name><operator>)</operator> <name>entity</name></expr></init></decl>;</decl_stmt>
                        <decl_stmt><decl><type><name>Query</name></type> <name>q</name> <init>= <expr><call><name><name>em</name><operator>.</operator><name>createNamedQuery</name></name><argument_list>(<argument><expr><literal type="string">"UPDATE_COORD_ACTION_STATUS_PENDING_TIME"</literal></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
                        <expr_stmt><expr><call><name><name>q</name><operator>.</operator><name>setParameter</name></name><argument_list>(<argument><expr><literal type="string">"id"</literal></expr></argument>, <argument><expr><call><name><name>action</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                        <expr_stmt><expr><call><name><name>q</name><operator>.</operator><name>setParameter</name></name><argument_list>(<argument><expr><literal type="string">"status"</literal></expr></argument>, <argument><expr><call><name><name>action</name><operator>.</operator><name>getStatus</name></name><argument_list>()</argument_list></call><operator>.</operator><call><name>toString</name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                        <expr_stmt><expr><call><name><name>q</name><operator>.</operator><name>setParameter</name></name><argument_list>(<argument><expr><literal type="string">"pending"</literal></expr></argument>, <argument><expr><call><name><name>action</name><operator>.</operator><name>getPending</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                        <expr_stmt><expr><call><name><name>q</name><operator>.</operator><name>setParameter</name></name><argument_list>(<argument><expr><literal type="string">"lastModifiedTime"</literal></expr></argument>, <argument><expr><operator>new</operator> <call><name>Date</name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                        <expr_stmt><expr><call><name><name>q</name><operator>.</operator><name>executeUpdate</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
                    </block_content>}</block></if>
                    <else>else <block>{<block_content>
                        <expr_stmt><expr><call><name><name>em</name><operator>.</operator><name>merge</name></name><argument_list>(<argument><expr><name>entity</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                    </block_content>}</block></else></if_stmt>
                </block_content>}</block></for>
            </block_content>}</block></if></if_stmt>
            <comment type="line">// Since the return type is Void, we have to return null</comment>
            <return>return <expr><literal type="null">null</literal></expr>;</return>
        </block_content>}</block>
        <catch>catch <parameter_list>(<parameter><decl><type><name>Exception</name></type> <name>e</name></decl></parameter>)</parameter_list> <block>{<block_content>
            <throw>throw <expr><operator>new</operator> <call><name>JPAExecutorException</name><argument_list>(<argument><expr><name><name>ErrorCode</name><operator>.</operator><name>E0603</name></name></expr></argument>, <argument><expr><name>e</name></expr></argument>)</argument_list></call></expr>;</throw>
        </block_content>}</block></catch></try>
    </block_content>}</block></function>
}</block></class>
<expr_stmt><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>executor</name><operator>/</operator><name>jpa</name><operator>/</operator><name><name>BulkUpdateInsertJPAExecutor</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>executor</name><operator>/</operator><name>jpa</name><operator>/</operator><name><name>BulkUpdateInsertJPAExecutor</name><operator>.</operator><name>java</name></name>
<name>index</name> <literal type="number">4256aa2a3</literal><operator>..</operator><literal type="number">970164d65</literal> <literal type="number">100644</literal>
<operator>--</operator> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>executor</name><operator>/</operator><name>jpa</name><operator>/</operator><name><name>BulkUpdateInsertJPAExecutor</name><operator>.</operator><name>java</name></name>
<operator>++</operator> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>executor</name><operator>/</operator><name>jpa</name><operator>/</operator><name><name>BulkUpdateInsertJPAExecutor</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">78</literal></expr><operator>,</operator><expr><literal type="number">18</literal> <operator>+</operator><literal type="number">78</literal></expr><operator>,</operator><expr><literal type="number">18</literal> @@ <specifier>public</specifier> <name>class</name> <name>BulkUpdateInsertJPAExecutor</name> implements <name><name>JPAExecutor</name><argument_list type="generic">&lt;<argument><name>Void</name></argument>&gt;</argument_list></name> <block>{
     @<expr><name>Override</name>
     <specifier>public</specifier> <name>Void</name> <call><name>execute</name><argument_list>(<argument><expr><name>EntityManager</name> <name>em</name></expr></argument>)</argument_list></call> <throws>throws <argument><expr><name>JPAExecutorException</name> <block>{</block></expr></argument></throws></expr>
         <try>try <block>{<block_content>
            <if_stmt><if>if <condition>(<expr><name>updateList</name><operator>!=</operator> <literal type="null">null</literal></expr>)</condition><block>{<block_content>
                <for>for <control>(<init><decl><type><name>JsonBean</name></type> <name>entity</name><range>: <expr><name>updateList</name></expr></range></decl></init>)</control><block>{<block_content>
            <if_stmt><if>if <condition>(<expr><name>insertList</name><operator>!=</operator> <literal type="null">null</literal></expr>)</condition><block>{<block_content>
                <for>for <control>(<init><decl><type><name>JsonBean</name></type> <name>entity</name><range>: <expr><name>insertList</name></expr></range></decl></init>)</control><block>{<block_content>
                     <expr_stmt><expr><call><name><name>ParamChecker</name><operator>.</operator><name>notNull</name></name><argument_list>(<argument><expr><name>entity</name></expr></argument>, <argument><expr><literal type="string">"JsonBean"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                    <expr_stmt><expr><call><name><name>em</name><operator>.</operator><name>merge</name></name><argument_list>(<argument><expr><name>entity</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                    <expr_stmt><expr><call><name><name>em</name><operator>.</operator><name>persist</name></name><argument_list>(<argument><expr><name>entity</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                 </block_content>}</block></for>
             </block_content>}</block></if></if_stmt>
             <comment type="line">// Only used by test cases to check for rollback of transaction</comment>
             <expr_stmt><expr><call><name><name>FaultInjection</name><operator>.</operator><name>activate</name></name><argument_list>(<argument><expr><literal type="string">"org.apache.oozie.command.SkipCommitFaultInjection"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <if_stmt><if>if <condition>(<expr><name>insertList</name><operator>!=</operator> <literal type="null">null</literal></expr>)</condition><block>{<block_content>
                <for>for <control>(<init><decl><type><name>JsonBean</name></type> <name>entity</name><range>: <expr><name>insertList</name></expr></range></decl></init>)</control><block>{<block_content>
            <if_stmt><if>if <condition>(<expr><name>updateList</name><operator>!=</operator> <literal type="null">null</literal></expr>)</condition><block>{<block_content>
                <for>for <control>(<init><decl><type><name>JsonBean</name></type> <name>entity</name><range>: <expr><name>updateList</name></expr></range></decl></init>)</control><block>{<block_content>
                     <expr_stmt><expr><call><name><name>ParamChecker</name><operator>.</operator><name>notNull</name></name><argument_list>(<argument><expr><name>entity</name></expr></argument>, <argument><expr><literal type="string">"JsonBean"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                    <expr_stmt><expr><call><name><name>em</name><operator>.</operator><name>persist</name></name><argument_list>(<argument><expr><name>entity</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                    <expr_stmt><expr><call><name><name>em</name><operator>.</operator><name>merge</name></name><argument_list>(<argument><expr><name>entity</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                 </block_content>}</block></for>
             </block_content>}</block></if></if_stmt>
             <return>return <expr><literal type="null">null</literal></expr>;</return>
<expr_stmt><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>executor</name><operator>/</operator><name>jpa</name><operator>/</operator><name><name>BundleActionsDeleteForPurgeJPAExecutor</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>executor</name><operator>/</operator><name>jpa</name><operator>/</operator><name><name>BundleActionsDeleteForPurgeJPAExecutor</name><operator>.</operator><name>java</name></name>
<name>index</name> <name>e3f67e42a</name><operator>..</operator><name>e69de29bb</name> <literal type="number">100644</literal>
<operator>--</operator> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>executor</name><operator>/</operator><name>jpa</name><operator>/</operator><name><name>BundleActionsDeleteForPurgeJPAExecutor</name><operator>.</operator><name>java</name></name>
<operator>++</operator> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>executor</name><operator>/</operator><name>jpa</name><operator>/</operator><name><name>BundleActionsDeleteForPurgeJPAExecutor</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">1</literal></expr><operator>,</operator><expr><literal type="number">62</literal> <operator>+</operator><literal type="number">0</literal></expr><operator>,</operator><expr><literal type="number">0</literal> @@</expr></expr_stmt>
<comment type="block" format="javadoc">/**
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 * 
 *      http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */</comment>
<package>package <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name></name>;</package>

<import>import <name><name>javax</name><operator>.</operator><name>persistence</name><operator>.</operator><name>EntityManager</name></name>;</import>
<import>import <name><name>javax</name><operator>.</operator><name>persistence</name><operator>.</operator><name>Query</name></name>;</import>

<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>ErrorCode</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>util</name><operator>.</operator><name>ParamChecker</name></name>;</import>

<comment type="block" format="javadoc">/**
 * Delete the list of BundleAction for a BundleJob and return the number of actions been deleted.
 */</comment>
<class><specifier>public</specifier> class <name>BundleActionsDeleteForPurgeJPAExecutor</name> <super_list><implements>implements <super><name><name>JPAExecutor</name><argument_list type="generic">&lt;<argument><name>Integer</name></argument>&gt;</argument_list></name></super></implements></super_list> <block>{

    <decl_stmt><decl><type><specifier>private</specifier> <name>String</name></type> <name>bundleId</name> <init>= <expr><literal type="null">null</literal></expr></init></decl>;</decl_stmt>

    <constructor><specifier>public</specifier> <name>BundleActionsDeleteForPurgeJPAExecutor</name><parameter_list>(<parameter><decl><type><name>String</name></type> <name>bundleId</name></decl></parameter>)</parameter_list> <block>{<block_content>
        <expr_stmt><expr><call><name><name>ParamChecker</name><operator>.</operator><name>notNull</name></name><argument_list>(<argument><expr><name>bundleId</name></expr></argument>, <argument><expr><literal type="string">"bundleId"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><name><name>this</name><operator>.</operator><name>bundleId</name></name> <operator>=</operator> <name>bundleId</name></expr>;</expr_stmt>
    </block_content>}</block></constructor>

    <comment type="block">/* (non-Javadoc)
     * @see org.apache.oozie.executor.jpa.JPAExecutor#getName()
     */</comment>
    <function><annotation>@<name>Override</name></annotation>
    <type><specifier>public</specifier> <name>String</name></type> <name>getName</name><parameter_list>()</parameter_list> <block>{<block_content>
        <return>return <expr><literal type="string">"BundleActionsDeleteForPurgeJPAExecutor"</literal></expr>;</return>
    </block_content>}</block></function>

    <comment type="block">/* (non-Javadoc)
     * @see org.apache.oozie.executor.jpa.JPAExecutor#execute(javax.persistence.EntityManager)
     */</comment>
    <function><annotation>@<name>Override</name></annotation>
    <type><specifier>public</specifier> <name>Integer</name></type> <name>execute</name><parameter_list>(<parameter><decl><type><name>EntityManager</name></type> <name>em</name></decl></parameter>)</parameter_list> <throws>throws <argument><expr><name>JPAExecutorException</name></expr></argument></throws> <block>{<block_content>
        <decl_stmt><decl><type><name>int</name></type> <name>actionsDeleted</name> <init>= <expr><literal type="number">0</literal></expr></init></decl>;</decl_stmt>
        <try>try <block>{<block_content>
            <decl_stmt><decl><type><name>Query</name></type> <name>g</name> <init>= <expr><call><name><name>em</name><operator>.</operator><name>createNamedQuery</name></name><argument_list>(<argument><expr><literal type="string">"DELETE_COMPLETED_ACTIONS_FOR_BUNDLE"</literal></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
            <expr_stmt><expr><call><name><name>g</name><operator>.</operator><name>setParameter</name></name><argument_list>(<argument><expr><literal type="string">"bundleId"</literal></expr></argument>, <argument><expr><name>bundleId</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><name>actionsDeleted</name> <operator>=</operator> <call><name><name>g</name><operator>.</operator><name>executeUpdate</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        </block_content>}</block>
        <catch>catch <parameter_list>(<parameter><decl><type><name>Exception</name></type> <name>e</name></decl></parameter>)</parameter_list> <block>{<block_content>
            <throw>throw <expr><operator>new</operator> <call><name>JPAExecutorException</name><argument_list>(<argument><expr><name><name>ErrorCode</name><operator>.</operator><name>E0603</name></name></expr></argument>, <argument><expr><name>e</name></expr></argument>)</argument_list></call></expr>;</throw>
        </block_content>}</block></catch></try>
        <return>return <expr><name>actionsDeleted</name></expr>;</return>
    </block_content>}</block></function>
}</block></class>
<expr_stmt><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>executor</name><operator>/</operator><name>jpa</name><operator>/</operator><name><name>BundleJobDeleteJPAExecutor</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>executor</name><operator>/</operator><name>jpa</name><operator>/</operator><name><name>BundleJobDeleteJPAExecutor</name><operator>.</operator><name>java</name></name>
<name>index</name> <literal type="number">20a86557e</literal><operator>..</operator><name>e69de29bb</name> <literal type="number">100644</literal>
<operator>--</operator> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>executor</name><operator>/</operator><name>jpa</name><operator>/</operator><name><name>BundleJobDeleteJPAExecutor</name><operator>.</operator><name>java</name></name>
<operator>++</operator> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>executor</name><operator>/</operator><name>jpa</name><operator>/</operator><name><name>BundleJobDeleteJPAExecutor</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">1</literal></expr><operator>,</operator><expr><literal type="number">56</literal> <operator>+</operator><literal type="number">0</literal></expr><operator>,</operator><expr><literal type="number">0</literal> @@</expr></expr_stmt>
<comment type="block" format="javadoc">/**
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 * 
 *      http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */</comment>
<package>package <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name></name>;</package>

<import>import <name><name>javax</name><operator>.</operator><name>persistence</name><operator>.</operator><name>EntityManager</name></name>;</import>

<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>BundleJobBean</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>util</name><operator>.</operator><name>ParamChecker</name></name>;</import>

<comment type="block" format="javadoc">/**
 * Delete bundle job
 */</comment>
<class><specifier>public</specifier> class <name>BundleJobDeleteJPAExecutor</name> <super_list><implements>implements <super><name><name>JPAExecutor</name><argument_list type="generic">&lt;<argument><name>Void</name></argument>&gt;</argument_list></name></super></implements></super_list> <block>{

    <decl_stmt><decl><type><specifier>private</specifier> <name>String</name></type> <name>bundleJobId</name> <init>= <expr><literal type="null">null</literal></expr></init></decl>;</decl_stmt>

    <constructor><specifier>public</specifier> <name>BundleJobDeleteJPAExecutor</name><parameter_list>(<parameter><decl><type><name>String</name></type> <name>bundleJobId</name></decl></parameter>)</parameter_list> <block>{<block_content>
        <expr_stmt><expr><call><name><name>ParamChecker</name><operator>.</operator><name>notEmpty</name></name><argument_list>(<argument><expr><name>bundleJobId</name></expr></argument>, <argument><expr><literal type="string">"bundleJobId"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><name><name>this</name><operator>.</operator><name>bundleJobId</name></name> <operator>=</operator> <name>bundleJobId</name></expr>;</expr_stmt>
    </block_content>}</block></constructor>

    <comment type="block">/* (non-Javadoc)
     * @see org.apache.oozie.executor.jpa.JPAExecutor#execute(javax.persistence.EntityManager)
     */</comment>
    <function><annotation>@<name>Override</name></annotation>
    <type><specifier>public</specifier> <name>Void</name></type> <name>execute</name><parameter_list>(<parameter><decl><type><name>EntityManager</name></type> <name>em</name></decl></parameter>)</parameter_list> <throws>throws <argument><expr><name>JPAExecutorException</name></expr></argument></throws> <block>{<block_content>
        <decl_stmt><decl><type><name>BundleJobBean</name></type> <name>job</name> <init>= <expr><call><name><name>em</name><operator>.</operator><name>find</name></name><argument_list>(<argument><expr><name><name>BundleJobBean</name><operator>.</operator><name>class</name></name></expr></argument>, <argument><expr><name><name>this</name><operator>.</operator><name>bundleJobId</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <if_stmt><if>if <condition>(<expr><name>job</name> <operator>!=</operator> <literal type="null">null</literal></expr>)</condition> <block>{<block_content>
            <expr_stmt><expr><call><name><name>em</name><operator>.</operator><name>remove</name></name><argument_list>(<argument><expr><name>job</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        </block_content>}</block></if></if_stmt>
        <return>return <expr><literal type="null">null</literal></expr>;</return>
    </block_content>}</block></function>

    <comment type="block">/* (non-Javadoc)
     * @see org.apache.oozie.executor.jpa.JPAExecutor#getName()
     */</comment>
    <function><annotation>@<name>Override</name></annotation>
    <type><specifier>public</specifier> <name>String</name></type> <name>getName</name><parameter_list>()</parameter_list> <block>{<block_content>
        <return>return <expr><literal type="string">"BundleJobDeleteJPAExecutor"</literal></expr>;</return>
    </block_content>}</block></function>
}</block></class>
<expr_stmt><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>executor</name><operator>/</operator><name>jpa</name><operator>/</operator><name><name>CoordActionUpdateForStartJPAExecutor</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>executor</name><operator>/</operator><name>jpa</name><operator>/</operator><name><name>CoordActionUpdateForStartJPAExecutor</name><operator>.</operator><name>java</name></name>
<name>index</name> <name>c7415fb5e</name><operator>..</operator><name>e69de29bb</name> <literal type="number">100644</literal>
<operator>--</operator> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>executor</name><operator>/</operator><name>jpa</name><operator>/</operator><name><name>CoordActionUpdateForStartJPAExecutor</name><operator>.</operator><name>java</name></name>
<operator>++</operator> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>executor</name><operator>/</operator><name>jpa</name><operator>/</operator><name><name>CoordActionUpdateForStartJPAExecutor</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">1</literal></expr><operator>,</operator><expr><literal type="number">76</literal> <operator>+</operator><literal type="number">0</literal></expr><operator>,</operator><expr><literal type="number">0</literal> @@</expr></expr_stmt>
<comment type="block" format="javadoc">/**
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */</comment>
<package>package <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name></name>;</package>

<import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>Date</name></name>;</import>

<import>import <name><name>javax</name><operator>.</operator><name>persistence</name><operator>.</operator><name>EntityManager</name></name>;</import>
<import>import <name><name>javax</name><operator>.</operator><name>persistence</name><operator>.</operator><name>Query</name></name>;</import>

<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>CoordinatorActionBean</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>ErrorCode</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>util</name><operator>.</operator><name>ParamChecker</name></name>;</import>

<comment type="block" format="javadoc">/**
 * Updates the action status, last modified time, runConf, externalId and pending of CoordinatorAction and persists it.
 * It executes SQL update query and return type is Void.
 */</comment>
<class><specifier>public</specifier> class <name>CoordActionUpdateForStartJPAExecutor</name> <super_list><implements>implements <super><name><name>JPAExecutor</name><argument_list type="generic">&lt;<argument><name>Void</name></argument>&gt;</argument_list></name></super></implements></super_list> <block>{

    <decl_stmt><decl><type><specifier>private</specifier> <name>CoordinatorActionBean</name></type> <name>coordAction</name> <init>= <expr><literal type="null">null</literal></expr></init></decl>;</decl_stmt>

    <constructor><specifier>public</specifier> <name>CoordActionUpdateForStartJPAExecutor</name><parameter_list>(<parameter><decl><type><name>CoordinatorActionBean</name></type> <name>coordAction</name></decl></parameter>)</parameter_list> <block>{<block_content>
        <expr_stmt><expr><call><name><name>ParamChecker</name><operator>.</operator><name>notNull</name></name><argument_list>(<argument><expr><name>coordAction</name></expr></argument>, <argument><expr><literal type="string">"coordAction"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><name><name>this</name><operator>.</operator><name>coordAction</name></name> <operator>=</operator> <name>coordAction</name></expr>;</expr_stmt>
    </block_content>}</block></constructor>

    <comment type="block">/*
     * (non-Javadoc)
     *
     * @see org.apache.oozie.executor.jpa.JPAExecutor#execute(javax.persistence.
     * EntityManager)
     */</comment>
    <function><annotation>@<name>Override</name></annotation>
    <type><specifier>public</specifier> <name>Void</name></type> <name>execute</name><parameter_list>(<parameter><decl><type><name>EntityManager</name></type> <name>em</name></decl></parameter>)</parameter_list> <throws>throws <argument><expr><name>JPAExecutorException</name></expr></argument></throws> <block>{<block_content>
        <try>try <block>{<block_content>
            <decl_stmt><decl><type><name>Query</name></type> <name>q</name> <init>= <expr><call><name><name>em</name><operator>.</operator><name>createNamedQuery</name></name><argument_list>(<argument><expr><literal type="string">"UPDATE_COORD_ACTION_FOR_START"</literal></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
            <expr_stmt><expr><call><name><name>q</name><operator>.</operator><name>setParameter</name></name><argument_list>(<argument><expr><literal type="string">"id"</literal></expr></argument>, <argument><expr><call><name><name>coordAction</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name><name>q</name><operator>.</operator><name>setParameter</name></name><argument_list>(<argument><expr><literal type="string">"status"</literal></expr></argument>, <argument><expr><call><name><name>coordAction</name><operator>.</operator><name>getStatus</name></name><argument_list>()</argument_list></call><operator>.</operator><call><name>toString</name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name><name>q</name><operator>.</operator><name>setParameter</name></name><argument_list>(<argument><expr><literal type="string">"lastModifiedTime"</literal></expr></argument>, <argument><expr><operator>new</operator> <call><name>Date</name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name><name>q</name><operator>.</operator><name>setParameter</name></name><argument_list>(<argument><expr><literal type="string">"runConf"</literal></expr></argument>, <argument><expr><call><name><name>coordAction</name><operator>.</operator><name>getRunConf</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name><name>q</name><operator>.</operator><name>setParameter</name></name><argument_list>(<argument><expr><literal type="string">"externalId"</literal></expr></argument>, <argument><expr><call><name><name>coordAction</name><operator>.</operator><name>getExternalId</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name><name>q</name><operator>.</operator><name>setParameter</name></name><argument_list>(<argument><expr><literal type="string">"pending"</literal></expr></argument>, <argument><expr><call><name><name>coordAction</name><operator>.</operator><name>getPending</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name><name>q</name><operator>.</operator><name>executeUpdate</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
            <comment type="line">// Since the return type is Void, we have to return null</comment>
            <return>return <expr><literal type="null">null</literal></expr>;</return>
        </block_content>}</block>
        <catch>catch <parameter_list>(<parameter><decl><type><name>Exception</name></type> <name>e</name></decl></parameter>)</parameter_list> <block>{<block_content>
            <throw>throw <expr><operator>new</operator> <call><name>JPAExecutorException</name><argument_list>(<argument><expr><name><name>ErrorCode</name><operator>.</operator><name>E0603</name></name></expr></argument>, <argument><expr><name>e</name></expr></argument>)</argument_list></call></expr>;</throw>
        </block_content>}</block></catch></try>
    </block_content>}</block></function>

    <comment type="block">/*
     * (non-Javadoc)
     *
     * @see org.apache.oozie.executor.jpa.JPAExecutor#getName()
     */</comment>
    <function><annotation>@<name>Override</name></annotation>
    <type><specifier>public</specifier> <name>String</name></type> <name>getName</name><parameter_list>()</parameter_list> <block>{<block_content>
        <return>return <expr><literal type="string">"CoordActionUpdateForStartJPAExecutor"</literal></expr>;</return>
    </block_content>}</block></function>
}</block></class>
<expr_stmt><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>executor</name><operator>/</operator><name>jpa</name><operator>/</operator><name><name>CoordActionsDeleteForPurgeJPAExecutor</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>executor</name><operator>/</operator><name>jpa</name><operator>/</operator><name><name>CoordActionsDeleteForPurgeJPAExecutor</name><operator>.</operator><name>java</name></name>
<name>index</name> <name>e0949d573</name><operator>..</operator><name>e69de29bb</name> <literal type="number">100644</literal>
<operator>--</operator> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>executor</name><operator>/</operator><name>jpa</name><operator>/</operator><name><name>CoordActionsDeleteForPurgeJPAExecutor</name><operator>.</operator><name>java</name></name>
<operator>++</operator> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>executor</name><operator>/</operator><name>jpa</name><operator>/</operator><name><name>CoordActionsDeleteForPurgeJPAExecutor</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">1</literal></expr><operator>,</operator><expr><literal type="number">62</literal> <operator>+</operator><literal type="number">0</literal></expr><operator>,</operator><expr><literal type="number">0</literal> @@</expr></expr_stmt>
<comment type="block" format="javadoc">/**
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 * 
 *      http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */</comment>
<package>package <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name></name>;</package>

<import>import <name><name>javax</name><operator>.</operator><name>persistence</name><operator>.</operator><name>EntityManager</name></name>;</import>
<import>import <name><name>javax</name><operator>.</operator><name>persistence</name><operator>.</operator><name>Query</name></name>;</import>

<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>ErrorCode</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>util</name><operator>.</operator><name>ParamChecker</name></name>;</import>

<comment type="block" format="javadoc">/**
 * Delete the list of CoordinatorAction for a CoordJob and return the number of actions been deleted.
 */</comment>
<class><specifier>public</specifier> class <name>CoordActionsDeleteForPurgeJPAExecutor</name> <super_list><implements>implements <super><name><name>JPAExecutor</name><argument_list type="generic">&lt;<argument><name>Integer</name></argument>&gt;</argument_list></name></super></implements></super_list> <block>{

    <decl_stmt><decl><type><specifier>private</specifier> <name>String</name></type> <name>coordJobId</name> <init>= <expr><literal type="null">null</literal></expr></init></decl>;</decl_stmt>

    <constructor><specifier>public</specifier> <name>CoordActionsDeleteForPurgeJPAExecutor</name><parameter_list>(<parameter><decl><type><name>String</name></type> <name>coordJobId</name></decl></parameter>)</parameter_list> <block>{<block_content>
        <expr_stmt><expr><call><name><name>ParamChecker</name><operator>.</operator><name>notNull</name></name><argument_list>(<argument><expr><name>coordJobId</name></expr></argument>, <argument><expr><literal type="string">"coordJobId"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><name><name>this</name><operator>.</operator><name>coordJobId</name></name> <operator>=</operator> <name>coordJobId</name></expr>;</expr_stmt>
    </block_content>}</block></constructor>

    <comment type="block">/* (non-Javadoc)
     * @see org.apache.oozie.executor.jpa.JPAExecutor#getName()
     */</comment>
    <function><annotation>@<name>Override</name></annotation>
    <type><specifier>public</specifier> <name>String</name></type> <name>getName</name><parameter_list>()</parameter_list> <block>{<block_content>
        <return>return <expr><literal type="string">"CoordActionsDeleteForPurgeJPAExecutor"</literal></expr>;</return>
    </block_content>}</block></function>

    <comment type="block">/* (non-Javadoc)
     * @see org.apache.oozie.executor.jpa.JPAExecutor#execute(javax.persistence.EntityManager)
     */</comment>
    <function><annotation>@<name>Override</name></annotation>
    <type><specifier>public</specifier> <name>Integer</name></type> <name>execute</name><parameter_list>(<parameter><decl><type><name>EntityManager</name></type> <name>em</name></decl></parameter>)</parameter_list> <throws>throws <argument><expr><name>JPAExecutorException</name></expr></argument></throws> <block>{<block_content>
        <decl_stmt><decl><type><name>int</name></type> <name>actionsDeleted</name> <init>= <expr><literal type="number">0</literal></expr></init></decl>;</decl_stmt>
        <try>try <block>{<block_content>
            <decl_stmt><decl><type><name>Query</name></type> <name>g</name> <init>= <expr><call><name><name>em</name><operator>.</operator><name>createNamedQuery</name></name><argument_list>(<argument><expr><literal type="string">"DELETE_COMPLETED_ACTIONS_FOR_COORDINATOR"</literal></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
            <expr_stmt><expr><call><name><name>g</name><operator>.</operator><name>setParameter</name></name><argument_list>(<argument><expr><literal type="string">"jobId"</literal></expr></argument>, <argument><expr><name>coordJobId</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><name>actionsDeleted</name> <operator>=</operator> <call><name><name>g</name><operator>.</operator><name>executeUpdate</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        </block_content>}</block>
        <catch>catch <parameter_list>(<parameter><decl><type><name>Exception</name></type> <name>e</name></decl></parameter>)</parameter_list> <block>{<block_content>
            <throw>throw <expr><operator>new</operator> <call><name>JPAExecutorException</name><argument_list>(<argument><expr><name><name>ErrorCode</name><operator>.</operator><name>E0603</name></name></expr></argument>, <argument><expr><name>e</name></expr></argument>)</argument_list></call></expr>;</throw>
        </block_content>}</block></catch></try>
        <return>return <expr><name>actionsDeleted</name></expr>;</return>
    </block_content>}</block></function>
}</block></class>
<expr_stmt><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>executor</name><operator>/</operator><name>jpa</name><operator>/</operator><name><name>CoordJobGetActionByActionNumberJPAExecutor</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>executor</name><operator>/</operator><name>jpa</name><operator>/</operator><name><name>CoordJobGetActionByActionNumberJPAExecutor</name><operator>.</operator><name>java</name></name>
<name>index</name> <name>ae54433e1</name><operator>..</operator><literal type="number">5461f19c3</literal> <literal type="number">100644</literal>
<operator>--</operator> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>executor</name><operator>/</operator><name>jpa</name><operator>/</operator><name><name>CoordJobGetActionByActionNumberJPAExecutor</name><operator>.</operator><name>java</name></name>
<operator>++</operator> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>executor</name><operator>/</operator><name>jpa</name><operator>/</operator><name><name>CoordJobGetActionByActionNumberJPAExecutor</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">17</literal></expr><operator>,</operator><expr><literal type="number">12</literal> <operator>+</operator><literal type="number">17</literal></expr><operator>,</operator><expr><literal type="number">9</literal> @@
  <operator>*</operator><operator>/</operator></expr></expr_stmt>
 <package>package <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name></name>;</package>
 
<import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>List</name></name>;</import>

 <import>import <name><name>javax</name><operator>.</operator><name>persistence</name><operator>.</operator><name>EntityManager</name></name>;</import>
 <import>import <name><name>javax</name><operator>.</operator><name>persistence</name><operator>.</operator><name>Query</name></name>;</import>
 
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>CoordinatorActionBean</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>ErrorCode</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>util</name><operator>.</operator><name>ParamChecker</name></name>;</import>
 
<expr_stmt><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>executor</name><operator>/</operator><name>jpa</name><operator>/</operator><name><name>WorkflowActionsDeleteForPurgeJPAExecutor</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>executor</name><operator>/</operator><name>jpa</name><operator>/</operator><name><name>WorkflowActionsDeleteForPurgeJPAExecutor</name><operator>.</operator><name>java</name></name>
<name>index</name> <name>b78dde96b</name><operator>..</operator><name>e69de29bb</name> <literal type="number">100644</literal>
<operator>--</operator> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>executor</name><operator>/</operator><name>jpa</name><operator>/</operator><name><name>WorkflowActionsDeleteForPurgeJPAExecutor</name><operator>.</operator><name>java</name></name>
<operator>++</operator> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>executor</name><operator>/</operator><name>jpa</name><operator>/</operator><name><name>WorkflowActionsDeleteForPurgeJPAExecutor</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">1</literal></expr><operator>,</operator><expr><literal type="number">63</literal> <operator>+</operator><literal type="number">0</literal></expr><operator>,</operator><expr><literal type="number">0</literal> @@</expr></expr_stmt>
<comment type="block" format="javadoc">/**
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 * 
 *      http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */</comment>
<package>package <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name></name>;</package>

<import>import <name><name>javax</name><operator>.</operator><name>persistence</name><operator>.</operator><name>EntityManager</name></name>;</import>
<import>import <name><name>javax</name><operator>.</operator><name>persistence</name><operator>.</operator><name>Query</name></name>;</import>

<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>ErrorCode</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>util</name><operator>.</operator><name>ParamChecker</name></name>;</import>

<comment type="block" format="javadoc">/**
 * Delete the list of WorkflowAction for a WorkflowJob and return the number of actions been deleted.
 */</comment>
<class><specifier>public</specifier> class <name>WorkflowActionsDeleteForPurgeJPAExecutor</name> <super_list><implements>implements <super><name><name>JPAExecutor</name><argument_list type="generic">&lt;<argument><name>Integer</name></argument>&gt;</argument_list></name></super></implements></super_list> <block>{

    <decl_stmt><decl><type><specifier>private</specifier> <name>String</name></type> <name>wfId</name> <init>= <expr><literal type="null">null</literal></expr></init></decl>;</decl_stmt>

    <constructor><specifier>public</specifier> <name>WorkflowActionsDeleteForPurgeJPAExecutor</name><parameter_list>(<parameter><decl><type><name>String</name></type> <name>wfId</name></decl></parameter>)</parameter_list> <block>{<block_content>
        <expr_stmt><expr><call><name><name>ParamChecker</name><operator>.</operator><name>notNull</name></name><argument_list>(<argument><expr><name>wfId</name></expr></argument>, <argument><expr><literal type="string">"wfId"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><name><name>this</name><operator>.</operator><name>wfId</name></name> <operator>=</operator> <name>wfId</name></expr>;</expr_stmt>
    </block_content>}</block></constructor>

    <comment type="block">/* (non-Javadoc)
     * @see org.apache.oozie.executor.jpa.JPAExecutor#getName()
     */</comment>
    <function><annotation>@<name>Override</name></annotation>
    <type><specifier>public</specifier> <name>String</name></type> <name>getName</name><parameter_list>()</parameter_list> <block>{<block_content>
        <return>return <expr><literal type="string">"WorkflowActionsDeleteForPurgeJPAExecutor"</literal></expr>;</return>
    </block_content>}</block></function>

    <comment type="block">/* (non-Javadoc)
     * @see org.apache.oozie.executor.jpa.JPAExecutor#execute(javax.persistence.EntityManager)
     */</comment>
    <function><annotation>@<name>Override</name></annotation>
    <type><specifier>public</specifier> <name>Integer</name></type> <name>execute</name><parameter_list>(<parameter><decl><type><name>EntityManager</name></type> <name>em</name></decl></parameter>)</parameter_list> <throws>throws <argument><expr><name>JPAExecutorException</name></expr></argument></throws> <block>{<block_content>
        <decl_stmt><decl><type><name>int</name></type> <name>actionsDeleted</name> <init>= <expr><literal type="number">0</literal></expr></init></decl>;</decl_stmt>
        <try>try <block>{<block_content>
            <decl_stmt><decl><type><name>Query</name></type> <name>g</name> <init>= <expr><call><name><name>em</name><operator>.</operator><name>createNamedQuery</name></name><argument_list>(<argument><expr><literal type="string">"DELETE_ACTIONS_FOR_WORKFLOW"</literal></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
            <expr_stmt><expr><call><name><name>g</name><operator>.</operator><name>setParameter</name></name><argument_list>(<argument><expr><literal type="string">"wfId"</literal></expr></argument>, <argument><expr><name>wfId</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><name>actionsDeleted</name> <operator>=</operator> <call><name><name>g</name><operator>.</operator><name>executeUpdate</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        </block_content>}</block>
        <catch>catch <parameter_list>(<parameter><decl><type><name>Exception</name></type> <name>e</name></decl></parameter>)</parameter_list> <block>{<block_content>
            <throw>throw <expr><operator>new</operator> <call><name>JPAExecutorException</name><argument_list>(<argument><expr><name><name>ErrorCode</name><operator>.</operator><name>E0603</name></name></expr></argument>, <argument><expr><name>e</name></expr></argument>)</argument_list></call></expr>;</throw>
        </block_content>}</block></catch></try>
        <return>return <expr><name>actionsDeleted</name></expr>;</return>
    </block_content>}</block></function>

}</block></class>
<expr_stmt><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>store</name><operator>/</operator><name><name>SLAStore</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>store</name><operator>/</operator><name><name>SLAStore</name><operator>.</operator><name>java</name></name>
<name>index</name> <literal type="number">41d7efb23</literal><operator>..</operator><literal type="number">55e502c95</literal> <literal type="number">100644</literal>
<operator>--</operator> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>store</name><operator>/</operator><name><name>SLAStore</name><operator>.</operator><name>java</name></name>
<operator>++</operator> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>store</name><operator>/</operator><name><name>SLAStore</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">18</literal></expr><operator>,</operator><expr><literal type="number">9</literal> <operator>+</operator><literal type="number">18</literal></expr><operator>,</operator><expr><literal type="number">7</literal> @@</expr></expr_stmt>
 <package>package <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>store</name></name>;</package>
 
 <import>import <name><name>java</name><operator>.</operator><name>sql</name><operator>.</operator><name>SQLException</name></name>;</import>
<import>import <name><name>java</name><operator>.</operator><name>sql</name><operator>.</operator><name>Timestamp</name></name>;</import>
 <import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>ArrayList</name></name>;</import>
<import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>Date</name></name>;</import>
 <import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>List</name></name>;</import>
 <import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>concurrent</name><operator>.</operator><name>Callable</name></name>;</import>
 
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">29</literal></expr><operator>,</operator><expr><literal type="number">7</literal> <operator>+</operator><literal type="number">27</literal></expr><operator>,</operator><expr><literal type="number">6</literal> @@</expr></expr_stmt> <import>import <name><name>javax</name><operator>.</operator><name>persistence</name><operator>.</operator><name>Query</name></name>;</import>
 
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>ErrorCode</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>SLAEventBean</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>XException</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>InstrumentationService</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>Services</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>util</name><operator>.</operator><name>Instrumentation</name></name>;</import>
<expr_stmt><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>util</name><operator>/</operator><name>db</name><operator>/</operator><name><name>SLADbOperations</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>util</name><operator>/</operator><name>db</name><operator>/</operator><name><name>SLADbOperations</name><operator>.</operator><name>java</name></name>
<name>index</name> <literal type="number">049e4893a</literal><operator>..</operator><literal type="number">15cc192a8</literal> <literal type="number">100644</literal>
<operator>--</operator> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>util</name><operator>/</operator><name>db</name><operator>/</operator><name><name>SLADbOperations</name><operator>.</operator><name>java</name></name>
<operator>++</operator> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>util</name><operator>/</operator><name>db</name><operator>/</operator><name><name>SLADbOperations</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">24</literal></expr><operator>,</operator><expr><literal type="number">11</literal> <operator>+</operator><literal type="number">24</literal></expr><operator>,</operator><expr><literal type="number">7</literal> @@</expr></expr_stmt> <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>SLAEventBean</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>SLAEvent</name><operator>.</operator><name>SlaAppType</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>SLAEvent</name><operator>.</operator><name>Status</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>CommandException</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>SLAEventInsertJPAExecutor</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>JPAService</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>Services</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>StoreService</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>store</name><operator>.</operator><name>SLAStore</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>store</name><operator>.</operator><name>Store</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>util</name><operator>.</operator><name>DateUtils</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>util</name><operator>.</operator><name>XLog</name></name>;</import>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">37</literal></expr><operator>,</operator><expr><literal type="number">11</literal> <operator>+</operator><literal type="number">33</literal></expr><operator>,</operator><expr><literal type="number">11</literal> @@</expr></expr_stmt> <import>import <name><name>org</name><operator>.</operator><name>jdom</name><operator>.</operator><name>Element</name></name>;</import>
 <class><specifier>public</specifier> class <name>SLADbOperations</name> <block>{
     <decl_stmt><decl><type><specifier>public</specifier> <specifier>static</specifier> <specifier>final</specifier> <name>String</name></type> <name>CLIENT_ID_TAG</name> <init>= <expr><literal type="string">"oozie:sla:client-id"</literal></expr></init></decl>;</decl_stmt>
 
    <decl_stmt><decl><type><specifier>public</specifier> <specifier>static</specifier> <name>void</name></type> <name>writeSlaRegistrationEvent</name><argument_list>(<argument><expr><name>Element</name> <name>eSla</name></expr></argument>, <argument><expr><name>Store</name> <name>store</name></expr></argument>, <argument><expr><name>String</name> <name>slaId</name></expr></argument>, <argument><expr><name>SlaAppType</name> <name>appType</name></expr></argument>, <argument><expr><name>String</name> <name>user</name></expr></argument>,
    <argument><expr><specifier>public</specifier> <specifier>static</specifier> <name>SLAEventBean</name> <call><name>createSlaRegistrationEvent</name><argument_list>(<argument><expr><name>Element</name> <name>eSla</name></expr></argument>, <argument><expr><name>Store</name> <name>store</name></expr></argument>, <argument><expr><name>String</name> <name>slaId</name></expr></argument>, <argument><expr><name>SlaAppType</name> <name>appType</name></expr></argument>, <argument><expr><name>String</name> <name>user</name></expr></argument>,
             <argument><expr><name>String</name> <name>groupName</name></expr></argument>)</argument_list></call> <throws>throws <argument><expr><name>Exception</name> <block>{</block></expr></argument></throws></expr></argument></argument_list></decl></decl_stmt>
         <comment type="line">// System.out.println("BBBBB SLA added");</comment>
         <if_stmt><if>if <condition>(<expr><name>eSla</name> <operator>==</operator> <literal type="null">null</literal></expr>)</condition> <block>{<block_content>
            <return>return;</return>
            <return>return <expr><literal type="null">null</literal></expr>;</return>
         </block_content>}</block></if></if_stmt>
         <comment type="line">// System.out.println("Writing REG AAAAA " + slaId);</comment>
         <decl_stmt><decl><type><name>SLAEventBean</name></type> <name>sla</name> <init>= <expr><operator>new</operator> <call><name>SLAEventBean</name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">106</literal></expr><operator>,</operator><expr><literal type="number">16</literal> <operator>+</operator><literal type="number">102</literal></expr><operator>,</operator><expr><literal type="number">15</literal> @@ <specifier>public</specifier> <name>class</name> <name>SLADbOperations</name> <block>{
         <expr><call><name><name>sla</name><operator>.</operator><name>setJobStatus</name></name><argument_list>(<argument><expr><name><name>Status</name><operator>.</operator><name>CREATED</name></name></expr></argument>)</argument_list></call></expr>;
         <call><name><name>sla</name><operator>.</operator><name>setStatusTimestamp</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>Date</name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></block></expr>;</expr_stmt>
 
        <decl_stmt><decl><type><name>SLAStore</name></type> <name>slaStore</name> <init>= <expr><operator>(</operator><name>SLAStore</name><operator>)</operator> <call><name><name>Services</name><operator>.</operator><name>get</name></name><argument_list>()</argument_list></call><operator>.</operator><call><name>get</name><argument_list>(<argument><expr><name><name>StoreService</name><operator>.</operator><name>class</name></name></expr></argument>)</argument_list></call><operator>.</operator><call><name>getStore</name><argument_list>(<argument><expr><name><name>SLAStore</name><operator>.</operator><name>class</name></name></expr></argument>, <argument><expr><name>store</name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <constructor_decl><name><name>slaStore</name><operator>.</operator><name>insertSLAEvent</name></name><parameter_list>(<parameter><decl><type><name>sla</name></type></decl></parameter>)</parameter_list>;</constructor_decl>
        <return>return <expr><name>sla</name></expr>;</return>
     }</block></class>
 
    <decl_stmt><decl><type><specifier>public</specifier> <specifier>static</specifier> <name>void</name></type> <name>writeSlaRegistrationEvent</name><argument_list>(<argument><expr><name>Element</name> <name>eSla</name></expr></argument>,
    <argument><expr><specifier>public</specifier> <specifier>static</specifier> <name>SLAEventBean</name> <call><name>createSlaRegistrationEvent</name><argument_list>(<argument><expr><name>Element</name> <name>eSla</name></expr></argument>,
                                                  <argument><expr><name>String</name> <name>slaId</name></expr></argument>, <argument><expr><name>SlaAppType</name> <name>appType</name></expr></argument>, <argument><expr><name>String</name> <name>user</name></expr></argument>, <argument><expr><name>String</name> <name>groupName</name></expr></argument>, <argument><expr><name>XLog</name> <name>log</name></expr></argument>)</argument_list></call>
             <throws>throws <argument><expr><name>Exception</name> <block>{</block></expr></argument></throws></expr></argument></argument_list></decl></decl_stmt>
         <comment type="line">// System.out.println("BBBBB SLA added");</comment>
         <if_stmt><if>if <condition>(<expr><name>eSla</name> <operator>==</operator> <literal type="null">null</literal></expr>)</condition> <block>{<block_content>
            <return>return;</return>
            <return>return <expr><literal type="null">null</literal></expr>;</return>
         </block_content>}</block></if></if_stmt>
         <comment type="line">//System.out.println("Writing REG AAAAA " + slaId);</comment>
         <decl_stmt><decl><type><name>SLAEventBean</name></type> <name>sla</name> <init>= <expr><operator>new</operator> <call><name>SLAEventBean</name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">186</literal></expr><operator>,</operator><expr><literal type="number">16</literal> <operator>+</operator><literal type="number">181</literal></expr><operator>,</operator><expr><literal type="number">10</literal> @@ <specifier>public</specifier> <name>class</name> <name>SLADbOperations</name> <block>{
         <comment type="line">//        .getStore(SLAStore.class, store);</comment>
         <comment type="line">//slaStore.insertSLAEvent(sla);</comment>
 
        <expr><name>JPAService</name> <name>jpaService</name> <operator>=</operator> <call><name><name>Services</name><operator>.</operator><name>get</name></name><argument_list>()</argument_list></call><operator>.</operator><call><name>get</name><argument_list>(<argument><expr><name><name>JPAService</name><operator>.</operator><name>class</name></name></expr></argument>)</argument_list></call></expr>;</block></expr></expr_stmt>
        <if_stmt><if>if <condition>(<expr><name>jpaService</name> <operator>!=</operator> <literal type="null">null</literal></expr>)</condition> <block>{<block_content>
            <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>SLAEventInsertJPAExecutor</name><argument_list>(<argument><expr><name>sla</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        </block_content>}</block></if>
        <else>else <block>{<block_content>
            <expr_stmt><expr><call><name><name>log</name><operator>.</operator><name>error</name></name><argument_list>(<argument><expr><name><name>ErrorCode</name><operator>.</operator><name>E0610</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        </block_content>}</block></else></if_stmt>
        <return>return <expr><name>sla</name></expr>;</return>
     </block_content>}</block></for>
 
    <decl_stmt><decl><type><specifier>public</specifier> <specifier>static</specifier> <name>void</name></type> <name>writeSlaStatusEvent</name><argument_list>(<argument><expr><name>String</name> <name>id</name></expr></argument>,
    <argument><expr><specifier>public</specifier> <specifier>static</specifier> <name>SLAEventBean</name> <call><name>createSlaStatusEvent</name><argument_list>(<argument><expr><name>String</name> <name>id</name></expr></argument>,
                                            <argument><expr><name>Status</name> <name>status</name></expr></argument>, <argument><expr><name>Store</name> <name>store</name></expr></argument>, <argument><expr><name>SlaAppType</name> <name>appType</name></expr></argument>)</argument_list></call> <throws>throws <argument><expr><name>Exception</name> <block>{
         <expr><name>SLAEventBean</name> <name>sla</name> <operator>=</operator> <operator>new</operator> <call><name>SLAEventBean</name><argument_list>()</argument_list></call></expr></block></expr></argument></throws></expr></argument>;</argument_list></decl></decl_stmt>
         <expr_stmt><expr><call><name><name>sla</name><operator>.</operator><name>setSlaId</name></name><argument_list>(<argument><expr><name>id</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">203</literal></expr><operator>,</operator><expr><literal type="number">12</literal> <operator>+</operator><literal type="number">192</literal></expr><operator>,</operator><expr><literal type="number">13</literal> @@ <specifier>public</specifier> <name>class</name> <name>SLADbOperations</name> <block>{
         <expr><call><name><name>sla</name><operator>.</operator><name>setAppType</name></name><argument_list>(<argument><expr><name>appType</name></expr></argument>)</argument_list></call></expr>;
         <call><name><name>sla</name><operator>.</operator><name>setStatusTimestamp</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>Date</name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></block></expr>;</expr_stmt>
         <comment type="line">//System.out.println("Writing STATUS AAAAA " + id);</comment>
        <decl_stmt><decl><type><name>SLAStore</name></type> <name>slaStore</name> <init>= <expr><operator>(</operator><name>SLAStore</name><operator>)</operator> <call><name><name>Services</name><operator>.</operator><name>get</name></name><argument_list>()</argument_list></call><operator>.</operator><call><name>get</name><argument_list>(<argument><expr><name><name>StoreService</name><operator>.</operator><name>class</name></name></expr></argument>)</argument_list></call>
                <operator>.</operator><call><name>getStore</name><argument_list>(<argument><expr><name><name>SLAStore</name><operator>.</operator><name>class</name></name></expr></argument>, <argument><expr><name>store</name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name><name>slaStore</name><operator>.</operator><name>insertSLAEvent</name></name><argument_list>(<argument><expr><name>sla</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <comment type="line">//SLAStore slaStore = (SLAStore) Services.get().get(StoreService.class)</comment>
                <comment type="line">//.getStore(SLAStore.class, store);</comment>
        <comment type="line">//slaStore.insertSLAEvent(sla);</comment>
        <return>return <expr><name>sla</name></expr>;</return>
     </block_content>}</block></if></if_stmt>
 
    <function><type><specifier>public</specifier> <specifier>static</specifier> <name>void</name></type> <name>writeSlaStatusEvent</name><parameter_list>(<parameter><decl><type><name>String</name></type> <name>id</name></decl></parameter>, <parameter><decl><type><name>Status</name></type> <name>status</name></decl></parameter>, <parameter><decl><type><name>SlaAppType</name></type> <name>appType</name></decl></parameter>, <parameter><decl><type><name>XLog</name></type> <name>log</name></decl></parameter>)</parameter_list> <throws>throws <argument><expr><name>Exception</name></expr></argument></throws> <block>{<block_content>
    <function><type><specifier>public</specifier> <specifier>static</specifier> <name>SLAEventBean</name></type> <name>createSlaStatusEvent</name><parameter_list>(<parameter><decl><type><name>String</name></type> <name>id</name></decl></parameter>, <parameter><decl><type><name>Status</name></type> <name>status</name></decl></parameter>, <parameter><decl><type><name>SlaAppType</name></type> <name>appType</name></decl></parameter>, <parameter><decl><type><name>XLog</name></type> <name>log</name></decl></parameter>)</parameter_list> <throws>throws <argument><expr><name>Exception</name></expr></argument></throws> <block>{<block_content>
         <decl_stmt><decl><type><name>SLAEventBean</name></type> <name>sla</name> <init>= <expr><operator>new</operator> <call><name>SLAEventBean</name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
         <expr_stmt><expr><call><name><name>sla</name><operator>.</operator><name>setSlaId</name></name><argument_list>(<argument><expr><name>id</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
         <expr_stmt><expr><call><name><name>sla</name><operator>.</operator><name>setJobStatus</name></name><argument_list>(<argument><expr><name>status</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">218</literal></expr><operator>,</operator><expr><literal type="number">35</literal> <operator>+</operator><literal type="number">208</literal></expr><operator>,</operator><expr><literal type="number">29</literal> @@ <specifier>public</specifier> <name>class</name> <name>SLADbOperations</name> <block>{
         <comment type="line">//SLAStore slaStore = (SLAStore) Services.get().get(StoreService.class).getStore(SLAStore.class, store);</comment>
         <comment type="line">//slaStore.insertSLAEvent(sla);</comment>
 
        <expr><name>JPAService</name> <name>jpaService</name> <operator>=</operator> <call><name><name>Services</name><operator>.</operator><name>get</name></name><argument_list>()</argument_list></call><operator>.</operator><call><name>get</name><argument_list>(<argument><expr><name><name>JPAService</name><operator>.</operator><name>class</name></name></expr></argument>)</argument_list></call></expr>;</block></expr></expr_stmt>
        <if_stmt><if>if <condition>(<expr><name>jpaService</name> <operator>!=</operator> <literal type="null">null</literal></expr>)</condition> <block>{<block_content>
            <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>SLAEventInsertJPAExecutor</name><argument_list>(<argument><expr><name>sla</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        </block_content>}</block></if>
        <else>else <block>{<block_content>
            <expr_stmt><expr><call><name><name>log</name><operator>.</operator><name>error</name></name><argument_list>(<argument><expr><name><name>ErrorCode</name><operator>.</operator><name>E0610</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        </block_content>}</block></else></if_stmt>
        <return>return <expr><name>sla</name></expr>;</return>
     </block_content>}</block></function>
 
    <decl_stmt><decl><type><specifier>public</specifier> <specifier>static</specifier> <name>void</name></type> <name>writeStausEvent</name><argument_list>(<argument><expr><name>String</name> <name>slaXml</name></expr></argument>, <argument><expr><name>String</name> <name>id</name></expr></argument>, <argument><expr><name>Store</name> <name>store</name></expr></argument>,
    <argument><expr><specifier>public</specifier> <specifier>static</specifier> <name>SLAEventBean</name> <call><name>createStatusEvent</name><argument_list>(<argument><expr><name>String</name> <name>slaXml</name></expr></argument>, <argument><expr><name>String</name> <name>id</name></expr></argument>, <argument><expr><name>Store</name> <name>store</name></expr></argument>,
                                        <argument><expr><name>Status</name> <name>stat</name></expr></argument>, <argument><expr><name>SlaAppType</name> <name>appType</name></expr></argument>)</argument_list></call> <throws>throws <argument><expr><name>CommandException</name> <block>{</block></expr></argument></throws></expr></argument></argument_list></decl></decl_stmt>
         <if_stmt><if>if <condition>(<expr><name>slaXml</name> <operator>==</operator> <literal type="null">null</literal> <operator>||</operator> <call><name><name>slaXml</name><operator>.</operator><name>length</name></name><argument_list>()</argument_list></call> <operator>==</operator> <literal type="number">0</literal></expr>)</condition> <block>{<block_content>
            <return>return;</return>
            <return>return <expr><literal type="null">null</literal></expr>;</return>
         </block_content>}</block></if></if_stmt>
         <try>try <block>{<block_content>
            <expr_stmt><expr><call><name>writeSlaStatusEvent</name><argument_list>(<argument><expr><name>id</name></expr></argument>, <argument><expr><name>stat</name></expr></argument>, <argument><expr><name>store</name></expr></argument>, <argument><expr><name>appType</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <return>return <expr><call><name>createSlaStatusEvent</name><argument_list>(<argument><expr><name>id</name></expr></argument>, <argument><expr><name>stat</name></expr></argument>, <argument><expr><name>store</name></expr></argument>, <argument><expr><name>appType</name></expr></argument>)</argument_list></call></expr>;</return>
         </block_content>}</block>
         <catch>catch <parameter_list>(<parameter><decl><type><name>Exception</name></type> <name>e</name></decl></parameter>)</parameter_list> <block>{<block_content>
             <throw>throw <expr><operator>new</operator> <call><name>CommandException</name><argument_list>(<argument><expr><name><name>ErrorCode</name><operator>.</operator><name>E1007</name></name></expr></argument>, <argument><expr><literal type="string">" id "</literal> <operator>+</operator> <name>id</name></expr></argument>, <argument><expr><name>e</name></expr></argument>)</argument_list></call></expr>;</throw>
         </block_content>}</block></catch></try>
     </block_content>}</block></function>
 
    <decl_stmt><decl><type><specifier>public</specifier> <specifier>static</specifier> <name>void</name></type> <name>writeStausEvent</name><argument_list>(<argument><expr><name>String</name> <name>slaXml</name></expr></argument>, <argument><expr><name>String</name> <name>id</name></expr></argument>, <argument><expr><name>Status</name> <name>stat</name></expr></argument>, <argument><expr><name>SlaAppType</name> <name>appType</name></expr></argument>, <argument><expr><name>XLog</name> <name>log</name></expr></argument>)</argument_list>
    public static <name>SLAEventBean</name> <name>createStatusEvent</name><argument_list>(<argument><expr><name>String</name> <name>slaXml</name></expr></argument>, <argument><expr><name>String</name> <name>id</name></expr></argument>, <argument><expr><name>Status</name> <name>stat</name></expr></argument>, <argument><expr><name>SlaAppType</name> <name>appType</name></expr></argument>, <argument><expr><name>XLog</name> <name>log</name></expr></argument>)</argument_list>
             <throws>throws <argument><expr><name>CommandException</name> <block>{</block></expr></argument></throws>
         if <argument_list>(<argument><expr><name>slaXml</name> <operator>==</operator> <literal type="null">null</literal> <operator>||</operator> <call><name><name>slaXml</name><operator>.</operator><name>length</name></name><argument_list>()</argument_list></call> <operator>==</operator> <literal type="number">0</literal></expr></argument>)</argument_list> <block>{<block_content>
            <return>return;</return>
            <return>return <expr><literal type="null">null</literal></expr>;</return>
         </block_content>}</block></decl></decl_stmt>
         <try>try <block>{<block_content>
            <expr_stmt><expr><call><name>writeSlaStatusEvent</name><argument_list>(<argument><expr><name>id</name></expr></argument>, <argument><expr><name>stat</name></expr></argument>, <argument><expr><name>appType</name></expr></argument>, <argument><expr><name>log</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <return>return <expr><call><name>createSlaStatusEvent</name><argument_list>(<argument><expr><name>id</name></expr></argument>, <argument><expr><name>stat</name></expr></argument>, <argument><expr><name>appType</name></expr></argument>, <argument><expr><name>log</name></expr></argument>)</argument_list></call></expr>;</return>
         </block_content>}</block>
         <catch>catch <parameter_list>(<parameter><decl><type><name>Exception</name></type> <name>e</name></decl></parameter>)</parameter_list> <block>{<block_content>
             <throw>throw <expr><operator>new</operator> <call><name>CommandException</name><argument_list>(<argument><expr><name><name>ErrorCode</name><operator>.</operator><name>E1007</name></name></expr></argument>, <argument><expr><literal type="string">" id "</literal> <operator>+</operator> <name>id</name></expr></argument>, <argument><expr><name>e</name></expr></argument>)</argument_list></call></expr>;</throw>
<expr_stmt><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>util</name><operator>/</operator><name>db</name><operator>/</operator><name><name>SLADbXOperations</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>util</name><operator>/</operator><name>db</name><operator>/</operator><name><name>SLADbXOperations</name><operator>.</operator><name>java</name></name>
<name>index</name> <literal type="number">08a20d93c</literal><operator>..</operator><name>b5415995b</name> <literal type="number">100644</literal>
<operator>--</operator> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>util</name><operator>/</operator><name>db</name><operator>/</operator><name><name>SLADbXOperations</name><operator>.</operator><name>java</name></name>
<operator>++</operator> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>util</name><operator>/</operator><name>db</name><operator>/</operator><name><name>SLADbXOperations</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">24</literal></expr><operator>,</operator><expr><literal type="number">8</literal> <operator>+</operator><literal type="number">24</literal></expr><operator>,</operator><expr><literal type="number">6</literal> @@</expr></expr_stmt> <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>SLAEventBean</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>SLAEvent</name><operator>.</operator><name>SlaAppType</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>SLAEvent</name><operator>.</operator><name>Status</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>CommandException</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>SLAEventInsertJPAExecutor</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>JPAService</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>Services</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>util</name><operator>.</operator><name>DateUtils</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>jdom</name><operator>.</operator><name>Element</name></name>;</import>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">43</literal></expr><operator>,</operator><expr><literal type="number">11</literal> <operator>+</operator><literal type="number">41</literal></expr><operator>,</operator><expr><literal type="number">11</literal> @@ <specifier>public</specifier> <name>class</name> <name>SLADbXOperations</name> <block>{
      <expr><operator>*</operator> @<name>param</name> <name>groupName</name> <name>group</name> <name>name</name>
      <operator>*</operator> @<throws>throws <argument><expr><name>Exception</name>
      <operator>*</operator><operator>/</operator>
    <specifier>public</specifier> <specifier>static</specifier> <name>void</name> <call><name>writeSlaRegistrationEvent</name><argument_list>(<argument><expr><name>Element</name> <name>eSla</name></expr></argument>, <argument><expr><name>String</name> <name>slaId</name></expr></argument>,
    <argument><expr><specifier>public</specifier> <specifier>static</specifier> <name>SLAEventBean</name> <call><name>createSlaRegistrationEvent</name><argument_list>(<argument><expr><name>Element</name> <name>eSla</name></expr></argument>, <argument><expr><name>String</name> <name>slaId</name></expr></argument>,
                                                  <argument><expr><name>SlaAppType</name> <name>appType</name></expr></argument>, <argument><expr><name>String</name> <name>user</name></expr></argument>, <argument><expr><name>String</name> <name>groupName</name></expr></argument>)</argument_list></call></expr></argument></argument_list></call></expr></argument></throws>
             <throws>throws <argument><expr><name>Exception</name> <block>{</block></expr></argument></throws></expr>
         <if_stmt><if>if <condition>(<expr><name>eSla</name> <operator>==</operator> <literal type="null">null</literal></expr>)</condition> <block>{<block_content>
            <return>return;</return>
            <return>return <expr><literal type="null">null</literal></expr>;</return>
         </block_content>}</block></if></if_stmt>
         <name>SLAEventBean</name> <name>sla</name> <operator>=</operator> <operator>new</operator> <call><name>SLAEventBean</name><argument_list>()</argument_list></call></block></expr>;</expr_stmt>
         <comment type="line">// sla.setClientId(getTagElement( eSla, "client-id"));</comment>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">107</literal></expr><operator>,</operator><expr><literal type="number">14</literal> <operator>+</operator><literal type="number">105</literal></expr><operator>,</operator><expr><literal type="number">7</literal> @@ <specifier>public</specifier> <name>class</name> <name>SLADbXOperations</name> <block>{
         <expr><call><name><name>sla</name><operator>.</operator><name>setJobStatus</name></name><argument_list>(<argument><expr><name><name>Status</name><operator>.</operator><name>CREATED</name></name></expr></argument>)</argument_list></call></expr>;
         <call><name><name>sla</name><operator>.</operator><name>setStatusTimestamp</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>Date</name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></block></expr>;</expr_stmt>
 
        <decl_stmt><decl><type><name>JPAService</name></type> <name>jpaService</name> <init>= <expr><call><name><name>Services</name><operator>.</operator><name>get</name></name><argument_list>()</argument_list></call><operator>.</operator><call><name>get</name><argument_list>(<argument><expr><name><name>JPAService</name><operator>.</operator><name>class</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>

        <if_stmt><if>if <condition>(<expr><name>jpaService</name> <operator>!=</operator> <literal type="null">null</literal></expr>)</condition> <block>{<block_content>
            <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>SLAEventInsertJPAExecutor</name><argument_list>(<argument><expr><name>sla</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        </block_content>}</block></if>
        <else>else <block>{<block_content>
            <throw>throw <expr><operator>new</operator> <call><name>CommandException</name><argument_list>(<argument><expr><name><name>ErrorCode</name><operator>.</operator><name>E0610</name></name></expr></argument>, <argument><expr><literal type="string">"unable to write sla event."</literal></expr></argument>)</argument_list></call></expr>;</throw>
        </block_content>}</block></else></if_stmt>
        <return>return <expr><name>sla</name></expr>;</return>
 
     </block_content>}</block></catch></try>
 
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">126</literal></expr><operator>,</operator><expr><literal type="number">7</literal> <operator>+</operator><literal type="number">117</literal></expr><operator>,</operator><expr><literal type="number">7</literal> @@ <specifier>public</specifier> <name>class</name> <name>SLADbXOperations</name> <block>{
      <expr><operator>*</operator> @<name>param</name> <name>appType</name> <name>SLA</name> <name>app</name> <name>type</name>
      <operator>*</operator> @<throws>throws <argument><expr><name>Exception</name>
      <operator>*</operator><operator>/</operator>
    <specifier>public</specifier> <specifier>static</specifier> <name>void</name> <call><name>writeSlaStatusEvent</name><argument_list>(<argument><expr><name>String</name> <name>id</name></expr></argument>,
    <argument><expr><specifier>public</specifier> <specifier>static</specifier> <name>SLAEventBean</name> <call><name>createSlaStatusEvent</name><argument_list>(<argument><expr><name>String</name> <name>id</name></expr></argument>,
                                            <argument><expr><name>Status</name> <name>status</name></expr></argument>, <argument><expr><name>SlaAppType</name> <name>appType</name></expr></argument>)</argument_list></call></expr></argument></argument_list></call></expr></argument></throws> <throws>throws <argument><expr><name>Exception</name> <block>{
         <expr><name>SLAEventBean</name> <name>sla</name> <operator>=</operator> <operator>new</operator> <call><name>SLAEventBean</name><argument_list>()</argument_list></call></expr></block></expr></argument></throws></expr>;
         <call><name><name>sla</name><operator>.</operator><name>setSlaId</name></name><argument_list>(<argument><expr><name>id</name></expr></argument>)</argument_list></call></block></expr>;</expr_stmt>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">134</literal></expr><operator>,</operator><expr><literal type="number">14</literal> <operator>+</operator><literal type="number">125</literal></expr><operator>,</operator><expr><literal type="number">7</literal> @@ <specifier>public</specifier> <name>class</name> <name>SLADbXOperations</name> <block>{
         <expr><call><name><name>sla</name><operator>.</operator><name>setAppType</name></name><argument_list>(<argument><expr><name>appType</name></expr></argument>)</argument_list></call></expr>;
         <call><name><name>sla</name><operator>.</operator><name>setStatusTimestamp</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>Date</name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></block></expr>;</expr_stmt>
 
        <decl_stmt><decl><type><name>JPAService</name></type> <name>jpaService</name> <init>= <expr><call><name><name>Services</name><operator>.</operator><name>get</name></name><argument_list>()</argument_list></call><operator>.</operator><call><name>get</name><argument_list>(<argument><expr><name><name>JPAService</name><operator>.</operator><name>class</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>

        <if_stmt><if>if <condition>(<expr><name>jpaService</name> <operator>!=</operator> <literal type="null">null</literal></expr>)</condition> <block>{<block_content>
            <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>SLAEventInsertJPAExecutor</name><argument_list>(<argument><expr><name>sla</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        </block_content>}</block></if>
        <else>else <block>{<block_content>
            <throw>throw <expr><operator>new</operator> <call><name>CommandException</name><argument_list>(<argument><expr><name><name>ErrorCode</name><operator>.</operator><name>E0610</name></name></expr></argument>, <argument><expr><literal type="string">"unable to write sla event."</literal></expr></argument>)</argument_list></call></expr>;</throw>
        </block_content>}</block></else></if_stmt>
        <return>return <expr><name>sla</name></expr>;</return>
     </block_content>}</block></for>
 
     <comment type="block" format="javadoc">/**
@@ -153,13 +137,13 @@ public class SLADbXOperations {
      * @param appType SLA app type
      * @throws CommandException
      */</comment>
    <decl_stmt><decl><type><specifier>public</specifier> <specifier>static</specifier> <name>void</name></type> <name>writeStausEvent</name><argument_list>(<argument><expr><name>String</name> <name>slaXml</name></expr></argument>, <argument><expr><name>String</name> <name>id</name></expr></argument>, <argument><expr><name>Status</name> <name>stat</name></expr></argument>,
    <argument><expr><specifier>public</specifier> <specifier>static</specifier> <name>SLAEventBean</name> <call><name>createStatusEvent</name><argument_list>(<argument><expr><name>String</name> <name>slaXml</name></expr></argument>, <argument><expr><name>String</name> <name>id</name></expr></argument>, <argument><expr><name>Status</name> <name>stat</name></expr></argument>,
                                        <argument><expr><name>SlaAppType</name> <name>appType</name></expr></argument>)</argument_list></call> <throws>throws <argument><expr><name>CommandException</name> <block>{</block></expr></argument></throws></expr></argument></argument_list></decl></decl_stmt>
         <if_stmt><if>if <condition>(<expr><name>slaXml</name> <operator>==</operator> <literal type="null">null</literal> <operator>||</operator> <call><name><name>slaXml</name><operator>.</operator><name>length</name></name><argument_list>()</argument_list></call> <operator>==</operator> <literal type="number">0</literal></expr>)</condition> <block>{<block_content>
            <return>return;</return>
            <return>return <expr><literal type="null">null</literal></expr>;</return>
         </block_content>}</block></if></if_stmt>
         <try>try <block>{<block_content>
            <expr_stmt><expr><call><name>writeSlaStatusEvent</name><argument_list>(<argument><expr><name>id</name></expr></argument>, <argument><expr><name>stat</name></expr></argument>, <argument><expr><name>appType</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <return>return <expr><call><name>createSlaStatusEvent</name><argument_list>(<argument><expr><name>id</name></expr></argument>, <argument><expr><name>stat</name></expr></argument>, <argument><expr><name>appType</name></expr></argument>)</argument_list></call></expr>;</return>
         </block_content>}</block>
         <catch>catch <parameter_list>(<parameter><decl><type><name>Exception</name></type> <name>e</name></decl></parameter>)</parameter_list> <block>{<block_content>
             <throw>throw <expr><operator>new</operator> <call><name>CommandException</name><argument_list>(<argument><expr><name><name>ErrorCode</name><operator>.</operator><name>E1007</name></name></expr></argument>, <argument><expr><literal type="string">" id "</literal> <operator>+</operator> <name>id</name></expr></argument>, <argument><expr><name>e</name></expr></argument>)</argument_list></call></expr>;</throw>
<expr_stmt><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>test</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>wf</name><operator>/</operator><name><name>TestActionErrors</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>test</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>wf</name><operator>/</operator><name><name>TestActionErrors</name><operator>.</operator><name>java</name></name>
<name>index</name> <name>f42693278</name><operator>..</operator><literal type="number">04ac3f423</literal> <literal type="number">100644</literal>
<operator>--</operator> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>test</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>wf</name><operator>/</operator><name><name>TestActionErrors</name><operator>.</operator><name>java</name></name>
<operator>++</operator> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>test</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>command</name><operator>/</operator><name>wf</name><operator>/</operator><name><name>TestActionErrors</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">30</literal></expr><operator>,</operator><expr><literal type="number">7</literal> <operator>+</operator><literal type="number">30</literal></expr><operator>,</operator><expr><literal type="number">6</literal> @@</expr></expr_stmt> <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>DagEngine</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>ForTestingActionExecutor</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>WorkflowActionBean</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>WorkflowJobBean</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>action</name><operator>.</operator><name>control</name><operator>.</operator><name>KillActionExecutor</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>CoordinatorJob</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>CoordinatorAction</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>OozieClient</name></name>;</import>
<expr_stmt><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>test</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>executor</name><operator>/</operator><name>jpa</name><operator>/</operator><name><name>TestBulkDeleteForPurgeJPAExecutor</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>test</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>executor</name><operator>/</operator><name>jpa</name><operator>/</operator><name><name>TestBulkDeleteForPurgeJPAExecutor</name><operator>.</operator><name>java</name></name>
<operator>new</operator> <name>file</name> <name>mode</name> <literal type="number">100644</literal>
<name>index</name> <literal type="number">000000000..d1086432f</literal>
<operator>--</operator> <operator>/</operator><name>dev</name><operator>/</operator><literal type="null">null</literal>
<operator>++</operator> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>test</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>executor</name><operator>/</operator><name>jpa</name><operator>/</operator><name><name>TestBulkDeleteForPurgeJPAExecutor</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">0</literal></expr><operator>,</operator><expr><literal type="number">0</literal> <operator>+</operator><literal type="number">1</literal></expr><operator>,</operator><expr><literal type="number">216</literal> @@</expr></expr_stmt>
<comment type="block" format="javadoc">/**
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */</comment>
<package>package <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name></name>;</package>

<import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>ArrayList</name></name>;</import>
<import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>List</name></name>;</import>

<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>BundleJobBean</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>CoordinatorActionBean</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>CoordinatorJobBean</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>ErrorCode</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>FaultInjection</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>WorkflowActionBean</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>WorkflowJobBean</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>CoordinatorAction</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>CoordinatorJob</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>BundleJob</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>Job</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>WorkflowAction</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>WorkflowJob</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>rest</name><operator>.</operator><name>JsonBean</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>SkipCommitFaultInjection</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>WorkflowJobGetJPAExecutor</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>JPAService</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>Services</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>test</name><operator>.</operator><name>XDataTestCase</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>workflow</name><operator>.</operator><name>WorkflowInstance</name></name>;</import>

<comment type="block" format="javadoc">/**
 * Testcases for bulk JPA writes - delete operations for Purge commands
 */</comment>
<class><specifier>public</specifier> class <name>TestBulkDeleteForPurgeJPAExecutor</name> <super_list><extends>extends <super><name>XDataTestCase</name></super></extends></super_list> <block>{
    <decl_stmt><decl><type><name>Services</name></type> <name>services</name></decl>;</decl_stmt>

    <function><annotation>@<name>Override</name></annotation>
    <type><specifier>protected</specifier> <name>void</name></type> <name>setUp</name><parameter_list>()</parameter_list> <throws>throws <argument><expr><name>Exception</name></expr></argument></throws> <block>{<block_content>
        <expr_stmt><expr><call><name><name>super</name><operator>.</operator><name>setUp</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><name>services</name> <operator>=</operator> <operator>new</operator> <call><name>Services</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>services</name><operator>.</operator><name>init</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>cleanUpDBTables</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
    </block_content>}</block></function>

    <function><annotation>@<name>Override</name></annotation>
    <type><specifier>protected</specifier> <name>void</name></type> <name>tearDown</name><parameter_list>()</parameter_list> <throws>throws <argument><expr><name>Exception</name></expr></argument></throws> <block>{<block_content>
        <expr_stmt><expr><call><name><name>services</name><operator>.</operator><name>destroy</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>super</name><operator>.</operator><name>tearDown</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
    </block_content>}</block></function>

    <comment type="block" format="javadoc">/**
     * Test bulk deletes with bundle job and its 1 bundle action
     * @throws Exception
     */</comment>
    <function><type><specifier>public</specifier> <name>void</name></type> <name>testDeleteBundle</name><parameter_list>()</parameter_list> <throws>throws <argument><expr><name>Exception</name></expr></argument></throws> <block>{<block_content>
        <decl_stmt><decl><type><name>BundleJobBean</name></type> <name>bundleJob</name> <init>= <expr><call><name>addRecordToBundleJobTable</name><argument_list>(<argument><expr><name><name>BundleJob</name><operator>.</operator><name>Status</name><operator>.</operator><name>PREP</name></name></expr></argument>, <argument><expr><literal type="boolean">true</literal></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name>addRecordToBundleActionTable</name><argument_list>(<argument><expr><call><name><name>bundleJob</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><literal type="string">"COORD_NAME"</literal></expr></argument>, <argument><expr><literal type="number">1</literal></expr></argument>, <argument><expr><name><name>Job</name><operator>.</operator><name>Status</name><operator>.</operator><name>SUCCEEDED</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <decl_stmt><decl><type><name>JPAService</name></type> <name>jpaService</name> <init>= <expr><call><name><name>Services</name><operator>.</operator><name>get</name></name><argument_list>()</argument_list></call><operator>.</operator><call><name>get</name><argument_list>(<argument><expr><name><name>JPAService</name><operator>.</operator><name>class</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name>assertNotNull</name><argument_list>(<argument><expr><name>jpaService</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <decl_stmt><decl><type><name><name>List</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name></type> <name>deleteList</name> <init>= <expr><operator>new</operator> <call><name><name>ArrayList</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
        <comment type="line">// add to list for doing bulk delete by bundle job</comment>
        <expr_stmt><expr><call><name><name>deleteList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>bundleJob</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <decl_stmt><decl><type><name>BulkDeleteForPurgeJPAExecutor</name></type> <name>bulkPurgeDelCmd</name> <init>= <expr><operator>new</operator> <call><name>BulkDeleteForPurgeJPAExecutor</name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name><name>bulkPurgeDelCmd</name><operator>.</operator><name>setDeleteList</name></name><argument_list>(<argument><expr><name>deleteList</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><name>bulkPurgeDelCmd</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <comment type="line">// check for non existence after running bulkDeleteJPA</comment>
        <try>try <block>{<block_content>
            <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>BundleJobGetJPAExecutor</name><argument_list>(<argument><expr><call><name><name>bundleJob</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name>fail</name><argument_list>()</argument_list></call></expr>;</expr_stmt> <comment type="line">//should not be found</comment>
        </block_content>}</block>
        <catch>catch<parameter_list>(<parameter><decl><type><name>JPAExecutorException</name></type> <name>jex</name></decl></parameter>)</parameter_list> <block>{<block_content>
            <expr_stmt><expr><call><name>assertEquals</name><argument_list>(<argument><expr><name><name>ErrorCode</name><operator>.</operator><name>E0604</name></name></expr></argument>, <argument><expr><call><name><name>jex</name><operator>.</operator><name>getErrorCode</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        </block_content>}</block></catch></try>
        <try>try <block>{<block_content>
            <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>BundleActionGetJPAExecutor</name><argument_list>(<argument><expr><call><name><name>bundleJob</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><literal type="string">"COORD_NAME"</literal></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name>fail</name><argument_list>()</argument_list></call></expr>;</expr_stmt> <comment type="line">//should not be found</comment>
        </block_content>}</block>
        <catch>catch<parameter_list>(<parameter><decl><type><name>JPAExecutorException</name></type> <name>jex</name></decl></parameter>)</parameter_list> <block>{<block_content>
            <expr_stmt><expr><call><name>assertEquals</name><argument_list>(<argument><expr><name><name>ErrorCode</name><operator>.</operator><name>E0605</name></name></expr></argument>, <argument><expr><call><name><name>jex</name><operator>.</operator><name>getErrorCode</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        </block_content>}</block></catch></try>
    </block_content>}</block></function>

    <comment type="block" format="javadoc">/**
     * Test bulk deletes with coord job with its 2 coord actions - only 1 in terminal state
     * @throws Exception
     */</comment>
    <function><type><specifier>public</specifier> <name>void</name></type> <name>testDeleteCoord</name><parameter_list>()</parameter_list> <throws>throws <argument><expr><name>Exception</name></expr></argument></throws> <block>{<block_content>
        <decl_stmt><decl><type><name>CoordinatorJobBean</name></type> <name>coordJob</name> <init>= <expr><call><name>addRecordToCoordJobTable</name><argument_list>(<argument><expr><name><name>CoordinatorJob</name><operator>.</operator><name>Status</name><operator>.</operator><name>PREP</name></name></expr></argument>, <argument><expr><literal type="boolean">true</literal></expr></argument>, <argument><expr><literal type="boolean">true</literal></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <decl_stmt><decl><type><name>CoordinatorActionBean</name></type> <name>action1</name> <init>= <expr><call><name>addRecordToCoordActionTable</name><argument_list>(<argument><expr><call><name><name>coordJob</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><literal type="number">1</literal></expr></argument>, <argument><expr><name><name>CoordinatorAction</name><operator>.</operator><name>Status</name><operator>.</operator><name>KILLED</name></name></expr></argument>, <argument><expr><literal type="string">"coord-action-get.xml"</literal></expr></argument>, <argument><expr><literal type="number">0</literal></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name>addRecordToCoordActionTable</name><argument_list>(<argument><expr><call><name><name>coordJob</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><literal type="number">2</literal></expr></argument>, <argument><expr><name><name>CoordinatorAction</name><operator>.</operator><name>Status</name><operator>.</operator><name>SUSPENDED</name></name></expr></argument>, <argument><expr><literal type="string">"coord-action-get.xml"</literal></expr></argument>, <argument><expr><literal type="number">0</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <decl_stmt><decl><type><name>JPAService</name></type> <name>jpaService</name> <init>= <expr><call><name><name>Services</name><operator>.</operator><name>get</name></name><argument_list>()</argument_list></call><operator>.</operator><call><name>get</name><argument_list>(<argument><expr><name><name>JPAService</name><operator>.</operator><name>class</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name>assertNotNull</name><argument_list>(<argument><expr><name>jpaService</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <decl_stmt><decl><type><name><name>List</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name></type> <name>deleteList</name> <init>= <expr><operator>new</operator> <call><name><name>ArrayList</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
        <comment type="line">// add to list for doing bulk delete by bundle job</comment>
        <expr_stmt><expr><call><name><name>deleteList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>coordJob</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <decl_stmt><decl><type><name>BulkDeleteForPurgeJPAExecutor</name></type> <name>bulkPurgeDelCmd</name> <init>= <expr><operator>new</operator> <call><name>BulkDeleteForPurgeJPAExecutor</name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name><name>bulkPurgeDelCmd</name><operator>.</operator><name>setDeleteList</name></name><argument_list>(<argument><expr><name>deleteList</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>assertEquals</name><argument_list>(<argument><expr><literal type="number">1</literal></expr></argument>, <argument><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><name>bulkPurgeDelCmd</name></expr></argument>)</argument_list></call><operator>.</operator><call><name>intValue</name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <comment type="line">// check for non existence after running bulkDeleteJPA</comment>
        <try>try <block>{<block_content>
            <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>CoordJobGetJPAExecutor</name><argument_list>(<argument><expr><call><name><name>coordJob</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name>fail</name><argument_list>()</argument_list></call></expr>;</expr_stmt> <comment type="line">//should not be found</comment>
        </block_content>}</block>
        <catch>catch<parameter_list>(<parameter><decl><type><name>JPAExecutorException</name></type> <name>jex</name></decl></parameter>)</parameter_list> <block>{<block_content>
            <expr_stmt><expr><call><name>assertEquals</name><argument_list>(<argument><expr><name><name>ErrorCode</name><operator>.</operator><name>E0604</name></name></expr></argument>, <argument><expr><call><name><name>jex</name><operator>.</operator><name>getErrorCode</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        </block_content>}</block></catch></try>
        <try>try <block>{<block_content>
            <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>CoordActionGetJPAExecutor</name><argument_list>(<argument><expr><call><name><name>action1</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name>fail</name><argument_list>()</argument_list></call></expr>;</expr_stmt> <comment type="line">//should not be found</comment>
        </block_content>}</block>
        <catch>catch<parameter_list>(<parameter><decl><type><name>JPAExecutorException</name></type> <name>jex</name></decl></parameter>)</parameter_list> <block>{<block_content>
            <expr_stmt><expr><call><name>assertEquals</name><argument_list>(<argument><expr><name><name>ErrorCode</name><operator>.</operator><name>E0605</name></name></expr></argument>, <argument><expr><call><name><name>jex</name><operator>.</operator><name>getErrorCode</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        </block_content>}</block></catch></try>
    </block_content>}</block></function>

    <comment type="block" format="javadoc">/**
     * Test bulk deletes with workflow job and its 2 actions
     * @throws Exception
     */</comment>
    <function><type><specifier>public</specifier> <name>void</name></type> <name>testDeleteWorkflow</name><parameter_list>()</parameter_list> <throws>throws <argument><expr><name>Exception</name></expr></argument></throws> <block>{<block_content>
        <decl_stmt><decl><type><name>WorkflowJobBean</name></type> <name>wfJob</name> <init>= <expr><call><name>addRecordToWfJobTable</name><argument_list>(<argument><expr><name><name>WorkflowJob</name><operator>.</operator><name>Status</name><operator>.</operator><name>PREP</name></name></expr></argument>, <argument><expr><name><name>WorkflowInstance</name><operator>.</operator><name>Status</name><operator>.</operator><name>RUNNING</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <decl_stmt><decl><type><name>WorkflowActionBean</name></type> <name>action1</name> <init>= <expr><call><name>addRecordToWfActionTable</name><argument_list>(<argument><expr><call><name><name>wfJob</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><literal type="string">"1"</literal></expr></argument>, <argument><expr><name><name>WorkflowAction</name><operator>.</operator><name>Status</name><operator>.</operator><name>KILLED</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <decl_stmt><decl><type><name>WorkflowActionBean</name></type> <name>action2</name> <init>= <expr><call><name>addRecordToWfActionTable</name><argument_list>(<argument><expr><call><name><name>wfJob</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><literal type="string">"2"</literal></expr></argument>, <argument><expr><name><name>WorkflowAction</name><operator>.</operator><name>Status</name><operator>.</operator><name>START_RETRY</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <decl_stmt><decl><type><name>JPAService</name></type> <name>jpaService</name> <init>= <expr><call><name><name>Services</name><operator>.</operator><name>get</name></name><argument_list>()</argument_list></call><operator>.</operator><call><name>get</name><argument_list>(<argument><expr><name><name>JPAService</name><operator>.</operator><name>class</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name>assertNotNull</name><argument_list>(<argument><expr><name>jpaService</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <decl_stmt><decl><type><name><name>List</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name></type> <name>deleteList</name> <init>= <expr><operator>new</operator> <call><name><name>ArrayList</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
        <comment type="line">// add to list for doing bulk delete by bundle job</comment>
        <expr_stmt><expr><call><name><name>deleteList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>wfJob</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <decl_stmt><decl><type><name>BulkDeleteForPurgeJPAExecutor</name></type> <name>bulkPurgeDelCmd</name> <init>= <expr><operator>new</operator> <call><name>BulkDeleteForPurgeJPAExecutor</name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name><name>bulkPurgeDelCmd</name><operator>.</operator><name>setDeleteList</name></name><argument_list>(<argument><expr><name>deleteList</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><name>bulkPurgeDelCmd</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <comment type="line">// check for non existence after running bulkDeleteJPA</comment>
        <try>try <block>{<block_content>
            <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>WorkflowJobGetJPAExecutor</name><argument_list>(<argument><expr><call><name><name>wfJob</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name>fail</name><argument_list>()</argument_list></call></expr>;</expr_stmt> <comment type="line">//should not be found</comment>
        </block_content>}</block>
        <catch>catch<parameter_list>(<parameter><decl><type><name>JPAExecutorException</name></type> <name>jex</name></decl></parameter>)</parameter_list> <block>{<block_content>
            <expr_stmt><expr><call><name>assertEquals</name><argument_list>(<argument><expr><name><name>ErrorCode</name><operator>.</operator><name>E0604</name></name></expr></argument>, <argument><expr><call><name><name>jex</name><operator>.</operator><name>getErrorCode</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        </block_content>}</block></catch></try>
        <try>try <block>{<block_content>
            <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>WorkflowActionGetJPAExecutor</name><argument_list>(<argument><expr><call><name><name>action1</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name>fail</name><argument_list>()</argument_list></call></expr>;</expr_stmt> <comment type="line">//should not be found</comment>
        </block_content>}</block>
        <catch>catch<parameter_list>(<parameter><decl><type><name>JPAExecutorException</name></type> <name>jex</name></decl></parameter>)</parameter_list> <block>{<block_content>
            <expr_stmt><expr><call><name>assertEquals</name><argument_list>(<argument><expr><name><name>ErrorCode</name><operator>.</operator><name>E0605</name></name></expr></argument>, <argument><expr><call><name><name>jex</name><operator>.</operator><name>getErrorCode</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        </block_content>}</block></catch></try>
        <try>try <block>{<block_content>
            <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>WorkflowActionGetJPAExecutor</name><argument_list>(<argument><expr><call><name><name>action2</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name>fail</name><argument_list>()</argument_list></call></expr>;</expr_stmt> <comment type="line">//should not be found</comment>
        </block_content>}</block>
        <catch>catch<parameter_list>(<parameter><decl><type><name>JPAExecutorException</name></type> <name>jex</name></decl></parameter>)</parameter_list> <block>{<block_content>
            <expr_stmt><expr><call><name>assertEquals</name><argument_list>(<argument><expr><name><name>ErrorCode</name><operator>.</operator><name>E0605</name></name></expr></argument>, <argument><expr><call><name><name>jex</name><operator>.</operator><name>getErrorCode</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        </block_content>}</block></catch></try>
    </block_content>}</block></function>

    <comment type="block" format="javadoc">/**
     * Test bulk deletes rollback
     *
     * @throws Exception
     */</comment>
    <function><type><specifier>public</specifier> <name>void</name></type> <name>testBulkDeletesRollback</name><parameter_list>()</parameter_list> <throws>throws <argument><expr><name>Exception</name></expr></argument></throws><block>{<block_content>
        <decl_stmt><decl><type><name>WorkflowJobBean</name></type> <name>job</name> <init>= <expr><call><name>addRecordToWfJobTable</name><argument_list>(<argument><expr><name><name>WorkflowJob</name><operator>.</operator><name>Status</name><operator>.</operator><name>PREP</name></name></expr></argument>, <argument><expr><name><name>WorkflowInstance</name><operator>.</operator><name>Status</name><operator>.</operator><name>RUNNING</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <decl_stmt><decl><type><name>WorkflowActionBean</name></type> <name>action1</name> <init>= <expr><call><name>addRecordToWfActionTable</name><argument_list>(<argument><expr><call><name><name>job</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><literal type="string">"1"</literal></expr></argument>, <argument><expr><name><name>WorkflowAction</name><operator>.</operator><name>Status</name><operator>.</operator><name>KILLED</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <decl_stmt><decl><type><name>JPAService</name></type> <name>jpaService</name> <init>= <expr><call><name><name>Services</name><operator>.</operator><name>get</name></name><argument_list>()</argument_list></call><operator>.</operator><call><name>get</name><argument_list>(<argument><expr><name><name>JPAService</name><operator>.</operator><name>class</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name>assertNotNull</name><argument_list>(<argument><expr><name>jpaService</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <decl_stmt><decl><type><name><name>List</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name></type> <name>deleteList</name> <init>= <expr><operator>new</operator> <call><name><name>ArrayList</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name><name>deleteList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>job</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <decl_stmt><decl><type><name>BulkDeleteForPurgeJPAExecutor</name></type> <name>bulkPurgeDelCmd</name> <init>= <expr><operator>new</operator> <call><name>BulkDeleteForPurgeJPAExecutor</name><argument_list>(<argument><expr><name>deleteList</name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>

        <comment type="line">// set fault injection to true, so transaction is roll backed</comment>
        <expr_stmt><expr><call><name>setSystemProperty</name><argument_list>(<argument><expr><name><name>FaultInjection</name><operator>.</operator><name>FAULT_INJECTION</name></name></expr></argument>, <argument><expr><literal type="string">"true"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>setSystemProperty</name><argument_list>(<argument><expr><name><name>SkipCommitFaultInjection</name><operator>.</operator><name>ACTION_FAILOVER_FAULT_INJECTION</name></name></expr></argument>, <argument><expr><literal type="string">"true"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <try>try <block>{<block_content>
            <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><name>bulkPurgeDelCmd</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name>fail</name><argument_list>(<argument><expr><literal type="string">"Expected exception due to commit failure but didn't get any"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        </block_content>}</block>
        <catch>catch <parameter_list>(<parameter><decl><type><name>Exception</name></type> <name>e</name></decl></parameter>)</parameter_list> <block>{<block_content>
        </block_content>}</block></catch></try>
        <expr_stmt><expr><call><name><name>FaultInjection</name><operator>.</operator><name>deactivate</name></name><argument_list>(<argument><expr><literal type="string">"org.apache.oozie.command.SkipCommitFaultInjection"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <comment type="line">// Check whether transactions are rolled back or not</comment>
        <try>try <block>{<block_content>
            <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>WorkflowJobGetJPAExecutor</name><argument_list>(<argument><expr><call><name><name>job</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        </block_content>}</block>
        <catch>catch <parameter_list>(<parameter><decl><type><name>JPAExecutorException</name></type> <name>je</name></decl></parameter>)</parameter_list> <block>{<block_content>
            <expr_stmt><expr><call><name>fail</name><argument_list>(<argument><expr><literal type="string">"WF job should not be removed due to transaction rollback but was not found"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        </block_content>}</block></catch></try>
        <try>try <block>{<block_content>
            <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>WorkflowActionGetJPAExecutor</name><argument_list>(<argument><expr><call><name><name>action1</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        </block_content>}</block>
        <catch>catch <parameter_list>(<parameter><decl><type><name>JPAExecutorException</name></type> <name>je</name></decl></parameter>)</parameter_list> <block>{<block_content>
            <expr_stmt><expr><call><name>fail</name><argument_list>(<argument><expr><literal type="string">"WF action should not be removed due to transaction rollback but was not found"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        </block_content>}</block></catch></try>
    </block_content>}</block></function>

}</block></class>
<expr_stmt><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>test</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>executor</name><operator>/</operator><name>jpa</name><operator>/</operator><name><name>TestBulkUpdateDeleteJPAExecutor</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>test</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>executor</name><operator>/</operator><name>jpa</name><operator>/</operator><name><name>TestBulkUpdateDeleteJPAExecutor</name><operator>.</operator><name>java</name></name>
<operator>new</operator> <name>file</name> <name>mode</name> <literal type="number">100644</literal>
<name>index</name> <literal type="number">000000000..c188e53e7</literal>
<operator>--</operator> <operator>/</operator><name>dev</name><operator>/</operator><literal type="null">null</literal>
<operator>++</operator> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>test</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>executor</name><operator>/</operator><name>jpa</name><operator>/</operator><name><name>TestBulkUpdateDeleteJPAExecutor</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">0</literal></expr><operator>,</operator><expr><literal type="number">0</literal> <operator>+</operator><literal type="number">1</literal></expr><operator>,</operator><expr><literal type="number">231</literal> @@</expr></expr_stmt>
<comment type="block" format="javadoc">/**
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */</comment>
<package>package <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name></name>;</package>

<import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>ArrayList</name></name>;</import>
<import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>List</name></name>;</import>

<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>CoordinatorActionBean</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>CoordinatorJobBean</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>ErrorCode</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>FaultInjection</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>WorkflowActionBean</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>WorkflowJobBean</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>CoordinatorAction</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>CoordinatorJob</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>WorkflowAction</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>WorkflowJob</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>rest</name><operator>.</operator><name>JsonBean</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>SkipCommitFaultInjection</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>WorkflowJobGetJPAExecutor</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>JPAService</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>Services</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>test</name><operator>.</operator><name>XDataTestCase</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>workflow</name><operator>.</operator><name>WorkflowInstance</name></name>;</import>

<comment type="block" format="javadoc">/**
 * Testcases for bulk JPA writes - update and delete operations
 */</comment>
<class><specifier>public</specifier> class <name>TestBulkUpdateDeleteJPAExecutor</name> <super_list><extends>extends <super><name>XDataTestCase</name></super></extends></super_list> <block>{
    <decl_stmt><decl><type><name>Services</name></type> <name>services</name></decl>;</decl_stmt>

    <function><annotation>@<name>Override</name></annotation>
    <type><specifier>protected</specifier> <name>void</name></type> <name>setUp</name><parameter_list>()</parameter_list> <throws>throws <argument><expr><name>Exception</name></expr></argument></throws> <block>{<block_content>
        <expr_stmt><expr><call><name><name>super</name><operator>.</operator><name>setUp</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><name>services</name> <operator>=</operator> <operator>new</operator> <call><name>Services</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>services</name><operator>.</operator><name>init</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>cleanUpDBTables</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
    </block_content>}</block></function>

    <function><annotation>@<name>Override</name></annotation>
    <type><specifier>protected</specifier> <name>void</name></type> <name>tearDown</name><parameter_list>()</parameter_list> <throws>throws <argument><expr><name>Exception</name></expr></argument></throws> <block>{<block_content>
        <expr_stmt><expr><call><name><name>services</name><operator>.</operator><name>destroy</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>super</name><operator>.</operator><name>tearDown</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
    </block_content>}</block></function>

    <comment type="block" format="javadoc">/**
     * Test bulk updates by updating coordinator job, workflow job and workflow action
     * @throws Exception
     */</comment>
    <function><type><specifier>public</specifier> <name>void</name></type> <name>testUpdates</name><parameter_list>()</parameter_list> <throws>throws <argument><expr><name>Exception</name></expr></argument></throws> <block>{<block_content>
        <decl_stmt><decl><type><name>CoordinatorJobBean</name></type> <name>coordJob</name> <init>= <expr><call><name>addRecordToCoordJobTable</name><argument_list>(<argument><expr><name><name>CoordinatorJob</name><operator>.</operator><name>Status</name><operator>.</operator><name>PREP</name></name></expr></argument>, <argument><expr><literal type="boolean">true</literal></expr></argument>, <argument><expr><literal type="boolean">true</literal></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <decl_stmt><decl><type><name>WorkflowJobBean</name></type> <name>wfJob</name> <init>= <expr><call><name>addRecordToWfJobTable</name><argument_list>(<argument><expr><name><name>WorkflowJob</name><operator>.</operator><name>Status</name><operator>.</operator><name>PREP</name></name></expr></argument>, <argument><expr><name><name>WorkflowInstance</name><operator>.</operator><name>Status</name><operator>.</operator><name>PREP</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <decl_stmt><decl><type><name>WorkflowActionBean</name></type> <name>action</name> <init>= <expr><call><name>addRecordToWfActionTable</name><argument_list>(<argument><expr><call><name><name>wfJob</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><literal type="string">"1"</literal></expr></argument>, <argument><expr><name><name>WorkflowAction</name><operator>.</operator><name>Status</name><operator>.</operator><name>PREP</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <decl_stmt><decl><type><name>JPAService</name></type> <name>jpaService</name> <init>= <expr><call><name><name>Services</name><operator>.</operator><name>get</name></name><argument_list>()</argument_list></call><operator>.</operator><call><name>get</name><argument_list>(<argument><expr><name><name>JPAService</name><operator>.</operator><name>class</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name>assertNotNull</name><argument_list>(<argument><expr><name>jpaService</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <comment type="line">// update the status</comment>
        <expr_stmt><expr><call><name><name>coordJob</name><operator>.</operator><name>setStatus</name></name><argument_list>(<argument><expr><name><name>CoordinatorJob</name><operator>.</operator><name>Status</name><operator>.</operator><name>RUNNING</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>wfJob</name><operator>.</operator><name>setStatus</name></name><argument_list>(<argument><expr><name><name>WorkflowJob</name><operator>.</operator><name>Status</name><operator>.</operator><name>SUCCEEDED</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>action</name><operator>.</operator><name>setStatus</name></name><argument_list>(<argument><expr><name><name>WorkflowAction</name><operator>.</operator><name>Status</name><operator>.</operator><name>RUNNING</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <decl_stmt><decl><type><name><name>List</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name></type> <name>updateList</name> <init>= <expr><operator>new</operator> <call><name><name>ArrayList</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
        <comment type="line">// update the list for doing bulk writes</comment>
        <expr_stmt><expr><call><name><name>updateList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>coordJob</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>updateList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>wfJob</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>updateList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>action</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <decl_stmt><decl><type><name>BulkUpdateDeleteJPAExecutor</name></type> <name>bulkUpdateCmd</name> <init>= <expr><operator>new</operator> <call><name>BulkUpdateDeleteJPAExecutor</name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name><name>bulkUpdateCmd</name><operator>.</operator><name>setUpdateList</name></name><argument_list>(<argument><expr><name>updateList</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><name>bulkUpdateCmd</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <comment type="line">// check for expected status after running bulkUpdateJPA</comment>
        <expr_stmt><expr><name>coordJob</name> <operator>=</operator> <call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>CoordJobGetJPAExecutor</name><argument_list>(<argument><expr><call><name><name>coordJob</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>assertEquals</name><argument_list>(<argument><expr><literal type="string">"RUNNING"</literal></expr></argument>, <argument><expr><call><name><name>coordJob</name><operator>.</operator><name>getStatusStr</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <expr_stmt><expr><name>wfJob</name> <operator>=</operator> <call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>WorkflowJobGetJPAExecutor</name><argument_list>(<argument><expr><call><name><name>wfJob</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>assertEquals</name><argument_list>(<argument><expr><literal type="string">"SUCCEEDED"</literal></expr></argument>, <argument><expr><call><name><name>wfJob</name><operator>.</operator><name>getStatusStr</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <decl_stmt><decl><type><name>WorkflowActionBean</name></type> <name>action2</name> <init>= <expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>WorkflowActionGetJPAExecutor</name><argument_list>(<argument><expr><call><name><name>action</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name>assertEquals</name><argument_list>(<argument><expr><name><name>WorkflowAction</name><operator>.</operator><name>Status</name><operator>.</operator><name>RUNNING</name></name></expr></argument>, <argument><expr><call><name><name>action2</name><operator>.</operator><name>getStatus</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>

    </block_content>}</block></function>

    <comment type="block" format="javadoc">/**
     * Test bulk deletes by deleting a coord action and a wf action
     * @throws Exception
     */</comment>
    <function><type><specifier>public</specifier> <name>void</name></type> <name>testDeletes</name><parameter_list>()</parameter_list> <throws>throws <argument><expr><name>Exception</name></expr></argument></throws><block>{<block_content>
        <decl_stmt><decl><type><name>CoordinatorActionBean</name></type> <name>action1</name> <init>= <expr><call><name>addRecordToCoordActionTable</name><argument_list>(<argument><expr><literal type="string">"000-123-C"</literal></expr></argument>, <argument><expr><literal type="number">1</literal></expr></argument>, <argument><expr><name><name>CoordinatorAction</name><operator>.</operator><name>Status</name><operator>.</operator><name>KILLED</name></name></expr></argument>, <argument><expr><literal type="string">"coord-action-get.xml"</literal></expr></argument>, <argument><expr><literal type="number">0</literal></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <decl_stmt><decl><type><name>WorkflowActionBean</name></type> <name>action2</name> <init>= <expr><call><name>addRecordToWfActionTable</name><argument_list>(<argument><expr><literal type="string">"000-123-W"</literal></expr></argument>, <argument><expr><literal type="string">"2"</literal></expr></argument>, <argument><expr><name><name>WorkflowAction</name><operator>.</operator><name>Status</name><operator>.</operator><name>PREP</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <decl_stmt><decl><type><name>JPAService</name></type> <name>jpaService</name> <init>= <expr><call><name><name>Services</name><operator>.</operator><name>get</name></name><argument_list>()</argument_list></call><operator>.</operator><call><name>get</name><argument_list>(<argument><expr><name><name>JPAService</name><operator>.</operator><name>class</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name>assertNotNull</name><argument_list>(<argument><expr><name>jpaService</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <decl_stmt><decl><type><name><name>List</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name></type> <name>deleteList</name> <init>= <expr><operator>new</operator> <call><name><name>ArrayList</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
        <comment type="line">// insert one workflow job and two actions</comment>
        <expr_stmt><expr><call><name><name>deleteList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>action1</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>deleteList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>action2</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <decl_stmt><decl><type><name>BulkUpdateDeleteJPAExecutor</name></type> <name>bulkDelRerunCmd</name> <init>= <expr><operator>new</operator> <call><name>BulkUpdateDeleteJPAExecutor</name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name><name>bulkDelRerunCmd</name><operator>.</operator><name>setDeleteList</name></name><argument_list>(<argument><expr><name>deleteList</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><name>bulkDelRerunCmd</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <comment type="line">// check for non existence after running bulkDeleteJPA</comment>
        <try>try <block>{<block_content>
            <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>CoordActionGetJPAExecutor</name><argument_list>(<argument><expr><call><name><name>action1</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name>fail</name><argument_list>()</argument_list></call></expr>;</expr_stmt> <comment type="line">//should not be found</comment>
        </block_content>}</block>
        <catch>catch<parameter_list>(<parameter><decl><type><name>JPAExecutorException</name></type> <name>jex</name></decl></parameter>)</parameter_list> <block>{<block_content>
            <expr_stmt><expr><call><name>assertEquals</name><argument_list>(<argument><expr><name><name>ErrorCode</name><operator>.</operator><name>E0605</name></name></expr></argument>, <argument><expr><call><name><name>jex</name><operator>.</operator><name>getErrorCode</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        </block_content>}</block></catch></try>
        <try>try <block>{<block_content>
            <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>WorkflowActionGetJPAExecutor</name><argument_list>(<argument><expr><call><name><name>action2</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name>fail</name><argument_list>()</argument_list></call></expr>;</expr_stmt> <comment type="line">//should not be found</comment>
        </block_content>}</block>
        <catch>catch<parameter_list>(<parameter><decl><type><name>JPAExecutorException</name></type> <name>jex</name></decl></parameter>)</parameter_list> <block>{<block_content>
            <expr_stmt><expr><call><name>assertEquals</name><argument_list>(<argument><expr><name><name>ErrorCode</name><operator>.</operator><name>E0605</name></name></expr></argument>, <argument><expr><call><name><name>jex</name><operator>.</operator><name>getErrorCode</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        </block_content>}</block></catch></try>
    </block_content>}</block></function>

    <comment type="block" format="javadoc">/**
     * Test bulk updates and deletes
     * workflow job and action
     *
     * @throws Exception
     */</comment>
    <function><type><specifier>public</specifier> <name>void</name></type> <name>testBulkUpdatesDeletes</name><parameter_list>()</parameter_list> <throws>throws <argument><expr><name>Exception</name></expr></argument></throws><block>{<block_content>
        <decl_stmt><decl><type><name>WorkflowJobBean</name></type> <name>job</name> <init>= <expr><call><name>addRecordToWfJobTable</name><argument_list>(<argument><expr><name><name>WorkflowJob</name><operator>.</operator><name>Status</name><operator>.</operator><name>KILLED</name></name></expr></argument>, <argument><expr><name><name>WorkflowInstance</name><operator>.</operator><name>Status</name><operator>.</operator><name>KILLED</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <decl_stmt><decl><type><name>WorkflowActionBean</name></type> <name>action</name> <init>= <expr><call><name>addRecordToWfActionTable</name><argument_list>(<argument><expr><call><name><name>job</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><literal type="string">"1"</literal></expr></argument>, <argument><expr><name><name>WorkflowAction</name><operator>.</operator><name>Status</name><operator>.</operator><name>PREP</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <decl_stmt><decl><type><name>JPAService</name></type> <name>jpaService</name> <init>= <expr><call><name><name>Services</name><operator>.</operator><name>get</name></name><argument_list>()</argument_list></call><operator>.</operator><call><name>get</name><argument_list>(<argument><expr><name><name>JPAService</name><operator>.</operator><name>class</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name>assertNotNull</name><argument_list>(<argument><expr><name>jpaService</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <expr_stmt><expr><call><name><name>job</name><operator>.</operator><name>setStatus</name></name><argument_list>(<argument><expr><name><name>WorkflowJob</name><operator>.</operator><name>Status</name><operator>.</operator><name>RUNNING</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <decl_stmt><decl><type><name><name>List</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name></type> <name>updateList</name> <init>= <expr><operator>new</operator> <call><name><name>ArrayList</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
        <comment type="line">// Add job to update</comment>
        <expr_stmt><expr><call><name><name>updateList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>job</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <decl_stmt><decl><type><name><name>List</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name></type> <name>deleteList</name> <init>= <expr><operator>new</operator> <call><name><name>ArrayList</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
        <comment type="line">//Add action to delete</comment>
        <expr_stmt><expr><call><name><name>deleteList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>action</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <decl_stmt><decl><type><name>BulkUpdateDeleteJPAExecutor</name></type> <name>bulkDelRerunCmd</name> <init>= <expr><operator>new</operator> <call><name>BulkUpdateDeleteJPAExecutor</name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name><name>bulkDelRerunCmd</name><operator>.</operator><name>setUpdateList</name></name><argument_list>(<argument><expr><name>updateList</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>bulkDelRerunCmd</name><operator>.</operator><name>setDeleteList</name></name><argument_list>(<argument><expr><name>deleteList</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><name>bulkDelRerunCmd</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <comment type="line">// check for update after running bulkJPA. job should be updated from KILLED -&gt; RUNING</comment>
        <expr_stmt><expr><name>job</name> <operator>=</operator> <call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>WorkflowJobGetJPAExecutor</name><argument_list>(<argument><expr><call><name><name>job</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>assertEquals</name><argument_list>(<argument><expr><literal type="string">"RUNNING"</literal></expr></argument>, <argument><expr><call><name><name>job</name><operator>.</operator><name>getStatusStr</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <comment type="line">// check for non existence after running bulkJPA</comment>
        <try>try <block>{<block_content>
            <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>WorkflowActionGetJPAExecutor</name><argument_list>(<argument><expr><call><name><name>action</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name>fail</name><argument_list>()</argument_list></call></expr>;</expr_stmt> <comment type="line">//should not be found</comment>
        </block_content>}</block>
        <catch>catch<parameter_list>(<parameter><decl><type><name>JPAExecutorException</name></type> <name>jex</name></decl></parameter>)</parameter_list> <block>{<block_content>
            <expr_stmt><expr><call><name>assertEquals</name><argument_list>(<argument><expr><name><name>ErrorCode</name><operator>.</operator><name>E0605</name></name></expr></argument>, <argument><expr><call><name><name>jex</name><operator>.</operator><name>getErrorCode</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        </block_content>}</block></catch></try>
    </block_content>}</block></function>

    <comment type="block" format="javadoc">/**
     * Test bulk updates and deletes rollback
     *
     * @throws Exception
     */</comment>
    <function><type><specifier>public</specifier> <name>void</name></type> <name>testBulkUpdatesDeletesRollback</name><parameter_list>()</parameter_list> <throws>throws <argument><expr><name>Exception</name></expr></argument></throws><block>{<block_content>
        <decl_stmt><decl><type><name>WorkflowJobBean</name></type> <name>job</name> <init>= <expr><call><name>addRecordToWfJobTable</name><argument_list>(<argument><expr><name><name>WorkflowJob</name><operator>.</operator><name>Status</name><operator>.</operator><name>PREP</name></name></expr></argument>, <argument><expr><name><name>WorkflowInstance</name><operator>.</operator><name>Status</name><operator>.</operator><name>PREP</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <decl_stmt><decl><type><name>WorkflowActionBean</name></type> <name>action1</name> <init>= <expr><call><name>addRecordToWfActionTable</name><argument_list>(<argument><expr><call><name><name>job</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><literal type="string">"1"</literal></expr></argument>, <argument><expr><name><name>WorkflowAction</name><operator>.</operator><name>Status</name><operator>.</operator><name>PREP</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <decl_stmt><decl><type><name>WorkflowActionBean</name></type> <name>action2</name> <init>= <expr><call><name>addRecordToWfActionTable</name><argument_list>(<argument><expr><call><name><name>job</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><literal type="string">"2"</literal></expr></argument>, <argument><expr><name><name>WorkflowAction</name><operator>.</operator><name>Status</name><operator>.</operator><name>PREP</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>

        <expr_stmt><expr><call><name><name>job</name><operator>.</operator><name>setStatus</name></name><argument_list>(<argument><expr><name><name>WorkflowJob</name><operator>.</operator><name>Status</name><operator>.</operator><name>RUNNING</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <decl_stmt><decl><type><name><name>List</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name></type> <name>deleteList</name> <init>= <expr><operator>new</operator> <call><name><name>ArrayList</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
        <comment type="line">// Add two actions to delete list</comment>
        <expr_stmt><expr><call><name><name>deleteList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>action1</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>deleteList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>action2</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <decl_stmt><decl><type><name><name>List</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name></type> <name>updateList</name> <init>= <expr><operator>new</operator> <call><name><name>ArrayList</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
        <comment type="line">// Add to update list</comment>
        <expr_stmt><expr><call><name><name>updateList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>job</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <decl_stmt><decl><type><name>JPAService</name></type> <name>jpaService</name> <init>= <expr><call><name><name>Services</name><operator>.</operator><name>get</name></name><argument_list>()</argument_list></call><operator>.</operator><call><name>get</name><argument_list>(<argument><expr><name><name>JPAService</name><operator>.</operator><name>class</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name>assertNotNull</name><argument_list>(<argument><expr><name>jpaService</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <decl_stmt><decl><type><name>BulkUpdateDeleteJPAExecutor</name></type> <name>wfUpdateCmd1</name> <init>= <expr><operator>new</operator> <call><name>BulkUpdateDeleteJPAExecutor</name><argument_list>(<argument><expr><name>updateList</name></expr></argument>, <argument><expr><name>deleteList</name></expr></argument>, <argument><expr><literal type="boolean">true</literal></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>

        <comment type="line">// set fault injection to true, so transaction is roll backed</comment>
        <expr_stmt><expr><call><name>setSystemProperty</name><argument_list>(<argument><expr><name><name>FaultInjection</name><operator>.</operator><name>FAULT_INJECTION</name></name></expr></argument>, <argument><expr><literal type="string">"true"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>setSystemProperty</name><argument_list>(<argument><expr><name><name>SkipCommitFaultInjection</name><operator>.</operator><name>ACTION_FAILOVER_FAULT_INJECTION</name></name></expr></argument>, <argument><expr><literal type="string">"true"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <try>try <block>{<block_content>
            <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><name>wfUpdateCmd1</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name>fail</name><argument_list>(<argument><expr><literal type="string">"Expected exception due to commit failure but didn't get any"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        </block_content>}</block>
        <catch>catch <parameter_list>(<parameter><decl><type><name>Exception</name></type> <name>e</name></decl></parameter>)</parameter_list> <block>{<block_content>
        </block_content>}</block></catch></try>
        <expr_stmt><expr><call><name><name>FaultInjection</name><operator>.</operator><name>deactivate</name></name><argument_list>(<argument><expr><literal type="string">"org.apache.oozie.command.SkipCommitFaultInjection"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <comment type="line">// Check whether transactions are rolled back or not</comment>
        <decl_stmt><decl><type><name>WorkflowJobGetJPAExecutor</name></type> <name>wfGetCmd</name> <init>= <expr><operator>new</operator> <call><name>WorkflowJobGetJPAExecutor</name><argument_list>(<argument><expr><call><name><name>job</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <decl_stmt><decl><type><name>WorkflowJobBean</name></type> <name>wfBean</name> <init>= <expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><name>wfGetCmd</name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <comment type="line">// status should NOT be RUNNING</comment>
        <expr_stmt><expr><call><name>assertEquals</name><argument_list>(<argument><expr><literal type="string">"PREP"</literal></expr></argument>, <argument><expr><call><name><name>wfBean</name><operator>.</operator><name>getStatusStr</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <try>try <block>{<block_content>
            <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>WorkflowActionGetJPAExecutor</name><argument_list>(<argument><expr><call><name><name>action1</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        </block_content>}</block>
        <catch>catch <parameter_list>(<parameter><decl><type><name>JPAExecutorException</name></type> <name>je</name></decl></parameter>)</parameter_list> <block>{<block_content>
            <expr_stmt><expr><call><name>fail</name><argument_list>(<argument><expr><literal type="string">"WF action should not be removed due to rollback but was not found"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        </block_content>}</block></catch></try>

        <try>try <block>{<block_content>
            <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>WorkflowActionGetJPAExecutor</name><argument_list>(<argument><expr><call><name><name>action2</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        </block_content>}</block>
        <catch>catch <parameter_list>(<parameter><decl><type><name>JPAExecutorException</name></type> <name>je</name></decl></parameter>)</parameter_list> <block>{<block_content>
            <expr_stmt><expr><call><name>fail</name><argument_list>(<argument><expr><literal type="string">"WF action should not be removed due to rollback but was not found"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        </block_content>}</block></catch></try>
    </block_content>}</block></function>

}</block></class>
<expr_stmt><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>test</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>executor</name><operator>/</operator><name>jpa</name><operator>/</operator><name><name>TestBulkUpdateInsertForCoordActionStartJPAExecutor</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>test</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>executor</name><operator>/</operator><name>jpa</name><operator>/</operator><name><name>TestBulkUpdateInsertForCoordActionStartJPAExecutor</name><operator>.</operator><name>java</name></name>
<operator>new</operator> <name>file</name> <name>mode</name> <literal type="number">100644</literal>
<name>index</name> <literal type="number">000000000..6da37ec67</literal>
<operator>--</operator> <operator>/</operator><name>dev</name><operator>/</operator><literal type="null">null</literal>
<operator>++</operator> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>test</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>executor</name><operator>/</operator><name>jpa</name><operator>/</operator><name><name>TestBulkUpdateInsertForCoordActionStartJPAExecutor</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">0</literal></expr><operator>,</operator><expr><literal type="number">0</literal> <operator>+</operator><literal type="number">1</literal></expr><operator>,</operator><expr><literal type="number">260</literal> @@</expr></expr_stmt>
<comment type="block" format="javadoc">/**
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */</comment>
<package>package <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name></name>;</package>

<import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>ArrayList</name></name>;</import>
<import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>List</name></name>;</import>

<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>hadoop</name><operator>.</operator><name>conf</name><operator>.</operator><name>Configuration</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>hadoop</name><operator>.</operator><name>fs</name><operator>.</operator><name>Path</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>CoordinatorJobBean</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>ErrorCode</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>FaultInjection</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>WorkflowActionBean</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>WorkflowJobBean</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>CoordinatorJob</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>Job</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>OozieClient</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>WorkflowAction</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>WorkflowJob</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>rest</name><operator>.</operator><name>JsonBean</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>SkipCommitFaultInjection</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>WorkflowJobGetJPAExecutor</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>JPAService</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>LiteWorkflowStoreService</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>Services</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>test</name><operator>.</operator><name>XDataTestCase</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>workflow</name><operator>.</operator><name>WorkflowApp</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>workflow</name><operator>.</operator><name>WorkflowInstance</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>workflow</name><operator>.</operator><name>lite</name><operator>.</operator><name>EndNodeDef</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>workflow</name><operator>.</operator><name>lite</name><operator>.</operator><name>LiteWorkflowApp</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>workflow</name><operator>.</operator><name>lite</name><operator>.</operator><name>StartNodeDef</name></name>;</import>

<comment type="block" format="javadoc">/**
 * Testcases for bulk JPA writes - insert and update operations for Coord Action
 * Start command
 */</comment>
<class><specifier>public</specifier> class <name>TestBulkUpdateInsertForCoordActionStartJPAExecutor</name> <super_list><extends>extends <super><name>XDataTestCase</name></super></extends></super_list> <block>{
    <decl_stmt><decl><type><name>Services</name></type> <name>services</name></decl>;</decl_stmt>

    <function><annotation>@<name>Override</name></annotation>
    <type><specifier>protected</specifier> <name>void</name></type> <name>setUp</name><parameter_list>()</parameter_list> <throws>throws <argument><expr><name>Exception</name></expr></argument></throws> <block>{<block_content>
        <expr_stmt><expr><call><name><name>super</name><operator>.</operator><name>setUp</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><name>services</name> <operator>=</operator> <operator>new</operator> <call><name>Services</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>services</name><operator>.</operator><name>init</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>cleanUpDBTables</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
    </block_content>}</block></function>

    <function><annotation>@<name>Override</name></annotation>
    <type><specifier>protected</specifier> <name>void</name></type> <name>tearDown</name><parameter_list>()</parameter_list> <throws>throws <argument><expr><name>Exception</name></expr></argument></throws> <block>{<block_content>
        <expr_stmt><expr><call><name><name>services</name><operator>.</operator><name>destroy</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>super</name><operator>.</operator><name>tearDown</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
    </block_content>}</block></function>

    <comment type="block" format="javadoc">/**
     * Test bulk updates by updating coordinator job, workflow job and workflow action
     * @throws Exception
     */</comment>
    <function><type><specifier>public</specifier> <name>void</name></type> <name>testUpdates</name><parameter_list>()</parameter_list> <throws>throws <argument><expr><name>Exception</name></expr></argument></throws> <block>{<block_content>
        <decl_stmt><decl><type><name>CoordinatorJobBean</name></type> <name>coordJob</name> <init>= <expr><call><name>addRecordToCoordJobTable</name><argument_list>(<argument><expr><name><name>CoordinatorJob</name><operator>.</operator><name>Status</name><operator>.</operator><name>PREP</name></name></expr></argument>, <argument><expr><literal type="boolean">true</literal></expr></argument>, <argument><expr><literal type="boolean">true</literal></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <decl_stmt><decl><type><name>WorkflowJobBean</name></type> <name>wfJob</name> <init>= <expr><call><name>addRecordToWfJobTable</name><argument_list>(<argument><expr><name><name>WorkflowJob</name><operator>.</operator><name>Status</name><operator>.</operator><name>PREP</name></name></expr></argument>, <argument><expr><name><name>WorkflowInstance</name><operator>.</operator><name>Status</name><operator>.</operator><name>PREP</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <decl_stmt><decl><type><name>WorkflowActionBean</name></type> <name>action</name> <init>= <expr><call><name>addRecordToWfActionTable</name><argument_list>(<argument><expr><call><name><name>wfJob</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><literal type="string">"1"</literal></expr></argument>, <argument><expr><name><name>WorkflowAction</name><operator>.</operator><name>Status</name><operator>.</operator><name>PREP</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <decl_stmt><decl><type><name>JPAService</name></type> <name>jpaService</name> <init>= <expr><call><name><name>Services</name><operator>.</operator><name>get</name></name><argument_list>()</argument_list></call><operator>.</operator><call><name>get</name><argument_list>(<argument><expr><name><name>JPAService</name><operator>.</operator><name>class</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name>assertNotNull</name><argument_list>(<argument><expr><name>jpaService</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <comment type="line">// update the status</comment>
        <expr_stmt><expr><call><name><name>coordJob</name><operator>.</operator><name>setStatus</name></name><argument_list>(<argument><expr><name><name>CoordinatorJob</name><operator>.</operator><name>Status</name><operator>.</operator><name>RUNNING</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>wfJob</name><operator>.</operator><name>setStatus</name></name><argument_list>(<argument><expr><name><name>WorkflowJob</name><operator>.</operator><name>Status</name><operator>.</operator><name>SUCCEEDED</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>action</name><operator>.</operator><name>setStatus</name></name><argument_list>(<argument><expr><name><name>WorkflowAction</name><operator>.</operator><name>Status</name><operator>.</operator><name>RUNNING</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <decl_stmt><decl><type><name><name>List</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name></type> <name>updateList</name> <init>= <expr><operator>new</operator> <call><name><name>ArrayList</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
        <comment type="line">// update the list for doing bulk writes</comment>
        <expr_stmt><expr><call><name><name>updateList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>coordJob</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>updateList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>wfJob</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>updateList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>action</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <decl_stmt><decl><type><name>BulkUpdateInsertForCoordActionStartJPAExecutor</name></type> <name>bulkUpdateCmd</name> <init>= <expr><operator>new</operator> <call><name>BulkUpdateInsertForCoordActionStartJPAExecutor</name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name><name>bulkUpdateCmd</name><operator>.</operator><name>setUpdateList</name></name><argument_list>(<argument><expr><name>updateList</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><name>bulkUpdateCmd</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <comment type="line">// check for expected status after running bulkUpdateJPA</comment>
        <expr_stmt><expr><name>coordJob</name> <operator>=</operator> <call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>CoordJobGetJPAExecutor</name><argument_list>(<argument><expr><call><name><name>coordJob</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>assertEquals</name><argument_list>(<argument><expr><literal type="string">"RUNNING"</literal></expr></argument>, <argument><expr><call><name><name>coordJob</name><operator>.</operator><name>getStatusStr</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <expr_stmt><expr><name>wfJob</name> <operator>=</operator> <call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>WorkflowJobGetJPAExecutor</name><argument_list>(<argument><expr><call><name><name>wfJob</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>assertEquals</name><argument_list>(<argument><expr><literal type="string">"SUCCEEDED"</literal></expr></argument>, <argument><expr><call><name><name>wfJob</name><operator>.</operator><name>getStatusStr</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <decl_stmt><decl><type><name>WorkflowActionBean</name></type> <name>action2</name> <init>= <expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>WorkflowActionGetJPAExecutor</name><argument_list>(<argument><expr><call><name><name>action</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name>assertEquals</name><argument_list>(<argument><expr><name><name>WorkflowAction</name><operator>.</operator><name>Status</name><operator>.</operator><name>RUNNING</name></name></expr></argument>, <argument><expr><call><name><name>action2</name><operator>.</operator><name>getStatus</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>

    </block_content>}</block></function>

    <comment type="block" format="javadoc">/**
     * Test bulk inserts by inserting a workflow job and two workflow actions
     * @throws Exception
     */</comment>
    <function><type><specifier>public</specifier> <name>void</name></type> <name>testInserts</name><parameter_list>()</parameter_list> <throws>throws <argument><expr><name>Exception</name></expr></argument></throws><block>{<block_content>
        <decl_stmt><decl><type><name>WorkflowApp</name></type> <name>app</name> <init>= <expr><operator>new</operator> <call><name>LiteWorkflowApp</name><argument_list>(<argument><expr><literal type="string">"testApp"</literal></expr></argument>, <argument><expr><literal type="string">"&lt;workflow-app/&gt;"</literal></expr></argument>,
            <argument><expr><operator>new</operator> <call><name>StartNodeDef</name><argument_list>(<argument><expr><name><name>LiteWorkflowStoreService</name><operator>.</operator><name>LiteControlNodeHandler</name><operator>.</operator><name>class</name></name></expr></argument>, <argument><expr><literal type="string">"end"</literal></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call>
                <operator>.</operator><call><name>addNode</name><argument_list>(<argument><expr><operator>new</operator> <call><name>EndNodeDef</name><argument_list>(<argument><expr><literal type="string">"end"</literal></expr></argument>, <argument><expr><name><name>LiteWorkflowStoreService</name><operator>.</operator><name>LiteControlNodeHandler</name><operator>.</operator><name>class</name></name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <decl_stmt><decl><type><name>Configuration</name></type> <name>conf</name> <init>= <expr><operator>new</operator> <call><name>Configuration</name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
        <decl_stmt><decl><type><name>Path</name></type> <name>appUri</name> <init>= <expr><operator>new</operator> <call><name>Path</name><argument_list>(<argument><expr><call><name>getAppPath</name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><literal type="string">"workflow.xml"</literal></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name><name>conf</name><operator>.</operator><name>set</name></name><argument_list>(<argument><expr><name><name>OozieClient</name><operator>.</operator><name>APP_PATH</name></name></expr></argument>, <argument><expr><call><name><name>appUri</name><operator>.</operator><name>toString</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>conf</name><operator>.</operator><name>set</name></name><argument_list>(<argument><expr><name><name>OozieClient</name><operator>.</operator><name>LOG_TOKEN</name></name></expr></argument>, <argument><expr><literal type="string">"testToken"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>conf</name><operator>.</operator><name>set</name></name><argument_list>(<argument><expr><name><name>OozieClient</name><operator>.</operator><name>USER_NAME</name></name></expr></argument>, <argument><expr><call><name>getTestUser</name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <decl_stmt><decl><type><name>WorkflowJobBean</name></type> <name>job</name> <init>= <expr><call><name>createWorkflow</name><argument_list>(<argument><expr><name>app</name></expr></argument>, <argument><expr><name>conf</name></expr></argument>, <argument><expr><literal type="string">"auth"</literal></expr></argument>, <argument><expr><name><name>WorkflowJob</name><operator>.</operator><name>Status</name><operator>.</operator><name>PREP</name></name></expr></argument>, <argument><expr><name><name>WorkflowInstance</name><operator>.</operator><name>Status</name><operator>.</operator><name>PREP</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <decl_stmt><decl><type><name>WorkflowActionBean</name></type> <name>action1</name> <init>= <expr><call><name>createWorkflowAction</name><argument_list>(<argument><expr><call><name><name>job</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><literal type="string">"1"</literal></expr></argument>, <argument><expr><name><name>WorkflowAction</name><operator>.</operator><name>Status</name><operator>.</operator><name>PREP</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <decl_stmt><decl><type><name>WorkflowActionBean</name></type> <name>action2</name> <init>= <expr><call><name>createWorkflowAction</name><argument_list>(<argument><expr><call><name><name>job</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><literal type="string">"2"</literal></expr></argument>, <argument><expr><name><name>WorkflowAction</name><operator>.</operator><name>Status</name><operator>.</operator><name>PREP</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>

        <decl_stmt><decl><type><name><name>List</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name></type> <name>insertList</name> <init>= <expr><operator>new</operator> <call><name><name>ArrayList</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
        <comment type="line">// insert one workflow job and two actions</comment>
        <expr_stmt><expr><call><name><name>insertList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>action1</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>insertList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>action2</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>insertList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>job</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <decl_stmt><decl><type><name>JPAService</name></type> <name>jpaService</name> <init>= <expr><call><name><name>Services</name><operator>.</operator><name>get</name></name><argument_list>()</argument_list></call><operator>.</operator><call><name>get</name><argument_list>(<argument><expr><name><name>JPAService</name><operator>.</operator><name>class</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name>assertNotNull</name><argument_list>(<argument><expr><name>jpaService</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <decl_stmt><decl><type><name>BulkUpdateInsertForCoordActionStartJPAExecutor</name></type> <name>bulkInsertCmd</name> <init>= <expr><operator>new</operator> <call><name>BulkUpdateInsertForCoordActionStartJPAExecutor</name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name><name>bulkInsertCmd</name><operator>.</operator><name>setInsertList</name></name><argument_list>(<argument><expr><name>insertList</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><name>bulkInsertCmd</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <comment type="line">// check for expected status after running bulkUpdateJPA</comment>
        <decl_stmt><decl><type><name>WorkflowActionGetJPAExecutor</name></type> <name>actionGetCmd</name> <init>= <expr><operator>new</operator> <call><name>WorkflowActionGetJPAExecutor</name><argument_list>(<argument><expr><call><name><name>action1</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><name>action1</name> <operator>=</operator> <call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><name>actionGetCmd</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>assertEquals</name><argument_list>(<argument><expr><literal type="string">"PREP"</literal></expr></argument>, <argument><expr><call><name><name>action1</name><operator>.</operator><name>getStatusStr</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <expr_stmt><expr><name>actionGetCmd</name> <operator>=</operator> <operator>new</operator> <call><name>WorkflowActionGetJPAExecutor</name><argument_list>(<argument><expr><call><name><name>action2</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><name>action2</name> <operator>=</operator> <call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><name>actionGetCmd</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>assertEquals</name><argument_list>(<argument><expr><literal type="string">"PREP"</literal></expr></argument>, <argument><expr><call><name><name>action2</name><operator>.</operator><name>getStatusStr</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <decl_stmt><decl><type><name>WorkflowJobGetJPAExecutor</name></type> <name>wfGetCmd</name> <init>= <expr><operator>new</operator> <call><name>WorkflowJobGetJPAExecutor</name><argument_list>(<argument><expr><call><name><name>job</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><name>job</name> <operator>=</operator> <call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><name>wfGetCmd</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>assertEquals</name><argument_list>(<argument><expr><literal type="string">"PREP"</literal></expr></argument>, <argument><expr><call><name><name>job</name><operator>.</operator><name>getStatusStr</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>

    </block_content>}</block></function>

    <comment type="block" format="javadoc">/**
     * Test bulk inserts and updates by inserting wf actions and updating
     * coordinator and workflow jobs
     *
     * @throws Exception
     */</comment>
    <function><type><specifier>public</specifier> <name>void</name></type> <name>testBulkInsertUpdates</name><parameter_list>()</parameter_list> <throws>throws <argument><expr><name>Exception</name></expr></argument></throws><block>{<block_content>
        <decl_stmt><decl><type><name>CoordinatorJobBean</name></type> <name>coordJob</name> <init>= <expr><call><name>addRecordToCoordJobTable</name><argument_list>(<argument><expr><name><name>CoordinatorJob</name><operator>.</operator><name>Status</name><operator>.</operator><name>PREP</name></name></expr></argument>, <argument><expr><literal type="boolean">true</literal></expr></argument>, <argument><expr><literal type="boolean">true</literal></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <decl_stmt><decl><type><name>WorkflowJobBean</name></type> <name>job</name> <init>= <expr><call><name>addRecordToWfJobTable</name><argument_list>(<argument><expr><name><name>WorkflowJob</name><operator>.</operator><name>Status</name><operator>.</operator><name>PREP</name></name></expr></argument>, <argument><expr><name><name>WorkflowInstance</name><operator>.</operator><name>Status</name><operator>.</operator><name>PREP</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <decl_stmt><decl><type><name>WorkflowActionBean</name></type> <name>action1</name> <init>= <expr><call><name>createWorkflowAction</name><argument_list>(<argument><expr><call><name><name>job</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><literal type="string">"1"</literal></expr></argument>, <argument><expr><name><name>WorkflowAction</name><operator>.</operator><name>Status</name><operator>.</operator><name>PREP</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <decl_stmt><decl><type><name>WorkflowActionBean</name></type> <name>action2</name> <init>= <expr><call><name>createWorkflowAction</name><argument_list>(<argument><expr><call><name><name>job</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><literal type="string">"2"</literal></expr></argument>, <argument><expr><name><name>WorkflowAction</name><operator>.</operator><name>Status</name><operator>.</operator><name>PREP</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>

        <expr_stmt><expr><call><name><name>job</name><operator>.</operator><name>setStatus</name></name><argument_list>(<argument><expr><name><name>WorkflowJob</name><operator>.</operator><name>Status</name><operator>.</operator><name>RUNNING</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>coordJob</name><operator>.</operator><name>setStatus</name></name><argument_list>(<argument><expr><name><name>Job</name><operator>.</operator><name>Status</name><operator>.</operator><name>SUCCEEDED</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <decl_stmt><decl><type><name><name>List</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name></type> <name>insertList</name> <init>= <expr><operator>new</operator> <call><name><name>ArrayList</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
        <comment type="line">// Add two actions to insert list</comment>
        <expr_stmt><expr><call><name><name>insertList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>action1</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>insertList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>action2</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <decl_stmt><decl><type><name><name>List</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name></type> <name>updateList</name> <init>= <expr><operator>new</operator> <call><name><name>ArrayList</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
        <comment type="line">//Add two jobs to update list</comment>
        <expr_stmt><expr><call><name><name>updateList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>coordJob</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>updateList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>job</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <decl_stmt><decl><type><name>JPAService</name></type> <name>jpaService</name> <init>= <expr><call><name><name>Services</name><operator>.</operator><name>get</name></name><argument_list>()</argument_list></call><operator>.</operator><call><name>get</name><argument_list>(<argument><expr><name><name>JPAService</name><operator>.</operator><name>class</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name>assertNotNull</name><argument_list>(<argument><expr><name>jpaService</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <decl_stmt><decl><type><name>BulkUpdateInsertForCoordActionStartJPAExecutor</name></type> <name>bulkUpdateCmd</name> <init>= <expr><operator>new</operator> <call><name>BulkUpdateInsertForCoordActionStartJPAExecutor</name><argument_list>(<argument><expr><name>updateList</name></expr></argument>, <argument><expr><name>insertList</name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><name>bulkUpdateCmd</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <expr_stmt><expr><name>coordJob</name> <operator>=</operator> <call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>CoordJobGetJPAExecutor</name><argument_list>(<argument><expr><call><name><name>coordJob</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>assertEquals</name><argument_list>(<argument><expr><literal type="string">"SUCCEEDED"</literal></expr></argument>, <argument><expr><call><name><name>coordJob</name><operator>.</operator><name>getStatusStr</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <decl_stmt><decl><type><name>WorkflowJobGetJPAExecutor</name></type> <name>wfGetCmd</name> <init>= <expr><operator>new</operator> <call><name>WorkflowJobGetJPAExecutor</name><argument_list>(<argument><expr><call><name><name>job</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <decl_stmt><decl><type><name>WorkflowJobBean</name></type> <name>wfBean</name> <init>= <expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><name>wfGetCmd</name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name>assertEquals</name><argument_list>(<argument><expr><literal type="string">"RUNNING"</literal></expr></argument>, <argument><expr><call><name><name>wfBean</name><operator>.</operator><name>getStatusStr</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <decl_stmt><decl><type><name>WorkflowActionGetJPAExecutor</name></type> <name>actionGetCmd</name> <init>= <expr><operator>new</operator> <call><name>WorkflowActionGetJPAExecutor</name><argument_list>(<argument><expr><call><name><name>action1</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><name>action1</name> <operator>=</operator> <call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><name>actionGetCmd</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>assertEquals</name><argument_list>(<argument><expr><literal type="string">"PREP"</literal></expr></argument>, <argument><expr><call><name><name>action1</name><operator>.</operator><name>getStatusStr</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <expr_stmt><expr><name>actionGetCmd</name> <operator>=</operator> <operator>new</operator> <call><name>WorkflowActionGetJPAExecutor</name><argument_list>(<argument><expr><call><name><name>action2</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><name>action2</name> <operator>=</operator> <call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><name>actionGetCmd</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>assertEquals</name><argument_list>(<argument><expr><literal type="string">"PREP"</literal></expr></argument>, <argument><expr><call><name><name>action2</name><operator>.</operator><name>getStatusStr</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    </block_content>}</block></function>

    <comment type="block" format="javadoc">/**
     * Test bulk inserts and updates rollback
     *
     * @throws Exception
     */</comment>
    <function><type><specifier>public</specifier> <name>void</name></type> <name>testBulkInsertUpdatesRollback</name><parameter_list>()</parameter_list> <throws>throws <argument><expr><name>Exception</name></expr></argument></throws><block>{<block_content>
        <decl_stmt><decl><type><name>WorkflowJobBean</name></type> <name>job</name> <init>= <expr><call><name>addRecordToWfJobTable</name><argument_list>(<argument><expr><name><name>WorkflowJob</name><operator>.</operator><name>Status</name><operator>.</operator><name>PREP</name></name></expr></argument>, <argument><expr><name><name>WorkflowInstance</name><operator>.</operator><name>Status</name><operator>.</operator><name>PREP</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <decl_stmt><decl><type><name>WorkflowActionBean</name></type> <name>action1</name> <init>= <expr><call><name>createWorkflowAction</name><argument_list>(<argument><expr><call><name><name>job</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><literal type="string">"1"</literal></expr></argument>, <argument><expr><name><name>WorkflowAction</name><operator>.</operator><name>Status</name><operator>.</operator><name>PREP</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <decl_stmt><decl><type><name>WorkflowActionBean</name></type> <name>action2</name> <init>= <expr><call><name>createWorkflowAction</name><argument_list>(<argument><expr><call><name><name>job</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><literal type="string">"2"</literal></expr></argument>, <argument><expr><name><name>WorkflowAction</name><operator>.</operator><name>Status</name><operator>.</operator><name>PREP</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>

        <expr_stmt><expr><call><name><name>job</name><operator>.</operator><name>setStatus</name></name><argument_list>(<argument><expr><name><name>WorkflowJob</name><operator>.</operator><name>Status</name><operator>.</operator><name>RUNNING</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <decl_stmt><decl><type><name><name>List</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name></type> <name>insertList</name> <init>= <expr><operator>new</operator> <call><name><name>ArrayList</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
        <comment type="line">// Add two actions to insert list</comment>
        <expr_stmt><expr><call><name><name>insertList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>action1</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>insertList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>action2</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <decl_stmt><decl><type><name><name>List</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name></type> <name>updateList</name> <init>= <expr><operator>new</operator> <call><name><name>ArrayList</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
        <comment type="line">// Add to update list</comment>
        <expr_stmt><expr><call><name><name>updateList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>job</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <decl_stmt><decl><type><name>JPAService</name></type> <name>jpaService</name> <init>= <expr><call><name><name>Services</name><operator>.</operator><name>get</name></name><argument_list>()</argument_list></call><operator>.</operator><call><name>get</name><argument_list>(<argument><expr><name><name>JPAService</name><operator>.</operator><name>class</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name>assertNotNull</name><argument_list>(<argument><expr><name>jpaService</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <decl_stmt><decl><type><name>BulkUpdateInsertForCoordActionStartJPAExecutor</name></type> <name>wfUpdateCmd1</name> <init>= <expr><operator>new</operator> <call><name>BulkUpdateInsertForCoordActionStartJPAExecutor</name><argument_list>(<argument><expr><name>updateList</name></expr></argument>, <argument><expr><name>insertList</name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>

        <comment type="line">// set fault injection to true, so transaction is roll backed</comment>
        <expr_stmt><expr><call><name>setSystemProperty</name><argument_list>(<argument><expr><name><name>FaultInjection</name><operator>.</operator><name>FAULT_INJECTION</name></name></expr></argument>, <argument><expr><literal type="string">"true"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>setSystemProperty</name><argument_list>(<argument><expr><name><name>SkipCommitFaultInjection</name><operator>.</operator><name>ACTION_FAILOVER_FAULT_INJECTION</name></name></expr></argument>, <argument><expr><literal type="string">"true"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <try>try <block>{<block_content>
            <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><name>wfUpdateCmd1</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name>fail</name><argument_list>(<argument><expr><literal type="string">"Expected exception due to commit failure but didn't get any"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        </block_content>}</block>
        <catch>catch <parameter_list>(<parameter><decl><type><name>Exception</name></type> <name>e</name></decl></parameter>)</parameter_list> <block>{<block_content>
        </block_content>}</block></catch></try>
        <expr_stmt><expr><call><name><name>FaultInjection</name><operator>.</operator><name>deactivate</name></name><argument_list>(<argument><expr><literal type="string">"org.apache.oozie.command.SkipCommitFaultInjection"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <comment type="line">// Check whether transactions are rolled back or not</comment>
        <decl_stmt><decl><type><name>WorkflowJobGetJPAExecutor</name></type> <name>wfGetCmd</name> <init>= <expr><operator>new</operator> <call><name>WorkflowJobGetJPAExecutor</name><argument_list>(<argument><expr><call><name><name>job</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <decl_stmt><decl><type><name>WorkflowJobBean</name></type> <name>wfBean</name> <init>= <expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><name>wfGetCmd</name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <comment type="line">// status should not be RUNNING</comment>
        <expr_stmt><expr><call><name>assertEquals</name><argument_list>(<argument><expr><literal type="string">"PREP"</literal></expr></argument>, <argument><expr><call><name><name>wfBean</name><operator>.</operator><name>getStatusStr</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <decl_stmt><decl><type><name>WorkflowActionGetJPAExecutor</name></type> <name>actionGetCmd</name> <init>= <expr><operator>new</operator> <call><name>WorkflowActionGetJPAExecutor</name><argument_list>(<argument><expr><call><name><name>action1</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <try>try <block>{<block_content>
            <expr_stmt><expr><name>action1</name> <operator>=</operator> <call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><name>actionGetCmd</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name>fail</name><argument_list>(<argument><expr><literal type="string">"Expected exception but didnt get any"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        </block_content>}</block>
        <catch>catch <parameter_list>(<parameter><decl><type><name>JPAExecutorException</name></type> <name>jpaee</name></decl></parameter>)</parameter_list> <block>{<block_content>
            <expr_stmt><expr><call><name>assertEquals</name><argument_list>(<argument><expr><name><name>ErrorCode</name><operator>.</operator><name>E0605</name></name></expr></argument>, <argument><expr><call><name><name>jpaee</name><operator>.</operator><name>getErrorCode</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        </block_content>}</block></catch></try>


        <expr_stmt><expr><name>actionGetCmd</name> <operator>=</operator> <operator>new</operator> <call><name>WorkflowActionGetJPAExecutor</name><argument_list>(<argument><expr><call><name><name>action2</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <try>try <block>{<block_content>
            <expr_stmt><expr><name>action2</name> <operator>=</operator> <call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><name>actionGetCmd</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name>fail</name><argument_list>(<argument><expr><literal type="string">"Expected exception but didnt get any"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        </block_content>}</block>
        <catch>catch <parameter_list>(<parameter><decl><type><name>JPAExecutorException</name></type> <name>jpaee</name></decl></parameter>)</parameter_list> <block>{<block_content>
            <expr_stmt><expr><call><name>assertEquals</name><argument_list>(<argument><expr><name><name>ErrorCode</name><operator>.</operator><name>E0605</name></name></expr></argument>, <argument><expr><call><name><name>jpaee</name><operator>.</operator><name>getErrorCode</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        </block_content>}</block></catch></try>

    </block_content>}</block></function>

}</block></class>
<expr_stmt><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>test</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>executor</name><operator>/</operator><name>jpa</name><operator>/</operator><name><name>TestBulkUpdateInsertForCoordActionStatusJPAExecutor</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>test</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>executor</name><operator>/</operator><name>jpa</name><operator>/</operator><name><name>TestBulkUpdateInsertForCoordActionStatusJPAExecutor</name><operator>.</operator><name>java</name></name>
<operator>new</operator> <name>file</name> <name>mode</name> <literal type="number">100644</literal>
<name>index</name> <literal type="number">000000000..2478c2dd1</literal>
<operator>--</operator> <operator>/</operator><name>dev</name><operator>/</operator><literal type="null">null</literal>
<operator>++</operator> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>test</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>executor</name><operator>/</operator><name>jpa</name><operator>/</operator><name><name>TestBulkUpdateInsertForCoordActionStatusJPAExecutor</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">0</literal></expr><operator>,</operator><expr><literal type="number">0</literal> <operator>+</operator><literal type="number">1</literal></expr><operator>,</operator><expr><literal type="number">260</literal> @@</expr></expr_stmt>
<comment type="block" format="javadoc">/**
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */</comment>
<package>package <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name></name>;</package>

<import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>ArrayList</name></name>;</import>
<import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>List</name></name>;</import>

<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>hadoop</name><operator>.</operator><name>conf</name><operator>.</operator><name>Configuration</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>hadoop</name><operator>.</operator><name>fs</name><operator>.</operator><name>Path</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>CoordinatorJobBean</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>ErrorCode</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>FaultInjection</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>WorkflowActionBean</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>WorkflowJobBean</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>CoordinatorJob</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>Job</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>OozieClient</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>WorkflowAction</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>WorkflowJob</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>rest</name><operator>.</operator><name>JsonBean</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>command</name><operator>.</operator><name>SkipCommitFaultInjection</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name><operator>.</operator><name>WorkflowJobGetJPAExecutor</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>JPAService</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>LiteWorkflowStoreService</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>Services</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>test</name><operator>.</operator><name>XDataTestCase</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>workflow</name><operator>.</operator><name>WorkflowApp</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>workflow</name><operator>.</operator><name>WorkflowInstance</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>workflow</name><operator>.</operator><name>lite</name><operator>.</operator><name>EndNodeDef</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>workflow</name><operator>.</operator><name>lite</name><operator>.</operator><name>LiteWorkflowApp</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>workflow</name><operator>.</operator><name>lite</name><operator>.</operator><name>StartNodeDef</name></name>;</import>

<comment type="block" format="javadoc">/**
 * Testcases for bulk JPA writes - insert and update operations for Coord Action
 * Status commands
 */</comment>
<class><specifier>public</specifier> class <name>TestBulkUpdateInsertForCoordActionStatusJPAExecutor</name> <super_list><extends>extends <super><name>XDataTestCase</name></super></extends></super_list> <block>{
    <decl_stmt><decl><type><name>Services</name></type> <name>services</name></decl>;</decl_stmt>

    <function><annotation>@<name>Override</name></annotation>
    <type><specifier>protected</specifier> <name>void</name></type> <name>setUp</name><parameter_list>()</parameter_list> <throws>throws <argument><expr><name>Exception</name></expr></argument></throws> <block>{<block_content>
        <expr_stmt><expr><call><name><name>super</name><operator>.</operator><name>setUp</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><name>services</name> <operator>=</operator> <operator>new</operator> <call><name>Services</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>services</name><operator>.</operator><name>init</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>cleanUpDBTables</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
    </block_content>}</block></function>

    <function><annotation>@<name>Override</name></annotation>
    <type><specifier>protected</specifier> <name>void</name></type> <name>tearDown</name><parameter_list>()</parameter_list> <throws>throws <argument><expr><name>Exception</name></expr></argument></throws> <block>{<block_content>
        <expr_stmt><expr><call><name><name>services</name><operator>.</operator><name>destroy</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>super</name><operator>.</operator><name>tearDown</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
    </block_content>}</block></function>

    <comment type="block" format="javadoc">/**
     * Test bulk updates by updating coordinator job, workflow job and workflow action
     * @throws Exception
     */</comment>
    <function><type><specifier>public</specifier> <name>void</name></type> <name>testUpdates</name><parameter_list>()</parameter_list> <throws>throws <argument><expr><name>Exception</name></expr></argument></throws> <block>{<block_content>
        <decl_stmt><decl><type><name>CoordinatorJobBean</name></type> <name>coordJob</name> <init>= <expr><call><name>addRecordToCoordJobTable</name><argument_list>(<argument><expr><name><name>CoordinatorJob</name><operator>.</operator><name>Status</name><operator>.</operator><name>PREP</name></name></expr></argument>, <argument><expr><literal type="boolean">true</literal></expr></argument>, <argument><expr><literal type="boolean">true</literal></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <decl_stmt><decl><type><name>WorkflowJobBean</name></type> <name>wfJob</name> <init>= <expr><call><name>addRecordToWfJobTable</name><argument_list>(<argument><expr><name><name>WorkflowJob</name><operator>.</operator><name>Status</name><operator>.</operator><name>PREP</name></name></expr></argument>, <argument><expr><name><name>WorkflowInstance</name><operator>.</operator><name>Status</name><operator>.</operator><name>PREP</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <decl_stmt><decl><type><name>WorkflowActionBean</name></type> <name>action</name> <init>= <expr><call><name>addRecordToWfActionTable</name><argument_list>(<argument><expr><call><name><name>wfJob</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><literal type="string">"1"</literal></expr></argument>, <argument><expr><name><name>WorkflowAction</name><operator>.</operator><name>Status</name><operator>.</operator><name>PREP</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <decl_stmt><decl><type><name>JPAService</name></type> <name>jpaService</name> <init>= <expr><call><name><name>Services</name><operator>.</operator><name>get</name></name><argument_list>()</argument_list></call><operator>.</operator><call><name>get</name><argument_list>(<argument><expr><name><name>JPAService</name><operator>.</operator><name>class</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name>assertNotNull</name><argument_list>(<argument><expr><name>jpaService</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <comment type="line">// update the status</comment>
        <expr_stmt><expr><call><name><name>coordJob</name><operator>.</operator><name>setStatus</name></name><argument_list>(<argument><expr><name><name>CoordinatorJob</name><operator>.</operator><name>Status</name><operator>.</operator><name>RUNNING</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>wfJob</name><operator>.</operator><name>setStatus</name></name><argument_list>(<argument><expr><name><name>WorkflowJob</name><operator>.</operator><name>Status</name><operator>.</operator><name>SUCCEEDED</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>action</name><operator>.</operator><name>setStatus</name></name><argument_list>(<argument><expr><name><name>WorkflowAction</name><operator>.</operator><name>Status</name><operator>.</operator><name>RUNNING</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <decl_stmt><decl><type><name><name>List</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name></type> <name>updateList</name> <init>= <expr><operator>new</operator> <call><name><name>ArrayList</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
        <comment type="line">// update the list for doing bulk writes</comment>
        <expr_stmt><expr><call><name><name>updateList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>coordJob</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>updateList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>wfJob</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>updateList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>action</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <decl_stmt><decl><type><name>BulkUpdateInsertForCoordActionStatusJPAExecutor</name></type> <name>bulkUpdateCmd</name> <init>= <expr><operator>new</operator> <call><name>BulkUpdateInsertForCoordActionStatusJPAExecutor</name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name><name>bulkUpdateCmd</name><operator>.</operator><name>setUpdateList</name></name><argument_list>(<argument><expr><name>updateList</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><name>bulkUpdateCmd</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <comment type="line">// check for expected status after running bulkUpdateJPA</comment>
        <expr_stmt><expr><name>coordJob</name> <operator>=</operator> <call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>CoordJobGetJPAExecutor</name><argument_list>(<argument><expr><call><name><name>coordJob</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>assertEquals</name><argument_list>(<argument><expr><literal type="string">"RUNNING"</literal></expr></argument>, <argument><expr><call><name><name>coordJob</name><operator>.</operator><name>getStatusStr</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <expr_stmt><expr><name>wfJob</name> <operator>=</operator> <call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>WorkflowJobGetJPAExecutor</name><argument_list>(<argument><expr><call><name><name>wfJob</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>assertEquals</name><argument_list>(<argument><expr><literal type="string">"SUCCEEDED"</literal></expr></argument>, <argument><expr><call><name><name>wfJob</name><operator>.</operator><name>getStatusStr</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <decl_stmt><decl><type><name>WorkflowActionBean</name></type> <name>action2</name> <init>= <expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>WorkflowActionGetJPAExecutor</name><argument_list>(<argument><expr><call><name><name>action</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name>assertEquals</name><argument_list>(<argument><expr><name><name>WorkflowAction</name><operator>.</operator><name>Status</name><operator>.</operator><name>RUNNING</name></name></expr></argument>, <argument><expr><call><name><name>action2</name><operator>.</operator><name>getStatus</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>

    </block_content>}</block></function>

    <comment type="block" format="javadoc">/**
     * Test bulk inserts by inserting a workflow job and two workflow actions
     * @throws Exception
     */</comment>
    <function><type><specifier>public</specifier> <name>void</name></type> <name>testInserts</name><parameter_list>()</parameter_list> <throws>throws <argument><expr><name>Exception</name></expr></argument></throws><block>{<block_content>
        <decl_stmt><decl><type><name>WorkflowApp</name></type> <name>app</name> <init>= <expr><operator>new</operator> <call><name>LiteWorkflowApp</name><argument_list>(<argument><expr><literal type="string">"testApp"</literal></expr></argument>, <argument><expr><literal type="string">"&lt;workflow-app/&gt;"</literal></expr></argument>,
            <argument><expr><operator>new</operator> <call><name>StartNodeDef</name><argument_list>(<argument><expr><name><name>LiteWorkflowStoreService</name><operator>.</operator><name>LiteControlNodeHandler</name><operator>.</operator><name>class</name></name></expr></argument>, <argument><expr><literal type="string">"end"</literal></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call>
                <operator>.</operator><call><name>addNode</name><argument_list>(<argument><expr><operator>new</operator> <call><name>EndNodeDef</name><argument_list>(<argument><expr><literal type="string">"end"</literal></expr></argument>, <argument><expr><name><name>LiteWorkflowStoreService</name><operator>.</operator><name>LiteControlNodeHandler</name><operator>.</operator><name>class</name></name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <decl_stmt><decl><type><name>Configuration</name></type> <name>conf</name> <init>= <expr><operator>new</operator> <call><name>Configuration</name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
        <decl_stmt><decl><type><name>Path</name></type> <name>appUri</name> <init>= <expr><operator>new</operator> <call><name>Path</name><argument_list>(<argument><expr><call><name>getAppPath</name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><literal type="string">"workflow.xml"</literal></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name><name>conf</name><operator>.</operator><name>set</name></name><argument_list>(<argument><expr><name><name>OozieClient</name><operator>.</operator><name>APP_PATH</name></name></expr></argument>, <argument><expr><call><name><name>appUri</name><operator>.</operator><name>toString</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>conf</name><operator>.</operator><name>set</name></name><argument_list>(<argument><expr><name><name>OozieClient</name><operator>.</operator><name>LOG_TOKEN</name></name></expr></argument>, <argument><expr><literal type="string">"testToken"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>conf</name><operator>.</operator><name>set</name></name><argument_list>(<argument><expr><name><name>OozieClient</name><operator>.</operator><name>USER_NAME</name></name></expr></argument>, <argument><expr><call><name>getTestUser</name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <decl_stmt><decl><type><name>WorkflowJobBean</name></type> <name>job</name> <init>= <expr><call><name>createWorkflow</name><argument_list>(<argument><expr><name>app</name></expr></argument>, <argument><expr><name>conf</name></expr></argument>, <argument><expr><literal type="string">"auth"</literal></expr></argument>, <argument><expr><name><name>WorkflowJob</name><operator>.</operator><name>Status</name><operator>.</operator><name>PREP</name></name></expr></argument>, <argument><expr><name><name>WorkflowInstance</name><operator>.</operator><name>Status</name><operator>.</operator><name>PREP</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <decl_stmt><decl><type><name>WorkflowActionBean</name></type> <name>action1</name> <init>= <expr><call><name>createWorkflowAction</name><argument_list>(<argument><expr><call><name><name>job</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><literal type="string">"1"</literal></expr></argument>, <argument><expr><name><name>WorkflowAction</name><operator>.</operator><name>Status</name><operator>.</operator><name>PREP</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <decl_stmt><decl><type><name>WorkflowActionBean</name></type> <name>action2</name> <init>= <expr><call><name>createWorkflowAction</name><argument_list>(<argument><expr><call><name><name>job</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><literal type="string">"2"</literal></expr></argument>, <argument><expr><name><name>WorkflowAction</name><operator>.</operator><name>Status</name><operator>.</operator><name>PREP</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>

        <decl_stmt><decl><type><name><name>List</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name></type> <name>insertList</name> <init>= <expr><operator>new</operator> <call><name><name>ArrayList</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
        <comment type="line">// insert one workflow job and two actions</comment>
        <expr_stmt><expr><call><name><name>insertList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>action1</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>insertList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>action2</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>insertList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>job</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <decl_stmt><decl><type><name>JPAService</name></type> <name>jpaService</name> <init>= <expr><call><name><name>Services</name><operator>.</operator><name>get</name></name><argument_list>()</argument_list></call><operator>.</operator><call><name>get</name><argument_list>(<argument><expr><name><name>JPAService</name><operator>.</operator><name>class</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name>assertNotNull</name><argument_list>(<argument><expr><name>jpaService</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <decl_stmt><decl><type><name>BulkUpdateInsertForCoordActionStatusJPAExecutor</name></type> <name>bulkInsertCmd</name> <init>= <expr><operator>new</operator> <call><name>BulkUpdateInsertForCoordActionStatusJPAExecutor</name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name><name>bulkInsertCmd</name><operator>.</operator><name>setInsertList</name></name><argument_list>(<argument><expr><name>insertList</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><name>bulkInsertCmd</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <comment type="line">// check for expected status after running bulkUpdateJPA</comment>
        <decl_stmt><decl><type><name>WorkflowActionGetJPAExecutor</name></type> <name>actionGetCmd</name> <init>= <expr><operator>new</operator> <call><name>WorkflowActionGetJPAExecutor</name><argument_list>(<argument><expr><call><name><name>action1</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><name>action1</name> <operator>=</operator> <call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><name>actionGetCmd</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>assertEquals</name><argument_list>(<argument><expr><literal type="string">"PREP"</literal></expr></argument>, <argument><expr><call><name><name>action1</name><operator>.</operator><name>getStatusStr</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <expr_stmt><expr><name>actionGetCmd</name> <operator>=</operator> <operator>new</operator> <call><name>WorkflowActionGetJPAExecutor</name><argument_list>(<argument><expr><call><name><name>action2</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><name>action2</name> <operator>=</operator> <call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><name>actionGetCmd</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>assertEquals</name><argument_list>(<argument><expr><literal type="string">"PREP"</literal></expr></argument>, <argument><expr><call><name><name>action2</name><operator>.</operator><name>getStatusStr</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <decl_stmt><decl><type><name>WorkflowJobGetJPAExecutor</name></type> <name>wfGetCmd</name> <init>= <expr><operator>new</operator> <call><name>WorkflowJobGetJPAExecutor</name><argument_list>(<argument><expr><call><name><name>job</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><name>job</name> <operator>=</operator> <call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><name>wfGetCmd</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>assertEquals</name><argument_list>(<argument><expr><literal type="string">"PREP"</literal></expr></argument>, <argument><expr><call><name><name>job</name><operator>.</operator><name>getStatusStr</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>

    </block_content>}</block></function>

    <comment type="block" format="javadoc">/**
     * Test bulk inserts and updates by inserting wf actions and updating
     * coordinator and workflow jobs
     *
     * @throws Exception
     */</comment>
    <function><type><specifier>public</specifier> <name>void</name></type> <name>testBulkInsertUpdates</name><parameter_list>()</parameter_list> <throws>throws <argument><expr><name>Exception</name></expr></argument></throws><block>{<block_content>
        <decl_stmt><decl><type><name>CoordinatorJobBean</name></type> <name>coordJob</name> <init>= <expr><call><name>addRecordToCoordJobTable</name><argument_list>(<argument><expr><name><name>CoordinatorJob</name><operator>.</operator><name>Status</name><operator>.</operator><name>PREP</name></name></expr></argument>, <argument><expr><literal type="boolean">true</literal></expr></argument>, <argument><expr><literal type="boolean">true</literal></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <decl_stmt><decl><type><name>WorkflowJobBean</name></type> <name>job</name> <init>= <expr><call><name>addRecordToWfJobTable</name><argument_list>(<argument><expr><name><name>WorkflowJob</name><operator>.</operator><name>Status</name><operator>.</operator><name>PREP</name></name></expr></argument>, <argument><expr><name><name>WorkflowInstance</name><operator>.</operator><name>Status</name><operator>.</operator><name>PREP</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <decl_stmt><decl><type><name>WorkflowActionBean</name></type> <name>action1</name> <init>= <expr><call><name>createWorkflowAction</name><argument_list>(<argument><expr><call><name><name>job</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><literal type="string">"1"</literal></expr></argument>, <argument><expr><name><name>WorkflowAction</name><operator>.</operator><name>Status</name><operator>.</operator><name>PREP</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <decl_stmt><decl><type><name>WorkflowActionBean</name></type> <name>action2</name> <init>= <expr><call><name>createWorkflowAction</name><argument_list>(<argument><expr><call><name><name>job</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><literal type="string">"2"</literal></expr></argument>, <argument><expr><name><name>WorkflowAction</name><operator>.</operator><name>Status</name><operator>.</operator><name>PREP</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>

        <expr_stmt><expr><call><name><name>job</name><operator>.</operator><name>setStatus</name></name><argument_list>(<argument><expr><name><name>WorkflowJob</name><operator>.</operator><name>Status</name><operator>.</operator><name>RUNNING</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>coordJob</name><operator>.</operator><name>setStatus</name></name><argument_list>(<argument><expr><name><name>Job</name><operator>.</operator><name>Status</name><operator>.</operator><name>SUCCEEDED</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <decl_stmt><decl><type><name><name>List</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name></type> <name>insertList</name> <init>= <expr><operator>new</operator> <call><name><name>ArrayList</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
        <comment type="line">// Add two actions to insert list</comment>
        <expr_stmt><expr><call><name><name>insertList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>action1</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>insertList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>action2</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <decl_stmt><decl><type><name><name>List</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name></type> <name>updateList</name> <init>= <expr><operator>new</operator> <call><name><name>ArrayList</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
        <comment type="line">//Add two jobs to update list</comment>
        <expr_stmt><expr><call><name><name>updateList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>coordJob</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>updateList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>job</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <decl_stmt><decl><type><name>JPAService</name></type> <name>jpaService</name> <init>= <expr><call><name><name>Services</name><operator>.</operator><name>get</name></name><argument_list>()</argument_list></call><operator>.</operator><call><name>get</name><argument_list>(<argument><expr><name><name>JPAService</name><operator>.</operator><name>class</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name>assertNotNull</name><argument_list>(<argument><expr><name>jpaService</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <decl_stmt><decl><type><name>BulkUpdateInsertForCoordActionStatusJPAExecutor</name></type> <name>bulkUpdateCmd</name> <init>= <expr><operator>new</operator> <call><name>BulkUpdateInsertForCoordActionStatusJPAExecutor</name><argument_list>(<argument><expr><name>updateList</name></expr></argument>, <argument><expr><name>insertList</name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><name>bulkUpdateCmd</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <expr_stmt><expr><name>coordJob</name> <operator>=</operator> <call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><operator>new</operator> <call><name>CoordJobGetJPAExecutor</name><argument_list>(<argument><expr><call><name><name>coordJob</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>assertEquals</name><argument_list>(<argument><expr><literal type="string">"SUCCEEDED"</literal></expr></argument>, <argument><expr><call><name><name>coordJob</name><operator>.</operator><name>getStatusStr</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <decl_stmt><decl><type><name>WorkflowJobGetJPAExecutor</name></type> <name>wfGetCmd</name> <init>= <expr><operator>new</operator> <call><name>WorkflowJobGetJPAExecutor</name><argument_list>(<argument><expr><call><name><name>job</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <decl_stmt><decl><type><name>WorkflowJobBean</name></type> <name>wfBean</name> <init>= <expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><name>wfGetCmd</name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name>assertEquals</name><argument_list>(<argument><expr><literal type="string">"RUNNING"</literal></expr></argument>, <argument><expr><call><name><name>wfBean</name><operator>.</operator><name>getStatusStr</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <decl_stmt><decl><type><name>WorkflowActionGetJPAExecutor</name></type> <name>actionGetCmd</name> <init>= <expr><operator>new</operator> <call><name>WorkflowActionGetJPAExecutor</name><argument_list>(<argument><expr><call><name><name>action1</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><name>action1</name> <operator>=</operator> <call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><name>actionGetCmd</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>assertEquals</name><argument_list>(<argument><expr><literal type="string">"PREP"</literal></expr></argument>, <argument><expr><call><name><name>action1</name><operator>.</operator><name>getStatusStr</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <expr_stmt><expr><name>actionGetCmd</name> <operator>=</operator> <operator>new</operator> <call><name>WorkflowActionGetJPAExecutor</name><argument_list>(<argument><expr><call><name><name>action2</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><name>action2</name> <operator>=</operator> <call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><name>actionGetCmd</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>assertEquals</name><argument_list>(<argument><expr><literal type="string">"PREP"</literal></expr></argument>, <argument><expr><call><name><name>action2</name><operator>.</operator><name>getStatusStr</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    </block_content>}</block></function>

    <comment type="block" format="javadoc">/**
     * Test bulk inserts and updates rollback
     *
     * @throws Exception
     */</comment>
    <function><type><specifier>public</specifier> <name>void</name></type> <name>testBulkInsertUpdatesRollback</name><parameter_list>()</parameter_list> <throws>throws <argument><expr><name>Exception</name></expr></argument></throws><block>{<block_content>
        <decl_stmt><decl><type><name>WorkflowJobBean</name></type> <name>job</name> <init>= <expr><call><name>addRecordToWfJobTable</name><argument_list>(<argument><expr><name><name>WorkflowJob</name><operator>.</operator><name>Status</name><operator>.</operator><name>PREP</name></name></expr></argument>, <argument><expr><name><name>WorkflowInstance</name><operator>.</operator><name>Status</name><operator>.</operator><name>PREP</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <decl_stmt><decl><type><name>WorkflowActionBean</name></type> <name>action1</name> <init>= <expr><call><name>createWorkflowAction</name><argument_list>(<argument><expr><call><name><name>job</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><literal type="string">"1"</literal></expr></argument>, <argument><expr><name><name>WorkflowAction</name><operator>.</operator><name>Status</name><operator>.</operator><name>PREP</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <decl_stmt><decl><type><name>WorkflowActionBean</name></type> <name>action2</name> <init>= <expr><call><name>createWorkflowAction</name><argument_list>(<argument><expr><call><name><name>job</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><literal type="string">"2"</literal></expr></argument>, <argument><expr><name><name>WorkflowAction</name><operator>.</operator><name>Status</name><operator>.</operator><name>PREP</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>

        <expr_stmt><expr><call><name><name>job</name><operator>.</operator><name>setStatus</name></name><argument_list>(<argument><expr><name><name>WorkflowJob</name><operator>.</operator><name>Status</name><operator>.</operator><name>RUNNING</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <decl_stmt><decl><type><name><name>List</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name></type> <name>insertList</name> <init>= <expr><operator>new</operator> <call><name><name>ArrayList</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
        <comment type="line">// Add two actions to insert list</comment>
        <expr_stmt><expr><call><name><name>insertList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>action1</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>insertList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>action2</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <decl_stmt><decl><type><name><name>List</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name></type> <name>updateList</name> <init>= <expr><operator>new</operator> <call><name><name>ArrayList</name><argument_list type="generic">&lt;<argument><name>JsonBean</name></argument>&gt;</argument_list></name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
        <comment type="line">// Add to update list</comment>
        <expr_stmt><expr><call><name><name>updateList</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>job</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <decl_stmt><decl><type><name>JPAService</name></type> <name>jpaService</name> <init>= <expr><call><name><name>Services</name><operator>.</operator><name>get</name></name><argument_list>()</argument_list></call><operator>.</operator><call><name>get</name><argument_list>(<argument><expr><name><name>JPAService</name><operator>.</operator><name>class</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name>assertNotNull</name><argument_list>(<argument><expr><name>jpaService</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <decl_stmt><decl><type><name>BulkUpdateInsertForCoordActionStatusJPAExecutor</name></type> <name>wfUpdateCmd1</name> <init>= <expr><operator>new</operator> <call><name>BulkUpdateInsertForCoordActionStatusJPAExecutor</name><argument_list>(<argument><expr><name>updateList</name></expr></argument>, <argument><expr><name>insertList</name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>

        <comment type="line">// set fault injection to true, so transaction is roll backed</comment>
        <expr_stmt><expr><call><name>setSystemProperty</name><argument_list>(<argument><expr><name><name>FaultInjection</name><operator>.</operator><name>FAULT_INJECTION</name></name></expr></argument>, <argument><expr><literal type="string">"true"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>setSystemProperty</name><argument_list>(<argument><expr><name><name>SkipCommitFaultInjection</name><operator>.</operator><name>ACTION_FAILOVER_FAULT_INJECTION</name></name></expr></argument>, <argument><expr><literal type="string">"true"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <try>try <block>{<block_content>
            <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><name>wfUpdateCmd1</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name>fail</name><argument_list>(<argument><expr><literal type="string">"Expected exception due to commit failure but didn't get any"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        </block_content>}</block>
        <catch>catch <parameter_list>(<parameter><decl><type><name>Exception</name></type> <name>e</name></decl></parameter>)</parameter_list> <block>{<block_content>
        </block_content>}</block></catch></try>
        <expr_stmt><expr><call><name><name>FaultInjection</name><operator>.</operator><name>deactivate</name></name><argument_list>(<argument><expr><literal type="string">"org.apache.oozie.command.SkipCommitFaultInjection"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <comment type="line">// Check whether transactions are rolled back or not</comment>
        <decl_stmt><decl><type><name>WorkflowJobGetJPAExecutor</name></type> <name>wfGetCmd</name> <init>= <expr><operator>new</operator> <call><name>WorkflowJobGetJPAExecutor</name><argument_list>(<argument><expr><call><name><name>job</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <decl_stmt><decl><type><name>WorkflowJobBean</name></type> <name>wfBean</name> <init>= <expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><name>wfGetCmd</name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <comment type="line">// status should not be RUNNING</comment>
        <expr_stmt><expr><call><name>assertEquals</name><argument_list>(<argument><expr><literal type="string">"PREP"</literal></expr></argument>, <argument><expr><call><name><name>wfBean</name><operator>.</operator><name>getStatusStr</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <decl_stmt><decl><type><name>WorkflowActionGetJPAExecutor</name></type> <name>actionGetCmd</name> <init>= <expr><operator>new</operator> <call><name>WorkflowActionGetJPAExecutor</name><argument_list>(<argument><expr><call><name><name>action1</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <try>try <block>{<block_content>
            <expr_stmt><expr><name>action1</name> <operator>=</operator> <call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><name>actionGetCmd</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name>fail</name><argument_list>(<argument><expr><literal type="string">"Expected exception but didnt get any"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        </block_content>}</block>
        <catch>catch <parameter_list>(<parameter><decl><type><name>JPAExecutorException</name></type> <name>jpaee</name></decl></parameter>)</parameter_list> <block>{<block_content>
            <expr_stmt><expr><call><name>assertEquals</name><argument_list>(<argument><expr><name><name>ErrorCode</name><operator>.</operator><name>E0605</name></name></expr></argument>, <argument><expr><call><name><name>jpaee</name><operator>.</operator><name>getErrorCode</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        </block_content>}</block></catch></try>


        <expr_stmt><expr><name>actionGetCmd</name> <operator>=</operator> <operator>new</operator> <call><name>WorkflowActionGetJPAExecutor</name><argument_list>(<argument><expr><call><name><name>action2</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <try>try <block>{<block_content>
            <expr_stmt><expr><name>action2</name> <operator>=</operator> <call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><name>actionGetCmd</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name>fail</name><argument_list>(<argument><expr><literal type="string">"Expected exception but didnt get any"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        </block_content>}</block>
        <catch>catch <parameter_list>(<parameter><decl><type><name>JPAExecutorException</name></type> <name>jpaee</name></decl></parameter>)</parameter_list> <block>{<block_content>
            <expr_stmt><expr><call><name>assertEquals</name><argument_list>(<argument><expr><name><name>ErrorCode</name><operator>.</operator><name>E0605</name></name></expr></argument>, <argument><expr><call><name><name>jpaee</name><operator>.</operator><name>getErrorCode</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        </block_content>}</block></catch></try>

    </block_content>}</block></function>

}</block></class>
<expr_stmt><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>test</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>executor</name><operator>/</operator><name>jpa</name><operator>/</operator><name><name>TestBulkUpdateInsertJPAExecutor</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>test</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>executor</name><operator>/</operator><name>jpa</name><operator>/</operator><name><name>TestBulkUpdateInsertJPAExecutor</name><operator>.</operator><name>java</name></name>
<name>index</name> <literal type="number">7aba2d895</literal><operator>..</operator><literal type="number">1c38d1e9c</literal> <literal type="number">100644</literal>
<operator>--</operator> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>test</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>executor</name><operator>/</operator><name>jpa</name><operator>/</operator><name><name>TestBulkUpdateInsertJPAExecutor</name><operator>.</operator><name>java</name></name>
<operator>++</operator> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>test</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>executor</name><operator>/</operator><name>jpa</name><operator>/</operator><name><name>TestBulkUpdateInsertJPAExecutor</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">45</literal></expr><operator>,</operator><expr><literal type="number">6</literal> <operator>+</operator><literal type="number">45</literal></expr><operator>,</operator><expr><literal type="number">9</literal> @@</expr></expr_stmt> <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>workflow</name><operator>.</operator><name>lite</name><operator>.</operator><name>EndNodeDef</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>workflow</name><operator>.</operator><name>lite</name><operator>.</operator><name>LiteWorkflowApp</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>workflow</name><operator>.</operator><name>lite</name><operator>.</operator><name>StartNodeDef</name></name>;</import>
 
<comment type="block" format="javadoc">/**
 * Testcases for bulk JPA writes - inserts and updates
 */</comment>
 <class><specifier>public</specifier> class <name>TestBulkUpdateInsertJPAExecutor</name> <super_list><extends>extends <super><name>XDataTestCase</name></super></extends></super_list> <block>{
     <decl_stmt><decl><type><name>Services</name></type> <name>services</name></decl>;</decl_stmt>
 
<expr_stmt><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>test</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>executor</name><operator>/</operator><name>jpa</name><operator>/</operator><name><name>TestBundleActionsDeleteForPurgeJPAExecutor</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>test</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>executor</name><operator>/</operator><name>jpa</name><operator>/</operator><name><name>TestBundleActionsDeleteForPurgeJPAExecutor</name><operator>.</operator><name>java</name></name>
<name>index</name> <literal type="number">58ec5e1ec</literal><operator>..</operator><name>e69de29bb</name> <literal type="number">100644</literal>
<operator>--</operator> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>test</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>executor</name><operator>/</operator><name>jpa</name><operator>/</operator><name><name>TestBundleActionsDeleteForPurgeJPAExecutor</name><operator>.</operator><name>java</name></name>
<operator>++</operator> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>test</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>executor</name><operator>/</operator><name>jpa</name><operator>/</operator><name><name>TestBundleActionsDeleteForPurgeJPAExecutor</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">1</literal></expr><operator>,</operator><expr><literal type="number">88</literal> <operator>+</operator><literal type="number">0</literal></expr><operator>,</operator><expr><literal type="number">0</literal> @@</expr></expr_stmt>
<comment type="block" format="javadoc">/**
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 * 
 *      http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */</comment>
<package>package <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name></name>;</package>

<import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>Date</name></name>;</import>
<import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>List</name></name>;</import>

<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>BundleActionBean</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>BundleJobBean</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>Job</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>JPAService</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>Services</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>test</name><operator>.</operator><name>XDataTestCase</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>util</name><operator>.</operator><name>DateUtils</name></name>;</import>

<class><specifier>public</specifier> class <name>TestBundleActionsDeleteForPurgeJPAExecutor</name> <super_list><extends>extends <super><name>XDataTestCase</name></super></extends></super_list> <block>{
    <decl_stmt><decl><type><name>Services</name></type> <name>services</name></decl>;</decl_stmt>

    <function><annotation>@<name>Override</name></annotation>
    <type><specifier>protected</specifier> <name>void</name></type> <name>setUp</name><parameter_list>()</parameter_list> <throws>throws <argument><expr><name>Exception</name></expr></argument></throws> <block>{<block_content>
        <expr_stmt><expr><call><name><name>super</name><operator>.</operator><name>setUp</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><name>services</name> <operator>=</operator> <operator>new</operator> <call><name>Services</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>services</name><operator>.</operator><name>init</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>cleanUpDBTables</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
    </block_content>}</block></function>

    <function><annotation>@<name>Override</name></annotation>
    <type><specifier>protected</specifier> <name>void</name></type> <name>tearDown</name><parameter_list>()</parameter_list> <throws>throws <argument><expr><name>Exception</name></expr></argument></throws> <block>{<block_content>
        <expr_stmt><expr><call><name><name>services</name><operator>.</operator><name>destroy</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>super</name><operator>.</operator><name>tearDown</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
    </block_content>}</block></function>

    <function><type><specifier>public</specifier> <name>void</name></type> <name>testBundleActionsDeleteForPurgeJPAExecutor</name><parameter_list>()</parameter_list> <throws>throws <argument><expr><name>Exception</name></expr></argument></throws> <block>{<block_content>
        <decl_stmt><decl><type><name>BundleJobBean</name></type> <name>job</name> <init>= <expr><call><name><name>this</name><operator>.</operator><name>addRecordToBundleJobTable</name></name><argument_list>(<argument><expr><name><name>Job</name><operator>.</operator><name>Status</name><operator>.</operator><name>SUCCEEDED</name></name></expr></argument>, <argument><expr><call><name><name>DateUtils</name><operator>.</operator><name>parseDateOozieTZ</name></name><argument_list>(
            <argument><expr><literal type="string">"2011-01-01T01:00Z"</literal></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name><name>this</name><operator>.</operator><name>addRecordToBundleActionTable</name></name><argument_list>(<argument><expr><call><name><name>job</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><literal type="string">"action1"</literal></expr></argument>, <argument><expr><literal type="number">0</literal></expr></argument>, <argument><expr><name><name>Job</name><operator>.</operator><name>Status</name><operator>.</operator><name>SUCCEEDED</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>this</name><operator>.</operator><name>addRecordToBundleActionTable</name></name><argument_list>(<argument><expr><call><name><name>job</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><literal type="string">"action2"</literal></expr></argument>, <argument><expr><literal type="number">0</literal></expr></argument>, <argument><expr><name><name>Job</name><operator>.</operator><name>Status</name><operator>.</operator><name>SUCCEEDED</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>_testBundleActionsDelete</name><argument_list>(<argument><expr><call><name><name>job</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    </block_content>}</block></function>

    <function><type><specifier>private</specifier> <name>void</name></type> <name>_testBundleActionsDelete</name><parameter_list>(<parameter><decl><type><name>String</name></type> <name>jobId</name></decl></parameter>)</parameter_list> <throws>throws <argument><expr><name>Exception</name></expr></argument></throws> <block>{<block_content>
        <decl_stmt><decl><type><name>JPAService</name></type> <name>jpaService</name> <init>= <expr><call><name><name>Services</name><operator>.</operator><name>get</name></name><argument_list>()</argument_list></call><operator>.</operator><call><name>get</name><argument_list>(<argument><expr><name><name>JPAService</name><operator>.</operator><name>class</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name>assertNotNull</name><argument_list>(<argument><expr><name>jpaService</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <decl_stmt><decl><type><name>BundleActionsGetJPAExecutor</name></type> <name>bundleActionsGetCmd</name> <init>= <expr><operator>new</operator> <call><name>BundleActionsGetJPAExecutor</name><argument_list>(<argument><expr><name>jobId</name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <decl_stmt><decl><type><name><name>List</name><argument_list type="generic">&lt;<argument><name>BundleActionBean</name></argument>&gt;</argument_list></name></type> <name>ret</name> <init>= <expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><name>bundleActionsGetCmd</name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name>assertEquals</name><argument_list>(<argument><expr><literal type="number">2</literal></expr></argument>, <argument><expr><call><name><name>ret</name><operator>.</operator><name>size</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <decl_stmt><decl><type><name>BundleActionsDeleteForPurgeJPAExecutor</name></type> <name>bundleActionsDelCmd</name> <init>= <expr><operator>new</operator> <call><name>BundleActionsDeleteForPurgeJPAExecutor</name><argument_list>(<argument><expr><name>jobId</name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><name>bundleActionsDelCmd</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <expr_stmt><expr><name>ret</name> <operator>=</operator> <call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><name>bundleActionsGetCmd</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>assertEquals</name><argument_list>(<argument><expr><literal type="number">0</literal></expr></argument>, <argument><expr><call><name><name>ret</name><operator>.</operator><name>size</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    </block_content>}</block></function>

    <function><type><specifier>protected</specifier> <name>BundleJobBean</name></type> <name>addRecordToBundleJobTable</name><parameter_list>(<parameter><decl><type><name><name>Job</name><operator>.</operator><name>Status</name></name></type> <name>jobStatus</name></decl></parameter>, <parameter><decl><type><name>Date</name></type> <name>lastModifiedTime</name></decl></parameter>)</parameter_list> <throws>throws <argument><expr><name>Exception</name></expr></argument></throws> <block>{<block_content>
        <decl_stmt><decl><type><name>BundleJobBean</name></type> <name>bundle</name> <init>= <expr><call><name>createBundleJob</name><argument_list>(<argument><expr><name>jobStatus</name></expr></argument>, <argument><expr><literal type="boolean">false</literal></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name><name>bundle</name><operator>.</operator><name>setLastModifiedTime</name></name><argument_list>(<argument><expr><name>lastModifiedTime</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <try>try <block>{<block_content>
            <decl_stmt><decl><type><name>JPAService</name></type> <name>jpaService</name> <init>= <expr><call><name><name>Services</name><operator>.</operator><name>get</name></name><argument_list>()</argument_list></call><operator>.</operator><call><name>get</name><argument_list>(<argument><expr><name><name>JPAService</name><operator>.</operator><name>class</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
            <expr_stmt><expr><call><name>assertNotNull</name><argument_list>(<argument><expr><name>jpaService</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <decl_stmt><decl><type><name>BundleJobInsertJPAExecutor</name></type> <name>bundleInsertjpa</name> <init>= <expr><operator>new</operator> <call><name>BundleJobInsertJPAExecutor</name><argument_list>(<argument><expr><name>bundle</name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
            <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><name>bundleInsertjpa</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        </block_content>}</block>
        <catch>catch <parameter_list>(<parameter><decl><type><name>JPAExecutorException</name></type> <name>je</name></decl></parameter>)</parameter_list> <block>{<block_content>
            <expr_stmt><expr><call><name><name>je</name><operator>.</operator><name>printStackTrace</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name>fail</name><argument_list>(<argument><expr><literal type="string">"Unable to insert the test bundle job record to table"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <throw>throw <expr><name>je</name></expr>;</throw>
        </block_content>}</block></catch></try>
        <return>return <expr><name>bundle</name></expr>;</return>
    </block_content>}</block></function>

}</block></class>
<expr_stmt><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>test</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>executor</name><operator>/</operator><name>jpa</name><operator>/</operator><name><name>TestBundleJobDeleteJPAExecutor</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>test</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>executor</name><operator>/</operator><name>jpa</name><operator>/</operator><name><name>TestBundleJobDeleteJPAExecutor</name><operator>.</operator><name>java</name></name>
<name>index</name> <literal type="number">5b02ddbd8</literal><operator>..</operator><name>e69de29bb</name> <literal type="number">100644</literal>
<operator>--</operator> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>test</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>executor</name><operator>/</operator><name>jpa</name><operator>/</operator><name><name>TestBundleJobDeleteJPAExecutor</name><operator>.</operator><name>java</name></name>
<operator>++</operator> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>test</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>executor</name><operator>/</operator><name>jpa</name><operator>/</operator><name><name>TestBundleJobDeleteJPAExecutor</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">1</literal></expr><operator>,</operator><expr><literal type="number">86</literal> <operator>+</operator><literal type="number">0</literal></expr><operator>,</operator><expr><literal type="number">0</literal> @@</expr></expr_stmt>
<comment type="block" format="javadoc">/**
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 * 
 *      http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */</comment>
<package>package <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name></name>;</package>

<import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>Date</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>BundleJobBean</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>Job</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>JPAService</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>Services</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>test</name><operator>.</operator><name>XDataTestCase</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>util</name><operator>.</operator><name>DateUtils</name></name>;</import>

<class><specifier>public</specifier> class <name>TestBundleJobDeleteJPAExecutor</name> <super_list><extends>extends <super><name>XDataTestCase</name></super></extends></super_list> <block>{
    <decl_stmt><decl><type><name>Services</name></type> <name>services</name></decl>;</decl_stmt>

    <function><annotation>@<name>Override</name></annotation>
    <type><specifier>protected</specifier> <name>void</name></type> <name>setUp</name><parameter_list>()</parameter_list> <throws>throws <argument><expr><name>Exception</name></expr></argument></throws> <block>{<block_content>
        <expr_stmt><expr><call><name><name>super</name><operator>.</operator><name>setUp</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><name>services</name> <operator>=</operator> <operator>new</operator> <call><name>Services</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>services</name><operator>.</operator><name>init</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>cleanUpDBTables</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
    </block_content>}</block></function>

    <function><annotation>@<name>Override</name></annotation>
    <type><specifier>protected</specifier> <name>void</name></type> <name>tearDown</name><parameter_list>()</parameter_list> <throws>throws <argument><expr><name>Exception</name></expr></argument></throws> <block>{<block_content>
        <expr_stmt><expr><call><name><name>services</name><operator>.</operator><name>destroy</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>super</name><operator>.</operator><name>tearDown</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
    </block_content>}</block></function>

    <function><type><specifier>public</specifier> <name>void</name></type> <name>testBundleJobDeleteJPAExecutor</name><parameter_list>()</parameter_list> <throws>throws <argument><expr><name>Exception</name></expr></argument></throws> <block>{<block_content>
        <decl_stmt><decl><type><name>BundleJobBean</name></type> <name>job1</name> <init>= <expr><call><name><name>this</name><operator>.</operator><name>addRecordToBundleJobTable</name></name><argument_list>(<argument><expr><name><name>Job</name><operator>.</operator><name>Status</name><operator>.</operator><name>SUCCEEDED</name></name></expr></argument>, <argument><expr><call><name><name>DateUtils</name><operator>.</operator><name>parseDateOozieTZ</name></name><argument_list>(
            <argument><expr><literal type="string">"2011-01-01T01:00Z"</literal></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name>_testBundleJobDelete</name><argument_list>(<argument><expr><call><name><name>job1</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <decl_stmt><decl><type><name>BundleJobBean</name></type> <name>job2</name> <init>= <expr><call><name><name>this</name><operator>.</operator><name>addRecordToBundleJobTable</name></name><argument_list>(<argument><expr><name><name>Job</name><operator>.</operator><name>Status</name><operator>.</operator><name>SUCCEEDED</name></name></expr></argument>, <argument><expr><call><name><name>DateUtils</name><operator>.</operator><name>parseDateOozieTZ</name></name><argument_list>(
            <argument><expr><literal type="string">"2011-01-02T01:00Z"</literal></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name>_testBundleJobDelete</name><argument_list>(<argument><expr><call><name><name>job2</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    </block_content>}</block></function>

    <function><type><specifier>private</specifier> <name>void</name></type> <name>_testBundleJobDelete</name><parameter_list>(<parameter><decl><type><name>String</name></type> <name>jobId</name></decl></parameter>)</parameter_list> <throws>throws <argument><expr><name>Exception</name></expr></argument></throws> <block>{<block_content>
        <decl_stmt><decl><type><name>JPAService</name></type> <name>jpaService</name> <init>= <expr><call><name><name>Services</name><operator>.</operator><name>get</name></name><argument_list>()</argument_list></call><operator>.</operator><call><name>get</name><argument_list>(<argument><expr><name><name>JPAService</name><operator>.</operator><name>class</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name>assertNotNull</name><argument_list>(<argument><expr><name>jpaService</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <decl_stmt><decl><type><name>BundleJobDeleteJPAExecutor</name></type> <name>bundleDelCmd</name> <init>= <expr><operator>new</operator> <call><name>BundleJobDeleteJPAExecutor</name><argument_list>(<argument><expr><name>jobId</name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><name>bundleDelCmd</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <try>try <block>{<block_content>
            <decl_stmt><decl><type><name>BundleJobGetJPAExecutor</name></type> <name>bundleGetCmd</name> <init>= <expr><operator>new</operator> <call><name>BundleJobGetJPAExecutor</name><argument_list>(<argument><expr><name>jobId</name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
            <decl_stmt><decl><type><name>BundleJobBean</name></type> <name>ret</name> <init>= <expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><name>bundleGetCmd</name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
            <expr_stmt><expr><call><name>fail</name><argument_list>(<argument><expr><literal type="string">"Job should not be there"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        </block_content>}</block>
        <catch>catch <parameter_list>(<parameter><decl><type><name>JPAExecutorException</name></type> <name>ex</name></decl></parameter>)</parameter_list> <block>{<block_content>
        </block_content>}</block></catch></try>

    </block_content>}</block></function>

    <function><type><specifier>protected</specifier> <name>BundleJobBean</name></type> <name>addRecordToBundleJobTable</name><parameter_list>(<parameter><decl><type><name><name>Job</name><operator>.</operator><name>Status</name></name></type> <name>jobStatus</name></decl></parameter>, <parameter><decl><type><name>Date</name></type> <name>lastModifiedTime</name></decl></parameter>)</parameter_list> <throws>throws <argument><expr><name>Exception</name></expr></argument></throws> <block>{<block_content>
        <decl_stmt><decl><type><name>BundleJobBean</name></type> <name>bundle</name> <init>= <expr><call><name>createBundleJob</name><argument_list>(<argument><expr><name>jobStatus</name></expr></argument>, <argument><expr><literal type="boolean">false</literal></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name><name>bundle</name><operator>.</operator><name>setLastModifiedTime</name></name><argument_list>(<argument><expr><name>lastModifiedTime</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <try>try <block>{<block_content>
            <decl_stmt><decl><type><name>JPAService</name></type> <name>jpaService</name> <init>= <expr><call><name><name>Services</name><operator>.</operator><name>get</name></name><argument_list>()</argument_list></call><operator>.</operator><call><name>get</name><argument_list>(<argument><expr><name><name>JPAService</name><operator>.</operator><name>class</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
            <expr_stmt><expr><call><name>assertNotNull</name><argument_list>(<argument><expr><name>jpaService</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <decl_stmt><decl><type><name>BundleJobInsertJPAExecutor</name></type> <name>bundleInsertjpa</name> <init>= <expr><operator>new</operator> <call><name>BundleJobInsertJPAExecutor</name><argument_list>(<argument><expr><name>bundle</name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
            <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><name>bundleInsertjpa</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        </block_content>}</block>
        <catch>catch <parameter_list>(<parameter><decl><type><name>JPAExecutorException</name></type> <name>ce</name></decl></parameter>)</parameter_list> <block>{<block_content>
            <expr_stmt><expr><call><name><name>ce</name><operator>.</operator><name>printStackTrace</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name>fail</name><argument_list>(<argument><expr><literal type="string">"Unable to insert the test bundle job record to table"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <throw>throw <expr><name>ce</name></expr>;</throw>
        </block_content>}</block></catch></try>
        <return>return <expr><name>bundle</name></expr>;</return>
    </block_content>}</block></function>

}</block></class>
<expr_stmt><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>test</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>executor</name><operator>/</operator><name>jpa</name><operator>/</operator><name><name>TestCoordActionUpdateForStartJPAExecutor</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>test</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>executor</name><operator>/</operator><name>jpa</name><operator>/</operator><name><name>TestCoordActionUpdateForStartJPAExecutor</name><operator>.</operator><name>java</name></name>
<name>index</name> <literal type="number">0f83430eb</literal><operator>..</operator><name>e69de29bb</name> <literal type="number">100644</literal>
<operator>--</operator> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>test</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>executor</name><operator>/</operator><name>jpa</name><operator>/</operator><name><name>TestCoordActionUpdateForStartJPAExecutor</name><operator>.</operator><name>java</name></name>
<operator>++</operator> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>test</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>executor</name><operator>/</operator><name>jpa</name><operator>/</operator><name><name>TestCoordActionUpdateForStartJPAExecutor</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">1</literal></expr><operator>,</operator><expr><literal type="number">80</literal> <operator>+</operator><literal type="number">0</literal></expr><operator>,</operator><expr><literal type="number">0</literal> @@</expr></expr_stmt>
<comment type="block" format="javadoc">/**
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */</comment>
<package>package <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name></name>;</package>

<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>CoordinatorActionBean</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>CoordinatorJobBean</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>CoordinatorAction</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>CoordinatorJob</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>local</name><operator>.</operator><name>LocalOozie</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>JPAService</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>Services</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>test</name><operator>.</operator><name>XDataTestCase</name></name>;</import>

<class><specifier>public</specifier> class <name>TestCoordActionUpdateForStartJPAExecutor</name> <super_list><extends>extends <super><name>XDataTestCase</name></super></extends></super_list> <block>{
    <decl_stmt><decl><type><name>Services</name></type> <name>services</name></decl>;</decl_stmt>

    <function><annotation>@<name>Override</name></annotation>
    <type><specifier>protected</specifier> <name>void</name></type> <name>setUp</name><parameter_list>()</parameter_list> <throws>throws <argument><expr><name>Exception</name></expr></argument></throws> <block>{<block_content>
        <expr_stmt><expr><call><name><name>super</name><operator>.</operator><name>setUp</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><name>services</name> <operator>=</operator> <operator>new</operator> <call><name>Services</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>services</name><operator>.</operator><name>init</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>cleanUpDBTables</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>LocalOozie</name><operator>.</operator><name>start</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
    </block_content>}</block></function>

    <function><annotation>@<name>Override</name></annotation>
    <type><specifier>protected</specifier> <name>void</name></type> <name>tearDown</name><parameter_list>()</parameter_list> <throws>throws <argument><expr><name>Exception</name></expr></argument></throws> <block>{<block_content>
        <expr_stmt><expr><call><name><name>LocalOozie</name><operator>.</operator><name>stop</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>services</name><operator>.</operator><name>destroy</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>super</name><operator>.</operator><name>tearDown</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
    </block_content>}</block></function>

    <function><type><specifier>public</specifier> <name>void</name></type> <name>testCoordActionUpdateStatus</name><parameter_list>()</parameter_list> <throws>throws <argument><expr><name>Exception</name></expr></argument></throws> <block>{<block_content>
        <decl_stmt><decl><type><name>int</name></type> <name>actionNum</name> <init>= <expr><literal type="number">1</literal></expr></init></decl>;</decl_stmt>
        <decl_stmt><decl><type><name>CoordinatorJobBean</name></type> <name>job</name> <init>= <expr><call><name>addRecordToCoordJobTable</name><argument_list>(<argument><expr><name><name>CoordinatorJob</name><operator>.</operator><name>Status</name><operator>.</operator><name>RUNNING</name></name></expr></argument>, <argument><expr><literal type="boolean">false</literal></expr></argument>, <argument><expr><literal type="boolean">false</literal></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <decl_stmt><decl><type><name>CoordinatorActionBean</name></type> <name>action</name> <init>= <expr><call><name>addRecordToCoordActionTable</name><argument_list>(<argument><expr><call><name><name>job</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><name>actionNum</name></expr></argument>,
                <argument><expr><name><name>CoordinatorAction</name><operator>.</operator><name>Status</name><operator>.</operator><name>RUNNING</name></name></expr></argument>, <argument><expr><literal type="string">"coord-action-get.xml"</literal></expr></argument>, <argument><expr><literal type="number">0</literal></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name>_testCoordActionUpdateStatus</name><argument_list>(<argument><expr><name>action</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    </block_content>}</block></function>

    <function><type><specifier>private</specifier> <name>void</name></type> <name>_testCoordActionUpdateStatus</name><parameter_list>(<parameter><decl><type><name>CoordinatorActionBean</name></type> <name>action</name></decl></parameter>)</parameter_list> <throws>throws <argument><expr><name>Exception</name></expr></argument></throws> <block>{<block_content>
        <decl_stmt><decl><type><name>JPAService</name></type> <name>jpaService</name> <init>= <expr><call><name><name>Services</name><operator>.</operator><name>get</name></name><argument_list>()</argument_list></call><operator>.</operator><call><name>get</name><argument_list>(<argument><expr><name><name>JPAService</name><operator>.</operator><name>class</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name>assertNotNull</name><argument_list>(<argument><expr><name>jpaService</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <expr_stmt><expr><call><name><name>action</name><operator>.</operator><name>setStatus</name></name><argument_list>(<argument><expr><name><name>CoordinatorAction</name><operator>.</operator><name>Status</name><operator>.</operator><name>SUCCEEDED</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>action</name><operator>.</operator><name>setRunConf</name></name><argument_list>(<argument><expr><literal type="string">"dummyConf"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>action</name><operator>.</operator><name>setExternalId</name></name><argument_list>(<argument><expr><literal type="string">"dummyExternalId"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>action</name><operator>.</operator><name>setPending</name></name><argument_list>(<argument><expr><literal type="number">1</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <comment type="line">// Call the JPAUpdate executor to execute the Update command</comment>
        <decl_stmt><decl><type><name>CoordActionUpdateForStartJPAExecutor</name></type> <name>coordUpdCmd</name> <init>= <expr><operator>new</operator> <call><name>CoordActionUpdateForStartJPAExecutor</name><argument_list>(<argument><expr><name>action</name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><name>coordUpdCmd</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <decl_stmt><decl><type><name>CoordActionGetJPAExecutor</name></type> <name>coordGetCmd</name> <init>= <expr><operator>new</operator> <call><name>CoordActionGetJPAExecutor</name><argument_list>(<argument><expr><call><name><name>action</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <decl_stmt><decl><type><name>CoordinatorActionBean</name></type> <name>newAction</name> <init>= <expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><name>coordGetCmd</name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>

        <expr_stmt><expr><call><name>assertNotNull</name><argument_list>(<argument><expr><name>newAction</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <comment type="line">// Check for expected values</comment>
        <expr_stmt><expr><call><name>assertEquals</name><argument_list>(<argument><expr><name><name>CoordinatorAction</name><operator>.</operator><name>Status</name><operator>.</operator><name>SUCCEEDED</name></name></expr></argument>, <argument><expr><call><name><name>newAction</name><operator>.</operator><name>getStatus</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>assertEquals</name><argument_list>(<argument><expr><literal type="string">"dummyConf"</literal></expr></argument>, <argument><expr><call><name><name>newAction</name><operator>.</operator><name>getRunConf</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>assertEquals</name><argument_list>(<argument><expr><literal type="string">"dummyExternalId"</literal></expr></argument>, <argument><expr><call><name><name>newAction</name><operator>.</operator><name>getExternalId</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>assertEquals</name><argument_list>(<argument><expr><literal type="number">1</literal></expr></argument>, <argument><expr><call><name><name>newAction</name><operator>.</operator><name>getPending</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    </block_content>}</block></function>

}</block></class>
<expr_stmt><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>test</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>executor</name><operator>/</operator><name>jpa</name><operator>/</operator><name><name>TestCoordActionsDeleteForPurgeJPAExecutor</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>test</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>executor</name><operator>/</operator><name>jpa</name><operator>/</operator><name><name>TestCoordActionsDeleteForPurgeJPAExecutor</name><operator>.</operator><name>java</name></name>
<name>index</name> <literal type="number">3e327ae22</literal><operator>..</operator><name>e69de29bb</name> <literal type="number">100644</literal>
<operator>--</operator> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>test</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>executor</name><operator>/</operator><name>jpa</name><operator>/</operator><name><name>TestCoordActionsDeleteForPurgeJPAExecutor</name><operator>.</operator><name>java</name></name>
<operator>++</operator> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>test</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>executor</name><operator>/</operator><name>jpa</name><operator>/</operator><name><name>TestCoordActionsDeleteForPurgeJPAExecutor</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">1</literal></expr><operator>,</operator><expr><literal type="number">65</literal> <operator>+</operator><literal type="number">0</literal></expr><operator>,</operator><expr><literal type="number">0</literal> @@</expr></expr_stmt>
<comment type="block" format="javadoc">/**
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 * 
 *      http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */</comment>
<package>package <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name></name>;</package>

<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>CoordinatorActionBean</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>CoordinatorJobBean</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>CoordinatorAction</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>CoordinatorJob</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>local</name><operator>.</operator><name>LocalOozie</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>JPAService</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>Services</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>test</name><operator>.</operator><name>XDataTestCase</name></name>;</import>

<class><specifier>public</specifier> class <name>TestCoordActionsDeleteForPurgeJPAExecutor</name> <super_list><extends>extends <super><name>XDataTestCase</name></super></extends></super_list> <block>{
    <decl_stmt><decl><type><name>Services</name></type> <name>services</name></decl>;</decl_stmt>

    <function><annotation>@<name>Override</name></annotation>
    <type><specifier>protected</specifier> <name>void</name></type> <name>setUp</name><parameter_list>()</parameter_list> <throws>throws <argument><expr><name>Exception</name></expr></argument></throws> <block>{<block_content>
        <expr_stmt><expr><call><name><name>super</name><operator>.</operator><name>setUp</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><name>services</name> <operator>=</operator> <operator>new</operator> <call><name>Services</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>services</name><operator>.</operator><name>init</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>cleanUpDBTables</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>LocalOozie</name><operator>.</operator><name>start</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
    </block_content>}</block></function>

    <function><annotation>@<name>Override</name></annotation>
    <type><specifier>protected</specifier> <name>void</name></type> <name>tearDown</name><parameter_list>()</parameter_list> <throws>throws <argument><expr><name>Exception</name></expr></argument></throws> <block>{<block_content>
        <expr_stmt><expr><call><name><name>LocalOozie</name><operator>.</operator><name>stop</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>services</name><operator>.</operator><name>destroy</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>super</name><operator>.</operator><name>tearDown</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
    </block_content>}</block></function>

    <function><type><specifier>public</specifier> <name>void</name></type> <name>testCoordActionDelForPurge</name><parameter_list>()</parameter_list> <throws>throws <argument><expr><name>Exception</name></expr></argument></throws> <block>{<block_content>
        <decl_stmt><decl><type><name>int</name></type> <name>actionNum</name> <init>= <expr><literal type="number">1</literal></expr></init></decl>;</decl_stmt>
        <decl_stmt><decl><type><name>CoordinatorJobBean</name></type> <name>job</name> <init>= <expr><call><name>addRecordToCoordJobTable</name><argument_list>(<argument><expr><name><name>CoordinatorJob</name><operator>.</operator><name>Status</name><operator>.</operator><name>RUNNING</name></name></expr></argument>, <argument><expr><literal type="boolean">false</literal></expr></argument>, <argument><expr><literal type="boolean">false</literal></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <decl_stmt><decl><type><name>CoordinatorActionBean</name></type> <name>action</name> <init>= <expr><call><name>addRecordToCoordActionTable</name><argument_list>(<argument><expr><call><name><name>job</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><name>actionNum</name></expr></argument>,
                <argument><expr><name><name>CoordinatorAction</name><operator>.</operator><name>Status</name><operator>.</operator><name>SUCCEEDED</name></name></expr></argument>, <argument><expr><literal type="string">"coord-action-get.xml"</literal></expr></argument>, <argument><expr><literal type="number">0</literal></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name>_testCoordActionDelForPurge</name><argument_list>(<argument><expr><call><name><name>job</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><call><name><name>action</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    </block_content>}</block></function>

    <function><type><specifier>private</specifier> <name>void</name></type> <name>_testCoordActionDelForPurge</name><parameter_list>(<parameter><decl><type><name>String</name></type> <name>jobId</name></decl></parameter>, <parameter><decl><type><name>String</name></type> <name>actionId</name></decl></parameter>)</parameter_list> <throws>throws <argument><expr><name>Exception</name></expr></argument></throws> <block>{<block_content>
        <decl_stmt><decl><type><name>JPAService</name></type> <name>jpaService</name> <init>= <expr><call><name><name>Services</name><operator>.</operator><name>get</name></name><argument_list>()</argument_list></call><operator>.</operator><call><name>get</name><argument_list>(<argument><expr><name><name>JPAService</name><operator>.</operator><name>class</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name>assertNotNull</name><argument_list>(<argument><expr><name>jpaService</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <decl_stmt><decl><type><name>CoordActionsDeleteForPurgeJPAExecutor</name></type> <name>coordDelCmd</name> <init>= <expr><operator>new</operator> <call><name>CoordActionsDeleteForPurgeJPAExecutor</name><argument_list>(<argument><expr><name>jobId</name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <decl_stmt><decl><type><name>Integer</name></type> <name>ret</name> <init>= <expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><name>coordDelCmd</name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name>assertNotNull</name><argument_list>(<argument><expr><name>ret</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>assertEquals</name><argument_list>(<argument><expr><call><name><name>ret</name><operator>.</operator><name>intValue</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><literal type="number">1</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    </block_content>}</block></function>

}</block></class>
<expr_stmt><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>test</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>executor</name><operator>/</operator><name>jpa</name><operator>/</operator><name><name>TestWorkflowActionsDeleteForPurgeJPAExecutor</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>test</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>executor</name><operator>/</operator><name>jpa</name><operator>/</operator><name><name>TestWorkflowActionsDeleteForPurgeJPAExecutor</name><operator>.</operator><name>java</name></name>
<name>index</name> <literal type="number">4167c73d3</literal><operator>..</operator><name>e69de29bb</name> <literal type="number">100644</literal>
<operator>--</operator> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>test</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>executor</name><operator>/</operator><name>jpa</name><operator>/</operator><name><name>TestWorkflowActionsDeleteForPurgeJPAExecutor</name><operator>.</operator><name>java</name></name>
<operator>++</operator> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>test</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>executor</name><operator>/</operator><name>jpa</name><operator>/</operator><name><name>TestWorkflowActionsDeleteForPurgeJPAExecutor</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">1</literal></expr><operator>,</operator><expr><literal type="number">64</literal> <operator>+</operator><literal type="number">0</literal></expr><operator>,</operator><expr><literal type="number">0</literal> @@</expr></expr_stmt>
<comment type="block" format="javadoc">/**
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 * 
 *      http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */</comment>
<package>package <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>executor</name><operator>.</operator><name>jpa</name></name>;</package>

<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>WorkflowJobBean</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>WorkflowAction</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>WorkflowJob</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>local</name><operator>.</operator><name>LocalOozie</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>JPAService</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>Services</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>test</name><operator>.</operator><name>XDataTestCase</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>workflow</name><operator>.</operator><name>WorkflowInstance</name></name>;</import>

<class><specifier>public</specifier> class <name>TestWorkflowActionsDeleteForPurgeJPAExecutor</name> <super_list><extends>extends <super><name>XDataTestCase</name></super></extends></super_list> <block>{
    <decl_stmt><decl><type><name>Services</name></type> <name>services</name></decl>;</decl_stmt>

    <function><annotation>@<name>Override</name></annotation>
    <type><specifier>protected</specifier> <name>void</name></type> <name>setUp</name><parameter_list>()</parameter_list> <throws>throws <argument><expr><name>Exception</name></expr></argument></throws> <block>{<block_content>
        <expr_stmt><expr><call><name><name>super</name><operator>.</operator><name>setUp</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><name>services</name> <operator>=</operator> <operator>new</operator> <call><name>Services</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>services</name><operator>.</operator><name>init</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>cleanUpDBTables</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>LocalOozie</name><operator>.</operator><name>start</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
    </block_content>}</block></function>

    <function><annotation>@<name>Override</name></annotation>
    <type><specifier>protected</specifier> <name>void</name></type> <name>tearDown</name><parameter_list>()</parameter_list> <throws>throws <argument><expr><name>Exception</name></expr></argument></throws> <block>{<block_content>
        <expr_stmt><expr><call><name><name>LocalOozie</name><operator>.</operator><name>stop</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>services</name><operator>.</operator><name>destroy</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name><name>super</name><operator>.</operator><name>tearDown</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
    </block_content>}</block></function>

    <function><type><specifier>public</specifier> <name>void</name></type> <name>testWorkflowActionsDeleteForPurge</name><parameter_list>()</parameter_list> <throws>throws <argument><expr><name>Exception</name></expr></argument></throws> <block>{<block_content>
        <decl_stmt><decl><type><name>WorkflowJobBean</name></type> <name>job</name> <init>= <expr><call><name><name>this</name><operator>.</operator><name>addRecordToWfJobTable</name></name><argument_list>(<argument><expr><name><name>WorkflowJob</name><operator>.</operator><name>Status</name><operator>.</operator><name>RUNNING</name></name></expr></argument>, <argument><expr><name><name>WorkflowInstance</name><operator>.</operator><name>Status</name><operator>.</operator><name>RUNNING</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name>addRecordToWfActionTable</name><argument_list>(<argument><expr><call><name><name>job</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><literal type="string">"1"</literal></expr></argument>, <argument><expr><name><name>WorkflowAction</name><operator>.</operator><name>Status</name><operator>.</operator><name>PREP</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>addRecordToWfActionTable</name><argument_list>(<argument><expr><call><name><name>job</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>, <argument><expr><literal type="string">"2"</literal></expr></argument>, <argument><expr><name><name>WorkflowAction</name><operator>.</operator><name>Status</name><operator>.</operator><name>PREP</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>_testDeleteWFActionsForJob</name><argument_list>(<argument><expr><call><name><name>job</name><operator>.</operator><name>getId</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    </block_content>}</block></function>

    <function><type><specifier>private</specifier> <name>void</name></type> <name>_testDeleteWFActionsForJob</name><parameter_list>(<parameter><decl><type><name>String</name></type> <name>jobId</name></decl></parameter>)</parameter_list> <throws>throws <argument><expr><name>Exception</name></expr></argument></throws> <block>{<block_content>
        <decl_stmt><decl><type><name>JPAService</name></type> <name>jpaService</name> <init>= <expr><call><name><name>Services</name><operator>.</operator><name>get</name></name><argument_list>()</argument_list></call><operator>.</operator><call><name>get</name><argument_list>(<argument><expr><name><name>JPAService</name><operator>.</operator><name>class</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name>assertNotNull</name><argument_list>(<argument><expr><name>jpaService</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <decl_stmt><decl><type><name>WorkflowActionsDeleteForPurgeJPAExecutor</name></type> <name>deleteActionsExecutor</name> <init>= <expr><operator>new</operator> <call><name>WorkflowActionsDeleteForPurgeJPAExecutor</name><argument_list>(<argument><expr><name>jobId</name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <decl_stmt><decl><type><name>int</name></type> <name>actionsDeleted</name> <init>= <expr><call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><name>deleteActionsExecutor</name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><call><name>assertEquals</name><argument_list>(<argument><expr><literal type="number">2</literal></expr></argument>, <argument><expr><name>actionsDeleted</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    </block_content>}</block></function>

}</block></class>
<expr_stmt><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>test</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>service</name><operator>/</operator><name><name>TestStatusTransitService</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>test</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>service</name><operator>/</operator><name><name>TestStatusTransitService</name><operator>.</operator><name>java</name></name>
<name>index</name> <name>cd68acf7e</name><operator>..</operator><literal type="number">65de2d151</literal> <literal type="number">100644</literal>
<operator>--</operator> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>test</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>service</name><operator>/</operator><name><name>TestStatusTransitService</name><operator>.</operator><name>java</name></name>
<operator>++</operator> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>test</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>service</name><operator>/</operator><name><name>TestStatusTransitService</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">198</literal></expr><operator>,</operator><expr><literal type="number">7</literal> <operator>+</operator><literal type="number">198</literal></expr><operator>,</operator><expr><literal type="number">7</literal> @@ <specifier>public</specifier> <name>class</name> <name>TestStatusTransitService</name> extends <name>XDataTestCase</name> <block>{
         <expr><call><name>assertEquals</name><argument_list>(<argument><expr><name><name>CoordinatorJob</name><operator>.</operator><name>Status</name><operator>.</operator><name>KILLED</name></name></expr></argument>, <argument><expr><call><name><name>coordJob</name><operator>.</operator><name>getStatus</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;
         <call><name>assertEquals</name><argument_list>(<argument><expr><name><name>CoordinatorAction</name><operator>.</operator><name>Status</name><operator>.</operator><name>KILLED</name></name></expr></argument>, <argument><expr><call><name><name>coordAction</name><operator>.</operator><name>getStatus</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></block></expr>;</expr_stmt>
         <expr_stmt><expr><call><name>assertEquals</name><argument_list>(<argument><expr><name><name>WorkflowJob</name><operator>.</operator><name>Status</name><operator>.</operator><name>KILLED</name></name></expr></argument>, <argument><expr><call><name><name>wfJob</name><operator>.</operator><name>getStatus</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>assertEquals</name><argument_list>(<argument><expr><literal type="boolean">false</literal></expr></argument>, <argument><expr><call><name><name>coordAction</name><operator>.</operator><name>isPending</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <comment type="line">//assertEquals(false, coordAction.isPending());</comment>
 
         <decl_stmt><decl><type><name>Runnable</name></type> <name>runnable</name> <init>= <expr><operator>new</operator> <call><name>StatusTransitRunnable</name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
         <constructor_decl><name><name>runnable</name><operator>.</operator><name>run</name></name><parameter_list>()</parameter_list>;</constructor_decl>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">215</literal></expr><operator>,</operator><expr><literal type="number">7</literal> <operator>+</operator><literal type="number">215</literal></expr><operator>,</operator><expr><literal type="number">7</literal> @@ <specifier>public</specifier> <name>class</name> <name>TestStatusTransitService</name> extends <name>XDataTestCase</name> <block>{
         }</block></expr></expr_stmt>)</block>;</class>
 
         <expr_stmt><expr><name>coordJob</name> <operator>=</operator> <call><name><name>jpaService</name><operator>.</operator><name>execute</name></name><argument_list>(<argument><expr><name>coordJobGetCmd</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>assertEquals</name><argument_list>(<argument><expr><literal type="boolean">false</literal></expr></argument>, <argument><expr><call><name><name>coordJob</name><operator>.</operator><name>isPending</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <comment type="line">//assertEquals(false, coordJob.isPending());</comment>
     </block_content>}</block></catch></try></block_content></block></if></if_stmt></block_content></block></try></block></expr></expr_stmt></block_content></block></catch></try></block></expr></expr_stmt></block_content></block></else></if_stmt></block_content></block></constructor></block_content></block></constructor></block></class></block_content></block></if></if_stmt></block_content></block></finally></block_content></block></catch></try></block_content></block></finally></try></block_content></block></constructor></block_content></block></function></block_content></block></function></block_content></block></function></block></class></block_content></block></else></if_stmt></block_content></block></constructor></block></class></block_content></block></else></if_stmt></block_content></block></function></block_content></block></function></block_content></block></catch></try></block_content></block></function></block_content></block></function></block_content></block></try></block_content></block></function></block_content></block></function></block_content></block></function></block_content></block></finally>
 
     <comment type="block" format="javadoc">/**
diff --git a/release-log.txt b/release-log.txt
index 7d333743b..723483172 100644
-- a/release-log.txt
++ b/release-log.txt
@@ -1,5 +1,6 @@
 -- Oozie 3.3.0 release (trunk - unreleased)
 
OOZIE-914 Make sure all commands do their JPA writes within a single JPA executor (mona via virag)
 OOZIE-918 Changing log level from DEBUG to TRACE for trivial log statements (mona via virag)
 OOZIE-957 TestStatusTransitService and TestCoordKillXCommand are failing randomly; replace Thread.sleep() (rkanter via tucu)
 OOZIE-477 Adding configurable filesystem support instead of hardcoded "hdfs" (mayank, mona via tucu)
- 
2.19.1.windows.1

</comment></unit>
