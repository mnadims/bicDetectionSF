<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<unit xmlns="http://www.srcML.org/srcML/src" revision="1.0.0" language="Java" filename="E:/01Courses@USASK/CMPT898-HumanDrivenSoftwareEngineeringForScientificResearch/ProjectProgress/data_files/final_dataset/gen_patch_codes/filtered/oozie/0f086d41.java"><expr_stmt><expr><name>From</name> <literal type="number">0f086d41b8f274abe0959705f76fa3225ab5ff2e</literal> <name>Mon</name> <name>Sep</name> <literal type="number">17</literal> <literal type="number">00</literal><operator>:</operator><literal type="number">00</literal><operator>:</operator><literal type="number">00</literal> <literal type="number">2001</literal>
<name>From</name><operator>:</operator> <name>Rohini</name> <name><name>Palaniswamy</name> <argument_list type="generic">&lt;<argument><name>rohini</name><annotation>@<name><name>apache</name><operator>.</operator><name>org</name></name></annotation></argument>&gt;</argument_list></name>
<name>Date</name><operator>:</operator> <name>Sat</name></expr><operator>,</operator> <expr><literal type="number">9</literal> <name>Jan</name> <literal type="number">2016</literal> <literal type="number">16</literal><operator>:</operator><literal type="number">02</literal><operator>:</operator><literal type="number">12</literal> <operator>-</operator><literal type="number">0800</literal>
<name>Subject</name><operator>:</operator> <index>[<expr><name>PATCH</name></expr>]</index> <name>OOZIE</name><operator>-</operator><literal type="number">2030</literal> <name>Configuration</name> <name>properties</name> <name>from</name> <name>global</name> <name>section</name> <name>is</name>
 <name>not</name> <name>getting</name> <name>set</name> <name>in</name> <name>Hadoop</name> <name>job</name> <name>conf</name> <name>when</name> <name>using</name> <name>sub</name><operator>-</operator><name>workflow</name> <name>action</name> <name>in</name> <name>Oozie</name>
 <call><name><name>workflow</name><operator>.</operator><name>xml</name></name> <argument_list>(<argument><expr><name>jaydeepvishwakarma</name> <name>via</name> <name>rohini</name></expr></argument>)</argument_list></call>

<operator>--</operator>
 <operator>...</operator><operator>/</operator><name>oozie</name><operator>/</operator><name><name>SubWorkflowActionExecutor</name><operator>.</operator><name>java</name></name>      <operator>|</operator>   <literal type="number">4</literal> <operator>+</operator>
 <operator>...</operator><operator>/</operator><name>workflow</name><operator>/</operator><name>lite</name><operator>/</operator><name><name>LiteWorkflowAppParser</name><operator>.</operator><name>java</name></name>  <operator>|</operator> <literal type="number">135</literal> <operator>++</operator><operator>++</operator><operator>++</operator><operator>++</operator><operator>++</operator><operator>++</operator><operator>++</operator><operator>++</operator><operator>--</operator>
 <operator>...</operator><operator>/</operator><name>oozie</name><operator>/</operator><name><name>TestSubWorkflowActionExecutor</name><operator>.</operator><name>java</name></name>  <operator>|</operator> <literal type="number">113</literal> <operator>++</operator><operator>++</operator><operator>++</operator><operator>++</operator><operator>++</operator><operator>++</operator><operator>++</operator><operator>-</operator>
 <name>release</name><operator>-</operator><name><name>log</name><operator>.</operator><name>txt</name></name>                               <operator>|</operator>   <literal type="number">1</literal> <operator>+</operator>
 <literal type="number">4</literal> <name>files</name> <name>changed</name></expr><operator>,</operator> <expr><literal type="number">238</literal> <call><name>insertions</name><argument_list>(<argument><expr><operator>+</operator></expr></argument>)</argument_list></call></expr><operator>,</operator> <expr><literal type="number">15</literal> <call><name>deletions</name><argument_list>(<argument><expr><operator>-</operator></expr></argument>)</argument_list></call>

<name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>action</name><operator>/</operator><name>oozie</name><operator>/</operator><name><name>SubWorkflowActionExecutor</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>action</name><operator>/</operator><name>oozie</name><operator>/</operator><name><name>SubWorkflowActionExecutor</name><operator>.</operator><name>java</name></name>
<name>index</name> <literal type="number">33efc6053</literal><operator>..</operator><literal type="number">6bf35983b</literal> <literal type="number">100644</literal>
<operator>--</operator> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>action</name><operator>/</operator><name>oozie</name><operator>/</operator><name><name>SubWorkflowActionExecutor</name><operator>.</operator><name>java</name></name>
<operator>++</operator> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>action</name><operator>/</operator><name>oozie</name><operator>/</operator><name><name>SubWorkflowActionExecutor</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">306</literal></expr><operator>,</operator><expr><literal type="number">4</literal> <operator>+</operator><literal type="number">306</literal></expr><operator>,</operator><expr><literal type="number">8</literal> @@ <specifier>public</specifier> <name>class</name> <name>SubWorkflowActionExecutor</name> extends <name>ActionExecutor</name> <block>{
     <expr><specifier>public</specifier> <name>boolean</name> <call><name>isCompleted</name><argument_list>(<argument><expr><name>String</name> <name>externalStatus</name></expr></argument>)</argument_list></call> <block>{
         <return>return <expr><call><name><name>FINAL_STATUS</name><operator>.</operator><name>contains</name></name><argument_list>(<argument><expr><name>externalStatus</name></expr></argument>)</argument_list></call></expr>;</return></block></expr>
     }</block>

    <specifier>public</specifier> <name>boolean</name> <call><name>supportsConfigurationJobXML</name><argument_list>()</argument_list></call> <block>{
        <return>return <expr><literal type="boolean">true</literal></expr>;</return>
    }</block></expr></expr_stmt>
 }
diff <expr_stmt><expr><operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>workflow</name><operator>/</operator><name>lite</name><operator>/</operator><name><name>LiteWorkflowAppParser</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>workflow</name><operator>/</operator><name>lite</name><operator>/</operator><name><name>LiteWorkflowAppParser</name><operator>.</operator><name>java</name></name>
<name>index</name> <name>d3a652360</name><operator>..</operator><literal type="number">03c84f15b</literal> <literal type="number">100644</literal>
<operator>--</operator> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>workflow</name><operator>/</operator><name>lite</name><operator>/</operator><name><name>LiteWorkflowAppParser</name><operator>.</operator><name>java</name></name>
<operator>++</operator> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>workflow</name><operator>/</operator><name>lite</name><operator>/</operator><name><name>LiteWorkflowAppParser</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">18</literal></expr><operator>,</operator><expr><literal type="number">8</literal> <operator>+</operator><literal type="number">18</literal></expr><operator>,</operator><expr><literal type="number">10</literal> @@</expr></expr_stmt>
 
 <package>package <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>workflow</name><operator>.</operator><name>lite</name></name>;</package>
 
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>commons</name><operator>.</operator><name>codec</name><operator>.</operator><name>binary</name><operator>.</operator><name>Base64</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>hadoop</name><operator>.</operator><name>io</name><operator>.</operator><name>Writable</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>action</name><operator>.</operator><name>oozie</name><operator>.</operator><name>SubWorkflowActionExecutor</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>ConfigurationService</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>workflow</name><operator>.</operator><name>WorkflowException</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>util</name><operator>.</operator><name>ELUtils</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>util</name><operator>.</operator><name>IOUtils</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>util</name><operator>.</operator><name>XConfiguration</name></name>;</import>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">27</literal></expr><operator>,</operator><expr><literal type="number">7</literal> <operator>+</operator><literal type="number">29</literal></expr><operator>,</operator><expr><literal type="number">9</literal> @@</expr></expr_stmt> <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>util</name><operator>.</operator><name>XmlUtils</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>util</name><operator>.</operator><name>ParamChecker</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>util</name><operator>.</operator><name>ParameterVerifier</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>util</name><operator>.</operator><name>ParameterVerifierException</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>util</name><operator>.</operator><name>WritableUtils</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>ErrorCode</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>workflow</name><operator>.</operator><name>WorkflowException</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>action</name><operator>.</operator><name>ActionExecutor</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>Services</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>ActionService</name></name>;</import>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">46</literal></expr><operator>,</operator><expr><literal type="number">6</literal> <operator>+</operator><literal type="number">50</literal></expr><operator>,</operator><expr><literal type="number">12</literal> @@</expr></expr_stmt> <import>import <name><name>java</name><operator>.</operator><name>io</name><operator>.</operator><name>IOException</name></name>;</import>
 <import>import <name><name>java</name><operator>.</operator><name>io</name><operator>.</operator><name>Reader</name></name>;</import>
 <import>import <name><name>java</name><operator>.</operator><name>io</name><operator>.</operator><name>StringReader</name></name>;</import>
 <import>import <name><name>java</name><operator>.</operator><name>io</name><operator>.</operator><name>StringWriter</name></name>;</import>
<import>import <name><name>java</name><operator>.</operator><name>io</name><operator>.</operator><name>ByteArrayOutputStream</name></name>;</import>
<import>import <name><name>java</name><operator>.</operator><name>io</name><operator>.</operator><name>ByteArrayInputStream</name></name>;</import>
<import>import <name><name>java</name><operator>.</operator><name>io</name><operator>.</operator><name>DataInputStream</name></name>;</import>
<import>import <name><name>java</name><operator>.</operator><name>io</name><operator>.</operator><name>DataInput</name></name>;</import>
<import>import <name><name>java</name><operator>.</operator><name>io</name><operator>.</operator><name>DataOutput</name></name>;</import>
<import>import <name><name>java</name><operator>.</operator><name>io</name><operator>.</operator><name>DataOutputStream</name></name>;</import>
 <import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>ArrayList</name></name>;</import>
 <import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>Arrays</name></name>;</import>
 <import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>Deque</name></name>;</import>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">54</literal></expr><operator>,</operator><expr><literal type="number">6</literal> <operator>+</operator><literal type="number">64</literal></expr><operator>,</operator><expr><literal type="number">7</literal> @@</expr></expr_stmt> <import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>HashSet</name></name>;</import>
 <import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>LinkedList</name></name>;</import>
 <import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>List</name></name>;</import>
 <import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>Map</name></name>;</import>
<import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>zip</name><operator>.</operator><name>*</name></name>;</import>
 
 <comment type="block" format="javadoc">/**
  * Class to parse and validate workflow xml
@@ -95,6 +106,7 @@ public class LiteWorkflowAppParser {
 
     public static final String DEFAULT_NAME_NODE = "oozie.actions.default.name-node";
     public static final String DEFAULT_JOB_TRACKER = "oozie.actions.default.job-tracker";
    public static final String OOZIE_GLOBAL = "oozie.wf.globalconf";
 
     private static final String JOB_TRACKER = "job-tracker";
     private static final String NAME_NODE = "name-node";
@@ -417,7 +429,9 @@ public class LiteWorkflowAppParser {
             throws WorkflowException {
         Namespace ns = root.getNamespace();
         LiteWorkflowApp def = null;
        GlobalSectionData gData = null;
        GlobalSectionData gData = jobConf.get(OOZIE_GLOBAL) == null ?
                null : getGlobalFromString(jobConf.get(OOZIE_GLOBAL));
        boolean serializedGlobalConf = false;
         for (Element eNode : (List&lt;Element&gt;) root.getChildren()) {
             if (eNode.getName().equals(START_E)) {
                 def = new LiteWorkflowApp(root.getAttributeValue(NAME_A), strDef,
@@ -457,6 +471,11 @@ public class LiteWorkflowAppParser {
                     } else if (SLA_INFO.equals(elem.getName()) || CREDENTIALS.equals(elem.getName())) {
                         continue;
                     } else {
                        if (!serializedGlobalConf  &amp;&amp; elem.getName().equals(SubWorkflowActionExecutor.ACTION_TYPE) &amp;&amp;
                                elem.getChild(("propagate-configuration"), ns) != null) {
                            serializedGlobalConf = true;
                            jobConf.set(OOZIE_GLOBAL, getGlobalString(gData));
                        }
                         eActionConf = elem;
                         handleDefaultsAndGlobal(gData, configDefault, elem);
                     }
@@ -484,6 +503,10 @@ public class LiteWorkflowAppParser {
             } else if (SLA_INFO.equals(eNode.getName()) || CREDENTIALS.equals(eNode.getName())) {
                 // No operation is required
             } else if (eNode.getName().equals(GLOBAL)) {
                if(jobConf.get(OOZIE_GLOBAL) != null) {
                    gData = getGlobalFromString(jobConf.get(OOZIE_GLOBAL));
                    handleDefaultsAndGlobal(gData, null, eNode);
                }
                 gData = parseGlobalSection(ns, eNode);
             } else if (eNode.getName().equals(PARAMETERS)) {
                 // No operation is required
@@ -494,6 +517,47 @@ public class LiteWorkflowAppParser {
         return def;
     }
 
    /**
     * Read the GlobalSectionData from Base64 string.
     * @param globalStr
     * @return GlobalSectionData
     * @throws WorkflowException
     */</comment>
    <function><type><specifier>private</specifier> <name>GlobalSectionData</name></type> <name>getGlobalFromString</name><parameter_list>(<parameter><decl><type><name>String</name></type> <name>globalStr</name></decl></parameter>)</parameter_list> <throws>throws <argument><expr><name>WorkflowException</name></expr></argument></throws> <block>{<block_content>
        <decl_stmt><decl><type><name>GlobalSectionData</name></type> <name>globalSectionData</name> <init>= <expr><operator>new</operator> <call><name>GlobalSectionData</name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
        <try>try <block>{<block_content>
            <decl_stmt><decl><type><name><name>byte</name><index>[]</index></name></type> <name>data</name> <init>= <expr><call><name><name>Base64</name><operator>.</operator><name>decodeBase64</name></name><argument_list>(<argument><expr><name>globalStr</name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
            <decl_stmt><decl><type><name>Inflater</name></type> <name>inflater</name> <init>= <expr><operator>new</operator> <call><name>Inflater</name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
            <decl_stmt><decl><type><name>DataInputStream</name></type> <name>ois</name> <init>= <expr><operator>new</operator> <call><name>DataInputStream</name><argument_list>(<argument><expr><operator>new</operator> <call><name>InflaterInputStream</name><argument_list>(<argument><expr><operator>new</operator> <call><name>ByteArrayInputStream</name><argument_list>(<argument><expr><name>data</name></expr></argument>)</argument_list></call></expr></argument>, <argument><expr><name>inflater</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
            <expr_stmt><expr><call><name><name>globalSectionData</name><operator>.</operator><name>readFields</name></name><argument_list>(<argument><expr><name>ois</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name><name>ois</name><operator>.</operator><name>close</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        </block_content>}</block> <catch>catch <parameter_list>(<parameter><decl><type><name>Exception</name></type> <name>ex</name></decl></parameter>)</parameter_list> <block>{<block_content>
            <throw>throw <expr><operator>new</operator> <call><name>WorkflowException</name><argument_list>(<argument><expr><name><name>ErrorCode</name><operator>.</operator><name>E0700</name></name></expr></argument>, <argument><expr><literal type="string">"Error while processing global section conf"</literal></expr></argument>)</argument_list></call></expr>;</throw>
        </block_content>}</block></catch></try>
        <return>return <expr><name>globalSectionData</name></expr>;</return>
    </block_content>}</block></function>


    <comment type="block" format="javadoc">/**
     * Write the GlobalSectionData to a Base64 string.
     * @param globalSectionData
     * @return String
     * @throws WorkflowException
     */</comment>
    <function><type><specifier>private</specifier> <name>String</name></type> <name>getGlobalString</name><parameter_list>(<parameter><decl><type><name>GlobalSectionData</name></type> <name>globalSectionData</name></decl></parameter>)</parameter_list> <throws>throws <argument><expr><name>WorkflowException</name></expr></argument></throws> <block>{<block_content>
        <decl_stmt><decl><type><name>ByteArrayOutputStream</name></type> <name>baos</name> <init>= <expr><operator>new</operator> <call><name>ByteArrayOutputStream</name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
        <decl_stmt><decl><type><name>DataOutputStream</name></type> <name>oos</name> <init>= <expr><literal type="null">null</literal></expr></init></decl>;</decl_stmt>
        <try>try <block>{<block_content>
            <decl_stmt><decl><type><name>Deflater</name></type> <name>def</name> <init>= <expr><operator>new</operator> <call><name>Deflater</name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
            <expr_stmt><expr><name>oos</name> <operator>=</operator> <operator>new</operator> <call><name>DataOutputStream</name><argument_list>(<argument><expr><operator>new</operator> <call><name>DeflaterOutputStream</name><argument_list>(<argument><expr><name>baos</name></expr></argument>, <argument><expr><name>def</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name><name>globalSectionData</name><operator>.</operator><name>write</name></name><argument_list>(<argument><expr><name>oos</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt><expr><call><name><name>oos</name><operator>.</operator><name>close</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        </block_content>}</block> <catch>catch <parameter_list>(<parameter><decl><type><name>IOException</name></type> <name>e</name></decl></parameter>)</parameter_list> <block>{<block_content>
            <throw>throw <expr><operator>new</operator> <call><name>WorkflowException</name><argument_list>(<argument><expr><name><name>ErrorCode</name><operator>.</operator><name>E0700</name></name></expr></argument>, <argument><expr><literal type="string">"Error while processing global section conf"</literal></expr></argument>)</argument_list></call></expr>;</throw>
        </block_content>}</block></catch></try>
        <return>return <expr><call><name><name>Base64</name><operator>.</operator><name>encodeBase64String</name></name><argument_list>(<argument><expr><call><name><name>baos</name><operator>.</operator><name>toByteArray</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</return>
    </block_content>}</block></function>

     <comment type="block" format="javadoc">/**
      * Validate workflow xml
      *
@@ -570,11 +634,14 @@ public class LiteWorkflowAppParser {
         parent.addContent(child);
     }
 
    private class GlobalSectionData {
        final String jobTracker;
        final String nameNode;
        final List&lt;String&gt; jobXmls;
        final Configuration conf;
    private class GlobalSectionData implements Writable {
        String jobTracker;
        String nameNode;
        List&lt;String&gt; jobXmls;
        Configuration conf;

        public GlobalSectionData() {
        }
 
         public GlobalSectionData(String jobTracker, String nameNode, List&lt;String&gt; jobXmls, Configuration conf) {
             this.jobTracker = jobTracker;
@@ -582,6 +649,43 @@ public class LiteWorkflowAppParser {
             this.jobXmls = jobXmls;
             this.conf = conf;
         }

        @Override
        public void write(DataOutput dataOutput) throws IOException {
            WritableUtils.writeStr(dataOutput, jobTracker);
            WritableUtils.writeStr(dataOutput, nameNode);

            if(jobXmls != null &amp;&amp; !jobXmls.isEmpty()) {
                dataOutput.writeInt(jobXmls.size());
                for (String content : jobXmls) {
                    WritableUtils.writeStr(dataOutput, content);
                }
            } else {
                dataOutput.writeInt(0);
            }
            if(conf != null) {
                WritableUtils.writeStr(dataOutput, XmlUtils.prettyPrint(conf).toString());
            } else {
                WritableUtils.writeStr(dataOutput, null);
            }
        }

        @Override
        public void readFields(DataInput dataInput) throws IOException {
            jobTracker = WritableUtils.readStr(dataInput);
            nameNode = WritableUtils.readStr(dataInput);
            int length = dataInput.readInt();
            if (length &gt; 0) {
                jobXmls = new ArrayList&lt;String&gt;();
                for (int i = 0; i &lt; length; i++) {
                    jobXmls.add(WritableUtils.readStr(dataInput));
                }
            }
            String confString = WritableUtils.readStr(dataInput);
            if(confString != null) {
                conf = new XConfiguration(new StringReader(confString));
            }
        }
     }
 
     private GlobalSectionData parseGlobalSection(Namespace ns, Element global) throws WorkflowException {
@@ -625,20 +729,23 @@ public class LiteWorkflowAppParser {
 
     private void handleDefaultsAndGlobal(GlobalSectionData gData, Configuration configDefault, Element actionElement)
             throws WorkflowException {

         ActionExecutor ae = Services.get().get(ActionService.class).getExecutor(actionElement.getName());
        if (ae == null) {
        if (ae == null &amp;&amp; !GLOBAL.equals(actionElement.getName())) {
             throw new WorkflowException(ErrorCode.E0723, actionElement.getName(), ActionService.class.getName());
         }
 
         Namespace actionNs = actionElement.getNamespace();
 
        if (ae.requiresNameNodeJobTracker()) {
        if (SubWorkflowActionExecutor.ACTION_TYPE.equals(actionElement.getName()) ||
                GLOBAL.equals(actionElement.getName()) || ae.requiresNameNodeJobTracker()) {
             if (actionElement.getChild(NAME_NODE, actionNs) == null) {
                 if (gData != null &amp;&amp; gData.nameNode != null) {
                     addChildElement(actionElement, actionNs, NAME_NODE, gData.nameNode);
                 } else if (defaultNameNode != null) {
                     addChildElement(actionElement, actionNs, NAME_NODE, defaultNameNode);
                } else {
                } else if (!(SubWorkflowActionExecutor.ACTION_TYPE.equals(actionElement.getName()) ||
                        GLOBAL.equals(actionElement.getName()))) {
                     throw new WorkflowException(ErrorCode.E0701, "No " + NAME_NODE + " defined");
                 }
             }
@@ -647,13 +754,14 @@ public class LiteWorkflowAppParser {
                     addChildElement(actionElement, actionNs, JOB_TRACKER, gData.jobTracker);
                 } else if (defaultJobTracker != null) {
                     addChildElement(actionElement, actionNs, JOB_TRACKER, defaultJobTracker);
                } else {
                } else if (!(SubWorkflowActionExecutor.ACTION_TYPE.equals(actionElement.getName()) ||
                        GLOBAL.equals(actionElement.getName()))) {
                     throw new WorkflowException(ErrorCode.E0701, "No " + JOB_TRACKER + " defined");
                 }
             }
         }
 
        if (ae.supportsConfigurationJobXML()) {
        if ( GLOBAL.equals(actionElement.getName()) || ae.supportsConfigurationJobXML()) {
             @SuppressWarnings("unchecked")
             List&lt;Element&gt; actionJobXmls = actionElement.getChildren(JOB_XML, actionNs);
             if (gData != null &amp;&amp; gData.jobXmls != null) {
@@ -706,5 +814,4 @@ public class LiteWorkflowAppParser {
             }
         }
     }

}
}
\ No newline at end of file
diff --git a/core/src/test/java/org/apache/oozie/action/oozie/TestSubWorkflowActionExecutor.java b/core/src/test/java/org/apache/oozie/action/oozie/TestSubWorkflowActionExecutor.java
index 9ab897ac8..26e5031af 100644
-- a/core/src/test/java/org/apache/oozie/action/oozie/TestSubWorkflowActionExecutor.java
++ b/core/src/test/java/org/apache/oozie/action/oozie/TestSubWorkflowActionExecutor.java
@@ -24,6 +24,7 @@ import org.apache.hadoop.fs.Path;
 import org.apache.oozie.WorkflowActionBean;
 import org.apache.oozie.WorkflowJobBean;
 import org.apache.oozie.action.hadoop.ActionExecutorTestCase;
import org.apache.oozie.action.hadoop.LauncherMainTester;
 import org.apache.oozie.client.OozieClient;
 import org.apache.oozie.client.WorkflowAction;
 import org.apache.oozie.client.WorkflowJob;
@@ -33,6 +34,8 @@ import org.apache.oozie.service.Services;
 import org.apache.oozie.service.WorkflowAppService;
 import org.apache.oozie.service.XLogService;
 import org.apache.oozie.util.XConfiguration;
import org.apache.oozie.util.XmlUtils;
import org.jdom.Element;
 
 import java.io.*;
 import java.net.URI;
@@ -544,7 +547,7 @@ public class TestSubWorkflowActionExecutor extends ActionExecutorTestCase {
     }
 
     public String getLazyWorkflow() {
        return  "&lt;workflow-app xmlns='uri:oozie:workflow:0.3' name='app'&gt;" +
        return  "&lt;workflow-app xmlns='uri:oozie:workflow:0.4' name='app'&gt;" +
                 "&lt;start to='java' /&gt;" +
                 "       &lt;action name='java'&gt;" +
                 "&lt;java&gt;" +
@@ -634,4 +637,112 @@ public class TestSubWorkflowActionExecutor extends ActionExecutorTestCase {
         }
 
     }

    public void testParentGlobalConf() throws Exception {
        try {
            Path subWorkflowAppPath = getFsTestCaseDir();
            FileSystem fs = getFileSystem();
            Path subWorkflowPath = new Path(subWorkflowAppPath, "workflow.xml");
            Writer writer = new OutputStreamWriter(fs.create(subWorkflowPath));
            writer.write(getWorkflow());
            writer.close();

            String workflowUri = getTestCaseFileUri("workflow.xml");
            String appXml = "&lt;workflow-app xmlns=\"uri:oozie:workflow:0.4\" name=\"workflow\"&gt;" +
                    "&lt;global&gt;" +
                    "   &lt;configuration&gt;" +
                    "        &lt;property&gt;" +
                    "            &lt;name&gt;foo2&lt;/name&gt;" +
                    "            &lt;value&gt;foo2&lt;/value&gt;" +
                    "        &lt;/property&gt;" +
                    "        &lt;property&gt;" +
                    "            &lt;name&gt;foo3&lt;/name&gt;" +
                    "            &lt;value&gt;foo3&lt;/value&gt;" +
                    "        &lt;/property&gt;" +
                    "    &lt;/configuration&gt;" +
                    "&lt;/global&gt;" +
                    "&lt;start to=\"subwf\"/&gt;" +
                    "&lt;action name=\"subwf\"&gt;" +
                    "     &lt;sub-workflow xmlns='uri:oozie:workflow:0.4'&gt;" +
                    "          &lt;app-path&gt;" + subWorkflowAppPath.toString() + "&lt;/app-path&gt;" +
                    "&lt;propagate-configuration/&gt;" +
                    "   &lt;configuration&gt;" +
                    "        &lt;property&gt;" +
                    "            &lt;name&gt;foo3&lt;/name&gt;" +
                    "            &lt;value&gt;actionconf&lt;/value&gt;" +
                    "        &lt;/property&gt;" +
                    "   &lt;/configuration&gt;" +
                    "     &lt;/sub-workflow&gt;" +
                    "     &lt;ok to=\"end\"/&gt;" +
                    "     &lt;error to=\"fail\"/&gt;" +
                    "&lt;/action&gt;" +
                    "&lt;kill name=\"fail\"&gt;" +
                    "     &lt;message&gt;Sub workflow failed, error message[${wf:errorMessage(wf:lastErrorNode())}]&lt;/message&gt;" +
                    "&lt;/kill&gt;" +
                    "&lt;end name=\"end\"/&gt;" +
                    "&lt;/workflow-app&gt;";

            writeToFile(appXml, workflowUri);
            LocalOozie.start();
            final OozieClient wfClient = LocalOozie.getClient();
            Properties conf = wfClient.createConfiguration();
            conf.setProperty(OozieClient.APP_PATH, workflowUri);
            conf.setProperty(OozieClient.USER_NAME, getTestUser());
            conf.setProperty("appName", "var-app-name");
            final String jobId = wfClient.submit(conf);
            wfClient.start(jobId);

            waitFor(JOB_TIMEOUT, new Predicate() {
                public boolean evaluate() throws Exception {
                    return (wfClient.getJobInfo(jobId).getStatus() == WorkflowJob.Status.SUCCEEDED) &amp;&amp;
                            (wfClient.getJobInfo(jobId).getActions().get(1).getStatus() == WorkflowAction.Status.OK);
                }
            });
            WorkflowJob subWorkflow = wfClient.getJobInfo(wfClient.getJobInfo(jobId).
                    getActions().get(1).getExternalId());
            Configuration subWorkflowConf = new XConfiguration(new StringReader(subWorkflow.getConf()));
            Element eConf = XmlUtils.parseXml(subWorkflow.getActions().get(1).getConf());
            Element element = eConf.getChild("configuration", eConf.getNamespace());
            Configuration actionConf = new XConfiguration(new StringReader(XmlUtils.prettyPrint(element).toString()));
            assertEquals(actionConf.get("foo1"), "foo1");
            assertEquals(actionConf.get("foo2"), "subconf");
            assertEquals(actionConf.get("foo3"), "foo3");
            // Checking the action conf configuration.
            assertEquals(subWorkflowConf.get("foo3"), "actionconf");
        } finally {
            LocalOozie.stop();
        }
    }

    public String getWorkflow() {
        return  "&lt;workflow-app xmlns='uri:oozie:workflow:0.4' name='app'&gt;" +
                "&lt;global&gt;" +
                "   &lt;configuration&gt;" +
                "        &lt;property&gt;" +
                "            &lt;name&gt;foo1&lt;/name&gt;" +
                "            &lt;value&gt;foo1&lt;/value&gt;" +
                "        &lt;/property&gt;" +
                "        &lt;property&gt;" +
                "            &lt;name&gt;foo2&lt;/name&gt;" +
                "            &lt;value&gt;subconf&lt;/value&gt;" +
                "        &lt;/property&gt;" +
                "    &lt;/configuration&gt;" +
                "&lt;/global&gt;" +
                "&lt;start to='java' /&gt;" +
                "&lt;action name='java'&gt;" +
                "&lt;java&gt;" +
                "&lt;job-tracker&gt;" + getJobTrackerUri() + "&lt;/job-tracker&gt;" +
                "&lt;name-node&gt;" + getNameNodeUri() + "&lt;/name-node&gt;" +
                "&lt;main-class&gt;" + LauncherMainTester.class.getName() + "&lt;/main-class&gt;" +
                "&lt;arg&gt;exit0&lt;/arg&gt;" +
                "&lt;/java&gt;"
                + "&lt;ok to='end' /&gt;"
                + "&lt;error to='fail' /&gt;"
                + "&lt;/action&gt;"
                + "&lt;kill name='fail'&gt;"
                + "&lt;message&gt;shell action fail, error message[${wf:errorMessage(wf:lastErrorNode())}]&lt;/message&gt;"
                + "&lt;/kill&gt;"
                + "&lt;end name='end' /&gt;"
                + "&lt;/workflow-app&gt;";
    }
 }
diff --git a/release-log.txt b/release-log.txt
index 275db88d2..bf8d35faa 100644
-- a/release-log.txt
++ b/release-log.txt
@@ -1,5 +1,6 @@
 -- Oozie 4.3.0 release (trunk - unreleased)
 
OOZIE-2030 Configuration properties from global section is not getting set in Hadoop job conf when using sub-workflow action in Oozie workflow.xml (jaydeepvishwakarma via rohini)
 OOZIE-2380 Oozie Hive action failed with wrong tmp path (vaifer via rkanter)
 OOZIE-2222 Oozie UI parent job should be clickable (puru)
 OOZIE-2407 AbandonedService should not send mail if there is no abandoned coord (puru)
- 
2.19.1.windows.1

</comment></unit>
