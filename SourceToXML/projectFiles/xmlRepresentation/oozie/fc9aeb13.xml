<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<unit xmlns="http://www.srcML.org/srcML/src" revision="1.0.0" language="Java" filename="E:/01Courses@USASK/CMPT898-HumanDrivenSoftwareEngineeringForScientificResearch/ProjectProgress/data_files/final_dataset/gen_patch_codes/filtered/oozie/fc9aeb13.java"><expr_stmt><expr><name>From</name> <name>fc9aeb13ae2d5c4d62f0a1de3fee0f040ea3f343</name> <name>Mon</name> <name>Sep</name> <literal type="number">17</literal> <literal type="number">00</literal><operator>:</operator><literal type="number">00</literal><operator>:</operator><literal type="number">00</literal> <literal type="number">2001</literal>
<name>From</name><operator>:</operator> <name>Purshotam</name> <name>Shah</name> <operator>&lt;</operator><name>purushah</name>@<name>yahoo</name><operator>-</operator><name><name>inc</name><operator>.</operator><name>com</name></name><operator>&gt;</operator>
<name>Date</name><operator>:</operator> <name>Fri</name></expr><operator>,</operator> <expr><literal type="number">3</literal> <name>Jun</name> <literal type="number">2016</literal> <literal type="number">22</literal><operator>:</operator><literal type="number">50</literal><operator>:</operator><literal type="number">05</literal> <operator>-</operator><literal type="number">0700</literal>
<name>Subject</name><operator>:</operator> <index>[<expr><name>PATCH</name></expr>]</index> <name>OOZIE</name><operator>-</operator><literal type="number">2503</literal> <name>show</name> <name>ChildJobURLs</name> <name>to</name> <name>spark</name> <name>action</name>

<operator>--</operator>
 <operator>...</operator><operator>/</operator><name>action</name><operator>/</operator><name>hadoop</name><operator>/</operator><name><name>SparkActionExecutor</name><operator>.</operator><name>java</name></name>    <operator>|</operator> <literal type="number">24</literal> <operator>++</operator><operator>++</operator><operator>+</operator><operator>--</operator>
 <name>release</name><operator>-</operator><name><name>log</name><operator>.</operator><name>txt</name></name>                               <operator>|</operator>  <literal type="number">1</literal> <operator>+</operator>
 <operator>...</operator><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>action</name><operator>/</operator><name>hadoop</name><operator>/</operator><name><name>SparkMain</name><operator>.</operator><name>java</name></name> <operator>|</operator> <literal type="number">69</literal> <operator>++</operator><operator>++</operator><operator>++</operator><operator>++</operator><operator>++</operator><operator>++</operator><operator>++</operator><operator>++</operator><operator>++</operator><operator>-</operator>
 <operator>...</operator><operator>/</operator><name>oozie</name><operator>/</operator><name>action</name><operator>/</operator><name>hadoop</name><operator>/</operator><name><name>TestSparkMain</name><operator>.</operator><name>java</name></name>    <operator>|</operator>  <literal type="number">7</literal> <operator>++</operator>
 <name>webapp</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>webapp</name><operator>/</operator><name>oozie</name><operator>-</operator><name><name>console</name><operator>.</operator><name>js</name></name>       <operator>|</operator>  <literal type="number">3</literal> <operator>+</operator><operator>-</operator>
 <literal type="number">5</literal> <name>files</name> <name>changed</name></expr><operator>,</operator> <expr><literal type="number">97</literal> <call><name>insertions</name><argument_list>(<argument><expr><operator>+</operator></expr></argument>)</argument_list></call></expr><operator>,</operator> <expr><literal type="number">7</literal> <call><name>deletions</name><argument_list>(<argument><expr><operator>-</operator></expr></argument>)</argument_list></call>

<name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>action</name><operator>/</operator><name>hadoop</name><operator>/</operator><name><name>SparkActionExecutor</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>action</name><operator>/</operator><name>hadoop</name><operator>/</operator><name><name>SparkActionExecutor</name><operator>.</operator><name>java</name></name>
<name>index</name> <literal type="number">6d37105b3</literal><operator>..</operator><literal type="number">97355fde0</literal> <literal type="number">100644</literal>
<operator>--</operator> <name>a</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>action</name><operator>/</operator><name>hadoop</name><operator>/</operator><name><name>SparkActionExecutor</name><operator>.</operator><name>java</name></name>
<operator>++</operator> <name>b</name><operator>/</operator><name>core</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>action</name><operator>/</operator><name>hadoop</name><operator>/</operator><name><name>SparkActionExecutor</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">18</literal></expr><operator>,</operator><expr><literal type="number">21</literal> <operator>+</operator><literal type="number">18</literal></expr><operator>,</operator><expr><literal type="number">26</literal> @@</expr></expr_stmt>
 
 <package>package <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>action</name><operator>.</operator><name>hadoop</name></name>;</package>
 
<import>import <name><name>java</name><operator>.</operator><name>io</name><operator>.</operator><name>IOException</name></name>;</import>
<import>import <name><name>java</name><operator>.</operator><name>net</name><operator>.</operator><name>URISyntaxException</name></name>;</import>
<import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>ArrayList</name></name>;</import>
<import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>List</name></name>;</import>
<import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>Map</name></name>;</import>

 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>hadoop</name><operator>.</operator><name>conf</name><operator>.</operator><name>Configuration</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>hadoop</name><operator>.</operator><name>fs</name><operator>.</operator><name>FileSystem</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>hadoop</name><operator>.</operator><name>fs</name><operator>.</operator><name>Path</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>hadoop</name><operator>.</operator><name>mapred</name><operator>.</operator><name>JobConf</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>hadoop</name><operator>.</operator><name>mapred</name><operator>.</operator><name>RunningJob</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>action</name><operator>.</operator><name>ActionExecutorException</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>client</name><operator>.</operator><name>WorkflowAction</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>HadoopAccessorException</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>Services</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>service</name><operator>.</operator><name>SparkConfigurationService</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>jdom</name><operator>.</operator><name>Element</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>jdom</name><operator>.</operator><name>JDOMException</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>jdom</name><operator>.</operator><name>Namespace</name></name>;</import>
 
<import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>ArrayList</name></name>;</import>
<import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>List</name></name>;</import>
<import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>Map</name></name>;</import>

 <class><specifier>public</specifier> class <name>SparkActionExecutor</name> <super_list><extends>extends <super><name>JavaActionExecutor</name></super></extends></super_list> <block>{
     <decl_stmt><decl><type><specifier>public</specifier> <specifier>static</specifier> <specifier>final</specifier> <name>String</name></type> <name>SPARK_MAIN_CLASS_NAME</name> <init>= <expr><literal type="string">"org.apache.oozie.action.hadoop.SparkMain"</literal></expr></init></decl>;</decl_stmt>
     <decl_stmt><decl><type><specifier>public</specifier> <specifier>static</specifier> <specifier>final</specifier> <name>String</name></type> <name>TASK_USER_PRECEDENCE</name> <init>= <expr><literal type="string">"mapreduce.task.classpath.user.precedence"</literal></expr></init></decl>;</decl_stmt> <comment type="line">// hadoop-2</comment>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">155</literal></expr><operator>,</operator><expr><literal type="number">4</literal> <operator>+</operator><literal type="number">160</literal></expr><operator>,</operator><expr><literal type="number">15</literal> @@ <specifier>public</specifier> <name>class</name> <name>SparkActionExecutor</name> extends <name>JavaActionExecutor</name> <block>{
         <return>return <expr><call><name><name>launcherConf</name><operator>.</operator><name>get</name></name><argument_list>(<argument><expr><name><name>LauncherMapper</name><operator>.</operator><name>CONF_OOZIE_ACTION_MAIN_CLASS</name></name></expr></argument>, <argument><expr><name>SPARK_MAIN_CLASS_NAME</name></expr></argument>)</argument_list></call></expr>;</return>
     }</block></expr></expr_stmt>
 
    <function><annotation>@<name>Override</name></annotation>
    <type><specifier>protected</specifier> <name>void</name></type> <name>getActionData</name><parameter_list>(<parameter><decl><type><name>FileSystem</name></type> <name>actionFs</name></decl></parameter>, <parameter><decl><type><name>RunningJob</name></type> <name>runningJob</name></decl></parameter>, <parameter><decl><type><name>WorkflowAction</name></type> <name>action</name></decl></parameter>, <parameter><decl><type><name>Context</name></type> <name>context</name></decl></parameter>)</parameter_list>
            <throws>throws <argument><expr><name>HadoopAccessorException</name></expr></argument>, <argument><expr><name>JDOMException</name></expr></argument>, <argument><expr><name>IOException</name></expr></argument>, <argument><expr><name>URISyntaxException</name></expr></argument></throws> <block>{<block_content>
        <expr_stmt><expr><call><name><name>super</name><operator>.</operator><name>getActionData</name></name><argument_list>(<argument><expr><name>actionFs</name></expr></argument>, <argument><expr><name>runningJob</name></expr></argument>, <argument><expr><name>action</name></expr></argument>, <argument><expr><name>context</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>readExternalChildIDs</name><argument_list>(<argument><expr><name>action</name></expr></argument>, <argument><expr><name>context</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    </block_content>}</block></function>

    <function><annotation>@<name>Override</name></annotation>
    <type><specifier>protected</specifier> <name>boolean</name></type> <name>getCaptureOutput</name><parameter_list>(<parameter><decl><type><name>WorkflowAction</name></type> <name>action</name></decl></parameter>)</parameter_list> <throws>throws <argument><expr><name>JDOMException</name></expr></argument></throws> <block>{<block_content>
        <return>return <expr><literal type="boolean">true</literal></expr>;</return>
    </block_content>}</block></function>
 }</block></class>
<expr_stmt><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>release</name><operator>-</operator><name><name>log</name><operator>.</operator><name>txt</name></name> <name>b</name><operator>/</operator><name>release</name><operator>-</operator><name><name>log</name><operator>.</operator><name>txt</name></name>
<name>index</name> <literal type="number">1f13c2635</literal><operator>..</operator><literal type="number">189ca2195</literal> <literal type="number">100644</literal>
<operator>--</operator> <name>a</name><operator>/</operator><name>release</name><operator>-</operator><name><name>log</name><operator>.</operator><name>txt</name></name>
<operator>++</operator> <name>b</name><operator>/</operator><name>release</name><operator>-</operator><name><name>log</name><operator>.</operator><name>txt</name></name>
@@ <operator>-</operator><literal type="number">1</literal></expr><operator>,</operator><expr><literal type="number">5</literal> <operator>+</operator><literal type="number">1</literal></expr><operator>,</operator><expr><literal type="number">6</literal> @@
 <operator>--</operator> <name>Oozie</name> <literal type="number">4.3.0</literal> <call><name>release</name> <argument_list>(<argument><expr><name>trunk</name> <operator>-</operator> <name>unreleased</name></expr></argument>)</argument_list></call>
 
<name>OOZIE</name><operator>-</operator><literal type="number">2503</literal> <name>show</name> <name>ChildJobURLs</name> <name>to</name> <name>spark</name> <call><name>action</name> <argument_list>(<argument><expr><name>satishsaley</name> <name>via</name> <name>puru</name></expr></argument>)</argument_list></call>
 <name>OOZIE</name><operator>-</operator><literal type="number">2551</literal> <name>Feature</name> <name>request</name><operator>:</operator> <name>epoch</name> <name>timestamp</name> <call><name>generation</name> <argument_list>(<argument><expr><name>jtolar</name> <name>via</name> <name>puru</name></expr></argument>)</argument_list></call>
 <name>OOZIE</name><operator>-</operator><literal type="number">2542</literal> <name>Option</name> <name>to</name> <name>disable</name> <name>OpenJPA</name> <name>BrokerImpl</name> <call><name>finalization</name> <argument_list>(<argument><expr><name>puru</name></expr></argument>)</argument_list></call>
 <name>OOZIE</name><operator>-</operator><literal type="number">2447</literal> <name>Illegal</name> <name>character</name> <literal type="number">0x0</literal> <name>oozie</name> <call><name>client</name> <argument_list>(<argument><expr><name>satishsaley</name> <name>via</name> <name>puru</name></expr></argument>)</argument_list></call>
<name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>sharelib</name><operator>/</operator><name>spark</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>action</name><operator>/</operator><name>hadoop</name><operator>/</operator><name><name>SparkMain</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>sharelib</name><operator>/</operator><name>spark</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>action</name><operator>/</operator><name>hadoop</name><operator>/</operator><name><name>SparkMain</name><operator>.</operator><name>java</name></name>
<name>index</name> <literal type="number">604f28733</literal><operator>..</operator><literal type="number">0e6e2716f</literal> <literal type="number">100644</literal>
<operator>--</operator> <name>a</name><operator>/</operator><name>sharelib</name><operator>/</operator><name>spark</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>action</name><operator>/</operator><name>hadoop</name><operator>/</operator><name><name>SparkMain</name><operator>.</operator><name>java</name></name>
<operator>++</operator> <name>b</name><operator>/</operator><name>sharelib</name><operator>/</operator><name>spark</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>oozie</name><operator>/</operator><name>action</name><operator>/</operator><name>hadoop</name><operator>/</operator><name><name>SparkMain</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">21</literal></expr><operator>,</operator><expr><literal type="number">13</literal> <operator>+</operator><literal type="number">21</literal></expr><operator>,</operator><expr><literal type="number">18</literal> @@</expr></expr_stmt> <package>package <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>oozie</name><operator>.</operator><name>action</name><operator>.</operator><name>hadoop</name></name>;</package>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>commons</name><operator>.</operator><name>io</name><operator>.</operator><name>FileUtils</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>commons</name><operator>.</operator><name>lang</name><operator>.</operator><name>StringUtils</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>hadoop</name><operator>.</operator><name>conf</name><operator>.</operator><name>Configuration</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>log4j</name><operator>.</operator><name>PropertyConfigurator</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>spark</name><operator>.</operator><name>deploy</name><operator>.</operator><name>SparkSubmit</name></name>;</import>
 
 <import>import <name><name>java</name><operator>.</operator><name>io</name><operator>.</operator><name>File</name></name>;</import>
<import>import <name><name>java</name><operator>.</operator><name>io</name><operator>.</operator><name>FileOutputStream</name></name>;</import>
 <import>import <name><name>java</name><operator>.</operator><name>io</name><operator>.</operator><name>IOException</name></name>;</import>
<import>import <name><name>java</name><operator>.</operator><name>io</name><operator>.</operator><name>OutputStream</name></name>;</import>
<import>import <name><name>java</name><operator>.</operator><name>net</name><operator>.</operator><name>URL</name></name>;</import>
 <import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>ArrayList</name></name>;</import>
 <import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>HashSet</name></name>;</import>
 <import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>List</name></name>;</import>
<import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>Properties</name></name>;</import>
 <import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>regex</name><operator>.</operator><name>Pattern</name></name>;</import>
 
 <class><specifier>public</specifier> class <name>SparkMain</name> <super_list><extends>extends <super><name>LauncherMain</name></super></extends></super_list> <block>{
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">48</literal></expr><operator>,</operator><expr><literal type="number">6</literal> <operator>+</operator><literal type="number">53</literal></expr><operator>,</operator><expr><literal type="number">9</literal> @@ <specifier>public</specifier> <name>class</name> <name>SparkMain</name> extends <name>LauncherMain</name> <block>{
     <expr><specifier>private</specifier> <name>String</name> <name>sparkJars</name> <operator>=</operator> <literal type="null">null</literal></expr>;
     <expr><specifier>private</specifier> <name>String</name> <name>sparkClasspath</name> <operator>=</operator> <literal type="null">null</literal></expr>;
 
    <expr><specifier>private</specifier> <specifier>static</specifier> <name>final</name> <name>String</name> <name>SPARK_LOG4J_PROPS</name> <operator>=</operator> <literal type="string">"spark-log4j.properties"</literal></expr>;
    <expr><specifier>private</specifier> <specifier>static</specifier> <name>final</name> <name><name>Pattern</name><index>[]</index></name> <name>SPARK_JOB_IDS_PATTERNS</name> <operator>=</operator> <block>{
            <expr><call><name><name>Pattern</name><operator>.</operator><name>compile</name></name><argument_list>(<argument><expr><literal type="string">"Submitted application (application[0-9_]*)"</literal></expr></argument>)</argument_list></call></expr> }</block></expr>;
     <expr><specifier>public</specifier> <specifier>static</specifier> <name>void</name> <call><name>main</name><argument_list>(<argument><expr><name><name>String</name><index>[]</index></name> <name>args</name></expr></argument>)</argument_list></call> <throws>throws <argument><expr><name>Exception</name> <block>{
         <expr><call><name>run</name><argument_list>(<argument><expr><name><name>SparkMain</name><operator>.</operator><name>class</name></name></expr></argument>, <argument><expr><name>args</name></expr></argument>)</argument_list></call></expr></block></expr></argument></throws></expr>;
     }</block>
@@ <operator>-</operator><literal type="number">58</literal></expr><operator>,</operator><expr><literal type="number">7</literal> <operator>+</operator><literal type="number">66</literal></expr><operator>,</operator><expr><literal type="number">7</literal> @@ <specifier>public</specifier> <name>class</name> <name>SparkMain</name> extends <name>LauncherMain</name> <block>{
         <expr><name>Configuration</name> <name>actionConf</name> <operator>=</operator> <call><name>loadActionConf</name><argument_list>()</argument_list></call></expr>;
         <expr><call><name>setYarnTag</name><argument_list>(<argument><expr><name>actionConf</name></expr></argument>)</argument_list></call></expr>;
         <expr><call><name><name>LauncherMainHadoopUtils</name><operator>.</operator><name>killChildYarnJobs</name></name><argument_list>(<argument><expr><name>actionConf</name></expr></argument>)</argument_list></call></expr>;

        <expr><name>String</name> <name>logFile</name> <operator>=</operator> <call><name>setUpSparkLog4J</name><argument_list>(<argument><expr><name>actionConf</name></expr></argument>)</argument_list></call></expr>;
         <expr><name><name>List</name><argument_list type="generic">&lt;<argument><name>String</name></argument>&gt;</argument_list></name> <name>sparkArgs</name> <operator>=</operator> <operator>new</operator> <call><name><name>ArrayList</name><argument_list type="generic">&lt;<argument><name>String</name></argument>&gt;</argument_list></name><argument_list>()</argument_list></call></expr>;
 
         <expr><call><name><name>sparkArgs</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>MASTER_OPTION</name></expr></argument>)</argument_list></call></expr>;
@@ <expr><operator>-</operator><literal type="number">175</literal></expr>,<expr><literal type="number">6</literal> <operator>+</operator><literal type="number">183</literal></expr>,<expr><literal type="number">13</literal> @@ <specifier>public</specifier> <name>class</name> <name>SparkMain</name> extends <name>LauncherMain</name> <block>{
             <expr><call><name><name>sparkArgs</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><literal type="string">"--conf"</literal></expr></argument>)</argument_list></call></expr>;
             <expr><call><name><name>sparkArgs</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>DIST_FILES</name> <operator>+</operator> <name>sparkJars</name></expr></argument>)</argument_list></call></expr>;
         }</block>

        <call><name><name>sparkArgs</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><literal type="string">"--conf"</literal></expr></argument>)</argument_list></call></expr>;
        <expr><call><name><name>sparkArgs</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><literal type="string">"spark.executor.extraJavaOptions=-Dlog4j.configuration="</literal> <operator>+</operator> <name>SPARK_LOG4J_PROPS</name></expr></argument>)</argument_list></call></expr>;

        <expr><call><name><name>sparkArgs</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><literal type="string">"--conf"</literal></expr></argument>)</argument_list></call></expr>;
        <expr><call><name><name>sparkArgs</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><literal type="string">"spark.driver.extraJavaOptions=-Dlog4j.configuration="</literal> <operator>+</operator> <name>SPARK_LOG4J_PROPS</name></expr></argument>)</argument_list></call></expr>;

         <if_stmt><if>if <condition>(<expr><operator>!</operator><name>addedHiveSecurityToken</name></expr>)</condition> <block>{<block_content>
             <expr_stmt><expr><call><name><name>sparkArgs</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><literal type="string">"--conf"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
             <expr_stmt><expr><call><name><name>sparkArgs</name><operator>.</operator><name>add</name></name><argument_list>(<argument><expr><name>HIVE_SECURITY_TOKEN</name> <operator>+</operator> <literal type="string">"=false"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">204</literal></expr><operator>,</operator><expr><literal type="number">7</literal> <operator>+</operator><literal type="number">219</literal></expr><operator>,</operator><expr><literal type="number">12</literal> @@ <specifier>public</specifier> <name>class</name> <name>SparkMain</name> extends <name>LauncherMain</name> <block>{
             <expr><call><name><name>System</name><operator>.</operator><name>out</name><operator>.</operator><name>println</name></name><argument_list>(<argument><expr><literal type="string">"                    "</literal> <operator>+</operator> <name>arg</name></expr></argument>)</argument_list></call></expr>;</block></expr></expr_stmt></block_content></block></if></if_stmt>
         }</block>
         <call><name><name>System</name><operator>.</operator><name>out</name><operator>.</operator><name>println</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        <expr_stmt><expr><call><name>runSpark</name><argument_list>(<argument><expr><call><name><name>sparkArgs</name><operator>.</operator><name>toArray</name></name><argument_list>(<argument><expr><operator>new</operator> <name><name>String</name><index>[<expr><call><name><name>sparkArgs</name><operator>.</operator><name>size</name></name><argument_list>()</argument_list></call></expr>]</index></name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <try>try <block>{<block_content>
            <expr_stmt><expr><call><name>runSpark</name><argument_list>(<argument><expr><call><name><name>sparkArgs</name><operator>.</operator><name>toArray</name></name><argument_list>(<argument><expr><operator>new</operator> <name><name>String</name><index>[<expr><call><name><name>sparkArgs</name><operator>.</operator><name>size</name></name><argument_list>()</argument_list></call></expr>]</index></name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        </block_content>}</block>
        <finally>finally <block>{<block_content>
            <expr_stmt><expr><call><name>writeExternalChildIDs</name><argument_list>(<argument><expr><name>logFile</name></expr></argument>, <argument><expr><name>SPARK_JOB_IDS_PATTERNS</name></expr></argument>, <argument><expr><literal type="string">"Spark"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        </block_content>}</block></finally></try>
     }</block></class>
 
     <comment type="block" format="javadoc">/**
@@ -331,4 +351,49 @@ public class SparkMain extends LauncherMain {
         }
         return result;
     }

    public static String setUpSparkLog4J(Configuration distcpConf) throws IOException {
        // Logfile to capture job IDs
        String hadoopJobId = System.getProperty("oozie.launcher.job.id");
        if (hadoopJobId == null) {
            throw new RuntimeException("Launcher Hadoop Job ID system,property not set");
        }
        String logFile = new File("spark-oozie-" + hadoopJobId + ".log").getAbsolutePath();
        Properties hadoopProps = new Properties();

        // Preparing log4j configuration
        URL log4jFile = Thread.currentThread().getContextClassLoader().getResource("log4j.properties");
        if (log4jFile != null) {
            // getting hadoop log4j configuration
            hadoopProps.load(log4jFile.openStream());
        }

        String logLevel = distcpConf.get("oozie.spark.log.level", "INFO");
        String rootLogLevel = distcpConf.get("oozie.action." + LauncherMapper.ROOT_LOGGER_LEVEL, "INFO");

        hadoopProps.setProperty("log4j.rootLogger", rootLogLevel + ", A");
        hadoopProps.setProperty("log4j.logger.org.apache.spark", logLevel + ", A, jobid");
        hadoopProps.setProperty("log4j.additivity.org.apache.spark", "false");
        hadoopProps.setProperty("log4j.appender.A", "org.apache.log4j.ConsoleAppender");
        hadoopProps.setProperty("log4j.appender.A.layout", "org.apache.log4j.PatternLayout");
        hadoopProps.setProperty("log4j.appender.A.layout.ConversionPattern", "%d [%t] %-5p %c %x - %m%n");
        hadoopProps.setProperty("log4j.appender.jobid", "org.apache.log4j.FileAppender");
        hadoopProps.setProperty("log4j.appender.jobid.file", logFile);
        hadoopProps.setProperty("log4j.appender.jobid.layout", "org.apache.log4j.PatternLayout");
        hadoopProps.setProperty("log4j.appender.jobid.layout.ConversionPattern", "%d [%t] %-5p %c %x - %m%n");
        hadoopProps.setProperty("log4j.logger.org.apache.hadoop.mapred", "INFO, jobid");
        hadoopProps.setProperty("log4j.logger.org.apache.hadoop.mapreduce.Job", "INFO, jobid");
        hadoopProps.setProperty("log4j.logger.org.apache.hadoop.yarn.client.api.impl.YarnClientImpl", "INFO, jobid");

        String localProps = new File(SPARK_LOG4J_PROPS).getAbsolutePath();
        OutputStream os1 = new FileOutputStream(localProps);
        try {
            hadoopProps.store(os1, "");
        }
        finally {
            os1.close();
        }
        PropertyConfigurator.configure(SPARK_LOG4J_PROPS);
        return logFile;
    }
 }
diff --git a/sharelib/spark/src/test/java/org/apache/oozie/action/hadoop/TestSparkMain.java b/sharelib/spark/src/test/java/org/apache/oozie/action/hadoop/TestSparkMain.java
index f3ec89954..5ef464920 100644
-- a/sharelib/spark/src/test/java/org/apache/oozie/action/hadoop/TestSparkMain.java
++ b/sharelib/spark/src/test/java/org/apache/oozie/action/hadoop/TestSparkMain.java
@@ -53,6 +53,9 @@ public class TestSparkMain extends MainTestCase {
 
         jobConf.set("mapreduce.job.tags", "" + System.currentTimeMillis());
         setSystemProperty("oozie.job.launch.time", "" + System.currentTimeMillis());
        File statsDataFile = new File(getTestCaseDir(), "statsdata.properties");
        File hadoopIdsFile = new File(getTestCaseDir(), "hadoopIds");
        File outputDataFile = new File(getTestCaseDir(), "outputdata.properties");
 
         jobConf.set(SparkActionExecutor.SPARK_MASTER, "local[*]");
         jobConf.set(SparkActionExecutor.SPARK_MODE, "client");
@@ -70,6 +73,10 @@ public class TestSparkMain extends MainTestCase {
         os.close();
 
         System.setProperty("oozie.action.conf.xml", actionXml.getAbsolutePath());
        setSystemProperty("oozie.launcher.job.id", "" + System.currentTimeMillis());
        setSystemProperty("oozie.action.stats.properties", statsDataFile.getAbsolutePath());
        setSystemProperty("oozie.action.externalChildIDs", hadoopIdsFile.getAbsolutePath());
        setSystemProperty("oozie.action.output.properties", outputDataFile.getAbsolutePath());
 
         File jarFile = IOUtils.createJar(new File(getTestCaseDir()), "test.jar", LauncherMainTester.class);
         InputStream is = new FileInputStream(jarFile);
diff --git a/webapp/src/main/webapp/oozie-console.js b/webapp/src/main/webapp/oozie-console.js
index 99dc6ce02..b35170439 100644
-- a/webapp/src/main/webapp/oozie-console.js
++ b/webapp/src/main/webapp/oozie-console.js
@@ -765,7 +765,8 @@ function jobDetailsPopup(response, request) {
                 items : urlUnit
             };
             if (actionStatus.type == "pig" || actionStatus.type == "hive" || actionStatus.type == "map-reduce"
                    || actionStatus.type == "hive2" || actionStatus.type == "sqoop" || actionStatus.type == "distcp") {
                    || actionStatus.type == "hive2" || actionStatus.type == "sqoop" || actionStatus.type == "distcp"
                    || actionStatus.type == "spark") {
                 var tabPanel = win.items.get(0);
                 tabPanel.add(childJobsItem);
             }
- 
2.19.1.windows.1

</comment></unit>
