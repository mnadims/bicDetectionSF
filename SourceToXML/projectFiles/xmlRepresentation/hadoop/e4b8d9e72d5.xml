<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<unit xmlns="http://www.srcML.org/srcML/src" revision="1.0.0" language="Java" filename="E:/01Courses@USASK/CMPT898-HumanDrivenSoftwareEngineeringForScientificResearch/ProjectProgress/data_files/final_dataset/gen_patch_codes/filtered/hadoop/e4b8d9e72d5.java"><expr_stmt><expr><name>From</name> <name>e4b8d9e72d54d4725bf2a902452459b6b243b2e9</name> <name>Mon</name> <name>Sep</name> <literal type="number">17</literal> <literal type="number">00</literal><operator>:</operator><literal type="number">00</literal><operator>:</operator><literal type="number">00</literal> <literal type="number">2001</literal>
<name>From</name><operator>:</operator> <name>Haohui</name> <name><name>Mai</name> <argument_list type="generic">&lt;<argument><name>wheat9</name><annotation>@<name><name>apache</name><operator>.</operator><name>org</name></name></annotation></argument>&gt;</argument_list></name>
<name>Date</name><operator>:</operator> <name>Wed</name></expr><operator>,</operator> <expr><literal type="number">25</literal> <name>Mar</name> <literal type="number">2015</literal> <literal type="number">11</literal><operator>:</operator><literal type="number">12</literal><operator>:</operator><literal type="number">27</literal> <operator>-</operator><literal type="number">0700</literal>
<name>Subject</name><operator>:</operator> <index>[<expr><name>PATCH</name></expr>]</index> <name>HADOOP</name><operator>-</operator><literal type="number">10670.</literal> <name>Allow</name> <name>AuthenticationFilters</name> <name>to</name> <name>load</name> <name>secret</name> <name>from</name>
 <name>signature</name> <name>secret</name> <name><name>files</name><operator>.</operator> <name>Contributed</name></name> <name>by</name> <name>Kai</name> <name><name>Zheng</name><operator>.</operator></name>

--
 <operator>...</operator><operator>/</operator><name>server</name><operator>/</operator><name><name>AuthenticationFilter</name><operator>.</operator><name>java</name></name>          <operator>|</operator> <literal type="number">18</literal> <operator>++</operator><operator>++</operator><operator>+</operator><operator>--</operator><operator>-</operator>
 <operator>...</operator><operator>/</operator><name>server</name><operator>/</operator><name><name>TestAuthenticationFilter</name><operator>.</operator><name>java</name></name>      <operator>|</operator> <literal type="number">38</literal> <operator>++</operator><operator>++</operator><operator>++</operator><operator>++</operator><operator>++</operator><operator>++</operator><operator>++</operator><operator>+</operator><operator>-</operator>
 <operator>...</operator><operator>/</operator><name>hadoop</name><operator>-</operator><name>common</name><operator>/</operator><name><name>CHANGES</name><operator>.</operator><name>txt</name></name>                 <operator>|</operator>  <literal type="number">3</literal> <operator>++</operator>
 <operator>...</operator><operator>/</operator><name><name>AuthenticationFilterInitializer</name><operator>.</operator><name>java</name></name>      <operator>|</operator> <literal type="number">26</literal> <operator>--</operator><operator>--</operator><operator>--</operator><operator>--</operator><operator>--</operator><operator>-</operator>
 <operator>...</operator><operator>/</operator><name>security</name><operator>/</operator><name><name>TestAuthenticationFilter</name><operator>.</operator><name>java</name></name>    <operator>|</operator> <literal type="number">12</literal> <operator>--</operator><operator>--</operator><operator>--</operator>
 <operator>...</operator><name><name>melineAuthenticationFilterInitializer</name><operator>.</operator><name>java</name></name> <operator>|</operator> <literal type="number">43</literal> <operator>++</operator><operator>--</operator><operator>--</operator><operator>--</operator><operator>--</operator><operator>--</operator><operator>--</operator><operator>--</operator><operator>--</operator><operator>-</operator>
 <operator>...</operator><operator>/</operator><name><name>RMAuthenticationFilterInitializer</name><operator>.</operator><name>java</name></name>    <operator>|</operator> <literal type="number">31</literal> <operator>--</operator><operator>--</operator><operator>--</operator><operator>--</operator><operator>--</operator><operator>--</operator><operator>-</operator>
 <literal type="number">7</literal> <name>files</name> <name>changed</name></expr><operator>,</operator> <expr><literal type="number">55</literal> <call><name>insertions</name><argument_list>(<argument><expr><operator>+</operator></expr></argument>)</argument_list></call></expr><operator>,</operator> <expr><literal type="number">116</literal> <call><name>deletions</name><argument_list>(<argument><expr><operator>-</operator></expr></argument>)</argument_list></call>

<name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>hadoop</name><operator>-</operator><name>common</name><operator>-</operator><name>project</name><operator>/</operator><name>hadoop</name><operator>-</operator><name>auth</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>hadoop</name><operator>/</operator><name>security</name><operator>/</operator><name>authentication</name><operator>/</operator><name>server</name><operator>/</operator><name><name>AuthenticationFilter</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>hadoop</name><operator>-</operator><name>common</name><operator>-</operator><name>project</name><operator>/</operator><name>hadoop</name><operator>-</operator><name>auth</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>hadoop</name><operator>/</operator><name>security</name><operator>/</operator><name>authentication</name><operator>/</operator><name>server</name><operator>/</operator><name><name>AuthenticationFilter</name><operator>.</operator><name>java</name></name>
<name>index</name> <name>e891ed2623d</name><operator>..</operator><literal type="number">43bb4b0af92</literal> <literal type="number">100644</literal>
<operator>--</operator> <name>a</name><operator>/</operator><name>hadoop</name><operator>-</operator><name>common</name><operator>-</operator><name>project</name><operator>/</operator><name>hadoop</name><operator>-</operator><name>auth</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>hadoop</name><operator>/</operator><name>security</name><operator>/</operator><name>authentication</name><operator>/</operator><name>server</name><operator>/</operator><name><name>AuthenticationFilter</name><operator>.</operator><name>java</name></name>
<operator>++</operator> <name>b</name><operator>/</operator><name>hadoop</name><operator>-</operator><name>common</name><operator>-</operator><name>project</name><operator>/</operator><name>hadoop</name><operator>-</operator><name>auth</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>hadoop</name><operator>/</operator><name>security</name><operator>/</operator><name>authentication</name><operator>/</operator><name>server</name><operator>/</operator><name><name>AuthenticationFilter</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">18</literal></expr><operator>,</operator><expr><literal type="number">12</literal> <operator>+</operator><literal type="number">18</literal></expr><operator>,</operator><expr><literal type="number">7</literal> @@</expr></expr_stmt>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>hadoop</name><operator>.</operator><name>security</name><operator>.</operator><name>authentication</name><operator>.</operator><name>client</name><operator>.</operator><name>AuthenticatedURL</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>hadoop</name><operator>.</operator><name>security</name><operator>.</operator><name>authentication</name><operator>.</operator><name>client</name><operator>.</operator><name>AuthenticationException</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>hadoop</name><operator>.</operator><name>security</name><operator>.</operator><name>authentication</name><operator>.</operator><name>client</name><operator>.</operator><name>KerberosAuthenticator</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>hadoop</name><operator>.</operator><name>security</name><operator>.</operator><name>authentication</name><operator>.</operator><name>util</name><operator>.</operator><name>Signer</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>hadoop</name><operator>.</operator><name>security</name><operator>.</operator><name>authentication</name><operator>.</operator><name>util</name><operator>.</operator><name>SignerException</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>hadoop</name><operator>.</operator><name>security</name><operator>.</operator><name>authentication</name><operator>.</operator><name>util</name><operator>.</operator><name>RandomSignerSecretProvider</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>hadoop</name><operator>.</operator><name>security</name><operator>.</operator><name>authentication</name><operator>.</operator><name>util</name><operator>.</operator><name>SignerSecretProvider</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>hadoop</name><operator>.</operator><name>security</name><operator>.</operator><name>authentication</name><operator>.</operator><name>util</name><operator>.</operator><name>StringSignerSecretProvider</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>hadoop</name><operator>.</operator><name>security</name><operator>.</operator><name>authentication</name><operator>.</operator><name>util</name><operator>.</operator><name>ZKSignerSecretProvider</name></name>;</import>
<import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>hadoop</name><operator>.</operator><name>security</name><operator>.</operator><name>authentication</name><operator>.</operator><name>util</name><operator>.</operator><name>*</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>slf4j</name><operator>.</operator><name>Logger</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>slf4j</name><operator>.</operator><name>LoggerFactory</name></name>;</import>
 
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">147</literal></expr><operator>,</operator><expr><literal type="number">6</literal> <operator>+</operator><literal type="number">142</literal></expr><operator>,</operator><expr><literal type="number">8</literal> @@
    <operator>*</operator><operator>/</operator>
   <specifier>public</specifier> <specifier>static</specifier> <name>final</name> <name>String</name> <name>SIGNATURE_SECRET</name> <operator>=</operator> <literal type="string">"signature.secret"</literal></expr>;</expr_stmt>
 
  <decl_stmt><decl><type><specifier>public</specifier> <specifier>static</specifier> <specifier>final</specifier> <name>String</name></type> <name>SIGNATURE_SECRET_FILE</name> <init>= <expr><name>SIGNATURE_SECRET</name> <operator>+</operator> <literal type="string">".file"</literal></expr></init></decl>;</decl_stmt>

   <comment type="block" format="javadoc">/**
    * Constant for the configuration property that indicates the validity of the generated token.
    */</comment>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">283</literal></expr><operator>,</operator><expr><literal type="number">7</literal> <operator>+</operator><literal type="number">280</literal></expr><operator>,</operator><expr><literal type="number">12</literal> @@ <specifier>protected</specifier> <name>void</name> <call><name>initializeSecretProvider</name><argument_list>(<argument><expr><name>FilterConfig</name> <name>filterConfig</name></expr></argument>)</argument_list></call></expr></expr_stmt>
     <comment type="line">// fallback to old behavior</comment>
     <if_stmt><if>if <condition>(<expr><name>signerSecretProviderName</name> <operator>==</operator> <literal type="null">null</literal></expr>)</condition> <block>{<block_content>
       <decl_stmt><decl><type><name>String</name></type> <name>signatureSecret</name> <init>= <expr><call><name><name>config</name><operator>.</operator><name>getProperty</name></name><argument_list>(<argument><expr><name>SIGNATURE_SECRET</name></expr></argument>, <argument><expr><literal type="null">null</literal></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
      <if_stmt><if>if <condition>(<expr><name>signatureSecret</name> <operator>!=</operator> <literal type="null">null</literal></expr>)</condition> <block>{<block_content>
      <decl_stmt><decl><type><name>String</name></type> <name>signatureSecretFile</name> <init>= <expr><call><name><name>config</name><operator>.</operator><name>getProperty</name></name><argument_list>(
          <argument><expr><name>SIGNATURE_SECRET_FILE</name></expr></argument>, <argument><expr><literal type="null">null</literal></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
      <comment type="line">// The precedence from high to low : file, inline string, random</comment>
      <if_stmt><if>if <condition>(<expr><name>signatureSecretFile</name> <operator>!=</operator> <literal type="null">null</literal></expr>)</condition> <block>{<block_content>
        <expr_stmt><expr><name>providerClassName</name> <operator>=</operator> <call><name><name>FileSignerSecretProvider</name><operator>.</operator><name><name>class</name><operator>.</operator><name>getName</name></name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
      </block_content>}</block></if> <if type="elseif">else if <condition>(<expr><name>signatureSecret</name> <operator>!=</operator> <literal type="null">null</literal></expr>)</condition> <block>{<block_content>
         <expr_stmt><expr><name>providerClassName</name> <operator>=</operator> <call><name><name>StringSignerSecretProvider</name><operator>.</operator><name><name>class</name><operator>.</operator><name>getName</name></name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
       </block_content>}</block></if> <else>else <block>{<block_content>
         <expr_stmt><expr><name>providerClassName</name> <operator>=</operator> <call><name><name>RandomSignerSecretProvider</name><operator>.</operator><name><name>class</name><operator>.</operator><name>getName</name></name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">295</literal></expr><operator>,</operator><expr><literal type="number">6</literal> <operator>+</operator><literal type="number">297</literal></expr><operator>,</operator><expr><literal type="number">8</literal> @@ <specifier>protected</specifier> <name>void</name> <call><name>initializeSecretProvider</name><argument_list>(<argument><expr><name>FilterConfig</name> <name>filterConfig</name></expr></argument>)</argument_list></call>
         <name>randomSecret</name> <operator>=</operator> <literal type="boolean">true</literal></expr>;</expr_stmt>
       </block_content>}</block></else></if_stmt> <if_stmt><if type="elseif">else if <condition>(<expr><literal type="string">"string"</literal><operator>.</operator><call><name>equals</name><argument_list>(<argument><expr><name>signerSecretProviderName</name></expr></argument>)</argument_list></call></expr>)</condition> <block>{<block_content>
         <expr_stmt><expr><name>providerClassName</name> <operator>=</operator> <call><name><name>StringSignerSecretProvider</name><operator>.</operator><name><name>class</name><operator>.</operator><name>getName</name></name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
      </block_content>}</block></if> <if type="elseif">else if <condition>(<expr><literal type="string">"file"</literal><operator>.</operator><call><name>equals</name><argument_list>(<argument><expr><name>signerSecretProviderName</name></expr></argument>)</argument_list></call></expr>)</condition> <block>{<block_content>
        <expr_stmt><expr><name>providerClassName</name> <operator>=</operator> <call><name><name>FileSignerSecretProvider</name><operator>.</operator><name><name>class</name><operator>.</operator><name>getName</name></name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
       </block_content>}</block></if> <if type="elseif">else if <condition>(<expr><literal type="string">"zookeeper"</literal><operator>.</operator><call><name>equals</name><argument_list>(<argument><expr><name>signerSecretProviderName</name></expr></argument>)</argument_list></call></expr>)</condition> <block>{<block_content>
         <expr_stmt><expr><name>providerClassName</name> <operator>=</operator> <call><name><name>ZKSignerSecretProvider</name><operator>.</operator><name><name>class</name><operator>.</operator><name>getName</name></name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
       </block_content>}</block></if> <else>else <block>{<block_content>
<expr_stmt><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>hadoop</name><operator>-</operator><name>common</name><operator>-</operator><name>project</name><operator>/</operator><name>hadoop</name><operator>-</operator><name>auth</name><operator>/</operator><name>src</name><operator>/</operator><name>test</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>hadoop</name><operator>/</operator><name>security</name><operator>/</operator><name>authentication</name><operator>/</operator><name>server</name><operator>/</operator><name><name>TestAuthenticationFilter</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>hadoop</name><operator>-</operator><name>common</name><operator>-</operator><name>project</name><operator>/</operator><name>hadoop</name><operator>-</operator><name>auth</name><operator>/</operator><name>src</name><operator>/</operator><name>test</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>hadoop</name><operator>/</operator><name>security</name><operator>/</operator><name>authentication</name><operator>/</operator><name>server</name><operator>/</operator><name><name>TestAuthenticationFilter</name><operator>.</operator><name>java</name></name>
<name>index</name> <name>c01c182db15</name><operator>..</operator><name>a03894b0757</name> <literal type="number">100644</literal>
<operator>--</operator> <name>a</name><operator>/</operator><name>hadoop</name><operator>-</operator><name>common</name><operator>-</operator><name>project</name><operator>/</operator><name>hadoop</name><operator>-</operator><name>auth</name><operator>/</operator><name>src</name><operator>/</operator><name>test</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>hadoop</name><operator>/</operator><name>security</name><operator>/</operator><name>authentication</name><operator>/</operator><name>server</name><operator>/</operator><name><name>TestAuthenticationFilter</name><operator>.</operator><name>java</name></name>
<operator>++</operator> <name>b</name><operator>/</operator><name>hadoop</name><operator>-</operator><name>common</name><operator>-</operator><name>project</name><operator>/</operator><name>hadoop</name><operator>-</operator><name>auth</name><operator>/</operator><name>src</name><operator>/</operator><name>test</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>hadoop</name><operator>/</operator><name>security</name><operator>/</operator><name>authentication</name><operator>/</operator><name>server</name><operator>/</operator><name><name>TestAuthenticationFilter</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">13</literal></expr><operator>,</operator><expr><literal type="number">7</literal> <operator>+</operator><literal type="number">13</literal></expr><operator>,</operator><expr><literal type="number">10</literal> @@
  <operator>*</operator><operator>/</operator></expr></expr_stmt>
 <package>package <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>hadoop</name><operator>.</operator><name>security</name><operator>.</operator><name>authentication</name><operator>.</operator><name>server</name></name>;</package>
 
<import>import <name><name>java</name><operator>.</operator><name>io</name><operator>.</operator><name>File</name></name>;</import>
<import>import <name><name>java</name><operator>.</operator><name>io</name><operator>.</operator><name>FileWriter</name></name>;</import>
 <import>import <name><name>java</name><operator>.</operator><name>io</name><operator>.</operator><name>IOException</name></name>;</import>
<import>import <name><name>java</name><operator>.</operator><name>io</name><operator>.</operator><name>Writer</name></name>;</import>
 <import>import <name><name>java</name><operator>.</operator><name>net</name><operator>.</operator><name>HttpCookie</name></name>;</import>
 <import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>Arrays</name></name>;</import>
 <import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>HashMap</name></name>;</import>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">197</literal></expr><operator>,</operator><expr><literal type="number">7</literal> <operator>+</operator><literal type="number">200</literal></expr><operator>,</operator><expr><literal type="number">7</literal> @@ <specifier>public</specifier> <name>void</name> <call><name>testInit</name><argument_list>()</argument_list></call> <throws>throws <argument><expr><name>Exception</name> <block>{
       <expr><call><name><name>filter</name><operator>.</operator><name>destroy</name></name><argument_list>()</argument_list></call></expr></block></expr></argument></throws></expr>;</expr_stmt>
     </block_content>}</block></else></if_stmt>
 
    <comment type="line">// custom secret</comment>
    <comment type="line">// custom secret as inline</comment>
     <expr_stmt><expr><name>filter</name> <operator>=</operator> <operator>new</operator> <call><name>AuthenticationFilter</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
     <try>try <block>{<block_content>
       <decl_stmt><decl><type><name>FilterConfig</name></type> <name>config</name> <init>= <expr><call><name><name>Mockito</name><operator>.</operator><name>mock</name></name><argument_list>(<argument><expr><name><name>FilterConfig</name><operator>.</operator><name>class</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">231</literal></expr><operator>,</operator><expr><literal type="number">6</literal> <operator>+</operator><literal type="number">234</literal></expr><operator>,</operator><expr><literal type="number">39</literal> @@ <specifier>public</specifier> <name>void</name> <call><name>init</name><argument_list>(<argument><expr><name>Properties</name> <name>config</name></expr></argument>, <argument><expr><name>ServletContext</name> <name>servletContext</name></expr></argument>,
       <argument><expr><call><name><name>filter</name><operator>.</operator><name>destroy</name></name><argument_list>()</argument_list></call></expr></argument>;</argument_list></call></expr></expr_stmt>
     </block_content>}</block></try>
 
    <comment type="line">// custom secret by file</comment>
    <decl_stmt><decl><type><name>File</name></type> <name>testDir</name> <init>= <expr><operator>new</operator> <call><name>File</name><argument_list>(<argument><expr><call><name><name>System</name><operator>.</operator><name>getProperty</name></name><argument_list>(<argument><expr><literal type="string">"test.build.data"</literal></expr></argument>,
        <argument><expr><literal type="string">"target/test-dir"</literal></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
    <expr_stmt><expr><call><name><name>testDir</name><operator>.</operator><name>mkdirs</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
    <decl_stmt><decl><type><name>String</name></type> <name>secretValue</name> <init>= <expr><literal type="string">"hadoop"</literal></expr></init></decl>;</decl_stmt>
    <decl_stmt><decl><type><name>File</name></type> <name>secretFile</name> <init>= <expr><operator>new</operator> <call><name>File</name><argument_list>(<argument><expr><name>testDir</name></expr></argument>, <argument><expr><literal type="string">"http-secret.txt"</literal></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
    <decl_stmt><decl><type><name>Writer</name></type> <name>writer</name> <init>= <expr><operator>new</operator> <call><name>FileWriter</name><argument_list>(<argument><expr><name>secretFile</name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
    <expr_stmt><expr><call><name><name>writer</name><operator>.</operator><name>write</name></name><argument_list>(<argument><expr><name>secretValue</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    <expr_stmt><expr><call><name><name>writer</name><operator>.</operator><name>close</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>

    <expr_stmt><expr><name>filter</name> <operator>=</operator> <operator>new</operator> <call><name>AuthenticationFilter</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
    <try>try <block>{<block_content>
      <decl_stmt><decl><type><name>FilterConfig</name></type> <name>config</name> <init>= <expr><call><name><name>Mockito</name><operator>.</operator><name>mock</name></name><argument_list>(<argument><expr><name><name>FilterConfig</name><operator>.</operator><name>class</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
      <expr_stmt><expr><call><name><name>Mockito</name><operator>.</operator><name>when</name></name><argument_list>(<argument><expr><call><name><name>config</name><operator>.</operator><name>getInitParameter</name></name><argument_list>(
          <argument><expr><name><name>AuthenticationFilter</name><operator>.</operator><name>AUTH_TYPE</name></name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call><operator>.</operator><call><name>thenReturn</name><argument_list>(<argument><expr><literal type="string">"simple"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
      <expr_stmt><expr><call><name><name>Mockito</name><operator>.</operator><name>when</name></name><argument_list>(<argument><expr><call><name><name>config</name><operator>.</operator><name>getInitParameter</name></name><argument_list>(
          <argument><expr><name><name>AuthenticationFilter</name><operator>.</operator><name>SIGNATURE_SECRET_FILE</name></name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call>
          <operator>.</operator><call><name>thenReturn</name><argument_list>(<argument><expr><call><name><name>secretFile</name><operator>.</operator><name>getAbsolutePath</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
      <expr_stmt><expr><call><name><name>Mockito</name><operator>.</operator><name>when</name></name><argument_list>(<argument><expr><call><name><name>config</name><operator>.</operator><name>getInitParameterNames</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call><operator>.</operator><call><name>thenReturn</name><argument_list>(
          <argument><expr><operator>new</operator> <call><name><name>Vector</name><argument_list type="generic">&lt;<argument><name>String</name></argument>&gt;</argument_list></name><argument_list>(<argument><expr><call><name><name>Arrays</name><operator>.</operator><name>asList</name></name><argument_list>(<argument><expr><name><name>AuthenticationFilter</name><operator>.</operator><name>AUTH_TYPE</name></name></expr></argument>,
              <argument><expr><name><name>AuthenticationFilter</name><operator>.</operator><name>SIGNATURE_SECRET_FILE</name></name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call><operator>.</operator><call><name>elements</name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
      <decl_stmt><decl><type><name>ServletContext</name></type> <name>context</name> <init>= <expr><call><name><name>Mockito</name><operator>.</operator><name>mock</name></name><argument_list>(<argument><expr><name><name>ServletContext</name><operator>.</operator><name>class</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
      <expr_stmt><expr><call><name><name>Mockito</name><operator>.</operator><name>when</name></name><argument_list>(<argument><expr><call><name><name>context</name><operator>.</operator><name>getAttribute</name></name><argument_list>(
          <argument><expr><name><name>AuthenticationFilter</name><operator>.</operator><name>SIGNER_SECRET_PROVIDER_ATTRIBUTE</name></name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call>
          <operator>.</operator><call><name>thenReturn</name><argument_list>(<argument><expr><literal type="null">null</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
      <expr_stmt><expr><call><name><name>Mockito</name><operator>.</operator><name>when</name></name><argument_list>(<argument><expr><call><name><name>config</name><operator>.</operator><name>getServletContext</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call><operator>.</operator><call><name>thenReturn</name><argument_list>(<argument><expr><name>context</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
      <expr_stmt><expr><call><name><name>filter</name><operator>.</operator><name>init</name></name><argument_list>(<argument><expr><name>config</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
      <expr_stmt><expr><call><name><name>Assert</name><operator>.</operator><name>assertFalse</name></name><argument_list>(<argument><expr><call><name><name>filter</name><operator>.</operator><name>isRandomSecret</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
      <expr_stmt><expr><call><name><name>Assert</name><operator>.</operator><name>assertFalse</name></name><argument_list>(<argument><expr><call><name><name>filter</name><operator>.</operator><name>isCustomSignerSecretProvider</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    </block_content>}</block> <finally>finally <block>{<block_content>
      <expr_stmt><expr><call><name><name>filter</name><operator>.</operator><name>destroy</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
    </block_content>}</block></finally></try>

     <comment type="line">// custom cookie domain and cookie path</comment>
     <expr_stmt><expr><name>filter</name> <operator>=</operator> <operator>new</operator> <call><name>AuthenticationFilter</name><argument_list>()</argument_list></call></expr>;</expr_stmt>
     <try>try <block>{<block_content>
<expr_stmt><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>hadoop</name><operator>-</operator><name>common</name><operator>-</operator><name>project</name><operator>/</operator><name>hadoop</name><operator>-</operator><name>common</name><operator>/</operator><name><name>CHANGES</name><operator>.</operator><name>txt</name></name> <name>b</name><operator>/</operator><name>hadoop</name><operator>-</operator><name>common</name><operator>-</operator><name>project</name><operator>/</operator><name>hadoop</name><operator>-</operator><name>common</name><operator>/</operator><name><name>CHANGES</name><operator>.</operator><name>txt</name></name>
<name>index</name> <name>a01a201206b</name><operator>..</operator><literal type="number">46dfee4d456</literal> <literal type="number">100644</literal>
<operator>--</operator> <name>a</name><operator>/</operator><name>hadoop</name><operator>-</operator><name>common</name><operator>-</operator><name>project</name><operator>/</operator><name>hadoop</name><operator>-</operator><name>common</name><operator>/</operator><name><name>CHANGES</name><operator>.</operator><name>txt</name></name>
<operator>++</operator> <name>b</name><operator>/</operator><name>hadoop</name><operator>-</operator><name>common</name><operator>-</operator><name>project</name><operator>/</operator><name>hadoop</name><operator>-</operator><name>common</name><operator>/</operator><name><name>CHANGES</name><operator>.</operator><name>txt</name></name>
@@ <operator>-</operator><literal type="number">710</literal></expr><operator>,</operator><expr><literal type="number">6</literal> <operator>+</operator><literal type="number">710</literal></expr><operator>,</operator><expr><literal type="number">9</literal> @@ <name>Release</name> <literal type="number">2.7.0</literal> <operator>-</operator> <name>UNRELEASED</name>
     <name>HADOOP</name><operator>-</operator><literal type="number">9329.</literal> <name>document</name> <specifier>native</specifier> <name>build</name> <name>dependencies</name> <name>in</name> <call><name><name>BUILDING</name><operator>.</operator><name>txt</name></name> <argument_list>(<argument><expr><name>Vijay</name> <name>Bhat</name>
     <name>via</name> <name>Colin</name> <name><name>P</name><operator>.</operator> <name>McCabe</name></name></expr></argument>)</argument_list></call>
 
    <name>HADOOP</name><operator>-</operator><literal type="number">10670.</literal> <name>Allow</name> <name>AuthenticationFilters</name> <name>to</name> <name>load</name> <name>secret</name> <name>from</name> <name>signature</name>
    <name>secret</name> <name><name>files</name><operator>.</operator></name> (<name>Kai</name> <name>Zheng</name> <name>via</name> <name>wheat9</name></expr></expr_stmt>)</block_content>

   OPTIMIZATIONS
 
     HADOOP-11323. WritableComparator#compare keeps reference to byte array.
diff --git a/hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/security/AuthenticationFilterInitializer.java b/hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/security/AuthenticationFilterInitializer.java
index 43d1b66d44f..cb3830d3ea2 100644
-- a/hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/security/AuthenticationFilterInitializer.java
++ b/hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/security/AuthenticationFilterInitializer.java
@@ -17</block><operator>,</operator><expr_stmt><expr><literal type="number">7</literal> <operator>+</operator><literal type="number">17</literal></expr><operator>,</operator><expr><literal type="number">6</literal> @@
  <operator>*</operator><operator>/</operator></expr></expr_stmt></try>
 <package>package <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>hadoop</name><operator>.</operator><name>security</name></name>;</package>
 
<import>import <name><name>com</name><operator>.</operator><name>google</name><operator>.</operator><name>common</name><operator>.</operator><name>base</name><operator>.</operator><name>Charsets</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>hadoop</name><operator>.</operator><name>http</name><operator>.</operator><name>HttpServer2</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>hadoop</name><operator>.</operator><name>security</name><operator>.</operator><name>authentication</name><operator>.</operator><name>server</name><operator>.</operator><name>AuthenticationFilter</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>hadoop</name><operator>.</operator><name>conf</name><operator>.</operator><name>Configuration</name></name>;</import>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">25</literal></expr><operator>,</operator><expr><literal type="number">11</literal> <operator>+</operator><literal type="number">24</literal></expr><operator>,</operator><expr><literal type="number">7</literal> @@</expr></expr_stmt>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>hadoop</name><operator>.</operator><name>http</name><operator>.</operator><name>FilterInitializer</name></name>;</import>
 <import>import <name><name>org</name><operator>.</operator><name>apache</name><operator>.</operator><name>hadoop</name><operator>.</operator><name>security</name><operator>.</operator><name>authentication</name><operator>.</operator><name>server</name><operator>.</operator><name>KerberosAuthenticationHandler</name></name>;</import>
 
<import>import <name><name>java</name><operator>.</operator><name>io</name><operator>.</operator><name>FileInputStream</name></name>;</import>
<import>import <name><name>java</name><operator>.</operator><name>io</name><operator>.</operator><name>FileReader</name></name>;</import>
 <import>import <name><name>java</name><operator>.</operator><name>io</name><operator>.</operator><name>IOException</name></name>;</import>
<import>import <name><name>java</name><operator>.</operator><name>io</name><operator>.</operator><name>InputStreamReader</name></name>;</import>
<import>import <name><name>java</name><operator>.</operator><name>io</name><operator>.</operator><name>Reader</name></name>;</import>
 <import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>HashMap</name></name>;</import>
 <import>import <name><name>java</name><operator>.</operator><name>util</name><operator>.</operator><name>Map</name></name>;</import>
 
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">50</literal></expr><operator>,</operator><expr><literal type="number">8</literal> <operator>+</operator><literal type="number">45</literal></expr><operator>,</operator><expr><literal type="number">6</literal> @@
 
   <specifier>static</specifier> <name>final</name> <name>String</name> <name>PREFIX</name> <operator>=</operator> <literal type="string">"hadoop.http.authentication."</literal></expr>;</expr_stmt>
 
  <decl_stmt><decl><type><specifier>static</specifier> <specifier>final</specifier> <name>String</name></type> <name>SIGNATURE_SECRET_FILE</name> <init>= <expr><name><name>AuthenticationFilter</name><operator>.</operator><name>SIGNATURE_SECRET</name></name> <operator>+</operator> <literal type="string">".file"</literal></expr></init></decl>;</decl_stmt>

   <comment type="block" format="javadoc">/**
    * Initializes hadoop-auth AuthenticationFilter.
    * &lt;p/&gt;
@@ -77,25 +70,6 @@ public void initFilter(FilterContainer container, Configuration conf) {
       }
     }
 
    String signatureSecretFile = filterConfig.get(SIGNATURE_SECRET_FILE);
    if (signatureSecretFile == null) {
      throw new RuntimeException("Undefined property: " + SIGNATURE_SECRET_FILE);      
    }

    StringBuilder secret = new StringBuilder();
    try (Reader reader = new InputStreamReader(
        new FileInputStream(signatureSecretFile), Charsets.UTF_8)) {
      int c = reader.read();
      while (c &gt; -1) {
        secret.append((char)c);
        c = reader.read();
      }
      reader.close();
      filterConfig.put(AuthenticationFilter.SIGNATURE_SECRET, secret.toString());
    } catch (IOException ex) {
      throw new RuntimeException("Could not read HTTP signature secret file: " + signatureSecretFile);            
    }

     //Resolve _HOST into bind address
     String bindAddress = conf.get(HttpServer2.BIND_ADDRESS);
     String principal = filterConfig.get(KerberosAuthenticationHandler.PRINCIPAL);
diff --git a/hadoop-common-project/hadoop-common/src/test/java/org/apache/hadoop/security/TestAuthenticationFilter.java b/hadoop-common-project/hadoop-common/src/test/java/org/apache/hadoop/security/TestAuthenticationFilter.java
index b6aae0eb637..c8179e2edc0 100644
-- a/hadoop-common-project/hadoop-common/src/test/java/org/apache/hadoop/security/TestAuthenticationFilter.java
++ b/hadoop-common-project/hadoop-common/src/test/java/org/apache/hadoop/security/TestAuthenticationFilter.java
@@ -37,17 +37,6 @@
   public void testConfiguration() throws Exception {
     Configuration conf = new Configuration();
     conf.set("hadoop.http.authentication.foo", "bar");
    
    File testDir = new File(System.getProperty("test.build.data", 
                                               "target/test-dir"));
    testDir.mkdirs();
    File secretFile = new File(testDir, "http-secret.txt");
    Writer writer = new FileWriter(new File(testDir, "http-secret.txt"));
    writer.write("hadoop");
    writer.close();
    conf.set(AuthenticationFilterInitializer.PREFIX + 
             AuthenticationFilterInitializer.SIGNATURE_SECRET_FILE, 
             secretFile.getAbsolutePath());
 
     conf.set(HttpServer2.BIND_ADDRESS, "barhost");
     
@@ -68,7 +57,6 @@ public Object answer(InvocationOnMock invocationOnMock)
 
           assertEquals("simple", conf.get("type"));
           assertEquals("36000", conf.get("token.validity"));
          assertEquals("hadoop", conf.get("signature.secret"));
           assertNull(conf.get("cookie.domain"));
           assertEquals("true", conf.get("simple.anonymous.allowed"));
           assertEquals("HTTP/barhost@LOCALHOST",
diff --git a/hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-applicationhistoryservice/src/main/java/org/apache/hadoop/yarn/server/timeline/security/TimelineAuthenticationFilterInitializer.java b/hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-applicationhistoryservice/src/main/java/org/apache/hadoop/yarn/server/timeline/security/TimelineAuthenticationFilterInitializer.java
index 1ee818145e6..a3c136c214f 100644
-- a/hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-applicationhistoryservice/src/main/java/org/apache/hadoop/yarn/server/timeline/security/TimelineAuthenticationFilterInitializer.java
++ b/hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-applicationhistoryservice/src/main/java/org/apache/hadoop/yarn/server/timeline/security/TimelineAuthenticationFilterInitializer.java
@@ -18,20 +18,11 @@
 
 package org.apache.hadoop.yarn.server.timeline.security;
 
import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.io.InputStreamReader;
import java.io.Reader;
import java.nio.charset.Charset;
import java.util.HashMap;
import java.util.Map;

import com.google.common.annotations.VisibleForTesting;
 import org.apache.hadoop.conf.Configuration;
 import org.apache.hadoop.http.FilterContainer;
 import org.apache.hadoop.http.FilterInitializer;
 import org.apache.hadoop.http.HttpServer2;
import org.apache.hadoop.io.IOUtils;
 import org.apache.hadoop.security.SecurityUtil;
 import org.apache.hadoop.security.authentication.server.AuthenticationFilter;
 import org.apache.hadoop.security.authentication.server.KerberosAuthenticationHandler;
@@ -42,7 +33,9 @@
 import org.apache.hadoop.security.token.delegation.web.PseudoDelegationTokenAuthenticationHandler;
 import org.apache.hadoop.yarn.security.client.TimelineDelegationTokenIdentifier;
 
import com.google.common.annotations.VisibleForTesting;
import java.io.IOException;
import java.util.HashMap;
import java.util.Map;
 
 /**
  * Initializes {@link TimelineAuthenticationFilter} which provides support for
@@ -62,9 +55,6 @@
    */</comment>
   <decl_stmt><decl><type><specifier>public</specifier> <specifier>static</specifier> <specifier>final</specifier> <name>String</name></type> <name>PREFIX</name> <init>= <expr><literal type="string">"yarn.timeline-service.http-authentication."</literal></expr></init></decl>;</decl_stmt>
 
  <decl_stmt><decl><type><specifier>private</specifier> <specifier>static</specifier> <specifier>final</specifier> <name>String</name></type> <name>SIGNATURE_SECRET_FILE</name> <init>=
      <expr><name><name>TimelineAuthenticationFilter</name><operator>.</operator><name>SIGNATURE_SECRET</name></name> <operator>+</operator> <literal type="string">".file"</literal></expr></init></decl>;</decl_stmt>

   <decl_stmt><decl><annotation>@<name>VisibleForTesting</name></annotation>
   <type><name><name>Map</name><argument_list type="generic">&lt;<argument><name>String</name></argument>, <argument><name>String</name></argument>&gt;</argument_list></name></type> <name>filterConfig</name></decl>;</decl_stmt>
 
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">106</literal></expr><operator>,</operator><expr><literal type="number">31</literal> <operator>+</operator><literal type="number">96</literal></expr><operator>,</operator><expr><literal type="number">6</literal> @@ <specifier>public</specifier> <name>void</name> <call><name>initFilter</name><argument_list>(<argument><expr><name>FilterContainer</name> <name>container</name></expr></argument>, <argument><expr><name>Configuration</name> <name>conf</name></expr></argument>)</argument_list></call> <block>{
       }</block></expr></expr_stmt>
     </block_content>}</block></if></if_stmt>
 
    <decl_stmt><decl><type><name>String</name></type> <name>signatureSecretFile</name> <init>= <expr><call><name><name>filterConfig</name><operator>.</operator><name>get</name></name><argument_list>(<argument><expr><name>SIGNATURE_SECRET_FILE</name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
    <if_stmt><if>if <condition>(<expr><name>signatureSecretFile</name> <operator>!=</operator> <literal type="null">null</literal></expr>)</condition> <block>{<block_content>
      <decl_stmt><decl><type><name>Reader</name></type> <name>reader</name> <init>= <expr><literal type="null">null</literal></expr></init></decl>;</decl_stmt>
      <try>try <block>{<block_content>
        <decl_stmt><decl><type><name>StringBuilder</name></type> <name>secret</name> <init>= <expr><operator>new</operator> <call><name>StringBuilder</name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><name>reader</name> <operator>=</operator> <operator>new</operator> <call><name>InputStreamReader</name><argument_list>(<argument><expr><operator>new</operator> <call><name>FileInputStream</name><argument_list>(<argument><expr><operator>new</operator> <call><name>File</name><argument_list>(<argument><expr><name>signatureSecretFile</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr></argument>,
                                      <argument><expr><call><name><name>Charset</name><operator>.</operator><name>forName</name></name><argument_list>(<argument><expr><literal type="string">"UTF-8"</literal></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <decl_stmt><decl><type><name>int</name></type> <name>c</name> <init>= <expr><call><name><name>reader</name><operator>.</operator><name>read</name></name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
        <while>while <condition>(<expr><name>c</name> <operator>&gt;</operator> <operator>-</operator><literal type="number">1</literal></expr>)</condition> <block>{<block_content>
          <expr_stmt><expr><call><name><name>secret</name><operator>.</operator><name>append</name></name><argument_list>(<argument><expr><operator>(</operator><name>char</name><operator>)</operator> <name>c</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
          <expr_stmt><expr><name>c</name> <operator>=</operator> <call><name><name>reader</name><operator>.</operator><name>read</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        </block_content>}</block></while>
        <expr_stmt><expr><call><name><name>filterConfig</name>
            <operator>.</operator><name>put</name></name><argument_list>(<argument><expr><name><name>TimelineAuthenticationFilter</name><operator>.</operator><name>SIGNATURE_SECRET</name></name></expr></argument>,
                <argument><expr><call><name><name>secret</name><operator>.</operator><name>toString</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
      </block_content>}</block> <catch>catch <parameter_list>(<parameter><decl><type><name>IOException</name></type> <name>ex</name></decl></parameter>)</parameter_list> <block>{<block_content>
        <throw>throw <expr><operator>new</operator> <call><name>RuntimeException</name><argument_list>(
            <argument><expr><literal type="string">"Could not read HTTP signature secret file: "</literal>
                <operator>+</operator> <name>signatureSecretFile</name></expr></argument>)</argument_list></call></expr>;</throw>
      </block_content>}</block></catch> <finally>finally <block>{<block_content>
        <expr_stmt><expr><call><name><name>IOUtils</name><operator>.</operator><name>closeStream</name></name><argument_list>(<argument><expr><name>reader</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
      </block_content>}</block></finally></try>
    </block_content>}</block></if></if_stmt>

     <decl_stmt><decl><type><name>String</name></type> <name>authType</name> <init>= <expr><call><name><name>filterConfig</name><operator>.</operator><name>get</name></name><argument_list>(<argument><expr><name><name>AuthenticationFilter</name><operator>.</operator><name>AUTH_TYPE</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
     <if_stmt><if>if <condition>(<expr><call><name><name>authType</name><operator>.</operator><name>equals</name></name><argument_list>(<argument><expr><name><name>PseudoAuthenticationHandler</name><operator>.</operator><name>TYPE</name></name></expr></argument>)</argument_list></call></expr>)</condition> <block>{<block_content>
       <expr_stmt><expr><call><name><name>filterConfig</name><operator>.</operator><name>put</name></name><argument_list>(<argument><expr><name><name>AuthenticationFilter</name><operator>.</operator><name>AUTH_TYPE</name></name></expr></argument>,
<argument><expr><name>diff</name> <operator>--</operator><name>git</name> <name>a</name><operator>/</operator><name>hadoop</name><operator>-</operator><name>yarn</name><operator>-</operator><name>project</name><operator>/</operator><name>hadoop</name><operator>-</operator><name>yarn</name><operator>/</operator><name>hadoop</name><operator>-</operator><name>yarn</name><operator>-</operator><name>server</name><operator>/</operator><name>hadoop</name><operator>-</operator><name>yarn</name><operator>-</operator><name>server</name><operator>-</operator><name>common</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>hadoop</name><operator>/</operator><name>yarn</name><operator>/</operator><name>server</name><operator>/</operator><name>security</name><operator>/</operator><name>http</name><operator>/</operator><name><name>RMAuthenticationFilterInitializer</name><operator>.</operator><name>java</name></name> <name>b</name><operator>/</operator><name>hadoop</name><operator>-</operator><name>yarn</name><operator>-</operator><name>project</name><operator>/</operator><name>hadoop</name><operator>-</operator><name>yarn</name><operator>/</operator><name>hadoop</name><operator>-</operator><name>yarn</name><operator>-</operator><name>server</name><operator>/</operator><name>hadoop</name><operator>-</operator><name>yarn</name><operator>-</operator><name>server</name><operator>-</operator><name>common</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>hadoop</name><operator>/</operator><name>yarn</name><operator>/</operator><name>server</name><operator>/</operator><name>security</name><operator>/</operator><name>http</name><operator>/</operator><name><name>RMAuthenticationFilterInitializer</name><operator>.</operator><name>java</name></name>
<name>index</name> <name>a62cda39a30</name><operator>..</operator><literal type="number">9fc13348c13</literal> <literal type="number">100644</literal>
<operator>--</operator> <name>a</name><operator>/</operator><name>hadoop</name><operator>-</operator><name>yarn</name><operator>-</operator><name>project</name><operator>/</operator><name>hadoop</name><operator>-</operator><name>yarn</name><operator>/</operator><name>hadoop</name><operator>-</operator><name>yarn</name><operator>-</operator><name>server</name><operator>/</operator><name>hadoop</name><operator>-</operator><name>yarn</name><operator>-</operator><name>server</name><operator>-</operator><name>common</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>hadoop</name><operator>/</operator><name>yarn</name><operator>/</operator><name>server</name><operator>/</operator><name>security</name><operator>/</operator><name>http</name><operator>/</operator><name><name>RMAuthenticationFilterInitializer</name><operator>.</operator><name>java</name></name>
<operator>++</operator> <name>b</name><operator>/</operator><name>hadoop</name><operator>-</operator><name>yarn</name><operator>-</operator><name>project</name><operator>/</operator><name>hadoop</name><operator>-</operator><name>yarn</name><operator>/</operator><name>hadoop</name><operator>-</operator><name>yarn</name><operator>-</operator><name>server</name><operator>/</operator><name>hadoop</name><operator>-</operator><name>yarn</name><operator>-</operator><name>server</name><operator>-</operator><name>common</name><operator>/</operator><name>src</name><operator>/</operator><name>main</name><operator>/</operator><name>java</name><operator>/</operator><name>org</name><operator>/</operator><name>apache</name><operator>/</operator><name>hadoop</name><operator>/</operator><name>yarn</name><operator>/</operator><name>server</name><operator>/</operator><name>security</name><operator>/</operator><name>http</name><operator>/</operator><name><name>RMAuthenticationFilterInitializer</name><operator>.</operator><name>java</name></name>
@@ <operator>-</operator><literal type="number">43</literal></expr></argument>,<argument><expr><literal type="number">14</literal> <operator>+</operator><literal type="number">43</literal></expr></argument>,<argument><expr><literal type="number">11</literal> @@
 <specifier>public</specifier> class <name>RMAuthenticationFilterInitializer</name> extends <name>FilterInitializer</name> <block>{
 
   <expr><name>String</name> <name>configPrefix</name></expr>;
  <name>String</name> <name>signatureSecretFileProperty</name></block></expr></argument>;</argument_list></call></expr></expr_stmt>
   <decl_stmt><decl><type><name>String</name></type> <name>kerberosPrincipalProperty</name></decl>;</decl_stmt>
   <decl_stmt><decl><type><name>String</name></type> <name>cookiePath</name></decl>;</decl_stmt>
 
   <constructor><specifier>public</specifier> <name>RMAuthenticationFilterInitializer</name><parameter_list>()</parameter_list> <block>{<block_content>
     <expr_stmt><expr><name><name>this</name><operator>.</operator><name>configPrefix</name></name> <operator>=</operator> <literal type="string">"hadoop.http.authentication."</literal></expr>;</expr_stmt>
    <expr_stmt><expr><name><name>this</name><operator>.</operator><name>signatureSecretFileProperty</name></name> <operator>=</operator>
        <name><name>AuthenticationFilter</name><operator>.</operator><name>SIGNATURE_SECRET</name></name> <operator>+</operator> <literal type="string">".file"</literal></expr>;</expr_stmt>
     <expr_stmt><expr><name><name>this</name><operator>.</operator><name>kerberosPrincipalProperty</name></name> <operator>=</operator> <name><name>KerberosAuthenticationHandler</name><operator>.</operator><name>PRINCIPAL</name></name></expr>;</expr_stmt>
     <expr_stmt><expr><name><name>this</name><operator>.</operator><name>cookiePath</name></name> <operator>=</operator> <literal type="string">"/"</literal></expr>;</expr_stmt>
   </block_content>}</block></constructor>
<annotation>@</annotation>@ <expr_stmt><expr><operator>-</operator><literal type="number">77</literal></expr><operator>,</operator><expr><literal type="number">34</literal> <operator>+</operator><literal type="number">74</literal></expr><operator>,</operator><expr><literal type="number">6</literal> @@ <specifier>public</specifier> <call><name>RMAuthenticationFilterInitializer</name><argument_list>()</argument_list></call> <block>{
       }</block></expr></expr_stmt>
     </block_content>}</block></if></if_stmt>
 
    <decl_stmt><decl><type><name>String</name></type> <name>signatureSecretFile</name> <init>= <expr><call><name><name>filterConfig</name><operator>.</operator><name>get</name></name><argument_list>(<argument><expr><name>signatureSecretFileProperty</name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
    <if_stmt><if>if <condition>(<expr><name>signatureSecretFile</name> <operator>!=</operator> <literal type="null">null</literal></expr>)</condition> <block>{<block_content>
      <decl_stmt><decl><type><name>Reader</name></type> <name>reader</name> <init>= <expr><literal type="null">null</literal></expr></init></decl>;</decl_stmt>
      <try>try <block>{<block_content>
        <decl_stmt><decl><type><name>StringBuilder</name></type> <name>secret</name> <init>= <expr><operator>new</operator> <call><name>StringBuilder</name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
        <expr_stmt><expr><name>reader</name> <operator>=</operator>
            <operator>new</operator> <call><name>InputStreamReader</name><argument_list>(<argument><expr><operator>new</operator> <call><name>FileInputStream</name><argument_list>(<argument><expr><name>signatureSecretFile</name></expr></argument>)</argument_list></call></expr></argument>,
              <argument><expr><literal type="string">"UTF-8"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <decl_stmt><decl><type><name>int</name></type> <name>c</name> <init>= <expr><call><name><name>reader</name><operator>.</operator><name>read</name></name><argument_list>()</argument_list></call></expr></init></decl>;</decl_stmt>
        <while>while <condition>(<expr><name>c</name> <operator>&gt;</operator> <operator>-</operator><literal type="number">1</literal></expr>)</condition> <block>{<block_content>
          <expr_stmt><expr><call><name><name>secret</name><operator>.</operator><name>append</name></name><argument_list>(<argument><expr><operator>(</operator><name>char</name><operator>)</operator> <name>c</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
          <expr_stmt><expr><name>c</name> <operator>=</operator> <call><name><name>reader</name><operator>.</operator><name>read</name></name><argument_list>()</argument_list></call></expr>;</expr_stmt>
        </block_content>}</block></while>
        <expr_stmt><expr><call><name><name>filterConfig</name><operator>.</operator><name>put</name></name><argument_list>(<argument><expr><name><name>AuthenticationFilter</name><operator>.</operator><name>SIGNATURE_SECRET</name></name></expr></argument>,
          <argument><expr><call><name><name>secret</name><operator>.</operator><name>toString</name></name><argument_list>()</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>
      </block_content>}</block> <catch>catch <parameter_list>(<parameter><decl><type><name>IOException</name></type> <name>ex</name></decl></parameter>)</parameter_list> <block>{<block_content>
        <comment type="line">// if running in non-secure mode, this filter only gets added</comment>
        <comment type="line">// because the user has not setup his own filter so just generate</comment>
        <comment type="line">// a random secret. in secure mode, the user needs to setup security</comment>
        <if_stmt><if>if <condition>(<expr><call><name><name>UserGroupInformation</name><operator>.</operator><name>isSecurityEnabled</name></name><argument_list>()</argument_list></call></expr>)</condition> <block>{<block_content>
          <throw>throw <expr><operator>new</operator> <call><name>RuntimeException</name><argument_list>(
            <argument><expr><literal type="string">"Could not read HTTP signature secret file: "</literal> <operator>+</operator> <name>signatureSecretFile</name></expr></argument>)</argument_list></call></expr>;</throw>
        </block_content>}</block></if></if_stmt>
      </block_content>}</block></catch> <finally>finally <block>{<block_content>
        <expr_stmt><expr><call><name><name>IOUtils</name><operator>.</operator><name>closeQuietly</name></name><argument_list>(<argument><expr><name>reader</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
      </block_content>}</block></finally></try>
    </block_content>}</block></if></if_stmt>

     <comment type="line">// Resolve _HOST into bind address</comment>
     <decl_stmt><decl><type><name>String</name></type> <name>bindAddress</name> <init>= <expr><call><name><name>conf</name><operator>.</operator><name>get</name></name><argument_list>(<argument><expr><name><name>HttpServer2</name><operator>.</operator><name>BIND_ADDRESS</name></name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
     <decl_stmt><decl><type><name>String</name></type> <name>principal</name> <init>= <expr><call><name><name>filterConfig</name><operator>.</operator><name>get</name></name><argument_list>(<argument><expr><name>kerberosPrincipalProperty</name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>
<expr_stmt><expr><operator>-</operator> 
<literal type="number">2.19.1.windows</literal><literal type="number">.1</literal></expr></expr_stmt></block_content></block></if></if_stmt>

</unit>
